<?xml version='1.0' encoding='utf-8'?><?xml-stylesheet href="https://www.blogger.com/styles/atom.css" type="text/css"?><feed xmlns='http://www.w3.org/2005/Atom' xmlns:openSearch='http://a9.com/-/spec/opensearchrss/1.0/' xmlns:gd='http://schemas.google.com/g/2005' xmlns:thr='http://purl.org/syndication/thread/1.0' xmlns:georss='http://www.georss.org/georss'><id>tag:blogger.com,1999:blog-3058240549611702067.archive</id><updated>2021-12-21T23:41:30.107+06:00</updated><title type='text'>Oracle Notes by Mikhail</title><link rel='http://schemas.google.com/g/2005#feed' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/archive'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/archive'/><link rel='http://schemas.google.com/g/2005#post' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/archive'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><generator version='7.00' uri='https://www.blogger.com'>Blogger</generator><entry><id>tag:blogger.com,1999:blog-3058240549611702067.layout</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#template'/><title type='text'>Шаблон: Oracle Notes by Mikhail</title><content type='text'>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;!DOCTYPE html&gt;
&lt;html b:version='2' class='v2' expr:dir='data:blog.languageDirection' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'&gt;
  &lt;head&gt;
    &lt;b:if cond='data:blog.isMobile'&gt;
      &lt;meta content='width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0' name='viewport'/&gt;
    &lt;b:else/&gt;
      &lt;meta content='width=1100' name='viewport'/&gt;
    &lt;/b:if&gt;
    &lt;b:include data='blog' name='all-head-content'/&gt;
    &lt;title&gt;&lt;data:blog.pageTitle/&gt;&lt;/title&gt;

    &lt;b:skin&gt;&lt;![CDATA[/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */

/* Variable definitions
   ====================
   &lt;Variable name="keycolor" description="Main Color" type="color" default="#66bbdd" value="#ffffff"/&gt;

   &lt;Group description="Page Text" selector="body"&gt;
     &lt;Variable name="body.font" description="Font" type="font"
         default="normal normal 12px Arial, Tahoma, Helvetica, FreeSans, sans-serif" value="normal normal 12px &amp;#39;Trebuchet MS&amp;#39;, Trebuchet, Verdana, sans-serif"/&gt;
     &lt;Variable name="body.text.color" description="Text Color" type="color" default="#222222" value="#666666"/&gt;
   &lt;/Group&gt;

   &lt;Group description="Backgrounds" selector=".body-fauxcolumns-outer"&gt;
     &lt;Variable name="body.background.color" description="Outer Background" type="color" default="#66bbdd" value="#ffffff"/&gt;
     &lt;Variable name="content.background.color" description="Main Background" type="color" default="#ffffff" value="#ffffff"/&gt;
     &lt;Variable name="header.background.color" description="Header Background" type="color" default="transparent" value="transparent"/&gt;
   &lt;/Group&gt;

   &lt;Group description="Links" selector=".main-outer"&gt;
     &lt;Variable name="link.color" description="Link Color" type="color" default="#2288bb" value="#2288bb"/&gt;
     &lt;Variable name="link.visited.color" description="Visited Color" type="color" default="#888888" value="#888888"/&gt;
     &lt;Variable name="link.hover.color" description="Hover Color" type="color" default="#33aaff" value="#33aaff"/&gt;
   &lt;/Group&gt;

   &lt;Group description="Blog Title" selector=".header h1"&gt;
     &lt;Variable name="header.font" description="Font" type="font"
         default="normal normal 60px Arial, Tahoma, Helvetica, FreeSans, sans-serif" value="normal normal 40px &amp;#39;Trebuchet MS&amp;#39;,Trebuchet,Verdana,sans-serif"/&gt;
     &lt;Variable name="header.text.color" description="Title Color" type="color" default="#3399bb"  value="#000000"/&gt;
   &lt;/Group&gt;

   &lt;Group description="Blog Description" selector=".header .description"&gt;
     &lt;Variable name="description.text.color" description="Description Color" type="color"
         default="#777777"  value="#000000"/&gt;
   &lt;/Group&gt;

   &lt;Group description="Tabs Text" selector=".tabs-inner .widget li a"&gt;
     &lt;Variable name="tabs.font" description="Font" type="font"
         default="normal normal 14px Arial, Tahoma, Helvetica, FreeSans, sans-serif" value="normal normal 12px &amp;#39;Trebuchet MS&amp;#39;, Trebuchet, Verdana, sans-serif"/&gt;
     &lt;Variable name="tabs.text.color" description="Text Color" type="color" default="#999999" value="#000000"/&gt;
     &lt;Variable name="tabs.selected.text.color" description="Selected Color" type="color" default="#000000" value="#000000"/&gt;
   &lt;/Group&gt;

   &lt;Group description="Tabs Background" selector=".tabs-outer .PageList"&gt;
     &lt;Variable name="tabs.background.color" description="Background Color" type="color" default="#f5f5f5" value="transparent"/&gt;
     &lt;Variable name="tabs.selected.background.color" description="Selected Color" type="color" default="#eeeeee" value="#eeeeee"/&gt;
   &lt;/Group&gt;

   &lt;Group description="Post Title" selector="h3.post-title, .comments h4"&gt;
     &lt;Variable name="post.title.font" description="Font" type="font"
         default="normal normal 22px Arial, Tahoma, Helvetica, FreeSans, sans-serif" value="normal normal 22px &amp;#39;Trebuchet MS&amp;#39;,Trebuchet,Verdana,sans-serif"/&gt;
   &lt;/Group&gt;

   &lt;Group description="Date Header" selector=".date-header"&gt;
     &lt;Variable name="date.header.color" description="Text Color" type="color"
         default="$(body.text.color)" value="#ffffff"/&gt;
     &lt;Variable name="date.header.background.color" description="Background Color" type="color"
         default="transparent" value="#bbbbbb"/&gt;
     &lt;Variable name="date.header.font" description="Text Font" type="font"
         default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif" value="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif"/&gt;
     &lt;Variable name="date.header.padding" description="Date Header Padding" type="string" default="inherit" value="0.4em"/&gt;
     &lt;Variable name="date.header.letterspacing" description="Date Header Letter Spacing" type="string" default="inherit" value="3px"/&gt;
     &lt;Variable name="date.header.margin" description="Date Header Margin" type="string" default="inherit" value="inherit"/&gt;
   &lt;/Group&gt;

   &lt;Group description="Post Footer" selector=".post-footer"&gt;
     &lt;Variable name="post.footer.text.color" description="Text Color" type="color" default="#666666" value="#666666"/&gt;
     &lt;Variable name="post.footer.background.color" description="Background Color" type="color"
         default="#f9f9f9" value="#eeeeee"/&gt;
     &lt;Variable name="post.footer.border.color" description="Shadow Color" type="color" default="#eeeeee" value="#eeeeee"/&gt;
   &lt;/Group&gt;

   &lt;Group description="Gadgets" selector="h2"&gt;
     &lt;Variable name="widget.title.font" description="Title Font" type="font"
         default="normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif" value="normal bold 11px &amp;#39;Trebuchet MS&amp;#39;,Trebuchet,Verdana,sans-serif"/&gt;
     &lt;Variable name="widget.title.text.color" description="Title Color" type="color" default="#000000" value="#000000"/&gt;
     &lt;Variable name="widget.alternate.text.color" description="Alternate Color" type="color" default="#999999" value="#999999"/&gt;
   &lt;/Group&gt;

   &lt;Group description="Images" selector=".main-inner"&gt;
     &lt;Variable name="image.background.color" description="Background Color" type="color" default="#ffffff" value="#ffffff"/&gt;
     &lt;Variable name="image.border.color" description="Border Color" type="color" default="#eeeeee" value="#eeeeee"/&gt;
     &lt;Variable name="image.text.color" description="Caption Text Color" type="color" default="$(body.text.color)" value="#666666"/&gt;
   &lt;/Group&gt;

   &lt;Group description="Accents" selector=".content-inner"&gt;
     &lt;Variable name="body.rule.color" description="Separator Line Color" type="color" default="#eeeeee" value="transparent"/&gt;
     &lt;Variable name="tabs.border.color" description="Tabs Border Color" type="color" default="$(body.rule.color)" value="#dddddd"/&gt;
   &lt;/Group&gt;

   &lt;Variable name="body.background" description="Body Background" type="background"
       color="$(body.background.color)" default="$(color) none repeat scroll top left" value="$(color) none repeat scroll top left"/&gt;
   &lt;Variable name="body.background.override" description="Body Background Override" type="string" default="" value=""/&gt;

   &lt;Variable name="body.background.gradient.cap" description="Body Gradient Cap" type="url"
       default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png)" value="none"/&gt;
   &lt;Variable name="body.background.gradient.tile" description="Body Gradient Tile" type="url"
       default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/body_gradient_tile_light.png)" value="none"/&gt;

   &lt;Variable name="content.background.color.selector" description="Content Background Color Selector" type="string" default=".content-inner" value=".content-inner"/&gt;
   &lt;Variable name="content.padding" description="Content Padding" type="length" default="10px" min="0" max="100px" value="10px"/&gt;
   &lt;Variable name="content.padding.horizontal" description="Content Horizontal Padding" type="length" default="$(content.padding)" min="0" max="100px" value="40px"/&gt;
   &lt;Variable name="content.shadow.spread" description="Content Shadow Spread" type="length" default="40px" min="0" max="100px" value="0"/&gt;
   &lt;Variable name="content.shadow.spread.webkit" description="Content Shadow Spread (WebKit)" type="length" default="5px" min="0" max="100px" value="0"/&gt;
   &lt;Variable name="content.shadow.spread.ie" description="Content Shadow Spread (IE)" type="length" default="10px" min="0" max="100px" value="0"/&gt;

   &lt;Variable name="main.border.width" description="Main Border Width" type="length" default="0" min="0" max="10px" value="0"/&gt;

   &lt;Variable name="header.background.gradient" description="Header Gradient" type="url" default="none" value="none"/&gt;
   &lt;Variable name="header.shadow.offset.left" description="Header Shadow Offset Left" type="length" default="-1px" min="-50px" max="50px" value="0"/&gt;
   &lt;Variable name="header.shadow.offset.top" description="Header Shadow Offset Top" type="length" default="-1px" min="-50px" max="50px" value="0"/&gt;
   &lt;Variable name="header.shadow.spread" description="Header Shadow Spread" type="length" default="1px" min="0" max="100px" value="0"/&gt;
   &lt;Variable name="header.padding" description="Header Padding" type="length" default="30px" min="0" max="100px" value="0"/&gt;

   &lt;Variable name="header.border.size" description="Header Border Size" type="length" default="1px" min="0" max="10px" value="1px"/&gt;
   &lt;Variable name="header.bottom.border.size" description="Header Bottom Border Size" type="length" default="$(header.border.size)" min="0" max="10px" value="0"/&gt;
   &lt;Variable name="header.border.horizontalsize" description="Header Horizontal Border Size" type="length" default="0" min="0" max="10px" value="1px"/&gt;

   &lt;Variable name="description.text.size" description="Description Text Size" type="string" default="140%" value="18px"/&gt;

   &lt;Variable name="tabs.margin.top" description="Tabs Margin Top" type="length" default="0" min="0" max="100px" value="0"/&gt;
   &lt;Variable name="tabs.margin.side" description="Tabs Side Margin" type="length" default="30px" min="0" max="100px" value="30px"/&gt;
   &lt;Variable name="tabs.background.gradient" description="Tabs Background Gradient" type="url"
       default="url(https://resources.blogblog.com/blogblog/data/1kt/simple/gradients_light.png)" value="none"/&gt;
   &lt;Variable name="tabs.border.width" description="Tabs Border Width" type="length" default="1px" min="0" max="10px" value="1px"/&gt;
   &lt;Variable name="tabs.bevel.border.width" description="Tabs Bevel Border Width" type="length" default="1px" min="0" max="10px" value="1px"/&gt;

   &lt;Variable name="post.margin.bottom" description="Post Bottom Margin" type="length" default="25px" min="0" max="100px" value="45px"/&gt;

   &lt;Variable name="image.border.small.size" description="Image Border Small Size" type="length" default="2px" min="0" max="10px" value="2px"/&gt;
   &lt;Variable name="image.border.large.size" description="Image Border Large Size" type="length" default="5px" min="0" max="10px" value="5px"/&gt;

   &lt;Variable name="page.width.selector" description="Page Width Selector" type="string" default=".region-inner" value=".region-inner"/&gt;
   &lt;Variable name="page.width" description="Page Width" type="string" default="auto" value="auto"/&gt;

   &lt;Variable name="main.section.margin" description="Main Section Margin" type="length" default="15px" min="0" max="100px" value="1em"/&gt;
   &lt;Variable name="main.padding" description="Main Padding" type="length" default="15px" min="0" max="100px" value="0"/&gt;
   &lt;Variable name="main.padding.top" description="Main Padding Top" type="length" default="30px" min="0" max="100px" value="35px"/&gt;
   &lt;Variable name="main.padding.bottom" description="Main Padding Bottom" type="length" default="30px" min="0" max="100px" value="65px"/&gt;

   &lt;Variable name="paging.background"
       color="$(content.background.color)"
       description="Background of blog paging area" type="background"
       default="transparent none no-repeat scroll top center" value="transparent url(//www.blogblog.com/1kt/simple/paging_dot.png) repeat-x scroll top center"/&gt;

   &lt;Variable name="footer.bevel" description="Bevel border length of footer" type="length" default="0" min="0" max="10px" value="1px"/&gt;

   &lt;Variable name="mobile.background.overlay" description="Mobile Background Overlay" type="string"
       default="transparent none repeat scroll top left" value="transparent none repeat scroll top left"/&gt;
   &lt;Variable name="mobile.background.size" description="Mobile Background Size" type="string" default="auto" value="auto"/&gt;
   &lt;Variable name="mobile.button.color" description="Mobile Button Color" type="color" default="#ffffff"  value="#ffffff"/&gt;

   &lt;Variable name="startSide" description="Side where text starts in blog language" type="automatic" default="left"/&gt;
   &lt;Variable name="endSide" description="Side where text ends in blog language" type="automatic" default="right"/&gt;
*/

/* Content
----------------------------------------------- */
body {
  font: $(body.font);
  color: $(body.text.color);
  background: $(body.background);
  padding: 0 $(content.shadow.spread) $(content.shadow.spread) $(content.shadow.spread);
  $(body.background.override)
}

html body $(page.width.selector) {
  min-width: 0;
  max-width: 100%;
  width: $(page.width);
}

h2 {
  font-size: 22px;
}

a:link {
  text-decoration:none;
  color: $(link.color);
}

a:visited {
  text-decoration:none;
  color: $(link.visited.color);
}

a:hover {
  text-decoration:underline;
  color: $(link.hover.color);
}

.body-fauxcolumn-outer .fauxcolumn-inner {
  background: transparent $(body.background.gradient.tile) repeat scroll top left;
  _background-image: none;
}

.body-fauxcolumn-outer .cap-top {
  position: absolute;
  z-index: 1;
  height: 400px;
  width: 100%;
}

.body-fauxcolumn-outer .cap-top .cap-left {
  width: 100%;
  background: transparent $(body.background.gradient.cap) repeat-x scroll top left;
  _background-image: none;
}

.content-outer {
  -moz-box-shadow: 0 0 $(content.shadow.spread) rgba(0, 0, 0, .15);
  -webkit-box-shadow: 0 0 $(content.shadow.spread.webkit) rgba(0, 0, 0, .15);
  -goog-ms-box-shadow: 0 0 $(content.shadow.spread.ie) #333333;
  box-shadow: 0 0 $(content.shadow.spread) rgba(0, 0, 0, .15);

  margin-bottom: 1px;
}

.content-inner {
  padding: $(content.padding) $(content.padding.horizontal);
}

$(content.background.color.selector) {
  background-color: $(content.background.color);
}

/* Header
----------------------------------------------- */
.header-outer {
  background: $(header.background.color) $(header.background.gradient) repeat-x scroll 0 -400px;
  _background-image: none;
}

.Header h1 {
  font: $(header.font);
  color: $(header.text.color);
  text-shadow: $(header.shadow.offset.left) $(header.shadow.offset.top) $(header.shadow.spread) rgba(0, 0, 0, .2);
}

.Header h1 a {
  color: $(header.text.color);
}

.Header .description {
  font-size: $(description.text.size);
  color: $(description.text.color);
}

.header-inner .Header .titlewrapper {
  padding: 22px $(header.padding);
}

.header-inner .Header .descriptionwrapper {
  padding: 0 $(header.padding);
}

/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
  border-top: $(header.bottom.border.size) solid $(tabs.border.color);
}

.tabs-inner .section:first-child ul {
  margin-top: -$(header.border.size);
  border-top: $(header.border.size) solid $(tabs.border.color);
  border-left: $(header.border.horizontalsize) solid $(tabs.border.color);
  border-right: $(header.border.horizontalsize) solid $(tabs.border.color);
}

.tabs-inner .widget ul {
  background: $(tabs.background.color) $(tabs.background.gradient) repeat-x scroll 0 -800px;
  _background-image: none;
  border-bottom: $(tabs.border.width) solid $(tabs.border.color);

  margin-top: $(tabs.margin.top);
  margin-left: -$(tabs.margin.side);
  margin-right: -$(tabs.margin.side);
}

.tabs-inner .widget li a {
  display: inline-block;

  padding: .6em 1em;

  font: $(tabs.font);
  color: $(tabs.text.color);

  border-$startSide: $(tabs.border.width) solid $(content.background.color);
  border-$endSide: $(tabs.bevel.border.width) solid $(tabs.border.color);
}

.tabs-inner .widget li:first-child a {
  border-$startSide: none;
}

.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
  color: $(tabs.selected.text.color);
  background-color: $(tabs.selected.background.color);
  text-decoration: none;
}

/* Columns
----------------------------------------------- */
.main-outer {
  border-top: $(main.border.width) solid $(body.rule.color);
}

.fauxcolumn-left-outer .fauxcolumn-inner {
  border-right: 1px solid $(body.rule.color);
}

.fauxcolumn-right-outer .fauxcolumn-inner {
  border-left: 1px solid $(body.rule.color);
}

/* Headings
----------------------------------------------- */
div.widget &gt; h2,
div.widget h2.title {
  margin: 0 0 1em 0;

  font: $(widget.title.font);
  color: $(widget.title.text.color);
}

/* Widgets
----------------------------------------------- */
.widget .zippy {
  color: $(widget.alternate.text.color);
  text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}

.widget .popular-posts ul {
  list-style: none;
}

/* Posts
----------------------------------------------- */
h2.date-header {
  font: $(date.header.font);
}

.date-header span {
  background-color: $(date.header.background.color);
  color: $(date.header.color);
  padding: $(date.header.padding);
  letter-spacing: $(date.header.letterspacing);
  margin: $(date.header.margin);
}

.main-inner {
  padding-top: $(main.padding.top);
  padding-bottom: $(main.padding.bottom);
}

.main-inner .column-center-inner {
  padding: 0 $(main.padding);
}

.main-inner .column-center-inner .section {
  margin: 0 $(main.section.margin);
}

.post {
  margin: 0 0 $(post.margin.bottom) 0;
}

h3.post-title, .comments h4 {
  font: $(post.title.font);
  margin: .75em 0 0;
}

.post-body {
  font-size: 110%;
  line-height: 1.4;
  position: relative;
}

.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
  padding: $(image.border.small.size);

  background: $(image.background.color);
  border: 1px solid $(image.border.color);

  -moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
  -webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
  box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}

.post-body img, .post-body .tr-caption-container {
  padding: $(image.border.large.size);
}

.post-body .tr-caption-container {
  color: $(image.text.color);
}

.post-body .tr-caption-container img {
  padding: 0;

  background: transparent;
  border: none;

  -moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
  -webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
  box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}

.post-header {
  margin: 0 0 1.5em;

  line-height: 1.6;
  font-size: 90%;
}

.post-footer {
  margin: 20px -2px 0;
  padding: 5px 10px;

  color: $(post.footer.text.color);
  background-color: $(post.footer.background.color);
  border-bottom: 1px solid $(post.footer.border.color);

  line-height: 1.6;
  font-size: 90%;
}

#comments .comment-author {
  padding-top: 1.5em;

  border-top: 1px solid $(body.rule.color);
  background-position: 0 1.5em;
}

#comments .comment-author:first-child {
  padding-top: 0;
  border-top: none;
}

.avatar-image-container {
  margin: .2em 0 0;
}

#comments .avatar-image-container img {
  border: 1px solid $(image.border.color);
}

/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
  background-repeat: no-repeat;
  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}

.comments .comments-content .loadmore a {
  border-top: 1px solid $(widget.alternate.text.color);
  border-bottom: 1px solid $(widget.alternate.text.color);
}

.comments .comment-thread.inline-thread {
  background-color: $(post.footer.background.color);
}

.comments .continue {
  border-top: 2px solid $(widget.alternate.text.color);
}

/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
  border-$startSide: 1px solid $(body.rule.color);
}

.blog-pager {
  background: $(paging.background);
}

.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
  background-color: $(content.background.color);
  padding: 5px;
}

.footer-outer {
  border-top: $(footer.bevel) dashed #bbbbbb;
}

/* Mobile
----------------------------------------------- */
body.mobile  {
  background-size: $(mobile.background.size);
}

.mobile .body-fauxcolumn-outer {
  background: $(mobile.background.overlay);
}

.mobile .body-fauxcolumn-outer .cap-top {
  background-size: 100% auto;
}

.mobile .content-outer {
  -webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
  box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}

.mobile .tabs-inner .widget ul {
  margin-left: 0;
  margin-right: 0;
}

.mobile .post {
  margin: 0;
}

.mobile .main-inner .column-center-inner .section {
  margin: 0;
}

.mobile .date-header span {
  padding: 0.1em 10px;
  margin: 0 -10px;
}

.mobile h3.post-title {
  margin: 0;
}

.mobile .blog-pager {
  background: transparent none no-repeat scroll top center;
}

.mobile .footer-outer {
  border-top: none;
}

.mobile .main-inner, .mobile .footer-inner {
  background-color: $(content.background.color);
}

.mobile-index-contents {
  color: $(body.text.color);
}

.mobile-link-button {
  background-color: $(link.color);
}

.mobile-link-button a:link, .mobile-link-button a:visited {
  color: $(mobile.button.color);
}

.mobile .tabs-inner .section:first-child {
  border-top: none;
}

.mobile .tabs-inner .PageList .widget-content {
  background-color: $(tabs.selected.background.color);
  color: $(tabs.selected.text.color);
  border-top: $(tabs.border.width) solid $(tabs.border.color);
  border-bottom: $(tabs.border.width) solid $(tabs.border.color);
}

.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
  border-$startSide: 1px solid $(tabs.border.color);
}
]]&gt;&lt;/b:skin&gt;

    &lt;b:template-skin&gt;
      &lt;b:variable default='960px' name='content.width' type='length' value='1300px'/&gt;
      &lt;b:variable default='0' name='main.column.left.width' type='length'/&gt;
      &lt;b:variable default='310px' name='main.column.right.width' type='length' value='370px'/&gt;

      &lt;![CDATA[
      body {
        min-width: $(content.width);
      }

      .content-outer, .content-fauxcolumn-outer, .region-inner {
        min-width: $(content.width);
        max-width: $(content.width);
        _width: $(content.width);
      }

      .main-inner .columns {
        padding-left: $(main.column.left.width);
        padding-right: $(main.column.right.width);
      }

      .main-inner .fauxcolumn-center-outer {
        left: $(main.column.left.width);
        right: $(main.column.right.width);
        /* IE6 does not respect left and right together */
        _width: expression(this.parentNode.offsetWidth -
            parseInt("$(main.column.left.width)") -
            parseInt("$(main.column.right.width)") + 'px');
      }

      .main-inner .fauxcolumn-left-outer {
        width: $(main.column.left.width);
      }

      .main-inner .fauxcolumn-right-outer {
        width: $(main.column.right.width);
      }

      .main-inner .column-left-outer {
        width: $(main.column.left.width);
        right: 100%;
        margin-left: -$(main.column.left.width);
      }

      .main-inner .column-right-outer {
        width: $(main.column.right.width);
        margin-right: -$(main.column.right.width);
      }

      #layout {
        min-width: 0;
      }

      #layout .content-outer {
        min-width: 0;
        width: 800px;
      }

      #layout .region-inner {
        min-width: 0;
        width: auto;
      }
      ]]&gt;
    &lt;/b:template-skin&gt;
    &lt;b:include data='blog' name='google-analytics'/&gt;
    &lt;!-- syntax highlighter--&gt;
    &lt;link href='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCore.css' rel='stylesheet' type='text/css'/&gt;
    &lt;link href='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shThemeDefault.css' rel='stylesheet' type='text/css'/&gt;
    &lt;script src='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shCore.js' type='text/javascript'/&gt;
    &lt;script src='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushSql.js' type='text/javascript'/&gt;
    &lt;script src='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushCpp.js' type='text/javascript'/&gt;
    &lt;script src='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushBash.js' type='text/javascript'/&gt;
    &lt;script src='https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushXml.js' type='text/javascript'/&gt;
    &lt;script language='javascript'&gt;
      SyntaxHighlighter.config.bloggerMode = true;
      SyntaxHighlighter.config.clipboardSwf = &amp;#39;http://alexgorbatchev.com/pub/sh/current/scripts/clipboard.swf&amp;#39;;
      SyntaxHighlighter.all();
    &lt;/script&gt;
  &lt;/head&gt;

  &lt;body expr:class='&amp;quot;loading&amp;quot; + data:blog.mobileClass'&gt;
  &lt;b:section class='navbar' id='navbar' maxwidgets='1' showaddelement='no'&gt;
    &lt;b:widget id='Navbar1' locked='true' title='Панель навигации' type='Navbar'&gt;
      &lt;b:includable id='main'&gt;&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener(&amp;#39;load&amp;#39;,
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent(&amp;#39;onload&amp;#39;, function(){ object[attribute] = val; });
      }
    }
  &amp;lt;/script&amp;gt;
&amp;lt;div id=&amp;quot;navbar-iframe-container&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;
&amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;https://apis.google.com/js/plusone.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
      gapi.load(&amp;quot;gapi.iframes:gapi.iframes.style.bubble&amp;quot;, function() {
        if (gapi.iframes &amp;amp;&amp;amp; gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: &amp;#39;https://www.blogger.com/navbar.g?targetBlogID\x3d3058240549611702067\x26blogName\x3dOracle+Notes+by+Mikhail\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://mvelikikh.blogspot.com/search\x26blogLocale\x3dru\x26v\x3d2\x26homepageUrl\x3dhttps://mvelikikh.blogspot.com/\x26vt\x3d7961882859596253766&amp;#39;,
              where: document.getElementById(&amp;quot;navbar-iframe-container&amp;quot;),
              id: &amp;quot;navbar-iframe&amp;quot;
          });
        }
      });
    &amp;lt;/script&amp;gt;&amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
(function() {
var script = document.createElement(&amp;#39;script&amp;#39;);
script.type = &amp;#39;text/javascript&amp;#39;;
script.src = &amp;#39;//pagead2.googlesyndication.com/pagead/js/google_top_exp.js&amp;#39;;
var head = document.getElementsByTagName(&amp;#39;head&amp;#39;)[0];
if (head) {
head.appendChild(script);
}})();
&amp;lt;/script&amp;gt;
&lt;/b:includable&gt;
    &lt;/b:widget&gt;
  &lt;/b:section&gt;

  &lt;b:if cond='data:blog.pageType == &amp;quot;index&amp;quot;'&gt;
    &lt;div itemscope='itemscope' itemtype='http://schema.org/Blog' style='display: none;'&gt;
      &lt;meta expr:content='data:blog.title' itemprop='name'/&gt;
      &lt;b:if cond='data:blog.metaDescription'&gt;
        &lt;meta expr:content='data:blog.metaDescription' itemprop='description'/&gt;
      &lt;/b:if&gt;
    &lt;/div&gt;
  &lt;/b:if&gt;

  &lt;div class='body-fauxcolumns'&gt;
    &lt;div class='fauxcolumn-outer body-fauxcolumn-outer'&gt;
    &lt;div class='cap-top'&gt;
      &lt;div class='cap-left'/&gt;
      &lt;div class='cap-right'/&gt;
    &lt;/div&gt;
    &lt;div class='fauxborder-left'&gt;
    &lt;div class='fauxborder-right'/&gt;
    &lt;div class='fauxcolumn-inner'&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class='cap-bottom'&gt;
      &lt;div class='cap-left'/&gt;
      &lt;div class='cap-right'/&gt;
    &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;div class='content'&gt;
  &lt;div class='content-fauxcolumns'&gt;
    &lt;div class='fauxcolumn-outer content-fauxcolumn-outer'&gt;
    &lt;div class='cap-top'&gt;
      &lt;div class='cap-left'/&gt;
      &lt;div class='cap-right'/&gt;
    &lt;/div&gt;
    &lt;div class='fauxborder-left'&gt;
    &lt;div class='fauxborder-right'/&gt;
    &lt;div class='fauxcolumn-inner'&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class='cap-bottom'&gt;
      &lt;div class='cap-left'/&gt;
      &lt;div class='cap-right'/&gt;
    &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;div class='content-outer'&gt;
  &lt;div class='content-cap-top cap-top'&gt;
    &lt;div class='cap-left'/&gt;
    &lt;div class='cap-right'/&gt;
  &lt;/div&gt;
  &lt;div class='fauxborder-left content-fauxborder-left'&gt;
  &lt;div class='fauxborder-right content-fauxborder-right'/&gt;
  &lt;div class='content-inner'&gt;

    &lt;header&gt;
    &lt;div class='header-outer'&gt;
    &lt;div class='header-cap-top cap-top'&gt;
      &lt;div class='cap-left'/&gt;
      &lt;div class='cap-right'/&gt;
    &lt;/div&gt;
    &lt;div class='fauxborder-left header-fauxborder-left'&gt;
    &lt;div class='fauxborder-right header-fauxborder-right'/&gt;
    &lt;div class='region-inner header-inner'&gt;
      &lt;b:section class='header' id='header' maxwidgets='1' showaddelement='no'&gt;
        &lt;b:widget id='Header1' locked='true' title='Oracle Notes by Mikhail (заголовок)' type='Header'&gt;
          &lt;b:widget-settings&gt;
            &lt;b:widget-setting name='displayUrl'/&gt;
            &lt;b:widget-setting name='displayHeight'&gt;0&lt;/b:widget-setting&gt;
            &lt;b:widget-setting name='sectionWidth'&gt;-1&lt;/b:widget-setting&gt;
            &lt;b:widget-setting name='useImage'&gt;false&lt;/b:widget-setting&gt;
            &lt;b:widget-setting name='shrinkToFit'&gt;false&lt;/b:widget-setting&gt;
            &lt;b:widget-setting name='imagePlacement'&gt;BEHIND&lt;/b:widget-setting&gt;
            &lt;b:widget-setting name='displayWidth'&gt;0&lt;/b:widget-setting&gt;
          &lt;/b:widget-settings&gt;
          &lt;b:includable id='main'&gt;

  &lt;b:if cond='data:useImage'&gt;
    &lt;b:if cond='data:imagePlacement == &amp;quot;BEHIND&amp;quot;'&gt;
      &lt;!--
      Show image as background to text. You can't really calculate the width
      reliably in JS because margins are not taken into account by any of
      clientWidth, offsetWidth or scrollWidth, so we don't force a minimum
      width if the user is using shrink to fit.
      This results in a margin-width's worth of pixels being cropped. If the
      user is not using shrink to fit then we expand the header.
      --&gt;
      &lt;b:if cond='data:mobile'&gt;
        &lt;div id='header-inner'&gt;
          &lt;div class='titlewrapper' style='background: transparent'&gt;
            &lt;h1 class='title' style='background: transparent; border-width: 0px'&gt;
              &lt;b:include name='title'/&gt;
            &lt;/h1&gt;
          &lt;/div&gt;
          &lt;b:include name='description'/&gt;
        &lt;/div&gt;
      &lt;b:else/&gt;
        &lt;div expr:style='&amp;quot;background-image: url(\&amp;quot;&amp;quot; + data:sourceUrl + &amp;quot;\&amp;quot;); &amp;quot;                      + &amp;quot;background-position: &amp;quot;                      + data:backgroundPositionStyleStr + &amp;quot;; &amp;quot;                      + data:widthStyleStr                      + &amp;quot;min-height: &amp;quot; + data:height                      + &amp;quot;_height: &amp;quot; + data:height                      + &amp;quot;background-repeat: no-repeat; &amp;quot;' id='header-inner'&gt;
          &lt;div class='titlewrapper' style='background: transparent'&gt;
            &lt;h1 class='title' style='background: transparent; border-width: 0px'&gt;
              &lt;b:include name='title'/&gt;
            &lt;/h1&gt;
          &lt;/div&gt;
          &lt;b:include name='description'/&gt;
        &lt;/div&gt;
      &lt;/b:if&gt;
    &lt;b:else/&gt;
      &lt;!--Show the image only--&gt;
      &lt;div id='header-inner'&gt;
        &lt;a expr:href='data:blog.homepageUrl' style='display: block'&gt;
          &lt;img expr:alt='data:title' expr:height='data:height' expr:id='data:widget.instanceId + &amp;quot;_headerimg&amp;quot;' expr:src='data:sourceUrl' expr:width='data:width' style='display: block'/&gt;
        &lt;/a&gt;
        &lt;!--Show the description--&gt;
        &lt;b:if cond='data:imagePlacement == &amp;quot;BEFORE_DESCRIPTION&amp;quot;'&gt;
          &lt;b:include name='description'/&gt;
        &lt;/b:if&gt;
      &lt;/div&gt;
    &lt;/b:if&gt;
  &lt;b:else/&gt;
    &lt;!--No header image --&gt;
    &lt;div id='header-inner'&gt;
      &lt;div class='titlewrapper'&gt;
        &lt;h1 class='title'&gt;
          &lt;b:include name='title'/&gt;
        &lt;/h1&gt;
      &lt;/div&gt;
      &lt;b:include name='description'/&gt;
    &lt;/div&gt;
  &lt;/b:if&gt;
&lt;/b:includable&gt;
          &lt;b:includable id='description'&gt;
  &lt;div class='descriptionwrapper'&gt;
    &lt;p class='description'&gt;&lt;span&gt;&lt;data:description/&gt;&lt;/span&gt;&lt;/p&gt;
  &lt;/div&gt;
&lt;/b:includable&gt;
          &lt;b:includable id='title'&gt;
  &lt;b:tag cond='data:blog.url != data:blog.homepageUrl' expr:href='data:blog.homepageUrl' name='a'&gt;
    &lt;data:title/&gt;
  &lt;/b:tag&gt;
&lt;/b:includable&gt;
        &lt;/b:widget&gt;
      &lt;/b:section&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class='header-cap-bottom cap-bottom'&gt;
      &lt;div class='cap-left'/&gt;
      &lt;div class='cap-right'/&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;/header&gt;

    &lt;div class='tabs-outer'&gt;
    &lt;div class='tabs-cap-top cap-top'&gt;
      &lt;div class='cap-left'/&gt;
      &lt;div class='cap-right'/&gt;
    &lt;/div&gt;
    &lt;div class='fauxborder-left tabs-fauxborder-left'&gt;
    &lt;div class='fauxborder-right tabs-fauxborder-right'/&gt;
    &lt;div class='region-inner tabs-inner'&gt;
      &lt;b:section class='tabs' id='crosscol' maxwidgets='1' showaddelement='yes'&gt;
        &lt;b:widget id='PageList1' locked='false' title='Страницы' type='PageList'&gt;
          &lt;b:widget-settings&gt;
            &lt;b:widget-setting name='pageListJson'&gt;&lt;![CDATA[{'home': {'href': 'http://mvelikikh.blogspot.com/', 'title': 'Home', 'position': 0}, '5151012371039921477': {'href': 'http://mvelikikh.blogspot.com/p/events.html', 'title': 'events', 'position': 1}}]]&gt;&lt;/b:widget-setting&gt;
            &lt;b:widget-setting name='homeTitle'&gt;Home&lt;/b:widget-setting&gt;
          &lt;/b:widget-settings&gt;
          &lt;b:includable id='main'&gt;
  &lt;b:if cond='data:title != &amp;quot;&amp;quot;'&gt;&lt;h2&gt;&lt;data:title/&gt;&lt;/h2&gt;&lt;/b:if&gt;
  &lt;div class='widget-content'&gt;
    &lt;b:if cond='data:mobile'&gt;
      &lt;select expr:id='data:widget.instanceId + &amp;quot;_select&amp;quot;'&gt;
        &lt;b:loop values='data:links' var='link'&gt;
          &lt;option expr:value='data:link.href'&gt;
            &lt;b:attr cond='data:link.isCurrentPage' name='selected' value='selected'/&gt;
            &lt;data:link.title/&gt;
          &lt;/option&gt;
        &lt;/b:loop&gt;
      &lt;/select&gt;
      &lt;span class='pagelist-arrow'&gt;&amp;amp;#9660;&lt;/span&gt;
    &lt;b:else/&gt;
      &lt;ul&gt;
        &lt;b:loop values='data:links' var='link'&gt;
          &lt;li&gt;
            &lt;b:class cond='data:link.isCurrentPage' name='selected'/&gt;
            &lt;a expr:href='data:link.href'&gt;&lt;data:link.title/&gt;&lt;/a&gt;
          &lt;/li&gt;
        &lt;/b:loop&gt;
      &lt;/ul&gt;
    &lt;/b:if&gt;
    &lt;b:include name='quickedit'/&gt;
  &lt;/div&gt;
&lt;/b:includable&gt;
        &lt;/b:widget&gt;
      &lt;/b:section&gt;
      &lt;b:section class='tabs' id='crosscol-overflow' showaddelement='no'/&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class='tabs-cap-bottom cap-bottom'&gt;
      &lt;div class='cap-left'/&gt;
      &lt;div class='cap-right'/&gt;
    &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class='main-outer'&gt;
    &lt;div class='main-cap-top cap-top'&gt;
      &lt;div class='cap-left'/&gt;
      &lt;div class='cap-right'/&gt;
    &lt;/div&gt;

    &lt;div class='fauxborder-left main-fauxborder-left'&gt;
    &lt;div class='fauxborder-right main-fauxborder-right'/&gt;
    &lt;div class='region-inner main-inner'&gt;

      &lt;div class='columns fauxcolumns'&gt;

        &lt;div class='fauxcolumn-outer fauxcolumn-center-outer'&gt;
        &lt;div class='cap-top'&gt;
          &lt;div class='cap-left'/&gt;
          &lt;div class='cap-right'/&gt;
        &lt;/div&gt;
        &lt;div class='fauxborder-left'&gt;
        &lt;div class='fauxborder-right'/&gt;
        &lt;div class='fauxcolumn-inner'&gt;
        &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class='cap-bottom'&gt;
          &lt;div class='cap-left'/&gt;
          &lt;div class='cap-right'/&gt;
        &lt;/div&gt;
        &lt;/div&gt;

        &lt;div class='fauxcolumn-outer fauxcolumn-left-outer'&gt;
        &lt;div class='cap-top'&gt;
          &lt;div class='cap-left'/&gt;
          &lt;div class='cap-right'/&gt;
        &lt;/div&gt;
        &lt;div class='fauxborder-left'&gt;
        &lt;div class='fauxborder-right'/&gt;
        &lt;div class='fauxcolumn-inner'&gt;
        &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class='cap-bottom'&gt;
          &lt;div class='cap-left'/&gt;
          &lt;div class='cap-right'/&gt;
        &lt;/div&gt;
        &lt;/div&gt;

        &lt;div class='fauxcolumn-outer fauxcolumn-right-outer'&gt;
        &lt;div class='cap-top'&gt;
          &lt;div class='cap-left'/&gt;
          &lt;div class='cap-right'/&gt;
        &lt;/div&gt;
        &lt;div class='fauxborder-left'&gt;
        &lt;div class='fauxborder-right'/&gt;
        &lt;div class='fauxcolumn-inner'&gt;
        &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class='cap-bottom'&gt;
          &lt;div class='cap-left'/&gt;
          &lt;div class='cap-right'/&gt;
        &lt;/div&gt;
        &lt;/div&gt;

        &lt;!-- corrects IE6 width calculation --&gt;
        &lt;div class='columns-inner'&gt;

        &lt;div class='column-center-outer'&gt;
        &lt;div class='column-center-inner'&gt;
          &lt;b:section class='main' id='main' showaddelement='no'&gt;
            &lt;b:widget id='Blog1' locked='true' title='Сообщения блога' type='Blog'&gt;
              &lt;b:widget-settings&gt;
                &lt;b:widget-setting name='showDateHeader'&gt;true&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='style.textcolor'&gt;#666666&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='showShareButtons'&gt;true&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='showCommentLink'&gt;true&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='style.urlcolor'&gt;#666666&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='showAuthor'&gt;true&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='disableGooglePlusShare'&gt;true&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='style.linkcolor'&gt;#2288bb&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='style.unittype'&gt;TextAndImage&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='style.bgcolor'&gt;#ffffff&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='reactionsLabel'/&gt;
                &lt;b:widget-setting name='showAuthorProfile'&gt;false&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='style.layout'&gt;1x1&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='showLabels'&gt;true&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='showLocation'&gt;true&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='showTimestamp'&gt;true&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='postsPerAd'&gt;1&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='showBacklinks'&gt;false&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='style.bordercolor'&gt;#ffffff&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='showInlineAds'&gt;false&lt;/b:widget-setting&gt;
                &lt;b:widget-setting name='showReactions'&gt;false&lt;/b:widget-setting&gt;
              &lt;/b:widget-settings&gt;
              &lt;b:includable id='main' var='top'&gt;
  &lt;b:if cond='!data:mobile'&gt;
    &lt;!-- posts --&gt;
    &lt;div class='blog-posts hfeed'&gt;

      &lt;b:include data='top' name='status-message'/&gt;

      &lt;b:loop values='data:posts' var='post'&gt;
        &lt;b:if cond='data:post.isDateStart and not data:post.isFirstPost'&gt;
          &amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;
        &lt;/b:if&gt;
        &lt;b:if cond='data:post.isDateStart'&gt;
          &amp;lt;div class=&amp;quot;date-outer&amp;quot;&amp;gt;
        &lt;/b:if&gt;
        &lt;b:if cond='data:post.dateHeader'&gt;
          &lt;h2 class='date-header'&gt;&lt;span&gt;&lt;data:post.dateHeader/&gt;&lt;/span&gt;&lt;/h2&gt;
        &lt;/b:if&gt;
        &lt;b:if cond='data:post.isDateStart'&gt;
          &amp;lt;div class=&amp;quot;date-posts&amp;quot;&amp;gt;
        &lt;/b:if&gt;
        &lt;div class='post-outer'&gt;
          &lt;b:include data='post' name='post'/&gt;
          &lt;b:include cond='data:blog.pageType in {&amp;quot;static_page&amp;quot;,&amp;quot;item&amp;quot;}' data='post' name='comment_picker'/&gt;
        &lt;/div&gt;

        &lt;!-- Ad --&gt;
        &lt;b:if cond='data:post.includeAd'&gt;
          &lt;div class='inline-ad'&gt;
            &lt;data:adCode/&gt;
          &lt;/div&gt;
        &lt;/b:if&gt;
      &lt;/b:loop&gt;
      &lt;b:if cond='data:numPosts != 0'&gt;
        &amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;
      &lt;/b:if&gt;
    &lt;/div&gt;

    &lt;!-- navigation --&gt;
    &lt;b:include name='nextprev'/&gt;

    &lt;!-- feed links --&gt;
    &lt;b:include name='feedLinks'/&gt;

  &lt;b:else/&gt;
    &lt;b:include name='mobile-main'/&gt;
  &lt;/b:if&gt;

  &lt;b:include cond='data:top.showPlusOne' name='googlePlusBootstrap'/&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='backlinkDeleteIcon' var='backlink'/&gt;
              &lt;b:includable id='backlinks' var='post'/&gt;
              &lt;b:includable id='comment-form' var='post'&gt;
  &lt;div class='comment-form'&gt;
    &lt;a name='comment-form'/&gt;
    &lt;b:if cond='data:mobile'&gt;
      &lt;h4 id='comment-post-message'&gt;
        &lt;a expr:id='data:widget.instanceId + &amp;quot;_comment-editor-toggle-link&amp;quot;' href='javascript:void(0)'&gt;&lt;data:postCommentMsg/&gt;&lt;/a&gt;&lt;/h4&gt;
      &lt;p&gt;&lt;data:blogCommentMessage/&gt;&lt;/p&gt;
      &lt;data:blogTeamBlogMessage/&gt;
      &lt;a expr:href='data:post.commentFormIframeSrc' id='comment-editor-src'/&gt;
      &lt;iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' expr:height='data:cmtIframeInitialHeight' frameborder='0' id='comment-editor' name='comment-editor' src='' style='display: none' width='100%'/&gt;
    &lt;b:else/&gt;
      &lt;h4 id='comment-post-message'&gt;&lt;data:postCommentMsg/&gt;&lt;/h4&gt;
      &lt;p&gt;&lt;data:blogCommentMessage/&gt;&lt;/p&gt;
      &lt;data:blogTeamBlogMessage/&gt;
      &lt;a expr:href='data:post.commentFormIframeSrc' id='comment-editor-src'/&gt;
      &lt;iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' expr:height='data:cmtIframeInitialHeight' frameborder='0' id='comment-editor' name='comment-editor' src='' width='100%'/&gt;
    &lt;/b:if&gt;
    &lt;data:post.cmtfpIframe/&gt;
    &lt;script type='text/javascript'&gt;
      BLOG_CMT_createIframe(&amp;#39;&lt;data:post.appRpcRelayPath/&gt;&amp;#39;);
    &lt;/script&gt;
  &lt;/div&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='commentDeleteIcon' var='comment'&gt;
  &lt;span expr:class='&amp;quot;item-control &amp;quot; + data:comment.adminClass'&gt;
    &lt;b:if cond='data:showCmtPopup'&gt;
      &lt;div class='goog-toggle-button'&gt;
        &lt;div class='goog-inline-block comment-action-icon'/&gt;
      &lt;/div&gt;
    &lt;b:else/&gt;
      &lt;a class='comment-delete' expr:href='data:comment.deleteUrl' expr:title='data:top.deleteCommentMsg'&gt;
        &lt;img src='https://resources.blogblog.com/img/icon_delete13.gif'/&gt;
      &lt;/a&gt;
    &lt;/b:if&gt;
  &lt;/span&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='comment_count_picker' var='post'&gt;
  &lt;a class='comment-link' expr:href='data:post.addCommentUrl' expr:onclick='data:post.addCommentOnclick'&gt;
    &lt;data:post.commentLabelFull/&gt;:
  &lt;/a&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='comment_picker' var='post'&gt;
  &lt;b:if cond='data:post.showThreadedComments'&gt;
    &lt;b:include data='post' name='threaded_comments'/&gt;
  &lt;b:else/&gt;
    &lt;b:include data='post' name='comments'/&gt;
  &lt;/b:if&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='comments' var='post'&gt;
  &lt;div class='comments' id='comments'&gt;
    &lt;a name='comments'/&gt;
    &lt;b:if cond='data:post.allowComments'&gt;
      &lt;h4&gt;&lt;data:post.commentLabelFull/&gt;:&lt;/h4&gt;

      &lt;b:if cond='data:post.commentPagingRequired'&gt;
        &lt;span class='paging-control-container'&gt;
          &lt;b:if cond='data:post.hasOlderLinks'&gt;
            &lt;a expr:class='data:post.oldLinkClass' expr:href='data:post.oldestLinkUrl'&gt;&lt;data:post.oldestLinkText/&gt;&lt;/a&gt;
              &amp;#160;
            &lt;a expr:class='data:post.oldLinkClass' expr:href='data:post.olderLinkUrl'&gt;&lt;data:post.olderLinkText/&gt;&lt;/a&gt;
              &amp;#160;
          &lt;/b:if&gt;

          &lt;data:post.commentRangeText/&gt;

          &lt;b:if cond='data:post.hasNewerLinks'&gt;
            &amp;#160;
            &lt;a expr:class='data:post.newLinkClass' expr:href='data:post.newerLinkUrl'&gt;&lt;data:post.newerLinkText/&gt;&lt;/a&gt;
            &amp;#160;
            &lt;a expr:class='data:post.newLinkClass' expr:href='data:post.newestLinkUrl'&gt;&lt;data:post.newestLinkText/&gt;&lt;/a&gt;
          &lt;/b:if&gt;
        &lt;/span&gt;
      &lt;/b:if&gt;

      &lt;div expr:id='data:widget.instanceId + &amp;quot;_comments-block-wrapper&amp;quot;'&gt;
        &lt;dl expr:class='data:post.avatarIndentClass' id='comments-block'&gt;
          &lt;b:loop values='data:post.comments' var='comment'&gt;
            &lt;dt expr:class='&amp;quot;comment-author &amp;quot; + data:comment.authorClass' expr:id='data:comment.anchorName'&gt;
              &lt;b:if cond='data:comment.favicon'&gt;
                &lt;img expr:src='data:comment.favicon' height='16px' style='margin-bottom:-2px;' width='16px'/&gt;
              &lt;/b:if&gt;
              &lt;a expr:name='data:comment.anchorName'/&gt;
              &lt;b:if cond='data:blog.enabledCommentProfileImages'&gt;
                &lt;data:comment.authorAvatarImage/&gt;
              &lt;/b:if&gt;
              &lt;b:if cond='data:comment.authorUrl'&gt;
                &lt;a expr:href='data:comment.authorUrl' rel='nofollow'&gt;&lt;data:comment.author/&gt;&lt;/a&gt;
              &lt;b:else/&gt;
                &lt;data:comment.author/&gt;
              &lt;/b:if&gt;
              &lt;data:commentPostedByMsg/&gt;
            &lt;/dt&gt;
            &lt;dd class='comment-body' expr:id='data:widget.instanceId + data:comment.cmtBodyIdPostfix'&gt;
              &lt;b:if cond='data:comment.isDeleted'&gt;
                &lt;span class='deleted-comment'&gt;&lt;data:comment.body/&gt;&lt;/span&gt;
              &lt;b:else/&gt;
                &lt;p&gt;
                  &lt;data:comment.body/&gt;
                &lt;/p&gt;
              &lt;/b:if&gt;
            &lt;/dd&gt;
            &lt;dd class='comment-footer'&gt;
              &lt;span class='comment-timestamp'&gt;
                &lt;a expr:href='data:comment.url' title='comment permalink'&gt;
                  &lt;data:comment.timestamp/&gt;
                &lt;/a&gt;
                &lt;b:include data='comment' name='commentDeleteIcon'/&gt;
              &lt;/span&gt;
            &lt;/dd&gt;
          &lt;/b:loop&gt;
        &lt;/dl&gt;
      &lt;/div&gt;

      &lt;b:if cond='data:post.commentPagingRequired'&gt;
        &lt;span class='paging-control-container'&gt;
          &lt;a expr:class='data:post.oldLinkClass' expr:href='data:post.oldestLinkUrl'&gt;
            &lt;data:post.oldestLinkText/&gt;
          &lt;/a&gt;
          &lt;a expr:class='data:post.oldLinkClass' expr:href='data:post.olderLinkUrl'&gt;
            &lt;data:post.olderLinkText/&gt;
          &lt;/a&gt;
          &amp;#160;
          &lt;data:post.commentRangeText/&gt;
          &amp;#160;
          &lt;a expr:class='data:post.newLinkClass' expr:href='data:post.newerLinkUrl'&gt;
            &lt;data:post.newerLinkText/&gt;
          &lt;/a&gt;
          &lt;a expr:class='data:post.newLinkClass' expr:href='data:post.newestLinkUrl'&gt;
            &lt;data:post.newestLinkText/&gt;
          &lt;/a&gt;
        &lt;/span&gt;
      &lt;/b:if&gt;

      &lt;p class='comment-footer'&gt;
        &lt;b:if cond='data:post.embedCommentForm'&gt;
          &lt;b:if cond='data:post.allowNewComments'&gt;
            &lt;b:include data='post' name='comment-form'/&gt;
          &lt;b:else/&gt;
            &lt;data:post.noNewCommentsText/&gt;
          &lt;/b:if&gt;
        &lt;b:elseif cond='data:post.allowComments'/&gt;
          &lt;a expr:href='data:post.addCommentUrl' expr:onclick='data:post.addCommentOnclick'&gt;&lt;data:postCommentMsg/&gt;&lt;/a&gt;
        &lt;/b:if&gt;
      &lt;/p&gt;
    &lt;/b:if&gt;
    &lt;b:if cond='data:showCmtPopup'&gt;
      &lt;div id='comment-popup'&gt;
        &lt;iframe allowtransparency='true' frameborder='0' id='comment-actions' name='comment-actions' scrolling='no'&gt;
        &lt;/iframe&gt;
      &lt;/div&gt;
    &lt;/b:if&gt;

  &lt;/div&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='feedLinks'&gt;
  &lt;b:if cond='data:blog.pageType != &amp;quot;item&amp;quot;'&gt; &lt;!-- Blog feed links --&gt;
    &lt;b:if cond='data:feedLinks'&gt;
      &lt;div class='blog-feeds'&gt;
        &lt;b:include data='feedLinks' name='feedLinksBody'/&gt;
      &lt;/div&gt;
    &lt;/b:if&gt;

  &lt;b:else/&gt; &lt;!--Post feed links --&gt;
    &lt;div class='post-feeds'&gt;
      &lt;b:loop values='data:posts' var='post'&gt;
        &lt;b:include cond='data:post.allowComments and data:post.feedLinks' data='post.feedLinks' name='feedLinksBody'/&gt;
      &lt;/b:loop&gt;
    &lt;/div&gt;
  &lt;/b:if&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='feedLinksBody' var='links'&gt;
  &lt;div class='feed-links'&gt;
  &lt;data:feedLinksMsg/&gt;
  &lt;b:loop values='data:links' var='f'&gt;
     &lt;a class='feed-link' expr:href='data:f.url' expr:type='data:f.mimeType' target='_blank'&gt;&lt;data:f.name/&gt; (&lt;data:f.feedType/&gt;)&lt;/a&gt;
  &lt;/b:loop&gt;
  &lt;/div&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='iframe_comments' var='post'&gt;
  &lt;!-- G+ comments, no longer available. The includable is retained for backwards-compatibility. --&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='mobile-index-post' var='post'&gt;
  &lt;div class='mobile-date-outer date-outer'&gt;
    &lt;b:if cond='data:post.dateHeader'&gt;
      &lt;div class='date-header'&gt;
        &lt;span&gt;&lt;data:post.dateHeader/&gt;&lt;/span&gt;
      &lt;/div&gt;
    &lt;/b:if&gt;

    &lt;div class='mobile-post-outer'&gt;
      &lt;a expr:href='data:post.url'&gt;
        &lt;h3 class='mobile-index-title entry-title' itemprop='name'&gt;
          &lt;data:post.title/&gt;
        &lt;/h3&gt;

        &lt;div class='mobile-index-arrow'&gt;&amp;amp;rsaquo;&lt;/div&gt;

        &lt;div class='mobile-index-contents'&gt;
          &lt;b:if cond='data:post.thumbnailUrl'&gt;
            &lt;div class='mobile-index-thumbnail'&gt;
              &lt;div class='Image'&gt;
                &lt;img expr:src='data:post.thumbnailUrl'/&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/b:if&gt;

          &lt;div class='post-body'&gt;
            &lt;b:if cond='data:post.snippet'&gt;&lt;data:post.snippet/&gt;&lt;/b:if&gt;
          &lt;/div&gt;
        &lt;/div&gt;

        &lt;div style='clear: both;'/&gt;
      &lt;/a&gt;

      &lt;div class='mobile-index-comment'&gt;
        &lt;b:include cond='data:blog.pageType != &amp;quot;static_page&amp;quot;                          and data:post.allowComments                          and data:post.numComments != 0' data='post' name='comment_count_picker'/&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='mobile-main' var='top'&gt;
    &lt;!-- posts --&gt;
    &lt;div class='blog-posts hfeed'&gt;

      &lt;b:include data='top' name='status-message'/&gt;

      &lt;b:if cond='data:blog.pageType == &amp;quot;index&amp;quot;'&gt;
        &lt;b:loop values='data:posts' var='post'&gt;
          &lt;b:include data='post' name='mobile-index-post'/&gt;
        &lt;/b:loop&gt;
      &lt;b:else/&gt;
        &lt;b:loop values='data:posts' var='post'&gt;
          &lt;b:include data='post' name='mobile-post'/&gt;
        &lt;/b:loop&gt;
      &lt;/b:if&gt;
    &lt;/div&gt;

   &lt;b:include name='mobile-nextprev'/&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='mobile-nextprev'&gt;
  &lt;div class='blog-pager' id='blog-pager'&gt;
    &lt;b:if cond='data:newerPageUrl'&gt;
      &lt;div class='mobile-link-button' id='blog-pager-newer-link'&gt;
      &lt;a class='blog-pager-newer-link' expr:href='data:newerPageUrl' expr:id='data:widget.instanceId + &amp;quot;_blog-pager-newer-link&amp;quot;' expr:title='data:newerPageTitle'&gt;&amp;amp;lsaquo;&lt;/a&gt;
      &lt;/div&gt;
    &lt;/b:if&gt;

    &lt;b:if cond='data:olderPageUrl'&gt;
      &lt;div class='mobile-link-button' id='blog-pager-older-link'&gt;
      &lt;a class='blog-pager-older-link' expr:href='data:olderPageUrl' expr:id='data:widget.instanceId + &amp;quot;_blog-pager-older-link&amp;quot;' expr:title='data:olderPageTitle'&gt;&amp;amp;rsaquo;&lt;/a&gt;
      &lt;/div&gt;
    &lt;/b:if&gt;

    &lt;div class='mobile-link-button' id='blog-pager-home-link'&gt;
    &lt;a class='home-link' expr:href='data:blog.homepageUrl'&gt;&lt;data:homeMsg/&gt;&lt;/a&gt;
    &lt;/div&gt;

    &lt;div class='mobile-desktop-link'&gt;
      &lt;a class='home-link' expr:href='data:desktopLinkUrl'&gt;&lt;data:desktopLinkMsg/&gt;&lt;/a&gt;
    &lt;/div&gt;

  &lt;/div&gt;
  &lt;div class='clear'/&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='mobile-post' var='post'&gt;
  &lt;div class='date-outer'&gt;
    &lt;b:if cond='data:post.dateHeader'&gt;
      &lt;h2 class='date-header'&gt;&lt;span&gt;&lt;data:post.dateHeader/&gt;&lt;/span&gt;&lt;/h2&gt;
    &lt;/b:if&gt;
    &lt;div class='date-posts'&gt;
      &lt;div class='post-outer'&gt;

        &lt;div class='post hentry uncustomized-post-template' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'&gt;
          &lt;b:if cond='data:post.thumbnailUrl'&gt;
            &lt;meta expr:content='data:post.thumbnailUrl' itemprop='image_url'/&gt;
          &lt;/b:if&gt;
          &lt;meta expr:content='data:blog.blogId' itemprop='blogId'/&gt;
          &lt;meta expr:content='data:post.id' itemprop='postId'/&gt;

          &lt;a expr:name='data:post.id'/&gt;
          &lt;b:if cond='data:post.title'&gt;
            &lt;h3 class='post-title entry-title' itemprop='name'&gt;
              &lt;b:if cond='data:post.link'&gt;
                &lt;a expr:href='data:post.link'&gt;&lt;data:post.title/&gt;&lt;/a&gt;
              &lt;b:elseif cond='data:post.url and data:blog.url != data:post.url'/&gt;
                &lt;a expr:href='data:post.url'&gt;&lt;data:post.title/&gt;&lt;/a&gt;
              &lt;b:else/&gt;
                &lt;data:post.title/&gt;
              &lt;/b:if&gt;
            &lt;/h3&gt;
          &lt;/b:if&gt;

          &lt;div class='post-header'&gt;
            &lt;div class='post-header-line-1'/&gt;
          &lt;/div&gt;

          &lt;div class='post-body entry-content' expr:id='&amp;quot;post-body-&amp;quot; + data:post.id' itemprop='articleBody'&gt;
            &lt;data:post.body/&gt;
            &lt;div style='clear: both;'/&gt; &lt;!-- clear for photos floats --&gt;
          &lt;/div&gt;

          &lt;div class='post-footer'&gt;
            &lt;div class='post-footer-line post-footer-line-1'&gt;
              &lt;span class='post-author vcard'&gt;
                &lt;b:if cond='data:top.showAuthor'&gt;
                  &lt;b:if cond='data:post.authorProfileUrl'&gt;
                    &lt;span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'&gt;
                      &lt;meta expr:content='data:post.authorProfileUrl' itemprop='url'/&gt;
                      &lt;a expr:href='data:post.authorProfileUrl' rel='author' title='author profile'&gt;
                        &lt;span itemprop='name'&gt;&lt;data:post.author/&gt;&lt;/span&gt;
                      &lt;/a&gt;
                    &lt;/span&gt;
                  &lt;b:else/&gt;
                    &lt;span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'&gt;
                      &lt;span itemprop='name'&gt;&lt;data:post.author/&gt;&lt;/span&gt;
                    &lt;/span&gt;
                  &lt;/b:if&gt;
                &lt;/b:if&gt;
              &lt;/span&gt;

              &lt;span class='post-timestamp'&gt;
                &lt;b:if cond='data:top.showTimestamp'&gt;
                  &lt;data:top.timestampLabel/&gt;
                  &lt;b:if cond='data:post.url'&gt;
                    &lt;meta expr:content='data:post.url.canonical' itemprop='url'/&gt;
                    &lt;a class='timestamp-link' expr:href='data:post.url' rel='bookmark' title='permanent link'&gt;&lt;abbr class='published' expr:title='data:post.timestampISO8601' itemprop='datePublished'&gt;&lt;data:post.timestamp/&gt;&lt;/abbr&gt;&lt;/a&gt;
                  &lt;/b:if&gt;
                &lt;/b:if&gt;
              &lt;/span&gt;

              &lt;span class='post-comment-link'&gt;
                &lt;b:include cond='data:blog.pageType not in {&amp;quot;item&amp;quot;,&amp;quot;static_page&amp;quot;}                                  and data:post.allowComments' data='post' name='comment_count_picker'/&gt;
              &lt;/span&gt;
            &lt;/div&gt;

            &lt;div class='post-footer-line post-footer-line-2'&gt;
              &lt;b:if cond='data:top.showMobileShare'&gt;
                &lt;div class='mobile-link-button goog-inline-block' id='mobile-share-button'&gt;
                  &lt;a href='javascript:void(0);'&gt;&lt;data:shareMsg/&gt;&lt;/a&gt;
                &lt;/div&gt;
              &lt;/b:if&gt;
              &lt;b:if cond='data:top.showDummy'&gt;
                &lt;div class='goog-inline-block dummy-container'&gt;&lt;data:post.dummyTag/&gt;&lt;/div&gt;
              &lt;/b:if&gt;
            &lt;/div&gt;

          &lt;/div&gt;
        &lt;/div&gt;

        &lt;b:include cond='data:blog.pageType in {&amp;quot;static_page&amp;quot;,&amp;quot;item&amp;quot;}' data='post' name='comment_picker'/&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='nextprev'&gt;
  &lt;div class='blog-pager' id='blog-pager'&gt;
    &lt;b:if cond='data:newerPageUrl'&gt;
      &lt;span id='blog-pager-newer-link'&gt;
      &lt;a class='blog-pager-newer-link' expr:href='data:newerPageUrl' expr:id='data:widget.instanceId + &amp;quot;_blog-pager-newer-link&amp;quot;' expr:title='data:newerPageTitle'&gt;&lt;data:newerPageTitle/&gt;&lt;/a&gt;
      &lt;/span&gt;
    &lt;/b:if&gt;

    &lt;b:if cond='data:olderPageUrl'&gt;
      &lt;span id='blog-pager-older-link'&gt;
      &lt;a class='blog-pager-older-link' expr:href='data:olderPageUrl' expr:id='data:widget.instanceId + &amp;quot;_blog-pager-older-link&amp;quot;' expr:title='data:olderPageTitle'&gt;&lt;data:olderPageTitle/&gt;&lt;/a&gt;
      &lt;/span&gt;
    &lt;/b:if&gt;

    &lt;a class='home-link' expr:href='data:blog.homepageUrl'&gt;&lt;data:homeMsg/&gt;&lt;/a&gt;

    &lt;b:if cond='data:mobileLinkUrl'&gt;
      &lt;div class='blog-mobile-link'&gt;
        &lt;a expr:href='data:mobileLinkUrl'&gt;&lt;data:mobileLinkMsg/&gt;&lt;/a&gt;
      &lt;/div&gt;
    &lt;/b:if&gt;

  &lt;/div&gt;
  &lt;div class='clear'/&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='post' var='post'&gt;
  &lt;div class='post hentry' itemprop='blogPost' itemscope='itemscope' itemtype='http://schema.org/BlogPosting'&gt;
    &lt;b:if cond='data:post.firstImageUrl'&gt;
      &lt;meta expr:content='data:post.firstImageUrl' itemprop='image_url'/&gt;
    &lt;/b:if&gt;
    &lt;meta expr:content='data:blog.blogId' itemprop='blogId'/&gt;
    &lt;meta expr:content='data:post.id' itemprop='postId'/&gt;

    &lt;a expr:name='data:post.id'/&gt;
    &lt;b:if cond='data:post.title'&gt;
      &lt;h3 class='post-title entry-title' itemprop='name'&gt;
      &lt;b:if cond='data:post.link'&gt;
        &lt;a expr:href='data:post.link'&gt;&lt;data:post.title/&gt;&lt;/a&gt;
      &lt;b:else/&gt;
        &lt;b:if cond='data:post.url'&gt;
          &lt;b:if cond='data:blog.url != data:post.url'&gt;
            &lt;a expr:href='data:post.url'&gt;&lt;data:post.title/&gt;&lt;/a&gt;
          &lt;b:else/&gt;
            &lt;data:post.title/&gt;
          &lt;/b:if&gt;
        &lt;b:else/&gt;
          &lt;data:post.title/&gt;
        &lt;/b:if&gt;
      &lt;/b:if&gt;
      &lt;/h3&gt;
    &lt;/b:if&gt;

    &lt;div class='post-header'&gt;
    &lt;div class='post-header-line-1'/&gt;
    &lt;/div&gt;

    &lt;b:if cond='data:blog.metaDescription == &amp;quot;&amp;quot;'&gt;
      &lt;!-- Then use the post body as the schema.org description,
          for good G+/FB snippeting. --&gt;
      &lt;div class='post-body entry-content' expr:id='&amp;quot;post-body-&amp;quot; + data:post.id' itemprop='description articleBody'&gt;
        &lt;data:post.body/&gt;
        &lt;div style='clear: both;'/&gt; &lt;!-- clear for photos floats --&gt;
      &lt;/div&gt;
    &lt;b:else/&gt;
      &lt;div class='post-body entry-content' expr:id='&amp;quot;post-body-&amp;quot; + data:post.id' itemprop='articleBody'&gt;
        &lt;data:post.body/&gt;
        &lt;div style='clear: both;'/&gt; &lt;!-- clear for photos floats --&gt;
      &lt;/div&gt;
    &lt;/b:if&gt;

    &lt;b:if cond='data:post.hasJumpLink'&gt;
      &lt;div class='jump-link'&gt;
        &lt;a expr:href='data:post.url + &amp;quot;#more&amp;quot;' expr:title='data:post.title'&gt;&lt;data:post.jumpText/&gt;&lt;/a&gt;
      &lt;/div&gt;
    &lt;/b:if&gt;

    &lt;div class='post-footer'&gt;
    &lt;div class='post-footer-line post-footer-line-1'&gt;&lt;span class='post-author vcard'&gt;
        &lt;b:if cond='data:top.showAuthor'&gt;
          &lt;data:top.authorLabel/&gt;
            &lt;b:if cond='data:post.authorProfileUrl'&gt;
              &lt;span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'&gt;
                &lt;meta expr:content='data:post.authorProfileUrl' itemprop='url'/&gt;
                &lt;a class='g-profile' expr:href='data:post.authorProfileUrl' rel='author' title='author profile'&gt;
                  &lt;span itemprop='name'&gt;&lt;data:post.author/&gt;&lt;/span&gt;
                &lt;/a&gt;
              &lt;/span&gt;
            &lt;b:else/&gt;
              &lt;span class='fn' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'&gt;
                &lt;span itemprop='name'&gt;&lt;data:post.author/&gt;&lt;/span&gt;
              &lt;/span&gt;
            &lt;/b:if&gt;
        &lt;/b:if&gt;
      &lt;/span&gt; &lt;span class='post-timestamp'&gt;
        &lt;b:if cond='data:top.showTimestamp'&gt;
          &lt;data:top.timestampLabel/&gt;
        &lt;b:if cond='data:post.url'&gt;
          &lt;meta expr:content='data:post.canonicalUrl' itemprop='url'/&gt;
          &lt;a class='timestamp-link' expr:href='data:post.url' rel='bookmark' title='permanent link'&gt;&lt;abbr class='published' expr:title='data:post.timestampISO8601' itemprop='datePublished'&gt;&lt;data:post.timestamp/&gt;&lt;/abbr&gt;&lt;/a&gt;
        &lt;/b:if&gt;
        &lt;/b:if&gt;
      &lt;/span&gt; &lt;span class='post-comment-link'&gt;
        &lt;b:if cond='data:blog.pageType != &amp;quot;item&amp;quot;'&gt;
          &lt;b:if cond='data:blog.pageType != &amp;quot;static_page&amp;quot;'&gt;
            &lt;b:if cond='data:post.allowComments'&gt;
              &lt;b:include data='post' name='comment_count_picker'/&gt;
            &lt;/b:if&gt;
          &lt;/b:if&gt;
        &lt;/b:if&gt;
      &lt;/span&gt; &lt;span class='post-icons'&gt;
        &lt;!-- email post links --&gt;
        &lt;b:if cond='data:post.emailPostUrl'&gt;
          &lt;span class='item-action'&gt;
          &lt;a expr:href='data:post.emailPostUrl' expr:title='data:top.emailPostMsg'&gt;
              &lt;img alt='' class='icon-action' height='13' src='http://img1.blogblog.com/img/icon18_email.gif' width='18'/&gt;
          &lt;/a&gt;
          &lt;/span&gt;
        &lt;/b:if&gt;

        &lt;!-- quickedit pencil --&gt;
        &lt;b:include data='post' name='postQuickEdit'/&gt;
      &lt;/span&gt; &lt;div class='post-share-buttons goog-inline-block'&gt;
        &lt;b:if cond='data:post.sharePostUrl'&gt;
          &lt;b:include data='post' name='shareButtons'/&gt;
        &lt;/b:if&gt;
      &lt;/div&gt; &lt;/div&gt;

      &lt;div class='post-footer-line post-footer-line-2'&gt;&lt;span class='post-labels'&gt;
        &lt;b:if cond='data:post.labels'&gt;
          &lt;data:postLabelsLabel/&gt;
          &lt;b:loop values='data:post.labels' var='label'&gt;
            &lt;a expr:href='data:label.url' rel='tag'&gt;&lt;data:label.name/&gt;&lt;/a&gt;&lt;b:if cond='data:label.isLast != &amp;quot;true&amp;quot;'&gt;,&lt;/b:if&gt;
          &lt;/b:loop&gt;
        &lt;/b:if&gt;
      &lt;/span&gt; &lt;/div&gt;

      &lt;div class='post-footer-line post-footer-line-3'&gt;&lt;span class='post-location'&gt;
        &lt;b:if cond='data:top.showLocation'&gt;
          &lt;b:if cond='data:post.location'&gt;
            &lt;data:postLocationLabel/&gt;
            &lt;a expr:href='data:post.location.mapsUrl' target='_blank'&gt;&lt;data:post.location.name/&gt;&lt;/a&gt;
          &lt;/b:if&gt;
        &lt;/b:if&gt;
      &lt;/span&gt; &lt;/div&gt;
      &lt;b:if cond='data:post.authorAboutMe'&gt;
        &lt;div class='author-profile' itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'&gt;
          &lt;b:if cond='data:post.authorPhoto.url'&gt;
            &lt;img expr:src='data:post.authorPhoto.url' itemprop='image' width='50px'/&gt;
          &lt;/b:if&gt;
          &lt;div&gt;
            &lt;a class='g-profile' expr:href='data:post.authorProfileUrl' itemprop='url' rel='author' title='author profile'&gt;
              &lt;span itemprop='name'&gt;&lt;data:post.author/&gt;&lt;/span&gt;
            &lt;/a&gt;
          &lt;/div&gt;
          &lt;span itemprop='description'&gt;&lt;data:post.authorAboutMe/&gt;&lt;/span&gt;
        &lt;/div&gt;
      &lt;/b:if&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='postQuickEdit' var='post'&gt;
  &lt;b:if cond='data:post.editUrl'&gt;
    &lt;span expr:class='&amp;quot;item-control &amp;quot; + data:post.adminClass'&gt;
      &lt;a expr:href='data:post.editUrl' expr:title='data:top.editPostMsg'&gt;
        &lt;img alt='' class='icon-action' height='18' src='https://resources.blogblog.com/img/icon18_edit_allbkg.gif' width='18'/&gt;
      &lt;/a&gt;
    &lt;/span&gt;
  &lt;/b:if&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='shareButtons' var='post'&gt;
  &lt;b:if cond='data:top.showEmailButton'&gt;&lt;a class='goog-inline-block share-button sb-email' expr:href='data:post.sharePostUrl + &amp;quot;&amp;amp;target=email&amp;quot;' expr:title='data:top.emailThisMsg' target='_blank'&gt;&lt;span class='share-button-link-text'&gt;&lt;data:top.emailThisMsg/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/b:if&gt;&lt;b:if cond='data:top.showBlogThisButton'&gt;&lt;a class='goog-inline-block share-button sb-blog' expr:href='data:post.sharePostUrl + &amp;quot;&amp;amp;target=blog&amp;quot;' expr:onclick='&amp;quot;window.open(this.href, \&amp;quot;_blank\&amp;quot;, \&amp;quot;height=270,width=475\&amp;quot;); return false;&amp;quot;' expr:title='data:top.blogThisMsg' target='_blank'&gt;&lt;span class='share-button-link-text'&gt;&lt;data:top.blogThisMsg/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/b:if&gt;&lt;b:if cond='data:top.showTwitterButton'&gt;&lt;a class='goog-inline-block share-button sb-twitter' expr:href='data:post.sharePostUrl + &amp;quot;&amp;amp;target=twitter&amp;quot;' expr:title='data:top.shareToTwitterMsg' target='_blank'&gt;&lt;span class='share-button-link-text'&gt;&lt;data:top.shareToTwitterMsg/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/b:if&gt;&lt;b:if cond='data:top.showFacebookButton'&gt;&lt;a class='goog-inline-block share-button sb-facebook' expr:href='data:post.sharePostUrl + &amp;quot;&amp;amp;target=facebook&amp;quot;' expr:onclick='&amp;quot;window.open(this.href, \&amp;quot;_blank\&amp;quot;, \&amp;quot;height=430,width=640\&amp;quot;); return false;&amp;quot;' expr:title='data:top.shareToFacebookMsg' target='_blank'&gt;&lt;span class='share-button-link-text'&gt;&lt;data:top.shareToFacebookMsg/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/b:if&gt;&lt;b:if cond='data:top.showPinterestButton'&gt;&lt;a class='goog-inline-block share-button sb-pinterest' expr:href='data:post.sharePostUrl + &amp;quot;&amp;amp;target=pinterest&amp;quot;' expr:title='data:top.shareToPinterestMsg' target='_blank'&gt;&lt;span class='share-button-link-text'&gt;&lt;data:top.shareToPinterestMsg/&gt;&lt;/span&gt;&lt;/a&gt;&lt;/b:if&gt;&lt;b:if cond='data:top.showPlusOne'&gt;&lt;div class='goog-inline-block google-plus-share-container'&gt;&lt;data:post.googlePlusShareTag/&gt;&lt;/div&gt;&lt;/b:if&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='status-message'&gt;
  &lt;b:if cond='data:navMessage'&gt;
  &lt;div class='status-msg-wrap'&gt;
    &lt;div class='status-msg-body'&gt;
      &lt;data:navMessage/&gt;
    &lt;/div&gt;
    &lt;div class='status-msg-border'&gt;
      &lt;div class='status-msg-bg'&gt;
        &lt;div class='status-msg-hidden'&gt;&lt;data:navMessage/&gt;&lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;div style='clear: both;'/&gt;
  &lt;/b:if&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='threaded-comment-form' var='post'&gt;
  &lt;div class='comment-form'&gt;
    &lt;a name='comment-form'/&gt;
    &lt;b:if cond='data:mobile'&gt;
      &lt;p&gt;&lt;data:blogCommentMessage/&gt;&lt;/p&gt;
      &lt;data:blogTeamBlogMessage/&gt;
      &lt;a expr:href='data:post.commentFormIframeSrc' id='comment-editor-src'/&gt;
      &lt;iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' expr:height='data:cmtIframeInitialHeight' frameborder='0' id='comment-editor' name='comment-editor' src='' style='display: none' width='100%'/&gt;
    &lt;b:else/&gt;
      &lt;p&gt;&lt;data:blogCommentMessage/&gt;&lt;/p&gt;
      &lt;data:blogTeamBlogMessage/&gt;
      &lt;a expr:href='data:post.commentFormIframeSrc' id='comment-editor-src'/&gt;
      &lt;iframe allowtransparency='true' class='blogger-iframe-colorize blogger-comment-from-post' expr:height='data:cmtIframeInitialHeight' frameborder='0' id='comment-editor' name='comment-editor' src='' width='100%'/&gt;
    &lt;/b:if&gt;
    &lt;data:post.cmtfpIframe/&gt;
    &lt;script type='text/javascript'&gt;
      BLOG_CMT_createIframe(&amp;#39;&lt;data:post.appRpcRelayPath/&gt;&amp;#39;);
    &lt;/script&gt;
  &lt;/div&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='threaded_comment_js' var='post'&gt;
  &lt;script async='async' expr:src='data:post.commentSrc' type='text/javascript'/&gt;

  &lt;script type='text/javascript'&gt;
    (function() {
      var items = &lt;data:post.commentJso/&gt;;
      var msgs = &lt;data:post.commentMsgs/&gt;;
      var config = &lt;data:post.commentConfig/&gt;;

// &lt;![CDATA[
      var cursor = null;
      if (items &amp;&amp; items.length &gt; 0) {
        cursor = parseInt(items[items.length - 1].timestamp) + 1;
      }

      var bodyFromEntry = function(entry) {
        var text = (entry &amp;&amp;
                    ((entry.content &amp;&amp; entry.content.$t) ||
                     (entry.summary &amp;&amp; entry.summary.$t))) ||
            '';
        if (entry &amp;&amp; entry.gd$extendedProperty) {
          for (var k in entry.gd$extendedProperty) {
            if (entry.gd$extendedProperty[k].name == 'blogger.contentRemoved') {
              return '&lt;span class="deleted-comment"&gt;' + text + '&lt;/span&gt;';
            }
          }
        }
        return text;
      }

      var parse = function(data) {
        cursor = null;
        var comments = [];
        if (data &amp;&amp; data.feed &amp;&amp; data.feed.entry) {
          for (var i = 0, entry; entry = data.feed.entry[i]; i++) {
            var comment = {};
            // comment ID, parsed out of the original id format
            var id = /blog-(\d+).post-(\d+)/.exec(entry.id.$t);
            comment.id = id ? id[2] : null;
            comment.body = bodyFromEntry(entry);
            comment.timestamp = Date.parse(entry.published.$t) + '';
            if (entry.author &amp;&amp; entry.author.constructor === Array) {
              var auth = entry.author[0];
              if (auth) {
                comment.author = {
                  name: (auth.name ? auth.name.$t : undefined),
                  profileUrl: (auth.uri ? auth.uri.$t : undefined),
                  avatarUrl: (auth.gd$image ? auth.gd$image.src : undefined)
                };
              }
            }
            if (entry.link) {
              if (entry.link[2]) {
                comment.link = comment.permalink = entry.link[2].href;
              }
              if (entry.link[3]) {
                var pid = /.*comments\/default\/(\d+)\?.*/.exec(entry.link[3].href);
                if (pid &amp;&amp; pid[1]) {
                  comment.parentId = pid[1];
                }
              }
            }
            comment.deleteclass = 'item-control blog-admin';
            if (entry.gd$extendedProperty) {
              for (var k in entry.gd$extendedProperty) {
                if (entry.gd$extendedProperty[k].name == 'blogger.itemClass') {
                  comment.deleteclass += ' ' + entry.gd$extendedProperty[k].value;
                } else if (entry.gd$extendedProperty[k].name == 'blogger.displayTime') {
                  comment.displayTime = entry.gd$extendedProperty[k].value;
                }
              }
            }
            comments.push(comment);
          }
        }
        return comments;
      };

      var paginator = function(callback) {
        if (hasMore()) {
          var url = config.feed + '?alt=json&amp;v=2&amp;orderby=published&amp;reverse=false&amp;max-results=50';
          if (cursor) {
            url += '&amp;published-min=' + new Date(cursor).toISOString();
          }
          window.bloggercomments = function(data) {
            var parsed = parse(data);
            cursor = parsed.length &lt; 50 ? null
                : parseInt(parsed[parsed.length - 1].timestamp) + 1
            callback(parsed);
            window.bloggercomments = null;
          }
          url += '&amp;callback=bloggercomments';
          var script = document.createElement('script');
          script.type = 'text/javascript';
          script.src = url;
          document.getElementsByTagName('head')[0].appendChild(script);
        }
      };
      var hasMore = function() {
        return !!cursor;
      };
      var getMeta = function(key, comment) {
        if ('iswriter' == key) {
          var matches = !!comment.author
              &amp;&amp; comment.author.name == config.authorName
              &amp;&amp; comment.author.profileUrl == config.authorUrl;
          return matches ? 'true' : '';
        } else if ('deletelink' == key) {
          return config.baseUri + '/delete-comment.g?blogID='
               + config.blogId + '&amp;postID=' + comment.id;
        } else if ('deleteclass' == key) {
          return comment.deleteclass;
        }
        return '';
      };

      var replybox = null;
      var replyUrlParts = null;
      var replyParent = undefined;

      var onReply = function(commentId, domId) {
        if (replybox == null) {
          // lazily cache replybox, and adjust to suit this style:
          replybox = document.getElementById('comment-editor');
          if (replybox != null) {
            replybox.height = '250px';
            replybox.style.display = 'block';
            replyUrlParts = replybox.src.split('#');
          }
        }
        if (replybox &amp;&amp; (commentId !== replyParent)) {
          replybox.src = '';
          document.getElementById(domId).insertBefore(replybox, null);
          replybox.src = replyUrlParts[0]
              + (commentId ? '&amp;parentID=' + commentId : '')
              + '#' + replyUrlParts[1];
          replyParent = commentId;
        }
      };

      var hash = (window.location.hash || '#').substring(1);
      var startThread, targetComment;
      if (/^comment-form_/.test(hash)) {
        startThread = hash.substring('comment-form_'.length);
      } else if (/^c[0-9]+$/.test(hash)) {
        targetComment = hash.substring(1);
      }

      // Configure commenting API:
      var configJso = {
        'maxDepth': config.maxThreadDepth
      };
      var provider = {
        'id': config.postId,
        'data': items,
        'loadNext': paginator,
        'hasMore': hasMore,
        'getMeta': getMeta,
        'onReply': onReply,
        'rendered': true,
        'initComment': targetComment,
        'initReplyThread': startThread,
        'config': configJso,
        'messages': msgs
      };

      var render = function() {
        if (window.goog &amp;&amp; window.goog.comments) {
          var holder = document.getElementById('comment-holder');
          window.goog.comments.render(holder, provider);
        }
      };

      // render now, or queue to render when library loads:
      if (window.goog &amp;&amp; window.goog.comments) {
        render();
      } else {
        window.goog = window.goog || {};
        window.goog.comments = window.goog.comments || {};
        window.goog.comments.loadQueue = window.goog.comments.loadQueue || [];
        window.goog.comments.loadQueue.push(render);
      }
    })();
// ]]&gt;
  &lt;/script&gt;
&lt;/b:includable&gt;
              &lt;b:includable id='threaded_comments' var='post'&gt;
  &lt;div class='comments' id='comments'&gt;
    &lt;a name='comments'/&gt;
    &lt;h4&gt;&lt;data:post.commentLabelFull/&gt;:&lt;/h4&gt;

    &lt;div class='comments-content'&gt;
      &lt;b:include cond='data:post.embedCommentForm' data='post' name='threaded_comment_js'/&gt;
      &lt;div id='comment-holder'&gt;
         &lt;data:post.commentHtml/&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;p class='comment-footer'&gt;
      &lt;b:if cond='data:post.allowNewComments'&gt;
        &lt;b:include data='post' name='threaded-comment-form'/&gt;
      &lt;b:else/&gt;
        &lt;data:post.noNewCommentsText/&gt;
      &lt;/b:if&gt;
    &lt;/p&gt;

    &lt;b:if cond='data:showCmtPopup'&gt;
      &lt;div id='comment-popup'&gt;
        &lt;iframe allowtransparency='true' frameborder='0' id='comment-actions' name='comment-actions' scrolling='no'&gt;
        &lt;/iframe&gt;
      &lt;/div&gt;
    &lt;/b:if&gt;

    &lt;div id='backlinks-container'&gt;
    &lt;div expr:id='data:widget.instanceId + &amp;quot;_backlinks-container&amp;quot;'&gt;
    &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/b:includable&gt;
            &lt;/b:widget&gt;
          &lt;/b:section&gt;
        &lt;/div&gt;
        &lt;/div&gt;

        &lt;div class='column-left-outer'&gt;
        &lt;div class='column-left-inner'&gt;
          &lt;aside&gt;
          &lt;macro:include id='main-column-left-sections' name='sections'&gt;
            &lt;macro:param default='0' name='num'/&gt;
            &lt;macro:param default='sidebar-left' name='idPrefix'/&gt;
            &lt;macro:param default='sidebar' name='class'/&gt;
            &lt;macro:param default='true' name='includeBottom'/&gt;
          &lt;/macro:include&gt;
          &lt;/aside&gt;
        &lt;/div&gt;
        &lt;/div&gt;

        &lt;div class='column-right-outer'&gt;
        &lt;div class='column-right-inner'&gt;
          &lt;aside&gt;
          &lt;macro:include id='main-column-right-sections' name='sections'&gt;
            &lt;macro:param default='2' name='num'/&gt;
            &lt;macro:param default='sidebar-right' name='idPrefix'/&gt;
            &lt;macro:param default='sidebar' name='class'/&gt;
            &lt;macro:param default='true' name='includeBottom'/&gt;
          &lt;/macro:include&gt;
          &lt;/aside&gt;
        &lt;/div&gt;
        &lt;/div&gt;

        &lt;/div&gt;

        &lt;div style='clear: both'/&gt;
      &lt;!-- columns --&gt;
      &lt;/div&gt;

    &lt;!-- main --&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class='main-cap-bottom cap-bottom'&gt;
      &lt;div class='cap-left'/&gt;
      &lt;div class='cap-right'/&gt;
    &lt;/div&gt;
    &lt;/div&gt;

    &lt;footer&gt;
    &lt;div class='footer-outer'&gt;
    &lt;div class='footer-cap-top cap-top'&gt;
      &lt;div class='cap-left'/&gt;
      &lt;div class='cap-right'/&gt;
    &lt;/div&gt;
    &lt;div class='fauxborder-left footer-fauxborder-left'&gt;
    &lt;div class='fauxborder-right footer-fauxborder-right'/&gt;
    &lt;div class='region-inner footer-inner'&gt;
      &lt;macro:include id='footer-sections' name='sections'&gt;
        &lt;macro:param default='2' name='num'/&gt;
        &lt;macro:param default='footer' name='idPrefix'/&gt;
        &lt;macro:param default='foot' name='class'/&gt;
        &lt;macro:param default='false' name='includeBottom'/&gt;
      &lt;/macro:include&gt;
      &lt;!-- outside of the include in order to lock Attribution widget --&gt;
      &lt;b:section class='foot' id='footer-3' showaddelement='no'&gt;
        &lt;b:widget id='Attribution1' locked='true' title='' type='Attribution'&gt;
          &lt;b:widget-settings&gt;
            &lt;b:widget-setting name='copyright'/&gt;
          &lt;/b:widget-settings&gt;
          &lt;b:includable id='main'&gt;
    &lt;div class='widget-content' style='text-align: center;'&gt;
      &lt;b:if cond='data:attribution != &amp;quot;&amp;quot;'&gt;
       &lt;data:attribution/&gt;
      &lt;/b:if&gt;
    &lt;/div&gt;

    &lt;b:include name='quickedit'/&gt;
  &lt;/b:includable&gt;
        &lt;/b:widget&gt;
      &lt;/b:section&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class='footer-cap-bottom cap-bottom'&gt;
      &lt;div class='cap-left'/&gt;
      &lt;div class='cap-right'/&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;/footer&gt;

  &lt;!-- content --&gt;
  &lt;/div&gt;
  &lt;/div&gt;
  &lt;div class='content-cap-bottom cap-bottom'&gt;
    &lt;div class='cap-left'/&gt;
    &lt;div class='cap-right'/&gt;
  &lt;/div&gt;
  &lt;/div&gt;
  &lt;/div&gt;

  &lt;script type='text/javascript'&gt;
    window.setTimeout(function() {
        document.body.className = document.body.className.replace(&amp;#39;loading&amp;#39;, &amp;#39;&amp;#39;);
      }, 10);
  &lt;/script&gt;
&lt;/body&gt;

&lt;macro:includable id='sections' var='col'&gt;
  &lt;macro:if cond='data:col.num == 0'&gt;
  &lt;macro:else/&gt;
    &lt;b:section mexpr:class='data:col.class' mexpr:id='data:col.idPrefix + &amp;quot;-1&amp;quot;' preferred='yes' showaddelement='yes'/&gt;

    &lt;macro:if cond='data:col.num &amp;gt;= 2'&gt;
      &lt;table border='0' cellpadding='0' cellspacing='0' mexpr:class='&amp;quot;section-columns columns-&amp;quot; + data:col.num'&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
        &lt;td class='first columns-cell'&gt;
          &lt;b:section mexpr:class='data:col.class' mexpr:id='data:col.idPrefix + &amp;quot;-2-1&amp;quot;'/&gt;
        &lt;/td&gt;

        &lt;td class='columns-cell'&gt;
          &lt;b:section mexpr:class='data:col.class' mexpr:id='data:col.idPrefix + &amp;quot;-2-2&amp;quot;'/&gt;
        &lt;/td&gt;

        &lt;macro:if cond='data:col.num &amp;gt;= 3'&gt;
          &lt;td class='columns-cell'&gt;
            &lt;b:section mexpr:class='data:col.class' mexpr:id='data:col.idPrefix + &amp;quot;-2-3&amp;quot;'/&gt;
          &lt;/td&gt;
        &lt;/macro:if&gt;

        &lt;macro:if cond='data:col.num &amp;gt;= 4'&gt;
          &lt;td class='columns-cell'&gt;
            &lt;b:section mexpr:class='data:col.class' mexpr:id='data:col.idPrefix + &amp;quot;-2-4&amp;quot;'/&gt;
          &lt;/td&gt;
        &lt;/macro:if&gt;
      &lt;/tr&gt;
      &lt;/tbody&gt;
      &lt;/table&gt;

      &lt;macro:if cond='data:col.includeBottom'&gt;
        &lt;b:section mexpr:class='data:col.class' mexpr:id='data:col.idPrefix + &amp;quot;-3&amp;quot;' showaddelement='no'/&gt;
      &lt;/macro:if&gt;
    &lt;/macro:if&gt;
  &lt;/macro:if&gt;
&lt;/macro:includable&gt;

&lt;b:section-contents id='sidebar-right-1'&gt;
  &lt;b:widget id='BlogSearch1' locked='false' title='Поиск по этому блогу' type='BlogSearch'&gt;
    &lt;b:includable id='main'&gt;
    &lt;!-- only display title if it's non-empty --&gt;
    &lt;b:if cond='data:title != &amp;quot;&amp;quot;'&gt;
      &lt;h2 class='title'&gt;&lt;data:title/&gt;&lt;/h2&gt;
    &lt;/b:if&gt;

    &lt;div class='widget-content'&gt;
      &lt;div expr:id='data:widget.instanceId + &amp;quot;_form&amp;quot;'&gt;
        &lt;form class='gsc-search-box' expr:action='data:blog.searchUrl'&gt;
          &lt;b:attr cond='not data:view.isPreview' name='target' value='_top'/&gt;
          &lt;table cellpadding='0' cellspacing='0' class='gsc-search-box'&gt;
            &lt;tbody&gt;
              &lt;tr&gt;
                &lt;td class='gsc-input'&gt;
                  &lt;input autocomplete='off' class='gsc-input' expr:value='data:view.isSearch ? data:view.search.query.escaped : &amp;quot;&amp;quot;' name='q' size='10' title='search' type='text'/&gt;
                &lt;/td&gt;
                &lt;td class='gsc-search-button'&gt;
                  &lt;input class='gsc-search-button' expr:value='data:messages.search' title='search' type='submit'/&gt;
                &lt;/td&gt;
              &lt;/tr&gt;
            &lt;/tbody&gt;
          &lt;/table&gt;
        &lt;/form&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;b:include name='quickedit'/&gt;
  &lt;/b:includable&gt;
  &lt;/b:widget&gt;
  &lt;b:widget id='Label1' locked='false' title='Tag Cloud' type='Label'&gt;
    &lt;b:widget-settings&gt;
      &lt;b:widget-setting name='sorting'&gt;ALPHA&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='display'&gt;CLOUD&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='selectedLabelsList'/&gt;
      &lt;b:widget-setting name='showType'&gt;ALL&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='showFreqNumbers'&gt;false&lt;/b:widget-setting&gt;
    &lt;/b:widget-settings&gt;
    &lt;b:includable id='main'&gt;
  &lt;b:if cond='data:title != &amp;quot;&amp;quot;'&gt;
    &lt;h2&gt;&lt;data:title/&gt;&lt;/h2&gt;
  &lt;/b:if&gt;
  &lt;div expr:class='&amp;quot;widget-content &amp;quot; + data:display + &amp;quot;-label-widget-content&amp;quot;'&gt;
    &lt;b:if cond='data:display == &amp;quot;list&amp;quot;'&gt;
      &lt;ul&gt;
        &lt;b:loop values='data:labels' var='label'&gt;
          &lt;li&gt;
            &lt;b:if cond='data:blog.url == data:label.url'&gt;
              &lt;span expr:dir='data:blog.languageDirection'&gt;&lt;data:label.name/&gt;&lt;/span&gt;
            &lt;b:else/&gt;
              &lt;a expr:dir='data:blog.languageDirection' expr:href='data:label.url'&gt;&lt;data:label.name/&gt;&lt;/a&gt;
            &lt;/b:if&gt;
            &lt;b:if cond='data:showFreqNumbers'&gt;
              &lt;span dir='ltr'&gt;(&lt;data:label.count/&gt;)&lt;/span&gt;
            &lt;/b:if&gt;
          &lt;/li&gt;
        &lt;/b:loop&gt;
      &lt;/ul&gt;
    &lt;b:else/&gt;
      &lt;b:loop values='data:labels' var='label'&gt;
        &lt;span expr:class='&amp;quot;label-size label-size-&amp;quot; + data:label.cssSize'&gt;
          &lt;b:if cond='data:blog.url == data:label.url'&gt;
            &lt;span expr:dir='data:blog.languageDirection'&gt;&lt;data:label.name/&gt;&lt;/span&gt;
          &lt;b:else/&gt;
            &lt;a expr:dir='data:blog.languageDirection' expr:href='data:label.url'&gt;&lt;data:label.name/&gt;&lt;/a&gt;
          &lt;/b:if&gt;
          &lt;b:if cond='data:showFreqNumbers'&gt;
            &lt;span class='label-count' dir='ltr'&gt;(&lt;data:label.count/&gt;)&lt;/span&gt;
          &lt;/b:if&gt;
        &lt;/span&gt;
      &lt;/b:loop&gt;
    &lt;/b:if&gt;
    &lt;b:include name='quickedit'/&gt;
  &lt;/div&gt;
&lt;/b:includable&gt;
  &lt;/b:widget&gt;
&lt;/b:section-contents&gt;&lt;b:section-contents id='sidebar-right-2-1'&gt;
  &lt;b:widget id='BlogArchive1' locked='false' title='Blog Archive' type='BlogArchive'&gt;
    &lt;b:widget-settings&gt;
      &lt;b:widget-setting name='showStyle'&gt;HIERARCHY&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='yearPattern'&gt;yyyy&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='showWeekEnd'&gt;true&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='monthPattern'&gt;MMMM&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='dayPattern'&gt;MMM dd&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='weekPattern'&gt;MM/dd&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='chronological'&gt;false&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='showPosts'&gt;true&lt;/b:widget-setting&gt;
      &lt;b:widget-setting name='frequency'&gt;MONTHLY&lt;/b:widget-setting&gt;
    &lt;/b:widget-settings&gt;
    &lt;b:includable id='main'&gt;
  &lt;b:if cond='data:title != &amp;quot;&amp;quot;'&gt;
    &lt;h2&gt;&lt;data:title/&gt;&lt;/h2&gt;
  &lt;/b:if&gt;
  &lt;div class='widget-content'&gt;
  &lt;div id='ArchiveList'&gt;
  &lt;div expr:id='data:widget.instanceId + &amp;quot;_ArchiveList&amp;quot;'&gt;
    &lt;b:include cond='data:style == &amp;quot;HIERARCHY&amp;quot;' data='data' name='interval'/&gt;
    &lt;b:include cond='data:style == &amp;quot;FLAT&amp;quot;' data='data' name='flat'/&gt;
    &lt;b:include cond='data:style == &amp;quot;MENU&amp;quot;' data='data' name='menu'/&gt;
  &lt;/div&gt;
  &lt;/div&gt;
  &lt;b:include name='quickedit'/&gt;
  &lt;/div&gt;
&lt;/b:includable&gt;
    &lt;b:includable id='flat' var='data'&gt;
  &lt;ul class='flat'&gt;
    &lt;b:loop values='data:data' var='i'&gt;
      &lt;li class='archivedate'&gt;
        &lt;a expr:href='data:i.url'&gt;&lt;data:i.name/&gt;&lt;/a&gt; (&lt;data:i.post-count/&gt;)
      &lt;/li&gt;
    &lt;/b:loop&gt;
  &lt;/ul&gt;
&lt;/b:includable&gt;
    &lt;b:includable id='interval' var='intervalData'&gt;
  &lt;b:loop values='data:intervalData' var='interval'&gt;
    &lt;ul class='hierarchy'&gt;
      &lt;li expr:class='&amp;quot;archivedate &amp;quot; + data:interval.expclass'&gt;
        &lt;b:include cond='data:interval.toggleId' data='interval' name='toggle'/&gt;
        &lt;a class='post-count-link' expr:href='data:interval.url'&gt;
          &lt;data:interval.name/&gt;
        &lt;/a&gt;
        &lt;span class='post-count' dir='ltr'&gt;(&lt;data:interval.post-count/&gt;)&lt;/span&gt;
        &lt;b:include cond='data:interval.data' data='interval.data' name='interval'/&gt;
        &lt;b:include cond='data:interval.posts' data='interval.posts' name='posts'/&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/b:loop&gt;
&lt;/b:includable&gt;
    &lt;b:includable id='menu' var='data'&gt;
  &lt;select expr:id='data:widget.instanceId + &amp;quot;_ArchiveMenu&amp;quot;'&gt;
    &lt;option value=''&gt;&lt;data:title/&gt;&lt;/option&gt;
    &lt;b:loop values='data:data' var='i'&gt;
      &lt;option expr:value='data:i.url'&gt;&lt;data:i.name/&gt; (&lt;data:i.post-count/&gt;)&lt;/option&gt;
    &lt;/b:loop&gt;
  &lt;/select&gt;
&lt;/b:includable&gt;
    &lt;b:includable id='posts' var='posts'&gt;
  &lt;ul class='posts'&gt;
    &lt;b:loop values='data:posts' var='post'&gt;
      &lt;li&gt;&lt;a expr:href='data:post.url'&gt;&lt;data:post.title/&gt;&lt;/a&gt;&lt;/li&gt;
    &lt;/b:loop&gt;
  &lt;/ul&gt;
&lt;/b:includable&gt;
    &lt;b:includable id='toggle' var='interval'&gt;
  &lt;a class='toggle' href='javascript:void(0)'&gt;
    &lt;span expr:class='&amp;quot;zippy&amp;quot; + (data:interval.expclass == &amp;quot;expanded&amp;quot; ? &amp;quot; toggle-open&amp;quot; : &amp;quot;&amp;quot;)'&gt;
      &lt;b:if cond='data:interval.expclass == &amp;quot;expanded&amp;quot;'&gt;
        &amp;#9660;&amp;#160;
      &lt;b:elseif cond='data:blog.languageDirection == &amp;quot;rtl&amp;quot;'/&gt;
        &amp;#9668;&amp;#160;
      &lt;b:else/&gt;
        &amp;#9658;&amp;#160;
      &lt;/b:if&gt;
    &lt;/span&gt;
  &lt;/a&gt;
&lt;/b:includable&gt;
  &lt;/b:widget&gt;
&lt;/b:section-contents&gt;&lt;b:section-contents id='sidebar-right-2-2'/&gt;&lt;b:section-contents id='sidebar-right-3'/&gt;&lt;b:section-contents id='footer-1'/&gt;&lt;b:section-contents id='footer-2-1'/&gt;&lt;b:section-contents id='footer-2-2'/&gt;&lt;/html&gt;</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/template/default'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/template/default'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_PUBLISHING_MODE</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Тип публикации, использованный для данного блога.</title><content type='text'>PUBLISH_MODE_BLOGSPOT</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_PUBLISHING_MODE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_PUBLISHING_MODE'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_ADMIN_PERMISSION</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Список сообщений администраторов по данному блогу.</title><content type='text'>mvelikikh@gmail.com</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_ADMIN_PERMISSION'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_ADMIN_PERMISSION'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_ADULT_CONTENT</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Определяет, содержит ли этот блог содержание только для взрослых</title><content type='text'>false</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_ADULT_CONTENT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_ADULT_CONTENT'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_ANALYTICS_ACCOUNT_NUMBER</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Номер аккаунта Google Analytics для блога</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_ANALYTICS_ACCOUNT_NUMBER'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_ANALYTICS_ACCOUNT_NUMBER'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_ARCHIVE_DATE_FORMAT</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Номер формата даты в индексе архива</title><content type='text'>9</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_ARCHIVE_DATE_FORMAT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_ARCHIVE_DATE_FORMAT'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_ARCHIVE_FREQUENCY</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Частота архивирования блога</title><content type='text'>MONTHLY</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_ARCHIVE_FREQUENCY'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_ARCHIVE_FREQUENCY'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_AUTHOR_PERMISSION</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Список адресов электронной почты авторов, у которых есть разрешение на публикацию.</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_AUTHOR_PERMISSION'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_AUTHOR_PERMISSION'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_BY_POST_ARCHIVING</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Предоставление страницы архива для каждого сообщения</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_BY_POST_ARCHIVING'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_BY_POST_ARCHIVING'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_COMMENT_ACCESS</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Кто может оставлять комментарии</title><content type='text'>BLOGGERS</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_ACCESS'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_ACCESS'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_COMMENT_CAPTCHA</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Обязательная проверка Captcha для авторов комментариев</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_CAPTCHA'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_CAPTCHA'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_COMMENT_EMAIL</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Список адресов электронной почты, на которые будут отправляться уведомления о новых комментариях</title><content type='text'>mvelikikh@gmail.com</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_EMAIL'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_EMAIL'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_COMMENT_FEED</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Тип канала, предоставляемого для комментариев блога</title><content type='text'>FULL</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_FEED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_FEED'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_COMMENT_FORM_LOCATION</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Расположение формы комментария в блоге</title><content type='text'>EMBEDDED_IFRAME</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_FORM_LOCATION'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_FORM_LOCATION'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_COMMENT_MESSAGE</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Сообщение комментария в блоге</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_MESSAGE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_MESSAGE'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_COMMENT_MODERATION</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Включение модерации комментариев</title><content type='text'>DISABLED</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_MODERATION'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_MODERATION'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_COMMENT_MODERATION_DELAY</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Количество дней, по истечении которых новые комментарии подвергаются модерации</title><content type='text'>14</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_MODERATION_DELAY'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_MODERATION_DELAY'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_COMMENT_MODERATION_EMAIL</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Адрес электронной почты для отправки уведомлений о новых комментариях, нуждающихся в проверке</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_MODERATION_EMAIL'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_MODERATION_EMAIL'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_COMMENT_PROFILE_IMAGES</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Отображение картинок профиля в комментариях</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_PROFILE_IMAGES'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENT_PROFILE_IMAGES'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_COMMENTS_ALLOWED</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Определяет, показывать ли комментарии</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENTS_ALLOWED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENTS_ALLOWED'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_COMMENTS_TIME_STAMP_FORMAT</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Номер формата времени публикации комментария</title><content type='text'>29</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENTS_TIME_STAMP_FORMAT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_COMMENTS_TIME_STAMP_FORMAT'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_CONVERT_LINE_BREAKS</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Определяет, нужно ли преобразовывать разрывы строк в &lt;br /&gt; теги в редакторе сообщений</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_CONVERT_LINE_BREAKS'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_CONVERT_LINE_BREAKS'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_CUSTOM_ADS_TXT</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Поисковые системы используют содержимое персонализированного файла ads.txt.</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_CUSTOM_ADS_TXT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_CUSTOM_ADS_TXT'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_CUSTOM_ADS_TXT_ENABLED</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Есть ли у этого блога персонализированный файл ads.txt, который обрабатывается поисковыми системами?</title><content type='text'>false</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_CUSTOM_ADS_TXT_ENABLED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_CUSTOM_ADS_TXT_ENABLED'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_CUSTOM_PAGE_NOT_FOUND</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Содержание, отображаемое в тех случаях, когда запись или страница не найдены.</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_CUSTOM_PAGE_NOT_FOUND'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_CUSTOM_PAGE_NOT_FOUND'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_CUSTOM_ROBOTS_TXT</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Файл robots.txt предоставляется поисковым системам.</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_CUSTOM_ROBOTS_TXT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_CUSTOM_ROBOTS_TXT'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_CUSTOM_ROBOTS_TXT_ENABLED</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Предоставляет ли этот блог поисковым системам файл robots.txt?</title><content type='text'>false</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_CUSTOM_ROBOTS_TXT_ENABLED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_CUSTOM_ROBOTS_TXT_ENABLED'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_DATE_FORMAT</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Номер формата заголовка даты</title><content type='text'>26</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_DATE_FORMAT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_DATE_FORMAT'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_DEFAULT_COMMENTS_MODE</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Режим комментариев по умолчанию для сообщений</title><content type='text'>DEFAULT_HAVE_COMMENTS</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_DEFAULT_COMMENTS_MODE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_DEFAULT_COMMENTS_MODE'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_DESCRIPTION</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Описание блога</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_DESCRIPTION'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_DESCRIPTION'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_EMAIL_POST_LINKS</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Определяет, показывать ли пользователям ссылку для отправки сообщений по электронной почте</title><content type='text'>false</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_EMAIL_POST_LINKS'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_EMAIL_POST_LINKS'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_FEED_REDIRECT_URL</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>URL для перенаправления запросов на канал сообщений</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_FEED_REDIRECT_URL'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_FEED_REDIRECT_URL'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_FLOAT_ALIGNMENT</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Определяет включение плавающего выравнивания в блоге</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_FLOAT_ALIGNMENT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_FLOAT_ALIGNMENT'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_LOCALE</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Язык для данного блога</title><content type='text'>ru</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_LOCALE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_LOCALE'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_MAX_NUM</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Максимальное количество единиц для показа на главной странице"</title><content type='text'>7</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_MAX_NUM'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_MAX_NUM'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_MAX_UNIT</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Блок для отображения на главной странице</title><content type='text'>POSTS</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_MAX_UNIT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_MAX_UNIT'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_META_DESCRIPTION</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Метаописание блога используется в поисковых системах.</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_META_DESCRIPTION'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_META_DESCRIPTION'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_META_DESCRIPTION_ENABLED</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>В этом блоге используется метаописание.</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_META_DESCRIPTION_ENABLED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_META_DESCRIPTION_ENABLED'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_NAME</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Название блога</title><content type='text'>Oracle Notes by Mikhail</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_NAME'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_NAME'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_PER_POST_FEED</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Тип канала, предоставляемого для комментариев к отдельным сообщениям</title><content type='text'>FULL</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_PER_POST_FEED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_PER_POST_FEED'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_POST_FEED</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Тип канала, предоставляемого для сообщений блога</title><content type='text'>FULL</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_POST_FEED'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_POST_FEED'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_POST_FEED_FOOTER</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Нижний колонтитул, добавляемый в конце каждой записи канала сообщений</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_POST_FEED_FOOTER'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_POST_FEED_FOOTER'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_POST_TEMPLATE</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Шаблон для сообщений блога</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_POST_TEMPLATE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_POST_TEMPLATE'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_QUICK_EDITING</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Определяет, включено ли быстрое редактирование</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_QUICK_EDITING'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_QUICK_EDITING'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_READ_ACCESS_MODE</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Тип доступа для читателей блога.</title><content type='text'>PUBLIC</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_READ_ACCESS_MODE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_READ_ACCESS_MODE'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_READER_PERMISSION</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Список адресов электронной почты пользователей, имеющих право на чтение этого блога.</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_READER_PERMISSION'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_READER_PERMISSION'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_SEARCHABLE</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Определяет индексирование данного блога поисковыми машинами</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_SEARCHABLE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_SEARCHABLE'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_SEND_EMAIL</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Разделенный запятыми список адресов электронной почты, на которые будут отправляться новые сообщения блогов</title><content type='text'></content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_SEND_EMAIL'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_SEND_EMAIL'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_SHOW_URL</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Определяет, показывать ли поле связанной ссылки у составителя сообщения</title><content type='text'>false</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_SHOW_URL'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_SHOW_URL'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_SUBDOMAIN</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Субдомен BlogSpot, в котором будет опубликован ваш блог</title><content type='text'>mvelikikh</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_SUBDOMAIN'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_SUBDOMAIN'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_TIME_STAMP_FORMAT</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Число формата отметки времени</title><content type='text'>27</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_TIME_STAMP_FORMAT'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_TIME_STAMP_FORMAT'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_TIME_ZONE</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Временная зона для этого блога</title><content type='text'>Asia/Omsk</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_TIME_ZONE'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_TIME_ZONE'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.settings.BLOG_USE_LIGHTBOX</id><published>2014-07-21T12:43:40.174+07:00</published><updated>2021-12-21T23:41:30.107+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#settings'/><title type='text'>Показывать изображения в Lightbox при нажатии</title><content type='text'>true</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_USE_LIGHTBOX'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/settings/BLOG_USE_LIGHTBOX'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-5079918392548920545</id><published>2021-12-21T23:40:00.002+06:00</published><updated>2021-12-21T23:40:48.101+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='21c'/><category scheme='http://www.blogger.com/atom/ns#' term='sql_trace'/><title type='text'>How to trace specific SQL statement executed by certain user</title><content type='html'>&lt;p&gt;A question asking the same appeared on oracle-l today &lt;a href="https://www.freelists.org/post/oracle-l/sql-trace-filtering"&gt;here&lt;/a&gt;. It is widely known how to trace a specific SQL statement at the system level, e.g.: &lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;alter system set events 'sql_trace[sql:&amp;lt;some_sql_id&amp;gt;]';&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;What if we want to trace the same SQL statement when it is executed by some specific user? A common approach in this case is to create a LOGON trigger and use &lt;strong&gt;ALTER SESSION SET EVENTS&lt;/strong&gt; in it. It turns out that it is possible by using event filters and the &lt;strong&gt;username()&lt;/strong&gt; function too. For example, to trace the SQL_ID &lt;strong&gt;bqka14bvd2zmb&lt;/strong&gt; run by the user &lt;strong&gt;TC1&lt;/strong&gt; we can use:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;alter system set events 'sql_trace[sql:bqka14bvd2zmb] {streq:username(),"TC1"}';&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;Here is a full example which is also available as a Gist &lt;a href="https://gist.github.com/mvelikikh/27a488e9104e63a55261c480b70a86f6"&gt;here&lt;/a&gt;:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;[oracle@db-21 ~]$ sqlplus /nolog @q&lt;br /&gt;&lt;br /&gt;SQL*Plus: Release 21.0.0.0.0 - Production on Tue Dec 21 15:54:22 2021&lt;br /&gt;Version 21.4.0.0.0&lt;br /&gt;&lt;br /&gt;Copyright (c) 1982, 2021, Oracle.  All rights reserved.&lt;br /&gt;&lt;br /&gt;SQL&gt; conn / as sysdba&lt;br /&gt;Connected.&lt;br /&gt;SQL&gt; alter session set container=pdb;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; drop user tc1 cascade;&lt;br /&gt;&lt;br /&gt;User dropped.&lt;br /&gt;&lt;br /&gt;SQL&gt; drop user tc2 cascade;&lt;br /&gt;&lt;br /&gt;User dropped.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; grant create session, select_catalog_role to tc1 identified by tc1;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt; grant create session, select_catalog_role to tc2 identified by tc2;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col sql_id old_v sql_id&lt;br /&gt;SQL&gt; select dbms_sql_translator.sql_id(q'#select 'trace_me' from dual#') sql_id from dual;&lt;br /&gt;&lt;br /&gt;SQL_ID&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;bqka14bvd2zmb&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter system set events 'sql_trace[sql:&amp;amp;sql_id.] {streq:username(),"TC1"}';&lt;br /&gt;old   1: alter system set events 'sql_trace[sql:&amp;amp;sql_id.] {streq:username(),"TC1"}'&lt;br /&gt;new   1: alter system set events 'sql_trace[sql:bqka14bvd2zmb] {streq:username(),"TC1"}'&lt;br /&gt;&lt;br /&gt;System altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; conn tc1/tc1@db-21/pdb&lt;br /&gt;Connected.&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select 'trace_me' from dual;&lt;br /&gt;&lt;br /&gt;'TRACE_M&lt;br /&gt;--------&lt;br /&gt;trace_me&lt;br /&gt;&lt;br /&gt;SQL&gt; col trace_file old_v trace_file&lt;br /&gt;SQL&gt; select value trace_file from v$diag_info where name='Default Trace File';&lt;br /&gt;&lt;br /&gt;TRACE_FILE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;/u01/app/oracle/diag/rdbms/orcl/orcl/trace/orcl_ora_5455.trc&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; !cat &amp;amp;trace_file.&lt;br /&gt;Trace file /u01/app/oracle/diag/rdbms/orcl/orcl/trace/orcl_ora_5455.trc&lt;br /&gt;Oracle Database 21c Enterprise Edition Release 21.0.0.0.0 - Production&lt;br /&gt;Version 21.4.0.0.0&lt;br /&gt;Build label:    RDBMS_21.3.0.0.0_LINUX.X64_210727&lt;br /&gt;ORACLE_HOME:    /u01/app/oracle/product/21.0.0/dbhome_1&lt;br /&gt;System name:    Linux&lt;br /&gt;Node name:      db-21.localdomain&lt;br /&gt;Release:        5.4.17-2136.300.7.el8uek.x86_64&lt;br /&gt;Version:        #2 SMP Fri Oct 8 16:23:01 PDT 2021&lt;br /&gt;Machine:        x86_64&lt;br /&gt;VM name:        KVM CPUID feature flags: 0x01000089&lt;br /&gt;Instance name: orcl&lt;br /&gt;Redo thread mounted by this instance: 1&lt;br /&gt;Oracle process number: 48&lt;br /&gt;Unix process pid: 5455, NID: 4026531836, image: oracle@db-21.localdomain&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;*** 2021-12-21T15:54:23.397300+00:00 (PDB(3))&lt;br /&gt;*** SESSION ID:(82.1864) 2021-12-21T15:54:23.397327+00:00&lt;br /&gt;*** CLIENT ID:() 2021-12-21T15:54:23.397344+00:00&lt;br /&gt;*** SERVICE NAME:(pdb) 2021-12-21T15:54:23.397360+00:00&lt;br /&gt;*** MODULE NAME:(SQL*Plus) 2021-12-21T15:54:23.397377+00:00&lt;br /&gt;*** ACTION NAME:() 2021-12-21T15:54:23.397394+00:00&lt;br /&gt;*** CLIENT DRIVER:(SQL*PLUS) 2021-12-21T15:54:23.397409+00:00&lt;br /&gt;*** CONTAINER ID:(3) 2021-12-21T15:54:23.397426+00:00&lt;br /&gt;*** CLIENT IP:(10.0.2.15) 2021-12-21T15:54:23.397449+00:00&lt;br /&gt;*** CLIENT IP:(10.0.2.15) 2021-12-21T15:54:23.397449+00:00&lt;br /&gt;&lt;br /&gt;=====================&lt;br /&gt;PARSING IN CURSOR #140557434715864 len=332 dep=1 uid=0 oct=3 lid=0 tim=1528633612 hv=2698389488 ad='85cb8630' sqlid='acmvv4fhdc9zh'&lt;br /&gt;select obj#,type#,ctime,mtime,stime, status, dataobj#, flags, oid$, spare1, spare2, spare3, signature, spare7, spare8, spare9, nvl(dflcollid, 16382), creappid, creverid, modappid, modverid, crepatchid, modpatchid from obj$ where owner#=:1 and name=:2 and namespace=:3 and remoteowner is null and linkname is null and subname is null&lt;br /&gt;END OF STMT&lt;br /&gt;EXEC #140557434715864:c=0,e=25,p=0,cr=0,cu=0,mis=0,r=0,dep=1,og=4,plh=813480514,tim=1528633611&lt;br /&gt;FETCH #140557434715864:c=19,e=19,p=0,cr=3,cu=0,mis=0,r=0,dep=1,og=4,plh=813480514,tim=1528634393&lt;br /&gt;CLOSE #140557434715864:c=0,e=0,dep=1,type=3,tim=1528634426&lt;br /&gt;=====================&lt;br /&gt;PARSING IN CURSOR #140557434718920 len=27 dep=0 uid=120 oct=3 lid=120 tim=1528635472 hv=4140924523 ad='7aa8feb0' sqlid='bqka14bvd2zmb'&lt;br /&gt;select 'trace_me' from dual&lt;br /&gt;END OF STMT&lt;br /&gt;EXEC #140557434718920:c=30,e=30,p=0,cr=0,cu=0,mis=0,r=0,dep=0,og=1,plh=1388734953,tim=1528635471&lt;br /&gt;FETCH #140557434718920:c=5,e=6,p=0,cr=0,cu=0,mis=0,r=1,dep=0,og=1,plh=1388734953,tim=1528635612&lt;br /&gt;STAT #140557434718920 id=1 cnt=1 pid=0 pos=1 obj=0 op='FAST DUAL  (cr=0 pr=0 pw=0 str=1 time=1 us cost=2 size=0 card=1)'&lt;br /&gt;FETCH #140557434718920:c=0,e=0,p=0,cr=0,cu=0,mis=0,r=0,dep=0,og=0,plh=1388734953,tim=1528636086&lt;br /&gt;CLOSE #140557434718920:c=0,e=7,dep=0,type=0,tim=1528637068&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; conn tc2/tc2@db-21/pdb&lt;br /&gt;Connected.&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select 'trace_me' from dual;&lt;br /&gt;&lt;br /&gt;'TRACE_M&lt;br /&gt;--------&lt;br /&gt;trace_me&lt;br /&gt;&lt;br /&gt;SQL&gt; col trace_file old_v trace_file&lt;br /&gt;SQL&gt; select value trace_file from v$diag_info where name='Default Trace File';&lt;br /&gt;&lt;br /&gt;TRACE_FILE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;/u01/app/oracle/diag/rdbms/orcl/orcl/trace/orcl_ora_5458.trc&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; !cat &amp;amp;trace_file.&lt;br /&gt;cat: /u01/app/oracle/diag/rdbms/orcl/orcl/trace/orcl_ora_5458.trc: No such file or directory&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;Here I make use of the streq filter and the username function:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;SQL&gt; oradebug doc event filter streq&lt;br /&gt;&lt;br /&gt;streq: filter to only fire an event when string s1 = s2 (up to &amp;lt;len&gt; characters)&lt;br /&gt;&lt;br /&gt;Usage&lt;br /&gt;-------&lt;br /&gt;{streq:  s1              &amp;lt;string&gt;[256],&lt;br /&gt;         s2              &amp;lt;string&gt;[256],&lt;br /&gt;         len             &amp;lt;ub4&gt; }&lt;br /&gt;&lt;br /&gt;SQL&gt; oradebug doc event action username&lt;br /&gt;username&lt;br /&gt;        - Return user log-in name&lt;br /&gt;Usage&lt;br /&gt;-------&lt;br /&gt;username( Action returns: &amp;lt;string&gt;[30])&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/5079918392548920545/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/12/how-to-trace-specific-sql-statement.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5079918392548920545'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5079918392548920545'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/12/how-to-trace-specific-sql-statement.html' title='How to trace specific SQL statement executed by certain user'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-735973288326067514</id><published>2021-12-18T17:36:00.001+06:00</published><updated>2021-12-18T17:36:57.686+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='DBMS_LOB'/><title type='text'>Mythbusters: VARRAY faster than CLOB</title><content type='html'>&lt;p&gt;There has been a tweet recently saying that VARRAY is faster than CLOB: &lt;a href="https://twitter.com/dbms_xtender/status/1469476734240178178"&gt;link&lt;/a&gt;. On this data set with SQL*Plus, the correctness of this statement largely depends on the underlying hardware on the database, and the network between the client and the server. More specifically, VARRAY will be faster with a rather slow network.&lt;/p&gt;&lt;p&gt;A typical production environment that I work with includes one or more databases deploying across different availability zones (AZ) on the cloud. The applications reside in the same AZ as the database server to avoid inter-AZ traffic that costs extra money. I tested the script from &lt;a href="https://gist.github.com/xtender/4ccc1bcae16883c0f1e80a0fb8404963"&gt;this Gist&lt;/a&gt; across two major cloud providers and VARRAY was never faster than CLOB. In fact, it is significantly slower. See the output from 19.13 below (the script is from &lt;a href="https://gist.github.com/xtender/4ccc1bcae16883c0f1e80a0fb8404963"&gt;this Gist&lt;/a&gt; - I just added the last query with DBMS_LOB):&lt;/p&gt;&lt;pre class='brush:sql;highlight:[25,45,80,115]'&gt;&lt;br /&gt;[oracle@rac2 ~]$ NLS_LANG=.AL32UTF8 sqlplus tc/tc@rac1:1522/pdb1 @test1&lt;br /&gt;&lt;br /&gt;SQL*Plus: Release 19.0.0.0.0 - Production on Sat Dec 18 10:54:03 2021&lt;br /&gt;Version 19.13.0.0.0&lt;br /&gt;&lt;br /&gt;Copyright (c) 1982, 2021, Oracle.  All rights reserved.&lt;br /&gt;&lt;br /&gt;Last Successful login time: Sat Dec 18 2021 10:53:17 +00:00&lt;br /&gt;&lt;br /&gt;Connected to:&lt;br /&gt;Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production&lt;br /&gt;Version 19.13.0.0.0&lt;br /&gt;&lt;br /&gt;SQL&gt; set lobprefetch 32767&lt;br /&gt;SQL&gt; set long 10000000&lt;br /&gt;SQL&gt; set longchunksize 10000000&lt;br /&gt;SQL&gt; set timing on;&lt;br /&gt;SQL&gt; set arraysize 1000;&lt;br /&gt;SQL&gt; --set feedback only&lt;br /&gt;SQL&gt; set autotrace trace stat;&lt;br /&gt;SQL&gt; select id,c_lob from t_lob_1_mb where id&amp;lt;=25;&lt;br /&gt;&lt;br /&gt;25 rows selected.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:01.50&lt;br /&gt;&lt;br /&gt;Statistics&lt;br /&gt;----------------------------------------------------------&lt;br /&gt;          0  recursive calls&lt;br /&gt;          0  db block gets&lt;br /&gt;         82  consistent gets&lt;br /&gt;       6475  physical reads&lt;br /&gt;          0  redo size&lt;br /&gt;   51655001  bytes sent via SQL*Net to client&lt;br /&gt;      15345  bytes received via SQL*Net from client&lt;br /&gt;         52  SQL*Net roundtrips to/from client&lt;br /&gt;          0  sorts (memory)&lt;br /&gt;          0  sorts (disk)&lt;br /&gt;         25  rows processed&lt;br /&gt;&lt;br /&gt;SQL&gt; select id,lob_to_varray(c_lob) c_varray from t_lob_1_mb where id&amp;lt;=25;&lt;br /&gt;&lt;br /&gt;25 rows selected.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:14.10&lt;br /&gt;&lt;br /&gt;Statistics&lt;br /&gt;----------------------------------------------------------&lt;br /&gt;         33  recursive calls&lt;br /&gt;          0  db block gets&lt;br /&gt;        199  consistent gets&lt;br /&gt;     653950  physical reads&lt;br /&gt;          0  redo size&lt;br /&gt;   25107664  bytes sent via SQL*Net to client&lt;br /&gt;       9261  bytes received via SQL*Net from client&lt;br /&gt;         61  SQL*Net roundtrips to/from client&lt;br /&gt;         25  sorts (memory)&lt;br /&gt;          0  sorts (disk)&lt;br /&gt;         25  rows processed&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select&lt;br /&gt;  2    c_varray&lt;br /&gt;  3  from t_lob_1_mb&lt;br /&gt;  4       outer apply (&lt;br /&gt;  5         select&lt;br /&gt;  6           cast(&lt;br /&gt;  7             collect(&lt;br /&gt;  8                cast(substr(c_lob,(level-1)*4000 + 1,4000) as varchar2(4000))&lt;br /&gt;  9                )&lt;br /&gt; 10             as sys.odcivarchar2list&lt;br /&gt; 11           ) c_varray&lt;br /&gt; 12         from dual&lt;br /&gt; 13         connect by level&amp;lt;=ceil(length(c_lob)/4000)&lt;br /&gt; 14       )&lt;br /&gt; 15  where id&amp;lt;=25;&lt;br /&gt;&lt;br /&gt;25 rows selected.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:14.16&lt;br /&gt;&lt;br /&gt;Statistics&lt;br /&gt;----------------------------------------------------------&lt;br /&gt;          0  recursive calls&lt;br /&gt;          0  db block gets&lt;br /&gt;        176  consistent gets&lt;br /&gt;     653950  physical reads&lt;br /&gt;          0  redo size&lt;br /&gt;   25106012  bytes sent via SQL*Net to client&lt;br /&gt;       9086  bytes received via SQL*Net from client&lt;br /&gt;         58  SQL*Net roundtrips to/from client&lt;br /&gt;         50  sorts (memory)&lt;br /&gt;          0  sorts (disk)&lt;br /&gt;         25  rows processed&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select&lt;br /&gt;  2    c_varray&lt;br /&gt;  3  from t_lob_1_mb&lt;br /&gt;  4       outer apply (&lt;br /&gt;  5         select&lt;br /&gt;  6           cast(&lt;br /&gt;  7             collect(&lt;br /&gt;  8                dbms_lob.substr(c_lob,4000,(level-1)*4000 + 1)&lt;br /&gt;  9                )&lt;br /&gt; 10             as sys.odcivarchar2list&lt;br /&gt; 11           ) c_varray&lt;br /&gt; 12         from dual&lt;br /&gt; 13         connect by level&amp;lt;=ceil(length(c_lob)/4000)&lt;br /&gt; 14       )&lt;br /&gt; 15  where id&amp;lt;=25;&lt;br /&gt;&lt;br /&gt;25 rows selected.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:03.19&lt;br /&gt;&lt;br /&gt;Statistics&lt;br /&gt;----------------------------------------------------------&lt;br /&gt;          0  recursive calls&lt;br /&gt;          0  db block gets&lt;br /&gt;        176  consistent gets&lt;br /&gt;      24900  physical reads&lt;br /&gt;          0  redo size&lt;br /&gt;   25106012  bytes sent via SQL*Net to client&lt;br /&gt;       9071  bytes received via SQL*Net from client&lt;br /&gt;         58  SQL*Net roundtrips to/from client&lt;br /&gt;         50  sorts (memory)&lt;br /&gt;          0  sorts (disk)&lt;br /&gt;         25  rows processed&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;&lt;b&gt;NB&lt;/b&gt;: the DBMS_LOB query is not mentioned in the original tweet, but I wrote why SUBSTR should not be used against LOB's in 2019: &lt;a href="https://mvelikikh.blogspot.com/2019/10/temporary-lobs.html"&gt;Temporary LOBs&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;As I said, it is quite a typical cloud environment in which the client is on a different VM from the DB server. I can get even better results with CLOB if I run the same script on the DB server itself or use a proximity placement group (Azure)/cluster placement group (AWS).&lt;/p&gt;&lt;p&gt;It can be seen that there is twice as much data transfered with CLOB than with the other queries (&lt;b&gt;50MB&lt;/b&gt; vs &lt;b&gt;25MB&lt;/b&gt;). It is a known issue that was already observed by several other authors, e.g. &lt;a href="https://jonathanlewis.wordpress.com/2019/08/01/lob-reads/"&gt;LOB reads&lt;/a&gt;. In the specific example from this post, the extra CLOB data will become noticeable on a slow network, e.g. me pulling data from a different continent on a mobile broadband. It is not the case in most environments (including non-productions) that I work with - CLOB will be faster than VARRAY (&lt;b&gt;1.5 seconds&lt;/b&gt; vs &lt;b&gt;14.16 seconds&lt;/b&gt;). As always, rather than relying on any information, such as the tweet above, it is better to test it for yourself as this post demonstrates.&lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/735973288326067514/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/12/mythbusters-varray-faster-than-clob.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/735973288326067514'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/735973288326067514'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/12/mythbusters-varray-faster-than-clob.html' title='Mythbusters: VARRAY faster than CLOB'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-4082825337524762020</id><published>2021-12-17T23:54:00.003+06:00</published><updated>2021-12-17T23:54:36.365+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='21c'/><title type='text'>Using credentials with database links in 21c</title><content type='html'>&lt;p&gt;Since 21c it is now possible to use credential objects in database links. Here is a short demonstration of this functionality:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;SQL&gt; exec dbms_credential.create_credential('TC_CRED', 'TC', 'tc')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create database link link1 connect with tc_cred using 'localhost/pdb';&lt;br /&gt;&lt;br /&gt;Database link created.&lt;br /&gt;&lt;br /&gt;SQL&gt; create database link link2 connect with tc_cred using 'localhost/pdb';&lt;br /&gt;&lt;br /&gt;Database link created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from dual@link1;&lt;br /&gt;&lt;br /&gt;D&lt;br /&gt;-&lt;br /&gt;X&lt;br /&gt;&lt;br /&gt;SQL&gt; select * from dual@link2;&lt;br /&gt;&lt;br /&gt;D&lt;br /&gt;-&lt;br /&gt;X&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;SQL Language Reference has not been updated with the new syntax yet. If we alter the user's password, the existing DB links will not work anymore (I do not consider gradual password rollover here):&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;SQL&gt; alter user tc identified by tc2;&lt;br /&gt;&lt;br /&gt;User altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session close database link link1;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; alter session close database link link2;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from dual@link1;&lt;br /&gt;select * from dual@link1&lt;br /&gt;                   *&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-01017: invalid username/password; logon denied&lt;br /&gt;ORA-02063: preceding line from LINK1&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;It is enough to alter the credentials objects to make the DB links work again:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;SQL&gt; exec dbms_credential.update_credential('TC_CRED', 'PASSWORD', 'tc2')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from dual@link1;&lt;br /&gt;&lt;br /&gt;D&lt;br /&gt;-&lt;br /&gt;X&lt;br /&gt;&lt;br /&gt;SQL&gt; select * from dual@link2;&lt;br /&gt;&lt;br /&gt;D&lt;br /&gt;-&lt;br /&gt;X&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Conclusion&lt;/h3&gt;&lt;p&gt;This functionality really comes into its own when you re-use one username and password pair in multiple database links. If we want to change the username or password, there is no need to change each link anymore. We can alter one credentials object instead. The functionality has been backported to 19c as well: &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=29541929.8"&gt;Bug 29541929 - support credential objects in database links (Doc ID 29541929.8)&lt;/a&gt;.&lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/4082825337524762020/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/12/using-credentials-with-database-links.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4082825337524762020'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4082825337524762020'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/12/using-credentials-with-database-links.html' title='Using credentials with database links in 21c'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-9163514902002656769</id><published>2021-12-16T23:21:00.006+06:00</published><updated>2021-12-16T23:21:36.327+06:00</updated><app:control xmlns:app='http://purl.org/atom/app#'><app:draft>yes</app:draft></app:control><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='sqlplus'/><title type='text'>SQL*Plus LONGCHUNKSIZE: how much is too much</title><content type='html'>&lt;p&gt;Here is a short demonstration showing that setting a large value for &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/sqpug/SET-system-variable-summary.html#GUID-2033D143-DCEA-4A86-AB7B-3FE0892195FA"&gt;LONGCHUNKSIZE&lt;/a&gt; will not necessarily result in a faster execution. In fact, the performance degradation can become quite significant (8x times) for a simple example from this blog post.&lt;/p&gt;&lt;h3&gt;Scripts&lt;/h3&gt;&lt;p&gt;The code for the example is taken from &lt;a href="https://gist.github.com/xtender/4ccc1bcae16883c0f1e80a0fb8404963"&gt;this Gist&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;There are two scripts that I am going to use to assess different LONGCHUNKSIZE values:&lt;/p&gt;&lt;p&gt;&lt;b&gt;test_longc_one.sql:&lt;/b&gt;&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;set lobprefetch 32767&lt;br /&gt;set long 10000000&lt;br /&gt;set longchunksize &amp;amp;1.&lt;br /&gt;set timing on;&lt;br /&gt;set arraysize 1000;&lt;br /&gt;set autotrace trace stat;&lt;br /&gt;select id,c_lob from t_lob_1_mb where id&amp;lt;=25;&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;&lt;b&gt;test_longc.sql:&lt;/b&gt;&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;set echo on&lt;br /&gt;@test_longc_one 100&lt;br /&gt;@test_longc_one 1000&lt;br /&gt;@test_longc_one 10000&lt;br /&gt;@test_longc_one 100000&lt;br /&gt;@test_longc_one 1000000&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;Basically, I start the test with &lt;b&gt;LONGCHUNKSIZE=100&lt;/b&gt; and keep increasing &lt;b&gt;LONGCHUNKSIZE&lt;/b&gt; by 10 times up to &lt;b&gt;1,000,000&lt;/b&gt; - this is the size of the LOB column from the example above.&lt;/p&gt;&lt;h3&gt;Results&lt;/h3&gt;&lt;p&gt;Long story short, here are the actual results that I got on a blank 19.13 database:&lt;/p&gt;&lt;style type="text/css"&gt;th.awrbg {     font: bold 8pt Arial,Helvetica,Geneva,sans-serif;     color: White;     background: #0066CC;     padding-left: 4px;     padding-right: 4px;     padding-bottom: 2px; } td.awrc {     font: 8pt Arial,Helvetica,Geneva,sans-serif;     color: black;     background: #FFFFCC;     vertical-align: top;     text-align: right; } td.awrnc {     font: 8pt Arial,Helvetica,Geneva,sans-serif;     color: black;     background: White;     vertical-align: top;     text-align: right; }    td.left {     text-align: left; } &lt;/style&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th class="awrbg"&gt;Client / LONGCHUNKSIZE&lt;/th&gt;&lt;th class="awrbg"&gt;100&lt;/th&gt;&lt;th class="awrbg"&gt;1,000&lt;/th&gt;&lt;th class="awrbg"&gt;10,000&lt;/th&gt;&lt;th class="awrbg"&gt;100,000&lt;/th&gt;&lt;th class="awrbg"&gt;1,000,000&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc left"&gt;Same VM (Cloud 1)&lt;/td&gt;&lt;td class="awrc"&gt;88.08&lt;/td&gt;&lt;td class="awrc"&gt;8.49&lt;/td&gt;&lt;td class="awrc"&gt;1.11&lt;/td&gt;&lt;td class="awrc"&gt;0.78&lt;/td&gt;&lt;td class="awrc"&gt;4.97&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrnc left"&gt;Different VM (Cloud 1)&lt;/td&gt;&lt;td class="awrnc"&gt;113.8&lt;/td&gt;&lt;td class="awrnc"&gt;13.48&lt;/td&gt;&lt;td class="awrnc"&gt;1.8&lt;/td&gt;&lt;td class="awrnc"&gt;1.11&lt;/td&gt;&lt;td class="awrnc"&gt;5.08&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc left"&gt;Same VM (Cloud 2)&lt;/td&gt;&lt;td class="awrc"&gt;265.28&lt;/td&gt;&lt;td class="awrc"&gt;27.78&lt;/td&gt;&lt;td class="awrc"&gt;3.12&lt;/td&gt;&lt;td class="awrc"&gt;1.19&lt;/td&gt;&lt;td class="awrc"&gt;5.4&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrnc left"&gt;Different VM (Cloud 2)&lt;/td&gt;&lt;td class="awrnc"&gt;289.77&lt;/td&gt;&lt;td class="awrnc"&gt;31.18&lt;/td&gt;&lt;td class="awrnc"&gt;4.95&lt;/td&gt;&lt;td class="awrnc"&gt;3.22&lt;/td&gt;&lt;td class="awrnc"&gt;7.44&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc left"&gt;Slow PC&lt;/td&gt;&lt;td class="awrc"&gt;218.45&lt;/td&gt;&lt;td class="awrc"&gt;20.07&lt;/td&gt;&lt;td class="awrc"&gt;3.79&lt;/td&gt;&lt;td class="awrc"&gt;5.3&lt;/td&gt;&lt;td class="awrc"&gt;41.48&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrnc left"&gt;Client with slow broadband&lt;/td&gt;&lt;td class="awrnc"&gt;N/A&lt;/td&gt;&lt;td class="awrnc"&gt;N/A&lt;/td&gt;&lt;td class="awrnc"&gt;442.45&lt;/td&gt;&lt;td class="awrnc"&gt;104.15&lt;/td&gt;&lt;td class="awrnc"&gt;75.81&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;Description:&lt;/p&gt;&lt;ul&gt;  &lt;li&gt;&lt;b&gt;Same VM (Cloud 1)&lt;/b&gt; - SQL*Plus running from the DB server VM on cloud provider 1&lt;/li&gt;  &lt;li&gt;&lt;b&gt;Different VM (Cloud 1)&lt;/b&gt; - SQL*Plus running from a VM on cloud provider 1&lt;/li&gt;  &lt;li&gt;&lt;b&gt;Same VM (Cloud 2)&lt;/b&gt; - SQL*Plus running from the DB server VM on cloud provider 2&lt;/li&gt;  &lt;li&gt;&lt;b&gt;Different VM (Cloud 2)&lt;/b&gt; - SQL*Plus running from a VM on cloud provider 2&lt;/li&gt;  &lt;li&gt;&lt;b&gt;Slow PC&lt;/b&gt; - Oracle DB running in VirtualBox on my PC&lt;/li&gt;  &lt;li&gt;&lt;b&gt;Client with slow broadband&lt;/b&gt; - me pulling data over mobile broadband from a different continent&lt;/li&gt;&lt;/ul&gt;</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/9163514902002656769'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/9163514902002656769'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-7302193972474156161</id><published>2021-12-09T17:26:00.000+06:00</published><updated>2021-12-09T17:26:26.303+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><title type='text'>gridSetup.sh executeConfigTools fails with PRVG-13606 : chrony daemon is not synchronized with any external time source</title><content type='html'>&lt;p&gt;The command failed with the following errors in the log:&lt;/p&gt;&lt;pre class='brush:sql'&gt;/u01/app/19.3.0/grid/gridSetup.sh -executeConfigTools -responseFile /opt/rsp/gi_19.3_config.rsp -silent&lt;br /&gt;...&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM] Verifying Clock Synchronization ...FAILED&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM] Skipping line: Verifying Clock Synchronization ...FAILED&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM]   Verifying Network Time Protocol (NTP) ...FAILED&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM] Skipping line:   Verifying Network Time Protocol (NTP) ...FAILED&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM]     Verifying chrony daemon is synchronized with at least one external time&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM] Skipping line:     Verifying chrony daemon is synchronized with at least one external time&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM]     source ...FAILED&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM] Skipping line:     source ...FAILED&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM]     rac2: PRVG-13606 : chrony daemon is not synchronized with any external time&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM] Skipping line:     rac2: PRVG-13606 : chrony daemon is not synchronized with any external time&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM]           source on node "rac2".&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM] Skipping line:           source on node "rac2".&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM] Skipping line:&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM]     rac1: PRVG-13606 : chrony daemon is not synchronized with any external time&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM] Skipping line:     rac1: PRVG-13606 : chrony daemon is not synchronized with any external time&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM]           source on node "rac1".&lt;br /&gt;INFO:  [Dec 8, 2021 8:20:51 AM] Skipping line:           source on node "rac1".&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;It can be easily reproduced by running CVU:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;[grid@rac1 ~]$ cluvfy comp clocksync -n rac1 -verbose&lt;br /&gt;&lt;br /&gt;Verifying Clock Synchronization ...&lt;br /&gt;  Node Name                             Status&lt;br /&gt;  ------------------------------------  ------------------------&lt;br /&gt;  rac1                                  passed&lt;br /&gt;&lt;br /&gt;  Node Name                             State&lt;br /&gt;  ------------------------------------  ------------------------&lt;br /&gt;  rac1                                  Observer&lt;br /&gt;&lt;br /&gt;CTSS is in Observer state. Switching over to clock synchronization checks using NTP&lt;br /&gt;&lt;br /&gt;  Verifying Network Time Protocol (NTP) ...&lt;br /&gt;    Verifying '/etc/chrony.conf' ...&lt;br /&gt;    Node Name                             File exists?&lt;br /&gt;    ------------------------------------  ------------------------&lt;br /&gt;    rac1                                  yes&lt;br /&gt;&lt;br /&gt;    Verifying '/etc/chrony.conf' ...PASSED&lt;br /&gt;    Verifying Daemon 'chronyd' ...&lt;br /&gt;    Node Name                             Running?&lt;br /&gt;    ------------------------------------  ------------------------&lt;br /&gt;    rac1                                  yes&lt;br /&gt;&lt;br /&gt;    Verifying Daemon 'chronyd' ...PASSED&lt;br /&gt;    Verifying NTP daemon or service using UDP port 123 ...&lt;br /&gt;    Node Name                             Port Open?&lt;br /&gt;    ------------------------------------  ------------------------&lt;br /&gt;    rac1                                  yes&lt;br /&gt;&lt;br /&gt;    Verifying NTP daemon or service using UDP port 123 ...PASSED&lt;br /&gt;    Verifying chrony daemon is synchronized with at least one external time source ...FAILED (PRVG-13606)&lt;br /&gt;  Verifying Network Time Protocol (NTP) ...FAILED (PRVG-13606)&lt;br /&gt;Verifying Clock Synchronization ...FAILED (PRVG-13606)&lt;br /&gt;&lt;br /&gt;Verification of Clock Synchronization across the cluster nodes was unsuccessful on all the specified nodes.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Failures were encountered during execution of CVU verification request "Clock Synchronization across the cluster nodes".&lt;br /&gt;&lt;br /&gt;Verifying Clock Synchronization ...FAILED&lt;br /&gt;  Verifying Network Time Protocol (NTP) ...FAILED&lt;br /&gt;    Verifying chrony daemon is synchronized with at least one external time&lt;br /&gt;    source ...FAILED&lt;br /&gt;    rac1: PRVG-13606 : chrony daemon is not synchronized with any external time&lt;br /&gt;          source on node "rac1".&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;CVU operation performed:      Clock Synchronization across the cluster nodes&lt;br /&gt;Date:                         Dec 9, 2021 10:56:45 AM&lt;br /&gt;CVU home:                     /u01/app/19.3.0/grid/&lt;br /&gt;User:                         grid&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;If we want to get more details, the CVU trace could be enabled:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;[grid@rac1 ~]$ rm -rf /tmp/cvutrace&lt;br /&gt;[grid@rac1 ~]$ mkdir /tmp/cvutrace&lt;br /&gt;[grid@rac1 ~]$ export CV_TRACELOC=/tmp/cvutrace&lt;br /&gt;[grid@rac1 ~]$ export SRVM_TRACE=true&lt;br /&gt;[grid@rac1 ~]$ export SRVM_TRACE_LEVEL=1&lt;br /&gt;[grid@rac1 ~]$ cluvfy comp clocksync -n rac1 -verbose&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;This produces the following lines in the trace file &lt;b&gt;/tmp/cvutrace/cvutrace.log.0&lt;/b&gt;:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;[main] [ 2021-12-09 10:58:10.179 UTC ] [VerificationUtil.traceAndLogInternal:16755]  [TaskNTP.doChronyTimeSourceCheck:2465] status=SUCCESSFUL; vfyCode=0; output=MS Name/IP address         Stratum Poll Reach Last&lt;br /&gt;Rx Last sample&lt;br /&gt;===============================================================================&lt;br /&gt;^* 169.254.169.123               3   7   377   128  +1141ns[+4603ns] +/-  501us&lt;br /&gt;&lt;br /&gt;[main] [ 2021-12-09 10:58:10.179 UTC ] [TaskAnonymousProxy.&amp;lt;init&gt;:119]  Defining proxy task with: 'chrony daemon is synchronized with at least one external time source'&lt;br /&gt;nodeList: 'rac1'&lt;br /&gt;from task: 'TaskNTP'&lt;br /&gt;Called from: 'TaskNTP.performNTPChecks:889'&lt;br /&gt;[main] [ 2021-12-09 10:58:10.179 UTC ] [ResultSet.overwriteResultSet:810]  Overwriting ResultSet, called from: TaskAnonymousProxy.performAnonymousTask:148&lt;br /&gt;[main] [ 2021-12-09 10:58:10.179 UTC ] [CVUVariables.getCVUVariable:607]  variable name : MODE_API&lt;br /&gt;[main] [ 2021-12-09 10:58:10.179 UTC ] [CVUVariables.getCVUVariable:643]  Variable found in the CVU and Command Line context&lt;br /&gt;[main] [ 2021-12-09 10:58:10.179 UTC ] [CVUVariables.resolve:981]  ForcedLookUp not enabled for variable:MODE_API&lt;br /&gt;[main] [ 2021-12-09 10:58:10.179 UTC ] [CVUVariables.secureVariableValueTrace:789]  getting CVUVariableConstant : VAR = MODE_API VAL = FALSE&lt;br /&gt;[main] [ 2021-12-09 10:58:10.180 UTC ] [ResultSet.traceResultSet:1040]&lt;br /&gt;&lt;br /&gt;ResultSet AFTER overwrite ===&gt;&lt;br /&gt;        Overall Status-&gt;VERIFICATION_FAILED&lt;br /&gt;&lt;br /&gt;        Uploaded Overall Status-&gt;UNKNOWN&lt;br /&gt;&lt;br /&gt;        HasNodeResults: true&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;        contents of resultTable&lt;br /&gt;&lt;br /&gt;Dumping Result data.&lt;br /&gt;  Status     : VERIFICATION_FAILED&lt;br /&gt;  Name       : rac1&lt;br /&gt;  Type       : Node&lt;br /&gt;  Has Results: No&lt;br /&gt;  Exp. value : null&lt;br /&gt;  Act. value : null&lt;br /&gt;&lt;br /&gt;  Errors  :&lt;br /&gt;    PRVG-13606 : chrony daemon is not synchronized with any external time source on node "rac1".&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;The same configuration steps were completed successfully on Oracle Linux (OL) 8.4, so that I started looking for any changes. It turns out that the &lt;strong&gt;chronyc sources&lt;/strong&gt; output was changed.&lt;br/&gt;OL 8.5 with &lt;b&gt;chrony-4.1-1.0.1.el8.x86_64&lt;/b&gt;:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;[root@rac1 ~]# chronyc sources&lt;br /&gt;MS Name/IP address         Stratum Poll Reach LastRx Last sample&lt;br /&gt;===============================================================================&lt;br /&gt;^* 169.254.169.123               3   7   377    10   -590ns[+4002ns] +/-  494us&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;OL 8.4 with &lt;b&gt;chrony-3.5-2.0.1.el8.x86_64&lt;/b&gt;:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;210 Number of sources = 1&lt;br /&gt;MS Name/IP address         Stratum Poll Reach LastRx Last sample               &lt;br /&gt;===============================================================================&lt;br /&gt;^* 169.254.169.123               3   6   377    39  +4827ns[  +10us] +/-  560us&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;The number of sources line is absent in OL 8.5.&lt;br/&gt;  There are two workarounds that can be used.&lt;/p&gt;&lt;h3&gt;Use ORA_DISABLED_CVU_CHECKS&lt;/h3&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;[grid@rac1 ~]$ ORA_DISABLED_CVU_CHECKS=TASKNTP cluvfy comp clocksync -n rac1 -verbose&lt;br /&gt;&lt;br /&gt;Verifying Clock Synchronization ...&lt;br /&gt;  Node Name                             Status&lt;br /&gt;  ------------------------------------  ------------------------&lt;br /&gt;  rac1                                  passed&lt;br /&gt;&lt;br /&gt;  Node Name                             State&lt;br /&gt;  ------------------------------------  ------------------------&lt;br /&gt;  rac1                                  Observer&lt;br /&gt;  Verifying Network Time Protocol (NTP) ...WARNING (PRVG-11640)&lt;br /&gt;Verifying Clock Synchronization ...WARNING (PRVG-11640)&lt;br /&gt;&lt;br /&gt;Verification of Clock Synchronization across the cluster nodes was successful.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Warnings were encountered during execution of CVU verification request "Clock Synchronization across the cluster nodes".&lt;br /&gt;&lt;br /&gt;Verifying Clock Synchronization ...WARNING&lt;br /&gt;  Verifying Network Time Protocol (NTP) ...WARNING&lt;br /&gt;  rac1: PRVG-11640 : The check "Network Time Protocol (NTP)" was not performed&lt;br /&gt;        as it is disabled&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;CVU operation performed:      Clock Synchronization across the cluster nodes&lt;br /&gt;Date:                         Dec 9, 2021 11:03:41 AM&lt;br /&gt;CVU home:                     /u01/app/19.3.0/grid/&lt;br /&gt;User:                         grid&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Amend chronyc temporarily to produce the desired output&lt;/h3&gt;&lt;p&gt;This is only to validate our hypothesis related to the cause of the validation error.&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;[root@rac1 ~]# mv /usr/bin/chronyc{,.orig}&lt;br /&gt;[root@rac1 ~]# vi /usr/bin/chronyc&lt;br /&gt;[root@rac1 ~]# chmod a+x /usr/bin/chronyc&lt;br /&gt;[root@rac1 ~]# /usr/bin/chronyc sources&lt;br /&gt;210 Number of sources = 1&lt;br /&gt;MS Name/IP address         Stratum Poll Reach LastRx Last sample&lt;br /&gt;===============================================================================&lt;br /&gt;^* 169.254.169.123               3   8   377    21    -32us[-5361ns] +/-  578us&lt;br /&gt;[root@rac1 ~]# cat /usr/bin/chronyc&lt;br /&gt;#!/bin/bash&lt;br /&gt;echo '210 Number of sources = 1'&lt;br /&gt;/usr/bin/chronyc.orig "$@"&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;Then we can validate the change by running CVU:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;[grid@rac1 ~]$ cluvfy comp clocksync -n rac1 -verbose&lt;br /&gt;&lt;br /&gt;Verifying Clock Synchronization ...&lt;br /&gt;  Node Name                             Status&lt;br /&gt;  ------------------------------------  ------------------------&lt;br /&gt;  rac1                                  passed&lt;br /&gt;&lt;br /&gt;  Node Name                             State&lt;br /&gt;  ------------------------------------  ------------------------&lt;br /&gt;  rac1                                  Observer&lt;br /&gt;&lt;br /&gt;CTSS is in Observer state. Switching over to clock synchronization checks using NTP&lt;br /&gt;&lt;br /&gt;  Verifying Network Time Protocol (NTP) ...&lt;br /&gt;    Verifying '/etc/chrony.conf' ...&lt;br /&gt;    Node Name                             File exists?&lt;br /&gt;    ------------------------------------  ------------------------&lt;br /&gt;    rac1                                  yes&lt;br /&gt;&lt;br /&gt;    Verifying '/etc/chrony.conf' ...PASSED&lt;br /&gt;    Verifying Daemon 'chronyd' ...&lt;br /&gt;    Node Name                             Running?&lt;br /&gt;    ------------------------------------  ------------------------&lt;br /&gt;    rac1                                  yes&lt;br /&gt;&lt;br /&gt;    Verifying Daemon 'chronyd' ...PASSED&lt;br /&gt;    Verifying NTP daemon or service using UDP port 123 ...&lt;br /&gt;    Node Name                             Port Open?&lt;br /&gt;    ------------------------------------  ------------------------&lt;br /&gt;    rac1                                  yes&lt;br /&gt;&lt;br /&gt;    Verifying NTP daemon or service using UDP port 123 ...PASSED&lt;br /&gt;    Verifying chrony daemon is synchronized with at least one external time source ...PASSED&lt;br /&gt;  Verifying Network Time Protocol (NTP) ...PASSED&lt;br /&gt;Verifying Clock Synchronization ...PASSED&lt;br /&gt;&lt;br /&gt;Verification of Clock Synchronization across the cluster nodes was successful.&lt;br /&gt;&lt;br /&gt;CVU operation performed:      Clock Synchronization across the cluster nodes&lt;br /&gt;Date:                         Dec 9, 2021 11:05:36 AM&lt;br /&gt;CVU home:                     /u01/app/19.3.0/grid/&lt;br /&gt;User:                         grid&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Conclusion&lt;/h3&gt;&lt;p&gt;The requirement to have an external NTP server is questionable. There can be hardware clocks which chrony can use, such as TimeSync PTP service on Azure. This post demonstrates how to debug NTP issues during Grid Infrastructure installations and/or CVU checks. There is one generic method provided to work around such issues by setting &lt;b&gt;ORA_DISABLED_CVU_CHECKS&lt;/b&gt;. If the issue is caused by Oracle utilities expecting certain output, then we might as well tweak system programs temporarily to produce the desired output.&lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/7302193972474156161/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/12/gridsetupsh-executeconfigtools-fails.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7302193972474156161'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7302193972474156161'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/12/gridsetupsh-executeconfigtools-fails.html' title='gridSetup.sh executeConfigTools fails with PRVG-13606 : chrony daemon is not synchronized with any external time source'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-7935848969686337719</id><published>2021-11-30T16:53:00.000+06:00</published><updated>2021-11-30T16:53:40.133+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='21c'/><title type='text'>Setting database session to read only in 21c</title><content type='html'>&lt;p&gt;Oracle introduced a new parameter &lt;strong&gt;read_only&lt;/strong&gt; in 21c which is not documented in &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/21/refrn/"&gt;Database Reference&lt;/a&gt; yet at the time of this writing.&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;[oracle@db-21 ~]$ sqlplus /nolog @q&lt;br /&gt;&lt;br /&gt;SQL*Plus: Release 21.0.0.0.0 - Production on Tue Nov 30 10:39:56 2021&lt;br /&gt;Version 21.4.0.0.0&lt;br /&gt;&lt;br /&gt;Copyright (c) 1982, 2021, Oracle.  All rights reserved.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; conn tc/tc@db-21/pdb&lt;br /&gt;Connected.&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create table t(x int);&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert into t values (0);&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set read_only=true;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; update t&lt;br /&gt;  2     set x=1;&lt;br /&gt;update t&lt;br /&gt;       *&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-16000: database or pluggable database open for read-only access&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create table new_tab(x int);&lt;br /&gt;create table new_tab(x int)&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-16000: database or pluggable database open for read-only access&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from t&lt;br /&gt;  3    for update;&lt;br /&gt;  from t&lt;br /&gt;       *&lt;br /&gt;ERROR at line 2:&lt;br /&gt;ORA-16000: database or pluggable database open for read-only access&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; lock table t in exclusive mode;&lt;br /&gt;lock table t in exclusive mode&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-16000: database or pluggable database open for read-only access&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set read_only=false;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; update t&lt;br /&gt;  2     set x=1;&lt;br /&gt;&lt;br /&gt;1 row updated.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create table new_tab(x int);&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from t&lt;br /&gt;  3    for update;&lt;br /&gt;&lt;br /&gt;         X&lt;br /&gt;----------&lt;br /&gt;         1&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; lock table t in exclusive mode;&lt;br /&gt;&lt;br /&gt;Table(s) Locked.&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;I believe it was originally introduced for Oracle Autonomous Database offerings since it is the only place where it is documented: &lt;a href="https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/autonomous-read-only-mode.html#GUID-F9417F91-0C56-4899-8595-4279F16EEC7D"&gt;Change Autonomous Database Operation Mode to Read/Write Read-Only or Restricted&lt;/a&gt;. There are no comparable database features that can provide the same functionality at this level of granularity. A typical usage of this when some application sessions should be set to Read-Only. We can set &lt;strong&gt;read_only=true&lt;/strong&gt; in a logon trigger for that:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;SQL&gt; create or replace trigger logon_trg&lt;br /&gt;  2  after logon on tc.schema&lt;br /&gt;  3  declare&lt;br /&gt;  4  begin&lt;br /&gt;  5    execute immediate 'alter session set read_only=true';&lt;br /&gt;  6  end;&lt;br /&gt;  7  /&lt;br /&gt;&lt;br /&gt;Trigger created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; conn tc/tc@db-21/pdb&lt;br /&gt;Connected.&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from t&lt;br /&gt;  3    for update;&lt;br /&gt;select *&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-16000: database or pluggable database open for read-only access&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; conn system/manager@db-21/pdb&lt;br /&gt;Connected.&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from tc.t&lt;br /&gt;  3    for update;&lt;br /&gt;&lt;br /&gt;         X&lt;br /&gt;----------&lt;br /&gt;         1&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/7935848969686337719/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/11/setting-database-session-to-read-only.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7935848969686337719'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7935848969686337719'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/11/setting-database-session-to-read-only.html' title='Setting database session to read only in 21c'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-1239444117237158868</id><published>2021-11-12T02:14:00.000+06:00</published><updated>2021-11-12T02:14:18.956+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-07445'/><title type='text'>ORA-7445 kpdbfSourceFileSearch with NFSv3 without noac option</title><content type='html'>&lt;p&gt;Creating a pluggable database (PDB) by plugging an unplugged PDB in 19.12 can fail with the &lt;b&gt;ORA-7445 kpdbfSourceFileSearch&lt;/b&gt; error. Somehow there is no information about this error on MOS, so that I am putting it here.&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;SQL&gt; create pluggable database pdb_test as clone using '/mnt/racdba/pdb_test.xml' copy source_file_directory='/mnt/racdba/datafile';&lt;br /&gt;create pluggable database pdb_test as clone using '/mnt/racdba/pdb_test.xml' copy source_file_directory='/mnt/racdba/datafile'&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-03113: end-of-file on communication channel&lt;br /&gt;Process ID: 302875&lt;br /&gt;Session ID: 140 Serial number: 36632&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;Producing the following lines in the alert log:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;2021-11-11T16:11:59.436812+00:00&lt;br /&gt;create pluggable database pdb_test as clone using '/mnt/racdba/pdb_test.xml' copy source_file_directory='/mnt/racdba/datafile'&lt;br /&gt;2021-11-11T16:11:59.662614+00:00&lt;br /&gt;WARNING:NFS file system /mnt/racdba mounted with incorrect options(rw,relatime,vers=3,rsize=1048576,wsize=1048576,namlen=255,hard,nolock,proto=tcp,port=2048,timeo=600,retrans=2,sec=sys,mountaddr=20.38.122.68,mountvers=3,mountport=2048,mo&lt;br /&gt;untproto=tcp,local_lock=all,addr=20.38.122.68)&lt;br /&gt;WARNING:Expected NFS mount options: rsize&gt;=32768,wsize&gt;=32768,hard,noac/actimeo=0&lt;br /&gt;WARNING:NFS file system /mnt/racdba mounted with incorrect options(rw,relatime,vers=3,rsize=1048576,wsize=1048576,namlen=255,hard,nolock,proto=tcp,port=2048,timeo=600,retrans=2,sec=sys,mountaddr=20.38.122.68,mountvers=3,mountport=2048&lt;br /&gt;,mountproto=tcp,local_lock=all,addr=20.38.122.68)&lt;br /&gt;WARNING:Expected NFS mount options: rsize&gt;=32768,wsize&gt;=32768,hard,noac/actimeo=0&lt;br /&gt;WARNING:NFS file system /mnt/racdba mounted with incorrect options(rw,relatime,vers=3,rsize=1048576,wsize=1048576,namlen=255,hard,nolock,proto=tcp,port=2048,timeo=600,retrans=2,sec=sys,mountaddr=20.38.122.68,mountvers=3,mountport=2048,mountproto=tcp,local_lock=all,addr=20.38.122.68)&lt;br /&gt;WARNING:Expected NFS mount options: rsize&gt;=32768,wsize&gt;=32768,hard,noac/actimeo=0&lt;br /&gt;WARNING:NFS file system /mnt/racdba mounted with incorrect options(rw,relatime,vers=3,rsize=1048576,wsize=1048576,namlen=255,hard,nolock,proto=tcp,port=2048,timeo=600,retrans=2,sec=sys,mountaddr=20.38.122.68,mountvers=3,mountport=2048,mountproto=tcp,local_lock=all,addr=20.38.122.68)&lt;br /&gt;WARNING:Expected NFS mount options: rsize&gt;=32768,wsize&gt;=32768,hard,noac/actimeo=0&lt;br /&gt;Scanning plugin datafile directory - /mnt/racdba/datafile for file originally          created  as +DATA/RACDBA/D0849B1A0CE20B41E0530101A8C085D0/DATAFILE/system.281.1088344145 with afn -14&lt;br /&gt;Exception [type: SIGSEGV, Address not mapped to object] [ADDR:0x1C8] [PC:0x99556E2, kpdbfSourceFileSearch()+674] [flags: 0x0, count: 1]&lt;br /&gt;Errors in file /u01/app/oracle/diag/rdbms/racdba/racdba1/trace/racdba1_ora_302875.trc  (incident=16137) (PDBNAME=CDB$ROOT):&lt;br /&gt;ORA-07445: exception encountered: core dump [kpdbfSourceFileSearch()+674] [SIGSEGV] [ADDR:0x1C8] [PC:0x99556E2] [Address not mapped to object] []&lt;br /&gt;Incident details in: /u01/app/oracle/diag/rdbms/racdba/racdba1/incident/incdir_16137/racdba1_ora_302875_i16137.trc&lt;br /&gt;Use ADRCI or Support Workbench to package the incident.&lt;br /&gt;See Note 411.1 at My Oracle Support for error and packaging details.&lt;br /&gt;2021-11-11T16:12:01.412859+00:00&lt;br /&gt;Dumping diagnostic data in directory=[cdmp_20211111161201], requested by (instance=1, osid=302875), summary=[incident=16137].&lt;br /&gt;2021-11-11T16:12:47.954425+00:00&lt;br /&gt;**************************************************************&lt;br /&gt;Undo Create of Pluggable Database PDB_TEST with pdb id - 4.&lt;br /&gt;**************************************************************&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;The partial call stack trace from the incident file is this:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;__sighandler()       call     sslsshandler()       000000019 7F66A4F8EBF0&lt;br /&gt;                                                   7F66A4F8EAC0 7F66A4F8EAC0 ?&lt;br /&gt;                                                   7F66A4F8EA30 ? 000000083 ?&lt;br /&gt;kpdbfSourceFileSear  signal   __sighandler()       7F66AA3C09C0 000000000&lt;br /&gt;ch()+674                                           7F66A39B09E0 000000008 ?&lt;br /&gt;                                                   000000701 ? 7F66AA27C450 ?&lt;br /&gt;kpdbcPlugVerifyFile  call     kpdbfSourceFileSear  000000014 7F6600000000&lt;br /&gt;s()+1853                      ch()                 7F66A35CC594 7F66A35CC58C&lt;br /&gt;                                                   7F66AA411140 7F66AA27C450 ?&lt;br /&gt;kpdbcPlugVerifyAndC  call     kpdbcPlugVerifyFile  7FFE906117B0 7F6600000000 ?&lt;br /&gt;opyFiles()+1722               s()                  068618378 7F66A35CC58C ?&lt;br /&gt;                                                   7F66AA411140 ? 7F66AA27C450 ?&lt;br /&gt;kpdbcParseAndVerify  call     kpdbcPlugVerifyAndC  7FFE906117B0 063F4FBA8&lt;br /&gt;XML()+558                     opyFiles()           068618378 ? 7F66A35CC58C ?&lt;br /&gt;                                                   7F66AA411140 ? 7F66AA27C450 ?&lt;br /&gt;kpdbcCreatePdbCbk()  call     kpdbcParseAndVerify  7FFE906117B0 063F4FBA8&lt;br /&gt;+2832                         XML()                068618378 ? 7F66A35CC58C ?&lt;br /&gt;                                                   7F66AA411140 ? 7F66AA27C450 ?&lt;br /&gt;kpdbcCreatePdb()+20  call     kpdbcCreatePdbCbk()  7F66A464F5D0 063F4FBA8 ?&lt;br /&gt;73                                                 7F66A464F5A8 7F66A35CC58C ?&lt;br /&gt;                                                   7F66AA411140 ? 7F66AA27C450 ?&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;Direct NFS (DNFS) is disabled for the database, and the actual mount options are as follows:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;[root@raca1 ~]# mount | grep /mnt/racdba&lt;br /&gt;mikhailstorageaccount.blob.core.windows.net:/mikhailstorageaccount/mikhailstoragecontainer on /mnt/racdba type nfs (rw,relatime,vers=3,rsize=1048576,wsize=1048576,namlen=255,hard,nolock,proto=tcp,port=2048,timeo=600,retrans=2,sec=sys,mountaddr=20.38.122.68,mountvers=3,mountport=2048,mountproto=tcp,local_lock=all,addr=20.38.122.68)&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;In this case remounting the filesystem with the &lt;b&gt;"noac"&lt;/b&gt; option helps (no cache file attributes):&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;SQL&gt; create pluggable database pdb_test as clone using '/mnt/racdba/pdb_test.xml' copy source_file_directory='/mnt/racdba/datafile';&lt;br /&gt;&lt;br /&gt;Pluggable database created.&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;Producing the following lines in the alert log:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;2021-11-11T16:37:07.331022+00:00&lt;br /&gt;create pluggable database pdb_test as clone using '/mnt/racdba/pdb_test.xml' copy source_file_directory='/mnt/racdba/datafile'&lt;br /&gt;2021-11-11T16:37:08.442188+00:00&lt;br /&gt;Scanning plugin datafile directory - /mnt/racdba/datafile for file originally          created  as +DATA/RACDBA/D0849B1A0CE20B41E0530101A8C085D0/DATAFILE/system.281.1088344145 with afn -14&lt;br /&gt;Using file-/mnt/racdba/datafile/data_D-RACDB_I-1085957449_TS-SYSTEM_FNO-14_020dtklc for original file-+DATA/RACDBA/D0849B1A0CE20B41E0530101A8C085D0/DATAFILE/system.281.1088344145 with afn-14&lt;br /&gt;Scanning plugin datafile directory - /mnt/racdba/datafile for file originally          created  as +DATA/RACDBA/D0849B1A0CE20B41E0530101A8C085D0/DATAFILE/sysaux.279.1088344145 with afn -15&lt;br /&gt;Using file-/mnt/racdba/datafile/data_D-RACDB_I-1085957449_TS-SYSAUX_FNO-15_050dtn16 for original file-+DATA/RACDBA/D0849B1A0CE20B41E0530101A8C085D0/DATAFILE/sysaux.279.1088344145 with afn-15&lt;br /&gt;Scanning plugin datafile directory - /mnt/racdba/datafile for file originally          created  as +DATA/RACDBA/D0849B1A0CE20B41E0530101A8C085D0/DATAFILE/undotbs1.280.1088344145 with afn -16&lt;br /&gt;Using file-/mnt/racdba/datafile/data_D-RACDB_I-1085957449_TS-UNDOTBS1_FNO-16_030dtler for original file-+DATA/RACDBA/D0849B1A0CE20B41E0530101A8C085D0/DATAFILE/undotbs1.280.1088344145 with afn-16&lt;br /&gt;Creating new file-/mnt/racdba/datafile/temp.282.1088344151 for original file-+DATA/RACDBA/D0849B1A0CE20B41E0530101A8C085D0/TEMPFILE/temp.282.1088344151&lt;br /&gt;Scanning plugin datafile directory - /mnt/racdba/datafile for file originally          created  as +DATA/RACDBA/D0849B1A0CE20B41E0530101A8C085D0/DATAFILE/undo_2.283.1088344175 with afn -17&lt;br /&gt;Using file-/mnt/racdba/datafile/data_D-RACDB_I-1085957449_TS-UNDO_2_FNO-17_040dtm80 for original file-+DATA/RACDBA/D0849B1A0CE20B41E0530101A8C085D0/DATAFILE/undo_2.283.1088344175 with afn-17&lt;br /&gt;2021-11-11T16:37:32.703370+00:00&lt;br /&gt;PDB_TEST(4):Endian type of dictionary set to little&lt;br /&gt;****************************************************************&lt;br /&gt;Pluggable Database PDB_TEST with pdb id - 4 is created as UNUSABLE.&lt;br /&gt;If any errors are encountered before the pdb is marked as NEW,&lt;br /&gt;then the pdb must be dropped&lt;br /&gt;local undo-1, localundoscn-0x0000000000000114&lt;br /&gt;****************************************************************&lt;br /&gt;PDB_TEST(4):Pluggable database PDB_TEST pseudo opening&lt;br /&gt;PDB_TEST(4):SUPLOG: Initialize PDB SUPLOG SGA, old value 0x0, new value 0x18&lt;br /&gt;PDB_TEST(4):Autotune of undo retention is turned on.&lt;br /&gt;PDB_TEST(4):This instance was first to open pluggable database PDB_TEST (container=4)&lt;br /&gt;PDB_TEST(4):queued attach DA request 0x8fff7aa0 for pdb 4, ospid 334557&lt;br /&gt;2021-11-11T16:37:33.671956+00:00&lt;br /&gt;Increasing priority of 2 RS&lt;br /&gt;Domain Action Reconfiguration started (domid 4, new da inc 11, cluster inc 8)&lt;br /&gt;Instance 1 is attaching to domain 4&lt;br /&gt; Global Resource Directory partially frozen for domain action&lt;br /&gt;Domain Action Reconfiguration complete (total time 0.0 secs)&lt;br /&gt;Decreasing priority of 2 RS&lt;br /&gt;2021-11-11T16:37:33.793006+00:00&lt;br /&gt;PDB_TEST(4):Undo initialization recovery: Parallel FPTR complete: start:18298543 end:18298544 diff:1 ms (0.0 seconds)&lt;br /&gt;PDB_TEST(4):Undo initialization recovery: err:0 start: 18298542 end: 18298545 diff: 3 ms (0.0 seconds)&lt;br /&gt;PDB_TEST(4):[334557] Successfully onlined Undo Tablespace 2.&lt;br /&gt;PDB_TEST(4):Undo initialization online undo segments: err:0 start: 18298545 end: 18298678 diff: 133 ms (0.1 seconds)&lt;br /&gt;PDB_TEST(4):Undo initialization finished serial:0 start:18298542 end:18298680 diff:138 ms (0.1 seconds)&lt;br /&gt;PDB_TEST(4):Database Characterset for PDB_TEST is AL32UTF8&lt;br /&gt;PDB_TEST(4):Pluggable database PDB_TEST pseudo closing&lt;br /&gt;PDB_TEST(4):JIT: pid 334557 requesting stop&lt;br /&gt;PDB_TEST(4):Closing sequence subsystem (18298726913).&lt;br /&gt;PDB_TEST(4):Buffer Cache flush started: 4&lt;br /&gt;PDB_TEST(4):Buffer Cache flush finished: 4&lt;br /&gt;PDB_TEST(4):queued detach DA request 0x8fff7a38 for pdb 4, ospid 334557&lt;br /&gt;2021-11-11T16:37:34.520104+00:00&lt;br /&gt;Increasing priority of 2 RS&lt;br /&gt;Domain Action Reconfiguration started (domid 4, new da inc 12, cluster inc 8)&lt;br /&gt;Instance 1 is detaching from domain 4 (lazy abort? 0, recovery member? 0)&lt;br /&gt; Global Resource Directory partially frozen for domain action&lt;br /&gt;* domain detach - domain 4 valid ? 1&lt;br /&gt; Non-local Process blocks cleaned out&lt;br /&gt; Set master node info&lt;br /&gt; Dwn-cvts replayed, VALBLKs dubious&lt;br /&gt; All grantable enqueues granted&lt;br /&gt;freeing rdom 4&lt;br /&gt;freeing the fusion rht of pdb 4&lt;br /&gt;freeing the pdb enqueue rht&lt;br /&gt;Domain Action Reconfiguration complete (total time 0.0 secs)&lt;br /&gt;Decreasing priority of 2 RS&lt;br /&gt;Completed: create pluggable database pdb_test as clone using '/mnt/racdba/pdb_test.xml' copy source_file_directory='/mnt/racdba/datafile'&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/1239444117237158868/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/11/ora-7445-kpdbfsourcefilesearch-with.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/1239444117237158868'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/1239444117237158868'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/11/ora-7445-kpdbfsourcefilesearch-with.html' title='ORA-7445 kpdbfSourceFileSearch with NFSv3 without noac option'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-1095933879610896319</id><published>2021-10-30T17:02:00.000+06:00</published><updated>2021-10-30T17:02:27.693+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><title type='text'>Workaround for ORA-22835: Buffer too small for CLOB to CHAR or BLOB to RAW conversion</title><content type='html'>&lt;p&gt;Oracle versions 9i and 10.1 have a bug in a LOB to CHAR conversion. When the value is larger than 4000 bytes, it is silently truncated without dropping an error (see: &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=388512.1"&gt;Ora-22835 - CLOB Larger Than 4000 Inserted Into Varchar2(4000) Column Is Silently Truncated (Doc ID 388512.1)&lt;/a&gt;). This can become an issue following a database upgrade since newer versions start dropping an ORA-22835 error. This happened in this topic on &lt;a href="https://www.sql.ru/forum/1339779/kak-by-maloy-krovu-razreshit-to-char-pri-clob-4000-podobno-kak-eto-bylo-v-oracle-9"&gt;SQL.RU&lt;/a&gt;. This blog post provides an undocumented workaround for this issue.&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;SQL&gt; !oerr ora 22836&lt;br /&gt;22836, 00000, "Event to turn on lob to char/raw silent truncation"&lt;br /&gt;// *Document: NO&lt;br /&gt;// *Cause:    N/A&lt;br /&gt;// *Action:   Do not throw error 22835 for truncation during LOB to CHAR/RAW&lt;br /&gt;//            conversion. Truncate the data instead.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create table t(vc varchar2(4000));&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; var c clob&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; begin&lt;br /&gt;  2    select xmltype.createxml(cursor(select * from all_objects)).getClobVal()&lt;br /&gt;  3      into :c&lt;br /&gt;  4      from dual;&lt;br /&gt;  5  end;&lt;br /&gt;  6  /&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec dbms_output.put_line(dbms_lob.getlength(:c))&lt;br /&gt;12273513&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert into t values (to_char(:c));&lt;br /&gt;insert into t values (to_char(:c))&lt;br /&gt;                      *&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-22835: Buffer too small for CLOB to CHAR or BLOB to RAW conversion (actual:&lt;br /&gt;12273513, maximum: 4000)&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set events '22836 level 1';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert into t values (to_char(:c));&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select length(vc) from t;&lt;br /&gt;&lt;br /&gt;LENGTH(VC)&lt;br /&gt;----------&lt;br /&gt;      4000&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select banner_full from v$version;&lt;br /&gt;&lt;br /&gt;BANNER_FULL&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production&lt;br /&gt;Version 19.9.0.0.0&lt;br /&gt;&lt;/pre&gt;&lt;h1&gt;Conclusion&lt;/h1&gt;&lt;p&gt;Event 22836 can be used to suppress the ORA-22835 error and enable the old behavior - LOB values larger than 4000 bytes will be silently truncated without throwing an error. This is not something that can be considered as a long term solution, however, it can become handy in some cases when changing the code is not practical or not feasible.&lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/1095933879610896319/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/10/workaround-for-ora-22835-buffer-too.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/1095933879610896319'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/1095933879610896319'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/10/workaround-for-ora-22835-buffer-too.html' title='Workaround for ORA-22835: Buffer too small for CLOB to CHAR or BLOB to RAW conversion'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8920493284999925127</id><published>2021-09-22T01:10:00.002+06:00</published><updated>2021-09-22T01:10:00.172+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='linux'/><title type='text'>Finding cause of kernel: blk_update_request: I/O error, dev fd0, sector 0</title><content type='html'>&lt;p&gt;There was a Linux server that got periodic &lt;strong&gt;kernel: blk_update_request: I/O error, dev fd0, sector 0&lt;/strong&gt; errors in &lt;strong&gt;/var/log/messages&lt;/strong&gt;:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;Sep 21 11:38:29 localhost kernel: blk_update_request: I/O error, dev fd0, sector 0&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;There was no cron jobs or systemd timers that can cause these errors, so that I had to resort to other tools.&lt;/p&gt;&lt;p&gt;In this specific example, I decided to use Linux audit:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;[root@floppy ~]# auditctl -a exit,always -S open -F path=/dev/fd0 -k floppy&lt;br /&gt;WARNING - 32/64 bit syscall mismatch, you should specify an arch&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;After I got new &lt;strong&gt;blk_update_request&lt;/strong&gt; errors, I obtained the audit logs (formatted for readability):&lt;/p&gt;&lt;pre class='brush:sql;highlight:[12,23]'&gt;&lt;br /&gt;[root@floppy ~]# ausearch -k floppy&lt;br /&gt;----&lt;br /&gt;time-&gt;Tue Sep 21 11:43:04 2021&lt;br /&gt;type=CONFIG_CHANGE msg=audit(1632224584.979:146): auid=1000 ses=1 op=add_rule key="floppy" list=4 res=1&lt;br /&gt;----&lt;br /&gt;time-&gt;Tue Sep 21 11:43:17 2021&lt;br /&gt;type=PROCTITLE msg=audit(1632224597.188:147): proctitle=666469736B002D6C002F6465762F666430&lt;br /&gt;type=PATH msg=audit(1632224597.188:147): item=0 name="/dev/fd0" inode=8972 dev=00:05 mode=060660 ouid=0 ogid=6 rdev=02:00 objtype=NORMAL cap_fp=0000000000000000 cap_fi=0000000000000000 cap_fe=0 cap_fver=0&lt;br /&gt;type=CWD msg=audit(1632224597.188:147):  cwd="/root"&lt;br /&gt;type=SYSCALL msg=audit(1632224597.188:147): arch=c000003e syscall=2 success=no exit=-6 a0=7ffcd4c7290a a1=80000 a2=1 a3=7ffcd4c70e20 items=1 &lt;br /&gt;                                            ppid=1767 pid=2060 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=1 &lt;br /&gt;                                            comm="fdisk" exe="/usr/sbin/fdisk" key="floppy"&lt;br /&gt;.. after a while ..&lt;br /&gt;[root@floppy ~]# ausearch -k floppy&lt;br /&gt;...&lt;br /&gt;----&lt;br /&gt;time-&gt;Tue Sep 21 11:43:31 2021&lt;br /&gt;type=PROCTITLE msg=audit(1632224611.123:148): proctitle=666469736B002D6C002F6465762F666430&lt;br /&gt;type=PATH msg=audit(1632224611.123:148): item=0 name="/dev/fd0" inode=8972 dev=00:05 mode=060660 ouid=0 ogid=6 rdev=02:00 objtype=NORMAL cap_fp=0000000000000000 cap_fi=0000000000000000 cap_fe=0 cap_fver=0&lt;br /&gt;type=CWD msg=audit(1632224611.123:148):  cwd="/root"&lt;br /&gt;type=SYSCALL msg=audit(1632224611.123:148): arch=c000003e syscall=2 success=no exit=-6 a0=7fff65dd690a a1=80000 a2=1 a3=7fff65dd4220 items=1&lt;br /&gt;                                            ppid=1767 pid=2073 auid=1000 uid=0 gid=0 euid=0 suid=0 fsuid=0 egid=0 sgid=0 fsgid=0 tty=pts0 ses=1&lt;br /&gt;                                            comm="fdisk" exe="/usr/sbin/fdisk" key="floppy"&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;As it's seen from the executable, it was &lt;strong&gt;fdisk&lt;/strong&gt;. More specifically, &lt;strong&gt;fdisk -l&lt;/strong&gt; can cause such errors on Azure V1 VMs.&lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/8920493284999925127/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/09/finding-cause-of-kernel.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8920493284999925127'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8920493284999925127'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/09/finding-cause-of-kernel.html' title='Finding cause of kernel: blk_update_request: I/O error, dev fd0, sector 0'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-3727923283696286779</id><published>2021-08-31T16:58:00.001+06:00</published><updated>2021-08-31T17:09:37.770+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='21c'/><category scheme='http://www.blogger.com/atom/ns#' term='asm'/><title type='text'>ASM disk group fails to mount with ORA-15017 ORA-15066 errors offlining disk "RACQ$LUN3" in group "DATA" may result in a data loss</title><content type='html'>&lt;p&gt;It's a test 21c cluster that wasn't shutdown properly yesterday. While mounting a DATA disk group, the following errors are encountered:&lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;SQL&gt; alter diskgroup data mount;&lt;br /&gt;alter diskgroup data mount&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-15032: not all alterations performed&lt;br /&gt;ORA-15017: diskgroup "DATA" cannot be mounted&lt;br /&gt;ORA-15066: offlining disk "RACQ$LUN3" in group "DATA" may result in a data loss&lt;br /&gt;&lt;/pre&gt;Mounting the disk group with the FORCE option is not possible either and fails with the same errors: &lt;pre class='brush:sql'&gt;&lt;br /&gt;ASMCMD&gt; mount data -f&lt;br /&gt;ORA-15032: not all alterations performed&lt;br /&gt;ORA-15017: diskgroup "DATA" cannot be mounted&lt;br /&gt;ORA-15066: offlining disk "RACQ$LUN3" in group "DATA" may result in a data loss (DBD ERROR: OCIStmtExecute)&lt;br /&gt;&lt;/pre&gt;With the next entries in the alert log: &lt;pre class='brush:sql;highlight:[22]'&gt;&lt;br /&gt;2021-08-31T10:31:52.117810+00:00&lt;br /&gt;SQL&gt; alter diskgroup data mount&lt;br /&gt;2021-08-31T10:31:52.124846+00:00&lt;br /&gt;NOTE: cache registered group DATA 2/0x05D14A8C&lt;br /&gt;NOTE: cache began mount (first) of group DATA 2/0x05D14A8C&lt;br /&gt;NOTE: Assigning number (2,5) to disk (/dev/flashgrid/rac2.lun5)&lt;br /&gt;WARNING: preferred read failure group RAC1 does not exist in diskgroup DATA&lt;br /&gt;NOTE: Assigning number (2,1) to disk (/dev/flashgrid/rac2.lun6)&lt;br /&gt;WARNING: preferred read failure group RAC1 does not exist in diskgroup DATA&lt;br /&gt;NOTE: Assigning number (2,4) to disk (/dev/flashgrid/rac2.lun3)&lt;br /&gt;WARNING: preferred read failure group RAC1 does not exist in diskgroup DATA&lt;br /&gt;NOTE: Assigning number (2,2) to disk (/dev/flashgrid/racq.lun3)&lt;br /&gt;WARNING: preferred read failure group RAC1 does not exist in diskgroup DATA&lt;br /&gt;NOTE: Assigning number (2,6) to disk (/dev/flashgrid/rac1.lun5)&lt;br /&gt;WARNING: DATA has too many failure groups for a stretch cluster.&lt;br /&gt;NOTE: Assigning number (2,0) to disk (/dev/flashgrid/rac1.lun6)&lt;br /&gt;WARNING: DATA has too many failure groups for a stretch cluster.&lt;br /&gt;NOTE: Assigning number (2,3) to disk (/dev/flashgrid/rac1.lun3)&lt;br /&gt;WARNING: DATA has too many failure groups for a stretch cluster.&lt;br /&gt;2021-08-31T10:31:52.294934+00:00&lt;br /&gt;cluster guid (5f307c7210446f13bfcd86fa9d15c5f1) generated for PST Hbeat for instance 1&lt;br /&gt;NOTE: initial disk modes for disk 2 (RACQ$LUN3) in group 2 (DATA) is not completely online: modes 0x1 lflags 0x4&lt;br /&gt;2021-08-31T10:31:52.297979+00:00&lt;br /&gt;NOTE: cache closing disk 2 of grp 2: (not open) RACQ$LUN3&lt;br /&gt;2021-08-31T10:31:58.301169+00:00&lt;br /&gt;ERROR: disk 2 (RACQ$LUN3) in group 2 cannot be offlined because all disks [2(RACQ$LUN3)] with mirror data would be offline.&lt;br /&gt;2021-08-31T10:31:58.301239+00:00&lt;br /&gt;ERROR: too many offline disks in PST (grp 2)&lt;br /&gt;2021-08-31T10:31:58.301932+00:00&lt;br /&gt;NOTE: cache dismounting (clean) group 2/0x05D14A8C (DATA)&lt;br /&gt;NOTE: messaging CKPT to quiesce pins Unix process pid: 7067, NID: 4026531836, image: oracle@rac1.example.com (TNS V1-V3)&lt;br /&gt;NOTE: dbwr not being msg'd to dismount&lt;br /&gt;NOTE: LGWR not being messaged to dismount&lt;br /&gt;NOTE: cache dismounted group 2/0x05D14A8C (DATA)&lt;br /&gt;NOTE: cache ending mount (fail) of group DATA number=2 incarn=0x05d14a8c&lt;br /&gt;NOTE: cache deleting context for group DATA 2/0x05d14a8c&lt;br /&gt;2021-08-31T10:31:58.303103+00:00&lt;br /&gt;GMON dismounting group 2 at 90 for pid 57, osid 7067&lt;br /&gt;2021-08-31T10:31:58.303346+00:00&lt;br /&gt;NOTE: Disk RAC1$LUN6 in mode 0x7f marked for de-assignment&lt;br /&gt;NOTE: Disk RAC2$LUN6 in mode 0x7f marked for de-assignment&lt;br /&gt;NOTE: Disk RACQ$LUN3 in mode 0x1 marked for de-assignment&lt;br /&gt;NOTE: Disk RAC1$LUN3 in mode 0x7f marked for de-assignment&lt;br /&gt;NOTE: Disk RAC2$LUN3 in mode 0x7f marked for de-assignment&lt;br /&gt;NOTE: Disk RAC2$LUN5 in mode 0x7f marked for de-assignment&lt;br /&gt;NOTE: Disk RAC1$LUN5 in mode 0x7f marked for de-assignment&lt;br /&gt;ERROR: diskgroup DATA was not mounted&lt;br /&gt;ORA-15032: not all alterations performed&lt;br /&gt;ORA-15017: diskgroup "DATA" cannot be mounted&lt;br /&gt;ORA-15066: offlining disk "RACQ$LUN3" in group "DATA" may result in a data loss&lt;br /&gt;&lt;br /&gt;2021-08-31T10:31:58.314373+00:00&lt;br /&gt;ERROR: alter diskgroup data mount&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;DATA is a NORMAL redundancy disk group with two regular and one quorum failure group. It's one of the cases when there might be a need to do some undocumented stuff: &lt;/p&gt;&lt;pre class='brush:sql;highlight:[25]'&gt;&lt;br /&gt;SQL&gt; select name,&lt;br /&gt;       path,&lt;br /&gt;       mount_status,&lt;br /&gt;       header_status,&lt;br /&gt;       mode_status,&lt;br /&gt;       state,&lt;br /&gt;       failgroup&lt;br /&gt;  from v$asm_disk&lt;br /&gt; where group_number=(select group_number from v$asm_diskgroup where name='DATA')&lt;br /&gt; order by path;&lt;br /&gt;  2    3    4    5    6    7    8    9   10&lt;br /&gt;NAME                           PATH                           MOUNT_S HEADER_STATU MODE_ST STATE    FAILGROUP&lt;br /&gt;------------------------------ ------------------------------ ------- ------------ ------- -------- ------------------------------&lt;br /&gt;                               /dev/flashgrid/rac1.lun3       CLOSED  MEMBER       ONLINE  NORMAL&lt;br /&gt;                               /dev/flashgrid/rac1.lun5       CLOSED  MEMBER       ONLINE  NORMAL&lt;br /&gt;                               /dev/flashgrid/rac1.lun6       CLOSED  MEMBER       ONLINE  NORMAL&lt;br /&gt;                               /dev/flashgrid/rac2.lun3       CLOSED  MEMBER       ONLINE  NORMAL&lt;br /&gt;                               /dev/flashgrid/rac2.lun5       CLOSED  MEMBER       ONLINE  NORMAL&lt;br /&gt;                               /dev/flashgrid/rac2.lun6       CLOSED  MEMBER       ONLINE  NORMAL&lt;br /&gt;                               /dev/flashgrid/racq.lun2       CLOSED  FORMER       ONLINE  NORMAL&lt;br /&gt;                               /dev/flashgrid/racq.lun3       CLOSED  MEMBER       ONLINE  NORMAL&lt;br /&gt;&lt;br /&gt;8 rows selected.&lt;br /&gt;&lt;br /&gt;SQL&gt; alter diskgroup data mount restricted for recovery;&lt;br /&gt;&lt;br /&gt;Diskgroup altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; select name,&lt;br /&gt;       path,&lt;br /&gt;       mount_status,&lt;br /&gt;       header_status,&lt;br /&gt;       mode_status,&lt;br /&gt;       state,&lt;br /&gt;       failgroup&lt;br /&gt;  from v$asm_disk&lt;br /&gt; where group_number=(select group_number from v$asm_diskgroup where name='DATA')&lt;br /&gt; order by path;&lt;br /&gt;  2    3    4    5    6    7    8    9   10&lt;br /&gt;NAME                           PATH                           MOUNT_S HEADER_STATU MODE_ST STATE    FAILGROUP&lt;br /&gt;------------------------------ ------------------------------ ------- ------------ ------- -------- ------------------------------&lt;br /&gt;RAC1$LUN3                      /dev/flashgrid/rac1.lun3       CACHED  MEMBER       ONLINE  NORMAL   RAC1&lt;br /&gt;RAC1$LUN5                      /dev/flashgrid/rac1.lun5       CACHED  MEMBER       ONLINE  NORMAL   RAC1&lt;br /&gt;RAC1$LUN6                      /dev/flashgrid/rac1.lun6       CACHED  MEMBER       ONLINE  NORMAL   RAC1&lt;br /&gt;RAC2$LUN3                      /dev/flashgrid/rac2.lun3       CACHED  MEMBER       ONLINE  NORMAL   RAC2&lt;br /&gt;RAC2$LUN5                      /dev/flashgrid/rac2.lun5       CACHED  MEMBER       ONLINE  NORMAL   RAC2&lt;br /&gt;RAC2$LUN6                      /dev/flashgrid/rac2.lun6       CACHED  MEMBER       ONLINE  NORMAL   RAC2&lt;br /&gt;RACQ$LUN3                      /dev/flashgrid/racq.lun3       CACHED  MEMBER       ONLINE  NORMAL   RACQ&lt;br /&gt;&lt;br /&gt;7 rows selected.&lt;br /&gt;&lt;/pre&gt;The alert log: &lt;pre class='brush:sql'&gt;&lt;br /&gt;2021-08-31T10:37:56.317024+00:00&lt;br /&gt;SQL&gt; alter diskgroup data mount restricted for recovery&lt;br /&gt;2021-08-31T10:37:56.323711+00:00&lt;br /&gt;NOTE: cache registered group DATA 2/0xEA114A90&lt;br /&gt;NOTE: cache began mount (first) of group DATA 2/0xEA114A90&lt;br /&gt;NOTE: Assigning number (2,5) to disk (/dev/flashgrid/rac2.lun5)&lt;br /&gt;WARNING: preferred read failure group RAC1 does not exist in diskgroup DATA&lt;br /&gt;NOTE: Assigning number (2,1) to disk (/dev/flashgrid/rac2.lun6)&lt;br /&gt;WARNING: preferred read failure group RAC1 does not exist in diskgroup DATA&lt;br /&gt;NOTE: Assigning number (2,4) to disk (/dev/flashgrid/rac2.lun3)&lt;br /&gt;WARNING: preferred read failure group RAC1 does not exist in diskgroup DATA&lt;br /&gt;NOTE: Assigning number (2,2) to disk (/dev/flashgrid/racq.lun3)&lt;br /&gt;WARNING: preferred read failure group RAC1 does not exist in diskgroup DATA&lt;br /&gt;NOTE: Assigning number (2,6) to disk (/dev/flashgrid/rac1.lun5)&lt;br /&gt;WARNING: DATA has too many failure groups for a stretch cluster.&lt;br /&gt;NOTE: Assigning number (2,0) to disk (/dev/flashgrid/rac1.lun6)&lt;br /&gt;WARNING: DATA has too many failure groups for a stretch cluster.&lt;br /&gt;NOTE: Assigning number (2,3) to disk (/dev/flashgrid/rac1.lun3)&lt;br /&gt;WARNING: DATA has too many failure groups for a stretch cluster.&lt;br /&gt;2021-08-31T10:37:56.529659+00:00&lt;br /&gt;cluster guid (5f307c7210446f13bfcd86fa9d15c5f1) generated for PST Hbeat for instance 1&lt;br /&gt;NOTE: initial disk modes for disk 2 (RACQ$LUN3) in group 2 (DATA) is not completely online: modes 0x1 lflags 0x4&lt;br /&gt;2021-08-31T10:37:56.532517+00:00&lt;br /&gt;NOTE: cache closing disk 2 of grp 2: (not open) RACQ$LUN3&lt;br /&gt;2021-08-31T10:38:02.539918+00:00&lt;br /&gt;NOTE: GMON heartbeating for grp 2 (DATA)&lt;br /&gt;2021-08-31T10:38:02.540568+00:00&lt;br /&gt;NOTE: cache closing disk 2 of grp 2: (not open) RACQ$LUN3&lt;br /&gt;GMON querying group 2 at 125 for pid 57, osid 7067&lt;br /&gt;2021-08-31T10:38:02.540905+00:00&lt;br /&gt;NOTE: cache closing disk 2 of grp 2: (not open) RACQ$LUN3&lt;br /&gt;2021-08-31T10:38:02.541129+00:00&lt;br /&gt;NOTE: cache is mounting group DATA created on 2021/07/30 12:37:34&lt;br /&gt;NOTE: cache opening disk 0 of grp 2: RAC1$LUN6 path:/dev/flashgrid/rac1.lun6&lt;br /&gt;NOTE: group 2 (DATA) high disk header ckpt advanced to fcn 0.42883&lt;br /&gt;NOTE: 08/31/21 10:38:02 DATA.F1X0 found on disk 0 au 10 fcn 0.42883 datfmt 2&lt;br /&gt;NOTE: cache opening disk 1 of grp 2: RAC2$LUN6 path:/dev/flashgrid/rac2.lun6&lt;br /&gt;NOTE: cache opening disk 3 of grp 2: RAC1$LUN3 path:/dev/flashgrid/rac1.lun3&lt;br /&gt;NOTE: cache opening disk 4 of grp 2: RAC2$LUN3 path:/dev/flashgrid/rac2.lun3&lt;br /&gt;NOTE: cache opening disk 5 of grp 2: RAC2$LUN5 path:/dev/flashgrid/rac2.lun5&lt;br /&gt;NOTE: 08/31/21 10:38:02 DATA.F1X0 found on disk 5 au 10 fcn 0.42883 datfmt 2&lt;br /&gt;NOTE: cache opening disk 6 of grp 2: RAC1$LUN5 path:/dev/flashgrid/rac1.lun5&lt;br /&gt;2021-08-31T10:38:02.541726+00:00&lt;br /&gt;NOTE: cache mounting (first) normal redundancy group 2/0xEA114A90 (DATA)&lt;br /&gt;2021-08-31T10:38:02.963014+00:00&lt;br /&gt;NOTE: attached to recovery domain 2&lt;br /&gt;2021-08-31T10:38:03.009050+00:00&lt;br /&gt;validate pdb 2, flags x4, valid 0, pdb flags x204&lt;br /&gt;* validated domain 2, flags = 0x200&lt;br /&gt;NOTE: cache recovered group 2 to fcn 0.43425&lt;br /&gt;NOTE: redo buffer size is 512 blocks (2105344 bytes)&lt;br /&gt;2021-08-31T10:38:03.011498+00:00&lt;br /&gt;NOTE: LGWR attempting to mount thread 1 for diskgroup 2 (DATA)&lt;br /&gt;NOTE: LGWR found thread 1 closed at ABA 30.7188 lock domain=0 inc#=0 instnum=1&lt;br /&gt;NOTE: LGWR mounted thread 1 for diskgroup 2 (DATA)&lt;br /&gt;2021-08-31T10:38:03.022814+00:00&lt;br /&gt;NOTE: LGWR opened thread 1 (DATA) at fcn 0.43425 ABA 31.7189 lock domain=2 inc#=2 instnum=1 gx.incarn=3927001744 mntstmp=2021/08/31 10:38:03.012000&lt;br /&gt;2021-08-31T10:38:03.023034+00:00&lt;br /&gt;NOTE: cache mounting group 2/0xEA114A90 (DATA) succeeded&lt;br /&gt;NOTE: cache ending mount (success) of group DATA number=2 incarn=0xea114a90&lt;br /&gt;WARNING: DATA has too many failure groups for a stretch cluster.&lt;br /&gt;2021-08-31T10:38:03.103835+00:00&lt;br /&gt;NOTE: cache closing disk 2 of grp 2: (not open) RACQ$LUN3&lt;br /&gt;2021-08-31T10:38:03.104063+00:00&lt;br /&gt;NOTE: Instance updated compatible.asm to 19.0.0.0.0 for grp 2 (DATA).&lt;br /&gt;2021-08-31T10:38:03.104307+00:00&lt;br /&gt;NOTE: cache closing disk 2 of grp 2: (not open) RACQ$LUN3&lt;br /&gt;2021-08-31T10:38:03.104463+00:00&lt;br /&gt;NOTE: Instance updated compatible.asm to 19.0.0.0.0 for grp 2 (DATA).&lt;br /&gt;2021-08-31T10:38:03.105130+00:00&lt;br /&gt;NOTE: Instance updated compatible.rdbms to 19.0.0.0.0 for grp 2 (DATA).&lt;br /&gt;2021-08-31T10:38:03.105436+00:00&lt;br /&gt;NOTE: Instance updated compatible.rdbms to 19.0.0.0.0 for grp 2 (DATA).&lt;br /&gt;WARNING: DATA has too many failure groups for a stretch cluster.&lt;br /&gt;WARNING: DATA has too many failure groups for a stretch cluster.&lt;br /&gt;2021-08-31T10:38:03.148108+00:00&lt;br /&gt;SUCCESS: diskgroup DATA was mounted&lt;br /&gt;2021-08-31T10:38:03.157095+00:00&lt;br /&gt;SUCCESS: alter diskgroup data mount restricted for recovery&lt;br /&gt;2021-08-31T10:38:03.167013+00:00&lt;br /&gt;NOTE: diskgroup resource ora.DATA.dg is online&lt;br /&gt;2021-08-31T10:38:19.113318+00:00&lt;br /&gt;NOTE: cache closing disk 2 of grp 2: (not open) RACQ$LUN3&lt;br /&gt;2021-08-31T10:38:19.114528+00:00&lt;br /&gt;NOTE: cache closing disk 2 of grp 2: (not open) RACQ$LUN3&lt;br /&gt;2021-08-31T10:38:19.475013+00:00&lt;br /&gt;SQL&gt; ALTER DISKGROUP "DATA" ONLINE QUORUM DISK "RACQ$LUN3"&lt;br /&gt;2021-08-31T10:38:19.478374+00:00&lt;br /&gt;NOTE: cache closing disk 2 of grp 2: (not open) RACQ$LUN3&lt;br /&gt;2021-08-31T10:38:19.486520+00:00&lt;br /&gt;NOTE: GroupBlock outside rolling migration privileged region&lt;br /&gt;NOTE: initiating resync of disk group 2 disks&lt;br /&gt;RACQ$LUN3 (2)&lt;br /&gt;&lt;br /&gt;NOTE: process _user21083_+asm1 (21083) initiating offline of disk 2.4042374244 (RACQ$LUN3) with mask 0x7e in group 2 (DATA) without client assisting&lt;br /&gt;2021-08-31T10:38:19.521378+00:00&lt;br /&gt;NOTE: sending set offline flag message (2320259704) to 1 disk(s) in group 2&lt;br /&gt;2021-08-31T10:38:19.521792+00:00&lt;br /&gt;WARNING: Disk 2 (RACQ$LUN3) in group 2 mode 0x1 is now being offlined&lt;br /&gt;2021-08-31T10:38:19.522023+00:00&lt;br /&gt;NOTE: initiating PST update: grp 2 (DATA), dsk = 2/0xf0f1bc64, mask = 0x6a, op = clear mandatory&lt;br /&gt;2021-08-31T10:38:19.522202+00:00&lt;br /&gt;GMON updating disk modes for group 2 at 135 for pid 52, osid 21083&lt;br /&gt;2021-08-31T10:38:19.522431+00:00&lt;br /&gt;NOTE: cache closing disk 2 of grp 2: (not open) RACQ$LUN3&lt;br /&gt;2021-08-31T10:38:19.523238+00:00&lt;br /&gt;NOTE: PST update grp = 2 completed successfully&lt;br /&gt;NOTE: initiating PST update: grp 2 (DATA), dsk = 2/0xf0f1bc64, mask = 0x7e, op = clear mandatory&lt;br /&gt;2021-08-31T10:38:19.523484+00:00&lt;br /&gt;GMON updating disk modes for group 2 at 136 for pid 52, osid 21083&lt;br /&gt;2021-08-31T10:38:19.523608+00:00&lt;br /&gt;NOTE: cache closing disk 2 of grp 2: (not open) RACQ$LUN3&lt;br /&gt;2021-08-31T10:38:19.524311+00:00&lt;br /&gt;NOTE: PST update grp = 2 completed successfully&lt;br /&gt;NOTE: requesting all-instance membership refresh for group=2&lt;br /&gt;NOTE: initiating PST update: grp 2 (DATA), dsk = 2/0x0, mask = 0x11, op = assign mandatory&lt;br /&gt;2021-08-31T10:38:19.532576+00:00&lt;br /&gt;GMON updating disk modes for group 2 at 137 for pid 52, osid 21083&lt;br /&gt;2021-08-31T10:38:19.532724+00:00&lt;br /&gt;NOTE: cache closing disk 2 of grp 2: (not open) RACQ$LUN3&lt;br /&gt;2021-08-31T10:38:19.540473+00:00&lt;br /&gt;NOTE: PST update grp = 2 completed successfully&lt;br /&gt;NOTE: requesting all-instance disk validation for group=2&lt;br /&gt;2021-08-31T10:38:19.540830+00:00&lt;br /&gt;NOTE: disk validation pending for 1 disk in group 2/0xea114a90 (DATA)&lt;br /&gt;NOTE: Found /dev/flashgrid/racq.lun3 for disk RACQ$LUN3&lt;br /&gt;WARNING: DATA has too many failure groups for a stretch cluster.&lt;br /&gt;NOTE: completed disk validation for 2/0xea114a90 (DATA)&lt;br /&gt;2021-08-31T10:38:19.677322+00:00&lt;br /&gt;NOTE: running client discovery for group 2 (reqid:16866344061815119730)&lt;br /&gt;NOTE: discarding redo for group 2 disk 2&lt;br /&gt;NOTE: initiating PST update: grp 2 (DATA), dsk = 2/0x0, mask = 0x19, op = assign mandatory&lt;br /&gt;2021-08-31T10:38:20.176650+00:00&lt;br /&gt;GMON updating disk modes for group 2 at 138 for pid 52, osid 21083&lt;br /&gt;NOTE: group DATA: updated PST location: disks 0005 0000 0002&lt;br /&gt;2021-08-31T10:38:20.225248+00:00&lt;br /&gt;NOTE: PST update grp = 2 completed successfully&lt;br /&gt;WARNING: DATA has too many failure groups for a stretch cluster.&lt;br /&gt;2021-08-31T10:38:20.225980+00:00&lt;br /&gt;NOTE: membership refresh pending for group 2/0xea114a90 (DATA)&lt;br /&gt;2021-08-31T10:38:20.227553+00:00&lt;br /&gt;GMON querying group 2 at 139 for pid 31, osid 22344&lt;br /&gt;2021-08-31T10:38:20.237960+00:00&lt;br /&gt;WARNING: DATA has too many failure groups for a stretch cluster.&lt;br /&gt;NOTE: cache opening disk 2 of grp 2: RACQ$LUN3 path:/dev/flashgrid/racq.lun3&lt;br /&gt;SUCCESS: refreshed membership for 2/0xea114a90 (DATA)&lt;br /&gt;2021-08-31T10:38:20.238448+00:00&lt;br /&gt;NOTE: initiating PST update: grp 2 (DATA), dsk = 2/0x0, mask = 0x7f, op = assign mandatory&lt;br /&gt;2021-08-31T10:38:20.239039+00:00&lt;br /&gt;GMON updating disk modes for group 2 at 140 for pid 52, osid 21083&lt;br /&gt;2021-08-31T10:38:20.284132+00:00&lt;br /&gt;NOTE: PST update grp = 2 completed successfully&lt;br /&gt;2021-08-31T10:38:20.284349+00:00&lt;br /&gt;SUCCESS: ALTER DISKGROUP "DATA" ONLINE QUORUM DISK "RACQ$LUN3"&lt;br /&gt;2021-08-31T10:38:21.596382+00:00&lt;br /&gt;NOTE: Attempting voting file refresh on diskgroup DATA&lt;br /&gt;NOTE: Refresh completed on diskgroup DATA. No voting file found.&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;The alert log shows that the RACQ$LUN3 disk is brought offline first and then put online. It can also be seen that ASM corrected the issue itself. The 'for recovery' mount option used to be documented somewhere on MOS, but I cannot find where it is now. Looks like Oracle Support made the document non-public.&lt;/p&gt;&lt;p&gt;I can now remount the disk group cleanly: &lt;/p&gt;&lt;pre class='brush:sql'&gt;&lt;br /&gt;SQL&gt; alter diskgroup data dismount;&lt;br /&gt;&lt;br /&gt;Diskgroup altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; alter diskgroup data mount;&lt;br /&gt;&lt;br /&gt;Diskgroup altered.&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/3727923283696286779/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/08/asm-disk-group-fails-to-mount-with-ora.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3727923283696286779'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3727923283696286779'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/08/asm-disk-group-fails-to-mount-with-ora.html' title='ASM disk group fails to mount with ORA-15017 ORA-15066 errors offlining disk &quot;RACQ$LUN3&quot; in group &quot;DATA&quot; may result in a data loss'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-4315930568800319781</id><published>2021-06-30T17:46:00.002+06:00</published><updated>2021-06-30T17:46:42.783+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><title type='text'>Making DBMS_SCHEDULER.CREATE_JOB Transactional</title><content type='html'>&lt;p&gt;It is known that &lt;code&gt;DBMS_SCHEDULER.CREATE_JOB&lt;/code&gt; is non-transactional as opposed to the old &lt;code&gt;DBMS_JOB&lt;/code&gt;. There is even an Oracle idea to provide a transactional interface: &lt;a href="https://community.oracle.com/tech/apps-infra/discussion/4390942/dbms-scheduler-create-job-remove-implicit-commit"&gt;link&lt;/a&gt;. In Oracle 19c &lt;code&gt;DBMS_JOB&lt;/code&gt; jobs are actually &lt;code&gt;DBMS_SCHEDULER&lt;/code&gt; jobs, and they can be part of a bigger transaction. I was curious how it is done and if I can make it work for &lt;code&gt;DBMS_SCHEDULER&lt;/code&gt; jobs.&lt;/p&gt;&lt;p&gt;Here is a test script that I used for this blogpost on 19.9:&lt;/p&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; conn / as sysdba&lt;br /&gt;Connected.&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set container=pdb;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec dbms_scheduler.purge_log()&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; drop user tc cascade;&lt;br /&gt;&lt;br /&gt;User dropped.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; grant create job, create session to tc identified by tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; grant execute on sys.dbms_isched to tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;Firstly, let us create a traditional &lt;code&gt;DBMS_SCHEDULER&lt;/code&gt; job so as to demonstrate that &lt;code&gt;CREATE_JOB&lt;/code&gt; is non-transactional. By "non-transactional" here I mean that it does not leave the session in a transaction.&lt;/p&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; conn tc/tc@localhost/pdb&lt;br /&gt;Connected.&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; doc&lt;br /&gt;DOC&gt;################################################################################&lt;br /&gt;DOC&gt;#  Traditional Job&lt;br /&gt;DOC&gt;################################################################################&lt;br /&gt;DOC&gt;#&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select dbms_transaction.local_transaction_id from dual;&lt;br /&gt;&lt;br /&gt;LOCAL_TRANSACTION_ID&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec dbms_scheduler.create_job( -&lt;br /&gt;&gt;   job_name =&gt; 'JOB_NON_TX', -&lt;br /&gt;&gt;   job_type =&gt; 'PLSQL_BLOCK', -&lt;br /&gt;&gt;   job_action =&gt; 'null;', -&lt;br /&gt;&gt;   enabled    =&gt; true)&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select dbms_transaction.local_transaction_id from dual;&lt;br /&gt;&lt;br /&gt;LOCAL_TRANSACTION_ID&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec dbms_session.sleep(5)&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col job_name for a10&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select job_name, state&lt;br /&gt;  2    from user_scheduler_jobs;&lt;br /&gt;&lt;br /&gt;no rows selected&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col log_date for a35&lt;br /&gt;SQL&gt; select log_date, job_name, status&lt;br /&gt;  2    from user_scheduler_job_run_details&lt;br /&gt;  3   order by log_date;&lt;br /&gt;&lt;br /&gt;LOG_DATE                            JOB_NAME   STATUS&lt;br /&gt;----------------------------------- ---------- ----------&lt;br /&gt;30-JUN-21 12.02.26.780546 PM +01:00 JOB_NON_TX SUCCEEDED&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;Now, I try the same but I call &lt;code&gt;DBMS_ISCHED.SET_NO_COMMIT_FLAG&lt;/code&gt; before calling the &lt;code&gt;CREATE_JOB&lt;/code&gt; procedure.&lt;/p&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; doc&lt;br /&gt;DOC&gt;################################################################################&lt;br /&gt;DOC&gt;#  Transactional Job&lt;br /&gt;DOC&gt;################################################################################&lt;br /&gt;DOC&gt;#&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec sys.dbms_isched.set_no_commit_flag&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select dbms_transaction.local_transaction_id from dual;&lt;br /&gt;&lt;br /&gt;LOCAL_TRANSACTION_ID&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec dbms_scheduler.create_job( -&lt;br /&gt;&gt;   job_name =&gt; 'JOB_TX', -&lt;br /&gt;&gt;   job_type =&gt; 'PLSQL_BLOCK', -&lt;br /&gt;&gt;   job_action =&gt; 'null;', -&lt;br /&gt;&gt;   enabled    =&gt; true)&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select dbms_transaction.local_transaction_id from dual;&lt;br /&gt;&lt;br /&gt;LOCAL_TRANSACTION_ID&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;9.23.604&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec dbms_session.sleep(5)&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col job_name for a10&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select job_name, state&lt;br /&gt;  2    from user_scheduler_jobs;&lt;br /&gt;&lt;br /&gt;JOB_NAME   STATE&lt;br /&gt;---------- ----------&lt;br /&gt;JOB_TX     SCHEDULED&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col log_date for a35&lt;br /&gt;SQL&gt; select log_date, job_name, status&lt;br /&gt;  2    from user_scheduler_job_run_details&lt;br /&gt;  3   order by log_date;&lt;br /&gt;&lt;br /&gt;LOG_DATE                            JOB_NAME   STATUS&lt;br /&gt;----------------------------------- ---------- ----------&lt;br /&gt;30-JUN-21 12.02.26.780546 PM +01:00 JOB_NON_TX SUCCEEDED&lt;br /&gt;&lt;/pre&gt;&lt;p&gt;The things are a bit different this time around:&lt;/p&gt;&lt;ul&gt;  &lt;li&gt;&lt;code&gt;DBMS_SCHEDULER.CREATE_JOB&lt;/code&gt; left the session in a transaction.&lt;/li&gt;  &lt;li&gt;The job is not started.&lt;/li&gt;  &lt;li&gt;It is not demonstrated here, but it is possible to issue rollback and it will remove the job definition.&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Such a job gets started as soon as commit is done:&lt;/p&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec dbms_session.sleep(5)&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col job_name for a10&lt;br /&gt;SQL&gt; col state for a10&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select job_name, state&lt;br /&gt;  2    from user_scheduler_jobs;&lt;br /&gt;&lt;br /&gt;no rows selected&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col status for a10&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col log_date for a35&lt;br /&gt;SQL&gt; select log_date, job_name, status&lt;br /&gt;  2    from user_scheduler_job_run_details&lt;br /&gt;  3   order by log_date;&lt;br /&gt;&lt;br /&gt;LOG_DATE                            JOB_NAME   STATUS&lt;br /&gt;----------------------------------- ---------- ----------&lt;br /&gt;30-JUN-21 12.02.26.780546 PM +01:00 JOB_NON_TX SUCCEEDED&lt;br /&gt;30-JUN-21 12.02.36.835878 PM +01:00 JOB_TX     SUCCEEDED&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Conclusion&lt;/h3&gt;&lt;p&gt;The post demonstrates that one can utilize undocumented &lt;code&gt;DBMS_ISCHED.SET_NO_COMMIT_FLAG&lt;/code&gt; to make &lt;code&gt;DBMS_SCHEDULER.CREATE_JOB&lt;/code&gt; transactional. Since the package is undocumented, there is no guarantee that it will keep working in future versions. Hopefully, Oracle will make a transactional interface available someday.&lt;/p&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/4315930568800319781/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/06/making-dbmsschedulercreatejob.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4315930568800319781'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4315930568800319781'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/06/making-dbmsschedulercreatejob.html' title='Making DBMS_SCHEDULER.CREATE_JOB Transactional'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-251743119734574026</id><published>2021-04-23T23:00:00.003+06:00</published><updated>2021-04-23T23:14:24.279+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='aws'/><title type='text'>How to Send Messages to AWS SQS from PL/SQL Using UTL_HTTP</title><content type='html'>This blog post provides a complete example showing how to send messages to an AWS SQS queue. &lt;br/&gt;&lt;br/&gt;&lt;h1&gt;AWS Prerequisites&lt;/h1&gt;I created a queue called TestQueue. I also created an SQS VPC endpoint for the purpose of this example.&lt;br/&gt;There is an IAM policy that I assigned to a dedicated IAM user created for this example: &lt;pre class="brush:sql"&gt;&lt;br /&gt;{&lt;br /&gt;    "Version": "2012-10-17",&lt;br /&gt;    "Statement": [&lt;br /&gt;        {&lt;br /&gt;            "Sid": "VisualEditor0",&lt;br /&gt;            "Effect": "Allow",&lt;br /&gt;            "Action": "sqs:SendMessage",&lt;br /&gt;            "Resource": "arn:aws:sqs:us-east-1:12&amp;lt;redacted&amp;gt;:TestQueue"&lt;br /&gt;        }&lt;br /&gt;    ]&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;&lt;br/&gt;&lt;h1&gt;Environment&lt;/h1&gt;I used Oracle Database 19.11 in my tests. The database user that is going to call the AWS SQS API is TC. &lt;br/&gt;&lt;br/&gt;&lt;h1&gt;Wallet&lt;/h1&gt;First of all, let us load the AWS certificates into a wallet. Creating a new wallet: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@rac1 ~]$ orapki wallet create -wallet /u01/app/oracle/wallet_sqs -pwd Oracle123 -auto_login&lt;br /&gt;Oracle PKI Tool Release 19.0.0.0.0 - Production&lt;br /&gt;Version 19.4.0.0.0&lt;br /&gt;Copyright (c) 2004, 2021, Oracle and/or its affiliates. All rights reserved.&lt;br /&gt;&lt;br /&gt;Operation is successfully completed.&lt;br /&gt;&lt;/pre&gt;Getting AWS certificates and loading them: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@rac1 ~]$ openssl s_client -showcerts -connect vpce-010f631ef8f1e24e7-8br55nv1.sqs.us-east-1.vpce.amazonaws.com:443 &amp;lt;/dev/null 2&gt;/dev/null | sed '/BEGIN/,/END/!d' | csplit -f aws -b '%d.pem' - /END/+1&lt;br /&gt;2033&lt;br /&gt;4798&lt;br /&gt;[oracle@rac1 ~]$ orapki wallet add -wallet /u01/app/oracle/wallet_sqs -cert aws1.pem -trusted_cert -pwd Oracle123&lt;br /&gt;Oracle PKI Tool Release 19.0.0.0.0 - Production&lt;br /&gt;Version 19.4.0.0.0&lt;br /&gt;Copyright (c) 2004, 2021, Oracle and/or its affiliates. All rights reserved.&lt;br /&gt;&lt;br /&gt;Operation is successfully completed.&lt;br /&gt;&lt;/pre&gt;In order to call AWS SQS, I need to provide both &lt;b&gt;AWS_ACCESS_KEY_ID&lt;/b&gt; and &lt;b&gt;AWS_SECRET_ACCESS_KEY&lt;/b&gt;. I certainly do not want to store them somewhere in the database. Instead, I am going to add the credentials to the wallet: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@rac1 ~]$ mkstore -wrl /u01/app/oracle/wallet_sqs -createCredential aws_sqs AKI&amp;lt;AWS_ACCESS_KEY_ID redacted&gt;&lt;br /&gt;Oracle Secret Store Tool Release 19.0.0.0.0 - Production&lt;br /&gt;Version 19.4.0.0.0&lt;br /&gt;Copyright (c) 2004, 2021, Oracle and/or its affiliates. All rights reserved.&lt;br /&gt;&lt;br /&gt;Your secret/Password is missing in the command line&lt;br /&gt;Enter your secret/Password:&lt;br /&gt;Re-enter your secret/Password:&lt;br /&gt;Enter wallet password:&lt;br /&gt;&lt;/pre&gt;In the end, that is what my wallet looks like: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@rac1 ~]$ orapki wallet display -wallet /u01/app/oracle/wallet_sqs&lt;br /&gt;Oracle PKI Tool Release 19.0.0.0.0 - Production&lt;br /&gt;Version 19.4.0.0.0&lt;br /&gt;Copyright (c) 2004, 2021, Oracle and/or its affiliates. All rights reserved.&lt;br /&gt;&lt;br /&gt;Requested Certificates:&lt;br /&gt;User Certificates:&lt;br /&gt;Oracle Secret Store entries:&lt;br /&gt;oracle.security.client.connect_string1&lt;br /&gt;oracle.security.client.password1&lt;br /&gt;oracle.security.client.username1&lt;br /&gt;Trusted Certificates:&lt;br /&gt;Subject:        CN=Amazon,OU=Server CA 1B,O=Amazon,C=US&lt;br /&gt;[oracle@rac1 ~]$ mkstore -wrl /u01/app/oracle/wallet_sqs -listCredential&lt;br /&gt;Oracle Secret Store Tool Release 19.0.0.0.0 - Production&lt;br /&gt;Version 19.4.0.0.0&lt;br /&gt;Copyright (c) 2004, 2021, Oracle and/or its affiliates. All rights reserved.&lt;br /&gt;&lt;br /&gt;Enter wallet password:&lt;br /&gt;List credential (index: connect_string username)&lt;br /&gt;1: aws_sqs AKI&amp;lt;AWS_ACCESS_KEY_ID redacted&gt;&lt;br /&gt;&lt;/pre&gt;&lt;br/&gt;&lt;h1&gt;Configuring Network Access Control Lists (ACLs)&lt;/h1&gt;There are two privileges required for the calling user, which is called TC: &lt;ul&gt;  &lt;li&gt;The user must be able to access the VPC endpoint over network&lt;/li&gt;  &lt;li&gt;The user must be able to access the wallet file&lt;/li&gt;&lt;/ul&gt;The privileges assigned as follows: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; exec dbms_network_acl_admin.append_host_ace( -&lt;br /&gt;  host =&gt; '*.amazonaws.com', -&lt;br /&gt;  ace  =&gt; xs$ace_type(privilege_list =&gt; xs$name_list('connect'), -&lt;br /&gt;                      principal_name =&gt; 'tc', -&lt;br /&gt;                      principal_type =&gt; xs_acl.ptype_db))&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt; exec dbms_network_acl_admin.append_wallet_ace( -&lt;br /&gt;  wallet_path =&gt; 'file:/u01/app/oracle/wallet_sqs', -&lt;br /&gt;  ace         =&gt;  xs$ace_type(privilege_list =&gt; xs$name_list('use_client_certificates', 'use_passwords'), -&lt;br /&gt;                              principal_name =&gt; 'tc', -&lt;br /&gt;                              principal_type =&gt; xs_acl.ptype_db))&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;&lt;br/&gt;&lt;h1&gt;Making UTL_HTTP Call&lt;/h1&gt;Finally, I am ready to make an AWS SQS API call: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; declare&lt;br /&gt;  2    req utl_http.req;&lt;br /&gt;  3    resp utl_http.resp;&lt;br /&gt;  4    value varchar2(32767);&lt;br /&gt;  5    endpoint varchar2(32767) := 'https://vpce-010f631ef8f1e24e7-8br55nv1.sqs.us-east-1.vpce.amazonaws.com/12&amp;lt;redacted&gt;/TestQueue/';&lt;br /&gt;  6    parameters varchar2(32767) := 'Action=SendMessage&amp;MessageBody=example';&lt;br /&gt;  7    request_url varchar2(32767) := endpoint || '?' || parameters;&lt;br /&gt;  8  begin&lt;br /&gt;  9    utl_http.set_wallet('file:/u01/app/oracle/wallet_sqs');&lt;br /&gt; 10    req := utl_http.begin_request(request_url);&lt;br /&gt; 11    utl_http.set_header(req, 'x-amz-date', to_char(sysdate,'yyyymmdd"T"hh24miss"Z"'));&lt;br /&gt; 12    utl_http.set_property(req, 'aws-region', 'us-east-1');&lt;br /&gt; 13    utl_http.set_property(req, 'aws-service', 'sqs');&lt;br /&gt; 14    utl_http.set_authentication_from_wallet(req, 'aws_sqs', 'AWS4-HMAC-SHA256');&lt;br /&gt; 15    resp := utl_http.get_response(req);&lt;br /&gt; 16    loop&lt;br /&gt; 17      utl_http.read_line(resp, value, true);&lt;br /&gt; 18      dbms_output.put_line(value);&lt;br /&gt; 19    end loop;&lt;br /&gt; 20  exception&lt;br /&gt; 21    when utl_http.end_of_body&lt;br /&gt; 22    then&lt;br /&gt; 23      utl_http.end_request(req);&lt;br /&gt; 24      utl_http.end_response(resp);&lt;br /&gt; 25    when others&lt;br /&gt; 26    then&lt;br /&gt; 27      utl_http.end_request(req);&lt;br /&gt; 28      raise;&lt;br /&gt; 29  end;&lt;br /&gt; 30  /&lt;br /&gt;&amp;lt;?xml version="1.0"?&gt;&amp;lt;SendMessageResponse&lt;br /&gt;xmlns="http://queue.amazonaws.com/doc/2012-11-05/"&gt;&amp;lt;SendMessageResult&gt;&amp;lt;MessageId&lt;br /&gt;&gt;d59b7cfb-4d9d-4675-bf1c-d64a9cb27929&amp;lt;/MessageId&gt;&amp;lt;MD5OfMessageBody&gt;1a79a4d60de67&lt;br /&gt;18e8e5b326e338ae533&amp;lt;/MD5OfMessageBody&gt;&amp;lt;/SendMessageResult&gt;&amp;lt;ResponseMetadata&gt;&amp;lt;Req&lt;br /&gt;uestId&gt;675ba300-5f89-59d8-bf23-fbfcb7bd1fc9&amp;lt;/RequestId&gt;&amp;lt;/ResponseMetadata&gt;&amp;lt;/Send&lt;br /&gt;MessageResponse&gt;&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;Let me explain the code above: &lt;ul&gt;  &lt;li&gt;&lt;b&gt;line 11&lt;/b&gt;: &lt;pre class="brush:sql"&gt;11    utl_http.set_header(req, 'x-amz-date', to_char(sysdate,'yyyymmdd"T"hh24miss"Z"'));&lt;/pre&gt;    &lt;b&gt;x-amz-date&lt;/b&gt; is one of the mandatory headers in &lt;a href="https://docs.aws.amazon.com/general/latest/gr/sigv4-date-handling.html"&gt;Signature Version 4&lt;/a&gt;  &lt;/li&gt;  &lt;li&gt;&lt;b&gt;lines 12-13:&lt;/b&gt;&lt;pre class="brush:sql"&gt;12    utl_http.set_property(req, 'aws-region', 'us-east-1');&lt;br /&gt;13    utl_http.set_property(req, 'aws-service', 'sqs');&lt;/pre&gt;    The lines are provided in accordance with the comments in &lt;b&gt;?/rdbms/admin/utlhttp.sql&lt;/b&gt;  &lt;/li&gt;  &lt;li&gt;&lt;b&gt;line 14:&lt;/b&gt;&lt;pre class="brush:sql"&gt;14    utl_http.set_authentication_from_wallet(req, 'aws_sqs', 'AWS4-HMAC-SHA256');&lt;/pre&gt;There is one UTL_HTTP call but there are a lot of things are performed inside the procedure, such as: loading &lt;b&gt;AWS_ACCESS_KEY_ID&lt;/b&gt; and &lt;b&gt;AWS_SECRET_ACCESS_KEY&lt;/b&gt; from the wallet, constructing a Signature Version 4 request. The scheme &lt;b&gt;AWS4-HMAC-SHA256&lt;/b&gt; is not documented yet in Oracle documentation, but it is mentioned in &lt;b&gt;?/rdbms/admin/utlhttp.sql&lt;/b&gt;&lt;/li&gt;&lt;/ul&gt;&lt;br/&gt;&lt;h1&gt;Conclusion&lt;/h1&gt;As this blog post demonstrates, it is quite simple to call the AWS SQS API from PL/SQL using UTL_HTTP. Regretfully, some of the parameters I used are not widely known, and there is little documentation for them. It is my hope that Oracle improves its documentation one day.&lt;br/&gt;&lt;br/&gt;It should be possible to call other AWS services using the same technique. SQS was used since there was an original question about it on &lt;a href="https://www.sql.ru/forum/1335452/aws-sqs-iz-pl-sql"&gt;SQL.RU&lt;/a&gt;. For instance, I remember I was calling S3 the other day using a similar script and a Signature Version 2 request, which corresponds to &lt;b&gt;schema=AWS&lt;/b&gt; in the &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/arpls/UTL_HTTP.html#GUID-4A74C20F-9544-4123-AF8D-B5588503B6C4"&gt;UTL_HTTP.SET_AUTHENTICATION_FROM_WALLET&lt;/a&gt; call. When it comes to S3, there is yet another way to utilize it that I blogged about in January: &lt;a href="https://mvelikikh.blogspot.com/2021/01/reading-amazon-s3-data-from-oracle-on.html"&gt;Reading Amazon S3 Data from Oracle on non-OCI Environment&lt;/a&gt;.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/251743119734574026/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/04/how-to-send-messages-to-aws-sqs-from.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/251743119734574026'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/251743119734574026'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/04/how-to-send-messages-to-aws-sqs-from.html' title='How to Send Messages to AWS SQS from PL/SQL Using UTL_HTTP'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8774519748822786724</id><published>2021-04-14T22:40:00.001+06:00</published><updated>2021-04-14T22:42:11.345+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='opatch'/><title type='text'>Patching with OPatch Failed with Undefined Reference to __libc_csu_fini __libc_csu_init due to Wrong Libc Library</title><content type='html'>Patching an Oracle Home failed on one cluster node with the following errors: &lt;pre class="brush:sql;highlight:[3,5]"&gt;&lt;br /&gt;Patching component oracle.rdbms, 19.0.0.0.0...&lt;br /&gt;Make failed to invoke "/usr/bin/make -f ins_rdbms.mk ioracle ORACLE_HOME=/u01/app/oracle/product/19.3.0/dbhome_1 OPATCH_SESSION=apply"....'/usr/lib64/crt1.o: In function `_start':&lt;br /&gt;(.text+0x12): undefined reference to `__libc_csu_fini'&lt;br /&gt;/usr/lib64/crt1.o: In function `_start':&lt;br /&gt;(.text+0x19): undefined reference to `__libc_csu_init'&lt;br /&gt;/u01/app/oracle/product/19.3.0/dbhome_1/lib//libserver19.a(kf.o): In function `kfNotify':&lt;br /&gt;kf.c:(.text+0x26f): undefined reference to `atexit'&lt;br /&gt;/u01/app/oracle/product/19.3.0/dbhome_1/lib//libserver19.a(jskm.o): In function `jskmCheckIMJobBCast':&lt;br /&gt;jskm.c:(.text+0x202d): undefined reference to `stat'&lt;br /&gt;jskm.c:(.text+0x2066): undefined reference to `stat'&lt;br /&gt;/u01/app/oracle/product/19.3.0/dbhome_1/lib//libserver19.a(qmsqx.o): In function `qmsqxFetchPos':&lt;br /&gt;qmsqx.c:(text.unlikely+0x1048f): undefined reference to `stat'&lt;br /&gt;/u01/app/oracle/product/19.3.0/dbhome_1/lib//libcore19.a(slzgetevar.o): In function `slzgetevarf_insert_keyval':&lt;br /&gt;slzgetevar.c:(text.unlikely+0x40e): undefined reference to `atexit'&lt;br /&gt;/u01/app/oracle/product/19.3.0/dbhome_1/lib//libgeneric19.a(skgfqsbt.o): In function `xsbtinit':&lt;br /&gt;skgfqsbt.c:(text.unlikely+0x88): undefined reference to `atexit'&lt;br /&gt;/u01/app/oracle/product/19.3.0/dbhome_1/lib//libjavavm19.a(eobtl.o): In function `eobti_create_sym_tmp_file':&lt;br /&gt;eobtl.c:(.text+0x106): undefined reference to `fstat'&lt;br /&gt;/u01/app/oracle/product/19.3.0/dbhome_1/lib//libjavavm19.a(eobtl.o): In function `eobti_digest_symbol_file':&lt;br /&gt;eobtl.c:(.text+0x1b8): undefined reference to `fstat'&lt;br /&gt;/u01/app/oracle/product/19.3.0/dbhome_1/lib//libjavavm19.a(eobtl.o): In function `eobti_build_lookup_tables':&lt;br /&gt;eobtl.c:(.text+0x24ae): undefined reference to `fstat'&lt;br /&gt;eobtl.c:(.text+0x264f): undefined reference to `fstat'&lt;br /&gt;/u01/app/oracle/product/19.3.0/dbhome_1/lib//libnnzst19.a(ext_ztrsaadapter.o): In function `ztcaProcCtx_New':&lt;br /&gt;ztrsaadapter.c:(.text+0xb95): undefined reference to `atexit'&lt;br /&gt;/u01/app/oracle/product/19.3.0/dbhome_1/lib//libnnzst19.a(ccme_ck_rand_load_fileS1.o): In function `r_ck_random_load_file':&lt;br /&gt;ck_rand_load_file.c:(.text+0xd4): undefined reference to `stat'&lt;br /&gt;/u01/app/oracle/product/19.3.0/dbhome_1/rdbms/lib//libfthread19.a(fthread_task.o): In function `fthread_task_tab_init':&lt;br /&gt;fthread_task.c:(text.unlikely+0x3df): undefined reference to `atexit'&lt;br /&gt;make: *** [/u01/app/oracle/product/19.3.0/dbhome_1/rdbms/lib/oracle] Error 1&lt;br /&gt;&lt;/pre&gt;After a bit of searching, I found that the same errors were reported when a wrong libc library was picked up in a case which was not related to Oracle.&lt;br/&gt;Sure enough, there was a symbolic link &lt;b&gt;$ORACLE_HOME/lib/libc.so&lt;/b&gt; to &lt;b&gt;/lib64/libc.so.6&lt;/b&gt;: &lt;pre class="brush:sql;highlight:[3]"&gt;&lt;br /&gt;[oracle@rac1 ~]$ find $ORACLE_HOME -name libc.so -ls&lt;br /&gt;137463494    4 -rw-r--r--   1 oracle   oinstall       83 Apr 25  2014 /u01/app/oracle/product/19.3.0/dbhome_1/lib/stubs/libc.so&lt;br /&gt;88704788    0 lrwxrwxrwx   1 oracle   oinstall       16 Apr 14 15:16 /u01/app/oracle/product/19.3.0/dbhome_1/lib/libc.so -&gt; /lib64/libc.so.6&lt;br /&gt;&lt;/pre&gt;Having deleted the link, I was able to patch the Oracle Home successfully.&lt;br/&gt;&lt;br/&gt;&lt;h3&gt;Thoughts&lt;/h3&gt;My main suspect was &lt;b&gt;ldconfig&lt;/b&gt; and the files in &lt;b&gt;/etc/ld.so.conf.d&lt;/b&gt;. For instance, Oracle Instant Client creates a file there with the &lt;b&gt;$ORACLE_HOME/lib&lt;/b&gt; in it: &lt;pre class="brush:sql;highlight:[2]"&gt;&lt;br /&gt;[oracle@rac1 ~]$ cat /etc/ld.so.conf.d/oracle-instantclient.conf&lt;br /&gt;/usr/lib/oracle/19.3/client64/lib&lt;br /&gt;[oracle@rac1 ~]$ rpm -qf /etc/ld.so.conf.d/oracle-instantclient.conf&lt;br /&gt;oracle-instantclient19.3-basic-19.3.0.0.0-1.x86_64&lt;br /&gt;&lt;/pre&gt;&lt;b&gt;ldconfig&lt;/b&gt; is also called when &lt;b&gt;glibc&lt;/b&gt; is installed: &lt;pre class="brush:sql"&gt;&lt;br /&gt;# rpm -qp --scripts /tmp/glibc/glibc-2.17-323.0.1.el7_9.x86_64.rpm&lt;br /&gt;preinstall scriptlet (using &amp;lt;lua&gt;):&lt;br /&gt;-- Check that the running kernel is new enough&lt;br /&gt;required = '2.6.32'&lt;br /&gt;rel = posix.uname("%r")&lt;br /&gt;if rpm.vercmp(rel, required) &amp;lt; 0 then&lt;br /&gt;  error("FATAL: kernel too old", 0)&lt;br /&gt;end&lt;br /&gt;postinstall program: /usr/sbin/glibc_post_upgrade.x86_64&lt;br /&gt;postuninstall program: /sbin/ldconfig&lt;br /&gt;&lt;/pre&gt;Besides, Oracle also uses some libc stubs (&lt;b&gt;$ORACLE_HOME/lib/stubs/libc.so&lt;/b&gt;), so could it be the case that some unsuccessful patch application left a symbolic link there?&lt;br/&gt;Then, it could be the case that somebody followed an article from My Oracle Support that recommends adding &lt;b&gt;$ORACLE_HOME/lib&lt;/b&gt; to &lt;b&gt;/etc/ld.so.conf.d&lt;/b&gt;: &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=2083336.1"&gt;IF: External Jobs Failed With ORA-27301/ORA-27302 (Doc ID 2083336.1)&lt;/a&gt;.&lt;br/&gt;It is still unclear what caused the issue in the problem scenario since there were no references to &lt;b&gt;$ORACLE_HOME/lib&lt;/b&gt; in &lt;b&gt;/etc/ld.so.conf.d&lt;/b&gt;. For what is worth, next time I will be better prepared when I encounter a similar error.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/8774519748822786724/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/04/patching-with-opatch-failed-with.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8774519748822786724'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8774519748822786724'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/04/patching-with-opatch-failed-with.html' title='Patching with OPatch Failed with Undefined Reference to __libc_csu_fini __libc_csu_init due to Wrong Libc Library'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-5575007206447137506</id><published>2021-04-13T21:29:00.005+06:00</published><updated>2021-04-13T21:29:36.536+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='rac'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='18c'/><title type='text'>Direct Path Read Write Temp while Selecting CLOB from GV$ in RAC</title><content type='html'>I was intestigating why a simple &lt;code&gt;SELECT * FROM GV$SQL&lt;/code&gt; started working much slower in &lt;b&gt;19c&lt;/b&gt; compared to &lt;b&gt;11.2.0.4&lt;/b&gt;. It turns out Oracle introduced some changes there in &lt;b&gt;18c&lt;/b&gt;. This blog post is written to demonstrate the new behavior.&lt;br/&gt;&lt;br/&gt;A simple test case which I constructed for this example is below: &lt;pre class="brush:sql"&gt;&lt;br /&gt;set echo on&lt;br /&gt;set timing on&lt;br /&gt;&lt;br /&gt;select banner from v$version;&lt;br /&gt;alter session set events 'sql_trace wait=true';&lt;br /&gt;begin&lt;br /&gt;  for r in (&lt;br /&gt;    select sql_fulltext&lt;br /&gt;      from gv$sql)&lt;br /&gt;  loop&lt;br /&gt;    null;&lt;br /&gt;  end loop;&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;alter session set events 'sql_trace off';&lt;br /&gt;&lt;br /&gt;select value&lt;br /&gt;  from v$diag_info&lt;br /&gt; where name='Default Trace File';&lt;br /&gt;&lt;/pre&gt;I ran it in &lt;b&gt;19.10&lt;/b&gt; and got the following results: &lt;pre class="brush:sql;highlight:[25]"&gt;&lt;br /&gt;SQL&gt; select banner from v$version;&lt;br /&gt;&lt;br /&gt;BANNER&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:00.00&lt;br /&gt;SQL&gt; alter session set events 'sql_trace wait=true';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:00.00&lt;br /&gt;SQL&gt; begin&lt;br /&gt;  2    for r in (&lt;br /&gt;  3      select sql_fulltext&lt;br /&gt;  4        from gv$sql)&lt;br /&gt;  5    loop&lt;br /&gt;  6      null;&lt;br /&gt;  7    end loop;&lt;br /&gt;  8  end;&lt;br /&gt;  9  /&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:02.14&lt;br /&gt;SQL&gt; alter session set events 'sql_trace off';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:00.00&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select value&lt;br /&gt;  2    from v$diag_info&lt;br /&gt;  3   where name='Default Trace File';&lt;br /&gt;&lt;br /&gt;VALUE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;/u01/app/oracle/diag/rdbms/orcl19/orcl191/trace/orcl191_ora_19616.trc&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:00.00&lt;br /&gt;&lt;/pre&gt;I processed the trace file using tkprof and got the output below: &lt;pre class="brush:sql;highlight:[12,43,44,45]"&gt;&lt;br /&gt;SQL ID: 250c8asaww0wz Plan Hash: 1891717107&lt;br /&gt;&lt;br /&gt;SELECT SQL_FULLTEXT&lt;br /&gt;FROM&lt;br /&gt; GV$SQL&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;call     count       cpu    elapsed       disk      query    current        rows&lt;br /&gt;------- ------  -------- ---------- ---------- ---------- ----------  ----------&lt;br /&gt;Parse        1      0.00       0.00          0          0          0           0&lt;br /&gt;Execute      1      0.00       0.00          0          0          0           0&lt;br /&gt;Fetch       21      0.44       2.13        288        288      25355        2011&lt;br /&gt;------- ------  -------- ---------- ---------- ---------- ----------  ----------&lt;br /&gt;total       23      0.44       2.13        288        288      25355        2011&lt;br /&gt;&lt;br /&gt;Misses in library cache during parse: 0&lt;br /&gt;Optimizer mode: ALL_ROWS&lt;br /&gt;Parsing user id: SYS   (recursive depth: 1)&lt;br /&gt;Number of plan statistics captured: 1&lt;br /&gt;&lt;br /&gt;Rows (1st) Rows (avg) Rows (max)  Row Source Operation&lt;br /&gt;---------- ---------- ----------  ---------------------------------------------------&lt;br /&gt;      2011       2011       2011  PX COORDINATOR  (cr=288 pr=288 pw=2259 time=2499846 us starts=1)&lt;br /&gt;         0          0          0   PX SEND QC (RANDOM) :TQ10000 (cr=0 pr=0 pw=0 time=0 us starts=0 cost=0 size=1638400 card=100)&lt;br /&gt;         0          0          0    VIEW  GV$SQL (cr=0 pr=0 pw=0 time=0 us starts=0)&lt;br /&gt;         0          0          0     FIXED TABLE FULL X$KGLCURSOR_CHILD (cr=0 pr=0 pw=0 time=0 us starts=0 cost=0 size=1638400 card=100)&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Elapsed times include waiting on following events:&lt;br /&gt;  Event waited on                             Times   Max. Wait  Total Waited&lt;br /&gt;  ----------------------------------------   Waited  ----------  ------------&lt;br /&gt;  PGA memory operation                           18        0.00          0.00&lt;br /&gt;  PX Deq: reap credit                           232        0.00          0.00&lt;br /&gt;  PX Deq: Join ACK                                2        0.00          0.00&lt;br /&gt;  PX Deq: Parse Reply                             2        0.00          0.00&lt;br /&gt;  PX Deq: Execute Reply                         146        0.00          0.00&lt;br /&gt;  Disk file operations I/O                        5        0.00          0.00&lt;br /&gt;  CSS initialization                              2        0.00          0.00&lt;br /&gt;  CSS operation: query                            6        0.00          0.00&lt;br /&gt;  CSS operation: action                           2        0.00          0.00&lt;br /&gt;  asynch descriptor resize                        1        0.00          0.00&lt;br /&gt;  ASM IO for non-blocking poll                 6769        0.00          0.00&lt;br /&gt;  direct path write temp                       2158        0.00          1.59&lt;br /&gt;  db file sequential read                       144        0.00          0.06&lt;br /&gt;  direct path read temp                         144        0.00          0.06&lt;br /&gt;  reliable message                                1        0.00          0.00&lt;br /&gt;  PX Deq: Signal ACK EXT                          2        0.00          0.00&lt;br /&gt;  IPC send completion sync                        1        0.00          0.00&lt;br /&gt;  PX Deq: Slave Session Stats                     2        0.00          0.00&lt;br /&gt;  IPC group service call                          1        0.00          0.00&lt;br /&gt;  enq: PS - contention                            1        0.00          0.00&lt;br /&gt;&lt;/pre&gt;It is worth noting that the number of rows is &lt;b&gt;2011&lt;/b&gt; while the number of &lt;b&gt;direct path write temp&lt;/b&gt; wait events is &lt;b&gt;2158&lt;/b&gt;. I believe it is a general pattern rather than a coincidence based on my tests. I found that the number of &lt;b&gt;direct path write temp&lt;/b&gt; is always greater than the number of rows but not much. That basically means that Oracle does at least one write per CLOB returned.&lt;br/&gt;Let us now compare it with &lt;b&gt;12.2&lt;/b&gt; (I tested both &lt;b&gt;12.2&lt;/b&gt; and &lt;b&gt;12.2&lt;/b&gt; with the latest release update): &lt;pre class="brush:sql;highlight:[29]"&gt;&lt;br /&gt;SQL&gt; select banner from v$version;&lt;br /&gt;&lt;br /&gt;BANNER&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Oracle Database 12c Enterprise Edition Release 12.2.0.1.0 - 64bit Production&lt;br /&gt;PL/SQL Release 12.2.0.1.0 - Production&lt;br /&gt;CORE    12.2.0.1.0      Production&lt;br /&gt;TNS for Linux: Version 12.2.0.1.0 - Production&lt;br /&gt;NLSRTL Version 12.2.0.1.0 - Production&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:00.01&lt;br /&gt;SQL&gt; alter session set events 'sql_trace wait=true';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:00.00&lt;br /&gt;SQL&gt; begin&lt;br /&gt;  2    for r in (&lt;br /&gt;  3      select sql_fulltext&lt;br /&gt;  4        from gv$sql)&lt;br /&gt;  5    loop&lt;br /&gt;  6      null;&lt;br /&gt;  7    end loop;&lt;br /&gt;  8  end;&lt;br /&gt;  9  /&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:00.05&lt;br /&gt;SQL&gt; alter session set events 'sql_trace off';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:00.00&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select value&lt;br /&gt;  2    from v$diag_info&lt;br /&gt;  3   where name='Default Trace File';&lt;br /&gt;&lt;br /&gt;VALUE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;/u01/app/oracle/diag/rdbms/o122a/o122a1/trace/o122a1_ora_24892.trc&lt;br /&gt;&lt;/pre&gt;It can be seen that &lt;b&gt;12.2&lt;/b&gt; is much faster than &lt;b&gt;19.10&lt;/b&gt;.&lt;br/&gt;Here is a tkprof processed output: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL ID: 250c8asaww0wz Plan Hash: 1891717107&lt;br /&gt;&lt;br /&gt;SELECT SQL_FULLTEXT&lt;br /&gt;FROM&lt;br /&gt; GV$SQL&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;call     count       cpu    elapsed       disk      query    current        rows&lt;br /&gt;------- ------  -------- ---------- ---------- ---------- ----------  ----------&lt;br /&gt;Parse        1      0.00       0.00          0          0          0           0&lt;br /&gt;Execute      1      0.00       0.00          0          0          0           0&lt;br /&gt;Fetch       21      0.02       0.03          0          0          0        2069&lt;br /&gt;------- ------  -------- ---------- ---------- ---------- ----------  ----------&lt;br /&gt;total       23      0.03       0.05          0          0          0        2069&lt;br /&gt;&lt;br /&gt;Misses in library cache during parse: 1&lt;br /&gt;Optimizer mode: ALL_ROWS&lt;br /&gt;Parsing user id: 76     (recursive depth: 1)&lt;br /&gt;Number of plan statistics captured: 1&lt;br /&gt;&lt;br /&gt;Rows (1st) Rows (avg) Rows (max)  Row Source Operation&lt;br /&gt;---------- ---------- ----------  ---------------------------------------------------&lt;br /&gt;      2069       2069       2069  PX COORDINATOR  (cr=0 pr=0 pw=0 time=138102 us starts=1)&lt;br /&gt;         0          0          0   PX SEND QC (RANDOM) :TQ10000 (cr=0 pr=0 pw=0 time=0 us starts=0 cost=0 size=200200 card=100)&lt;br /&gt;         0          0          0    VIEW  GV$SQL (cr=0 pr=0 pw=0 time=0 us starts=0)&lt;br /&gt;         0          0          0     FIXED TABLE FULL X$KGLCURSOR_CHILD (cr=0 pr=0 pw=0 time=0 us starts=0 cost=0 size=200200 card=100)&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Elapsed times include waiting on following events:&lt;br /&gt;  Event waited on                             Times   Max. Wait  Total Waited&lt;br /&gt;  ----------------------------------------   Waited  ----------  ------------&lt;br /&gt;  enq: PS - contention                            3        0.00          0.00&lt;br /&gt;  PX Deq: Join ACK                                5        0.00          0.00&lt;br /&gt;  PX Deq: reap credit                           277        0.00          0.00&lt;br /&gt;  IPC send completion sync                        3        0.00          0.00&lt;br /&gt;  PX Deq: Parse Reply                             2        0.00          0.00&lt;br /&gt;  PGA memory operation                           28        0.00          0.00&lt;br /&gt;  PX Deq: Execute Reply                         132        0.00          0.01&lt;br /&gt;  reliable message                                1        0.00          0.00&lt;br /&gt;  PX Deq: Signal ACK EXT                          2        0.00          0.00&lt;br /&gt;  PX Deq: Slave Session Stats                     2        0.00          0.00&lt;br /&gt;&lt;/pre&gt;Although the number of rows is roughly the same (&lt;b&gt;2069&lt;/b&gt; in &lt;b&gt;12.2&lt;/b&gt; vs &lt;b&gt;2011&lt;/b&gt; in &lt;b&gt;19.10&lt;/b&gt;), the runtime performance and wait events are drastically different. Please bear in mind, that I initially asked to investigate why the same query in &lt;b&gt;11.2&lt;/b&gt; was running in &lt;b&gt;1&lt;/b&gt; second while the same query in &lt;b&gt;19.10&lt;/b&gt; was running in &lt;b&gt;90&lt;/b&gt; seconds with about the same number of rows as in &lt;b&gt;11.2&lt;/b&gt;.&lt;br/&gt;I also reviewed the trace file in &lt;b&gt;19c&lt;/b&gt; to see if I can spot any pattern there: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@rac1 ~]$ grep 'WAIT #139925193433952' /u01/app/oracle/diag/rdbms/orcl19/orcl191/trace/orcl191_ora_19616.trc | grep -E 'direct path (read|write) temp|db file sequential read'&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 758 file number=201 first dba=4355 block cnt=1 obj#=-1 tim=20569064799&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 674 file number=201 first dba=4356 block cnt=1 obj#=-1 tim=20569065748&lt;br /&gt;..59 direct path write temp in total&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 680 file number=201 first dba=4413 block cnt=1 obj#=-1 tim=20569114649&lt;br /&gt;..then there are groups consisting of one db file sequential read/one direct path read temp (the same block)/multiple direct path write temp:&lt;br /&gt;..group 1&lt;br /&gt;WAIT #139925193433952: nam='db file sequential read' ela= 473 file#=201 block#=4413 blocks=1 obj#=-1 tim=20569115200&lt;br /&gt;WAIT #139925193433952: nam='direct path read temp' ela= 449 file number=201 first dba=4413 block cnt=1 obj#=-1 tim=20569115739&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 699 file number=201 first dba=4413 block cnt=1 obj#=-1 tim=20569116529&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 643 file number=201 first dba=4414 block cnt=1 obj#=-1 tim=20569117342&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 753 file number=201 first dba=4415 block cnt=1 obj#=-1 tim=20569118266&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 706 file number=201 first dba=4416 block cnt=1 obj#=-1 tim=20569119134&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 593 file number=201 first dba=4417 block cnt=1 obj#=-1 tim=20569119882&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 626 file number=201 first dba=4418 block cnt=1 obj#=-1 tim=20569120652&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 807 file number=201 first dba=4419 block cnt=1 obj#=-1 tim=20569121585&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 625 file number=201 first dba=4420 block cnt=1 obj#=-1 tim=20569122348&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 605 file number=201 first dba=4421 block cnt=1 obj#=-1 tim=20569123097&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 509 file number=201 first dba=4422 block cnt=1 obj#=-1 tim=20569123753&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 577 file number=201 first dba=4423 block cnt=1 obj#=-1 tim=20569124476&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 667 file number=201 first dba=4424 block cnt=1 obj#=-1 tim=20569125286&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 501 file number=201 first dba=4425 block cnt=1 obj#=-1 tim=20569125930&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 617 file number=201 first dba=4426 block cnt=1 obj#=-1 tim=20569126698&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 634 file number=201 first dba=4427 block cnt=1 obj#=-1 tim=20569127473&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 577 file number=201 first dba=4428 block cnt=1 obj#=-1 tim=20569128188&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 868 file number=201 first dba=4429 block cnt=1 obj#=-1 tim=20569129188&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 609 file number=201 first dba=4430 block cnt=1 obj#=-1 tim=20569130099&lt;br /&gt;..group 2&lt;br /&gt;WAIT #139925193433952: nam='db file sequential read' ela= 399 file#=201 block#=4430 blocks=1 obj#=-1 tim=20569130544&lt;br /&gt;WAIT #139925193433952: nam='direct path read temp' ela= 454 file number=201 first dba=4430 block cnt=1 obj#=-1 tim=20569131072&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 669 file number=201 first dba=4430 block cnt=1 obj#=-1 tim=20569131834&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 686 file number=201 first dba=4431 block cnt=1 obj#=-1 tim=20569132665&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 588 file number=201 first dba=4432 block cnt=1 obj#=-1 tim=20569133416&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 794 file number=201 first dba=4433 block cnt=1 obj#=-1 tim=20569134366&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 648 file number=201 first dba=4434 block cnt=1 obj#=-1 tim=20569135192&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 792 file number=201 first dba=4435 block cnt=1 obj#=-1 tim=20569136134&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 682 file number=201 first dba=4436 block cnt=1 obj#=-1 tim=20569136961&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 609 file number=201 first dba=4437 block cnt=1 obj#=-1 tim=20569137753&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 563 file number=201 first dba=4438 block cnt=1 obj#=-1 tim=20569138501&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 645 file number=201 first dba=4439 block cnt=1 obj#=-1 tim=20569139298&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 807 file number=201 first dba=4440 block cnt=1 obj#=-1 tim=20569140265&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 679 file number=201 first dba=4441 block cnt=1 obj#=-1 tim=20569141079&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 626 file number=201 first dba=4442 block cnt=1 obj#=-1 tim=20569141844&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 740 file number=201 first dba=4443 block cnt=1 obj#=-1 tim=20569142718&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 753 file number=201 first dba=4444 block cnt=1 obj#=-1 tim=20569143615&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 686 file number=201 first dba=4445 block cnt=1 obj#=-1 tim=20569144450&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 673 file number=201 first dba=4446 block cnt=1 obj#=-1 tim=20569145257&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 728 file number=201 first dba=4447 block cnt=1 obj#=-1 tim=20569146129&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 589 file number=201 first dba=4448 block cnt=1 obj#=-1 tim=20569146857&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 658 file number=201 first dba=4449 block cnt=1 obj#=-1 tim=20569147672&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 666 file number=201 first dba=4450 block cnt=1 obj#=-1 tim=20569148478&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 602 file number=201 first dba=4451 block cnt=1 obj#=-1 tim=20569149255&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 841 file number=201 first dba=4452 block cnt=1 obj#=-1 tim=20569150247&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 763 file number=201 first dba=4453 block cnt=1 obj#=-1 tim=20569151167&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 779 file number=201 first dba=4454 block cnt=1 obj#=-1 tim=20569152208&lt;br /&gt;..group 3&lt;br /&gt;WAIT #139925193433952: nam='db file sequential read' ela= 206 file#=201 block#=4454 blocks=1 obj#=-1 tim=20569152457&lt;br /&gt;WAIT #139925193433952: nam='direct path read temp' ela= 711 file number=201 first dba=4454 block cnt=1 obj#=-1 tim=20569153234&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 575 file number=201 first dba=4454 block cnt=1 obj#=-1 tim=20569153905&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 930 file number=201 first dba=4455 block cnt=1 obj#=-1 tim=20569155093&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 809 file number=201 first dba=4355 block cnt=1 obj#=-1 tim=20569156069&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 820 file number=201 first dba=4356 block cnt=1 obj#=-1 tim=20569157024&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 976 file number=201 first dba=4357 block cnt=1 obj#=-1 tim=20569158174&lt;br /&gt;WAIT #139925193433952: nam='direct path write temp' ela= 683 file number=201 first dba=4358 block cnt=1 obj#=-1 tim=20569159165&lt;br /&gt;WAIT #139925193433952: nam='db file sequential read' ela= 638 file#=201 block#=4358 blocks=1 obj#=-1 tim=20569159850&lt;br /&gt;WAIT #139925193433952: nam='direct path read temp' ela= 183 file number=201 first dba=4358 block cnt=1 obj#=-1 tim=20569160107&lt;br /&gt;..&lt;br /&gt;&lt;/pre&gt;My next thought was to test how 19c processes CLOB's in traditional tables - I have not found any issues there. There have been no &lt;b&gt;direct path read/write temp&lt;/b&gt; on copies of &lt;b&gt;GV$SQL&lt;/b&gt;.&lt;br/&gt;I then tried to select the same persistent tables (non-GV$) via database link in &lt;b&gt;19c&lt;/b&gt; - again everything worked as it should.&lt;br/&gt;It seems that only GV$ views are affected. Local selects are not affected at all (the output below is from the first instance): &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL ID: 87myh1vhjdcf8 Plan Hash: 1891717107&lt;br /&gt;&lt;br /&gt;SELECT SQL_FULLTEXT&lt;br /&gt;FROM&lt;br /&gt; GV$SQL WHERE INST_ID = 1&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;call     count       cpu    elapsed       disk      query    current        rows&lt;br /&gt;------- ------  -------- ---------- ---------- ---------- ----------  ----------&lt;br /&gt;Parse        1      0.00       0.00          0          0          0           0&lt;br /&gt;Execute      1      0.00       0.00          0          0          0           0&lt;br /&gt;Fetch       13      0.02       0.02          0          0          0        1231&lt;br /&gt;------- ------  -------- ---------- ---------- ---------- ----------  ----------&lt;br /&gt;total       15      0.03       0.03          0          0          0        1231&lt;br /&gt;&lt;br /&gt;Misses in library cache during parse: 1&lt;br /&gt;Optimizer mode: ALL_ROWS&lt;br /&gt;Parsing user id: SYS   (recursive depth: 1)&lt;br /&gt;Number of plan statistics captured: 1&lt;br /&gt;&lt;br /&gt;Rows (1st) Rows (avg) Rows (max)  Row Source Operation&lt;br /&gt;---------- ---------- ----------  ---------------------------------------------------&lt;br /&gt;      1231       1231       1231  PX COORDINATOR  (cr=0 pr=0 pw=0 time=13516 us starts=1)&lt;br /&gt;      1231       1231       1231   PX SEND QC (RANDOM) :TQ10000 (cr=0 pr=0 pw=0 time=13283 us starts=1 cost=0 size=1639700 card=100)&lt;br /&gt;      1231       1231       1231    VIEW  GV$SQL (cr=0 pr=0 pw=0 time=12908 us starts=1)&lt;br /&gt;      1231       1231       1231     FIXED TABLE FULL X$KGLCURSOR_CHILD (cr=0 pr=0 pw=0 time=12657 us starts=1 cost=0 size=1639700 card=100)&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Elapsed times include waiting on following events:&lt;br /&gt;  Event waited on                             Times   Max. Wait  Total Waited&lt;br /&gt;  ----------------------------------------   Waited  ----------  ------------&lt;br /&gt;  PGA memory operation                           99        0.00          0.00&lt;br /&gt;&lt;/pre&gt;Whereas any select when non-local instance is involved is done utilizing a temporary tablespace: &lt;pre class="brush:sql;highlight:[12,43,44,45]"&gt;&lt;br /&gt;SQL ID: 4p7vm0hhw6u1v Plan Hash: 1891717107&lt;br /&gt;&lt;br /&gt;SELECT SQL_FULLTEXT&lt;br /&gt;FROM&lt;br /&gt; GV$SQL WHERE INST_ID = 2&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;call     count       cpu    elapsed       disk      query    current        rows&lt;br /&gt;------- ------  -------- ---------- ---------- ---------- ----------  ----------&lt;br /&gt;Parse        1      0.00       0.00          0          0          0           0&lt;br /&gt;Execute      1      0.00       0.00          0          0          0           0&lt;br /&gt;Fetch       10      0.21       1.06        118        118      11953         968&lt;br /&gt;------- ------  -------- ---------- ---------- ---------- ----------  ----------&lt;br /&gt;total       12      0.21       1.07        118        118      11953         968&lt;br /&gt;&lt;br /&gt;Misses in library cache during parse: 1&lt;br /&gt;Optimizer mode: ALL_ROWS&lt;br /&gt;Parsing user id: SYS   (recursive depth: 1)&lt;br /&gt;Number of plan statistics captured: 1&lt;br /&gt;&lt;br /&gt;Rows (1st) Rows (avg) Rows (max)  Row Source Operation&lt;br /&gt;---------- ---------- ----------  ---------------------------------------------------&lt;br /&gt;       968        968        968  PX COORDINATOR  (cr=118 pr=118 pw=1075 time=907430 us starts=1)&lt;br /&gt;         0          0          0   PX SEND QC (RANDOM) :TQ10000 (cr=0 pr=0 pw=0 time=0 us starts=0 cost=0 size=1639700 card=100)&lt;br /&gt;         0          0          0    VIEW  GV$SQL (cr=0 pr=0 pw=0 time=0 us starts=0)&lt;br /&gt;         0          0          0     FIXED TABLE FULL X$KGLCURSOR_CHILD (cr=0 pr=0 pw=0 time=0 us starts=0 cost=0 size=1639700 card=100)&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Elapsed times include waiting on following events:&lt;br /&gt;  Event waited on                             Times   Max. Wait  Total Waited&lt;br /&gt;  ----------------------------------------   Waited  ----------  ------------&lt;br /&gt;  PX Deq: reap credit                           158        0.00          0.00&lt;br /&gt;  PX Deq: Join ACK                                1        0.00          0.00&lt;br /&gt;  PX Deq: Parse Reply                             1        0.00          0.00&lt;br /&gt;  PGA memory operation                           11        0.00          0.00&lt;br /&gt;  PX Deq: Execute Reply                          61        0.00          0.01&lt;br /&gt;  Disk file operations I/O                        3        0.00          0.00&lt;br /&gt;  CSS initialization                              2        0.00          0.00&lt;br /&gt;  CSS operation: query                            6        0.00          0.00&lt;br /&gt;  CSS operation: action                           2        0.00          0.00&lt;br /&gt;  asynch descriptor resize                        1        0.00          0.00&lt;br /&gt;  ASM IO for non-blocking poll                 3208        0.00          0.00&lt;br /&gt;  direct path write temp                       1029        0.00          0.81&lt;br /&gt;  db file sequential read                        59        0.00          0.02&lt;br /&gt;  direct path read temp                          59        0.00          0.02&lt;br /&gt;  reliable message                                1        0.00          0.00&lt;br /&gt;  PX Deq: Signal ACK EXT                          1        0.00          0.00&lt;br /&gt;  IPC send completion sync                        1        0.00          0.00&lt;br /&gt;  PX Deq: Slave Session Stats                     1        0.00          0.00&lt;br /&gt;  IPC group service call                          1        0.00          0.00&lt;br /&gt;  enq: PS - contention                            1        0.00          0.00&lt;br /&gt;&lt;/pre&gt;I then shut one instance down, and rechecked the queries against GV$ - there were no &lt;b&gt;direct path read/write temp&lt;/b&gt; wait events.&lt;br/&gt;&lt;br/&gt;&lt;h3&gt;Conclusion&lt;/h3&gt;It is still not clear why Oracle started writing every CLOB from GV$ to a temporary tablespace. I tried several different GV$ views and the same behaviour was observed everywhere. It looks like something was changed inside those GV$ functions.&lt;br/&gt;My initial thought was that it is some kind of a temporary tablespace flush for persistence in case some parallel processes got terminated. However, parallel slaves started on remote instances are sending the blocks to the QC bypassing any temp.&lt;br/&gt;Then I was thinking that it might be done to reduce memory usage. It has little sense to write every CLOB to temp anyway. Why do not keep a small memory area and write to temp everything that exceeded some threshold?&lt;br/&gt;I also do not know how to alter this behavior to make the things the same as they were before &lt;b&gt;18c&lt;/b&gt;. I tested &lt;b&gt;11.2.0.4&lt;/b&gt;, &lt;b&gt;12.2&lt;/b&gt;(vanilla and with the latest RU), &lt;b&gt;18c&lt;/b&gt;, &lt;b&gt;19c&lt;/b&gt; (vanilla and with the latest RU - &lt;b&gt;19.10&lt;/b&gt;). Both &lt;b&gt;18c&lt;/b&gt; and &lt;b&gt;19c&lt;/b&gt; are affected, so that they wait for &lt;b&gt;direct path read/write temp&lt;/b&gt; when a CLOB column is selected from GV$ with more than one instance.&lt;br/&gt;I will update the blog post if I get to the bottom of it and identify the root cause. </content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/5575007206447137506/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/04/direct-path-read-write-temp-while.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5575007206447137506'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5575007206447137506'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/04/direct-path-read-write-temp-while.html' title='Direct Path Read Write Temp while Selecting CLOB from GV$ in RAC'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-5432307846194492800</id><published>2021-03-13T23:54:00.003+06:00</published><updated>2021-03-13T23:54:43.338+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='dbms_redact'/><title type='text'>Strict Redaction Semantics</title><content type='html'>A DBMS_REDACT issue has recently popped up on &lt;a href="https://www.sql.ru/forum/1325742/pravilnoe-ispolzovanie-dbms-redact-add-policy"&gt;SQL.RU&lt;/a&gt;. I constructed a simple test case to demonstrate the problem in 19.9: &lt;pre class="brush:sql"&gt;&lt;br /&gt;set echo on lin 120&lt;br /&gt;&lt;br /&gt;conn tc/tc@localhost/pdb&lt;br /&gt;&lt;br /&gt;grant create table to scott identified by tiger;&lt;br /&gt;alter user scott quota unlimited on users;&lt;br /&gt;&lt;br /&gt;drop table scott.emp;&lt;br /&gt;create table scott.emp(client_name varchar2(30));&lt;br /&gt;&lt;br /&gt;insert into scott.emp values ('Larry Ellison');&lt;br /&gt;insert into scott.emp values ('Jeff Bezos');&lt;br /&gt;insert into scott.emp values ('Elon Musk');&lt;br /&gt;insert into scott.emp values ('Vladimir Putin');&lt;br /&gt;insert into scott.emp values (null);&lt;br /&gt;&lt;br /&gt;exec dbms_redact.add_policy( -&lt;br /&gt;       object_schema         =&gt; 'SCOTT', -&lt;br /&gt;       object_name           =&gt; 'emp', -&lt;br /&gt;       column_name           =&gt; 'CLIENT_NAME', -&lt;br /&gt;       policy_name           =&gt; 'client_fio', -&lt;br /&gt;       function_type         =&gt; dbms_redact.regexp, -&lt;br /&gt;       regexp_pattern        =&gt; '(\S{3})(\S+)', -&lt;br /&gt;       regexp_replace_string =&gt; '\1***', -&lt;br /&gt;       expression            =&gt; '1 = 1' -&lt;br /&gt;)&lt;br /&gt;&lt;br /&gt;col client_name for a16&lt;br /&gt;col c1 for a16&lt;br /&gt;col c2 like c1&lt;br /&gt;col c3 like c1&lt;br /&gt;create or replace view scott.vw as&lt;br /&gt;select client_name&lt;br /&gt;     , nvl(client_name, 'zyzy') c1&lt;br /&gt;     , case when client_name='Vla*** Put***' then 'y' else client_name end c2&lt;br /&gt;     ,'Hello '||client_name c3&lt;br /&gt;  from scott.emp;&lt;br /&gt;&lt;br /&gt;grant alter session, create session to tc2 identified by tc2;&lt;br /&gt;&lt;br /&gt;grant select on scott.vw to tc2;&lt;br /&gt;&lt;br /&gt;conn tc2/tc2@localhost/pdb&lt;br /&gt;&lt;br /&gt;select * from scott.vw;&lt;br /&gt;&lt;/pre&gt;In a nutshell, there is a table that has a data redaction policy. There is a view built on top of it. However, when a user tries to select from the view, it returns an error: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select * from scott.vw;&lt;br /&gt;select * from scott.vw&lt;br /&gt;                    *&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-28094: SQL construct not supported by data redaction&lt;br /&gt;&lt;/pre&gt;This restriction is mentioned in &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/asoag/oracle-data-redaction-use-with-oracle-database-features.html#GUID-FFCACD39-626A-4851-B4B2-D38225C91707"&gt;the Advanced Security Guide&lt;/a&gt;: &lt;blockquote cite="https://docs.oracle.com/en/database/oracle/oracle-database/19/asoag/oracle-data-redaction-use-with-oracle-database-features.html#GUID-FFCACD39-626A-4851-B4B2-D38225C91707"&gt;To avoid the ORA-28094 error, ensure that the query has the following properties:  &lt;br/&gt;In a CREATE VIEW definition or an inline view, there cannot be any SQL expression that involves a redacted column. &lt;/blockquote&gt;When I come across such restrictions, it is always interesting to explore if there is a way of getting around it. Let us enable Data Redaction tracing and rerun the query: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; alter session set events 'trace[radm]';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; select * from scott.vw;&lt;br /&gt;select * from scott.vw&lt;br /&gt;                    *&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-28094: SQL construct not supported by data redaction&lt;br /&gt;&lt;/pre&gt;Here is the trace file: &lt;pre class="brush:sql;highlight:[50]"&gt;&lt;br /&gt;kzdmpci: Table obj# is: 23656&lt;br /&gt;kzdmpci: Policy Name is: client_fio&lt;br /&gt;kzdmpci: Policy Expression ID radm_mc$.pe# = 5001&lt;br /&gt;kzdmpci: intcol# is: 1&lt;br /&gt;kzdmpci: Masking Function is: 5&lt;br /&gt;kzdmpci: RegExp pattern: (\S{3})(\S+) (len=12)&lt;br /&gt;kzdmpci: RegExp replace: \1*** (len=5)&lt;br /&gt;kzdmpci: RegExp match  :  (len=0), mpl=17&lt;br /&gt;kzdmpci: no RADM policies exist, starting new RADM Policy Chain.&lt;br /&gt;kzdmpci: new RADM Policy Chain ci-&gt;kkscdmpc=0x12da37ec started with  obj#=23656&lt;br /&gt;kzdmpci:2: radm_pe$ lookup: for Policy Expression ID pe# 5001, pe_pexpr is [1 = 1], pe_name = [], pe_obj# = 23656&lt;br /&gt;kzdmpci: added column 1 for object 23656&lt;br /&gt;kzradm_vc_replace_expr_allowed: policy on table EMP&lt;br /&gt;&lt;br /&gt;kzdmrfs: entered with opntyp of OPNTCOL&lt;br /&gt;kzdmrfs: found redacted col CLIENT_NAME at 7&lt;br /&gt;kzradm_vc_replace_expr_allowed: 0&lt;br /&gt;&lt;br /&gt;kzdmchkerpna: kzpcxp(KZSERP) gave FALSE, no bypass.&lt;br /&gt;&lt;br /&gt;kzdmchkerpna: kzpcxp(KZSERP) gave FALSE, no bypass.&lt;br /&gt;&lt;br /&gt;kzdmchkerpna: kzpcxp(KZSERP) gave FALSE, no bypass.&lt;br /&gt;&lt;br /&gt;kzdmchkerpna: kzpcxp(KZSERP) gave FALSE, no bypass.&lt;br /&gt;&lt;br /&gt;kzdmchkerp: kzpcsp(KZSERP) gave FALSE, no bypass.&lt;br /&gt;kzdmprqb: entered&lt;br /&gt;kzdminsc: entered with opntyp=OPNTCOL&lt;br /&gt;&lt;br /&gt;kzdminsc: view column CLIENT_NAME with KCCF2MASKDEP detected, calling kzdmpvc&lt;br /&gt;kzdmpvc: level 0, column 'CLIENT_NAME' has KCCF2MASKDEP flag&lt;br /&gt;kzdmpvc: level 0, calling kzdmcrmo to insert MASK operator around view column with name 'CLIENT_NAME'&lt;br /&gt;&lt;br /&gt;kzdmcrmo: the pe# is 5001&lt;br /&gt;kzdmcrmo: entered, creating MASK operator for column CLIENT_NAME of table EMP&lt;br /&gt;kzdmcrmo: policy chain = 0x6319aa30&lt;br /&gt;kzdmcrmo: obj# = 23656, intcol# = 1&lt;br /&gt;kzdmcrmo: New ctxmask chain pgactx-&gt;ctxmask=0x62485db0 started with obj#=23656&lt;br /&gt;kzdmcrmo: found object 23656&lt;br /&gt;kzdmcrmo: found column 1, metadata=0x6319a988&lt;br /&gt;kzdmcrmo: New ctxmask_re chain 0x62485d80 started with col=(23656,1)&lt;br /&gt;kzdmcrmo: finished creating MASK operator&lt;br /&gt;kzdmpvc: level 0, kzdmcrmo inserted MASK operator.&lt;br /&gt;kzdminsc: entered with opntyp=OPNTCOL&lt;br /&gt;&lt;br /&gt;kzdminsc: view column C1 with KCCF2MASKDEP detected, calling kzdmpvc&lt;br /&gt;kzdmpvc: level 0, column 'C1' has KCCF2MASKDEP flag&lt;br /&gt;kzdmpvc: level 0, processing SQL expression...&lt;br /&gt;kzdmpvc: strict semantics disallow expression in VIEW&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;kzdmchkerpna: kzpcxp(KZSERP) gave FALSE, no bypass.&lt;br /&gt;&lt;/pre&gt;This &lt;b&gt;&lt;i&gt;strict semantics disallow expression in VIEW&lt;/i&gt;&lt;/b&gt; bit sounded intriguing, so that I decided to research what it is and how to change it: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select ksppinm, ksppdesc from x$ksppi where ksppinm like '%redaction%';&lt;br /&gt;&lt;br /&gt;KSPPINM                        KSPPDESC&lt;br /&gt;------------------------------ ----------------------------------------&lt;br /&gt;_strict_redaction_semantics    Strict Data Redaction semantics&lt;br /&gt;&lt;/pre&gt;I set the parameter to &lt;code&gt;FALSE&lt;/code&gt; and bounced the database: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; alter system set "_strict_redaction_semantics"=false scope=spfile;&lt;br /&gt;&lt;br /&gt;System altered.&lt;br /&gt;&lt;br /&gt;$ srvctl stop database -db orcl ; srvctl start database -db orcl&lt;br /&gt;&lt;/pre&gt;Sure enough, that is what I got after selecting the data from the view: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select * from scott.vw;&lt;br /&gt;&lt;br /&gt;CLIENT_NAME      C1                  C2               C3&lt;br /&gt;---------------- ------------------- ---------------- -------------------&lt;br /&gt;Lar*** Ell***    Lar*** Ell***       Lar*** Ell***    Hello Lar*** Ell***&lt;br /&gt;Jef*** Bez***    Jef*** Bez***       Jef*** Bez***    Hello Jef*** Bez***&lt;br /&gt;Elo*** Mus***    Elo*** Mus***       Elo*** Mus***    Hello Elo*** Mus***&lt;br /&gt;Vla*** Put***    Vla*** Put***       y                Hello Vla*** Put***&lt;br /&gt;                 zyzy                                 Hello&lt;br /&gt;&lt;/pre&gt;&lt;h1&gt;Conclusion&lt;/h1&gt;Oracle obviously makes such restrictions on purpose. There is no much information about this parameter, but there should be some corner cases due to which Oracle decided to keep the redaction semantics as strict by default. It might be the case that Oracle will make this functionality officially available in a next release once it is ready for production use.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/5432307846194492800/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/03/strict-redaction-semantics.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5432307846194492800'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5432307846194492800'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/03/strict-redaction-semantics.html' title='Strict Redaction Semantics'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-818827394184648004</id><published>2021-03-09T02:17:00.005+06:00</published><updated>2021-03-09T02:22:24.715+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='OGG'/><title type='text'>Oracle to PostgreSQL Replication: Numbers Truncated to 6 Decimal Places</title><content type='html'>I configured an initial load from Oracle to PostgreSQL, and found that some numbers were truncated after the load, e.g. Oracle number &lt;code&gt;123.0123456789&lt;/code&gt; happened to be &lt;code&gt;123.012346&lt;/code&gt; in PostgreSQL.&lt;br/&gt;&lt;h1&gt;Setup&lt;/h1&gt;&lt;h3&gt;Source: Oracle 	Goldengate 19.1.0.0.4&lt;/h3&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;GGSCI (ogg-hub as c##ggadmin@orcl/CDB$ROOT) 9&gt; versions&lt;br /&gt;&lt;br /&gt;Operating System:&lt;br /&gt;Linux&lt;br /&gt;Version #2 SMP Fri Mar 29 17:05:02 PDT 2019, Release 4.1.12-124.26.7.el7uek.x86_64&lt;br /&gt;Node: ogg-hub&lt;br /&gt;Machine: Linux&lt;br /&gt;&lt;br /&gt;Database:&lt;br /&gt;Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Target: Oracle GoldenGate 19.1.0.0.200714 for PostgreSQL&lt;/h3&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;GGSCI (ogg-hub as ggadmin@testdb) 8&gt; versions&lt;br /&gt;&lt;br /&gt;Operating System:&lt;br /&gt;Linux&lt;br /&gt;Version #2 SMP Fri Mar 29 17:05:02 PDT 2019, Release 4.1.12-124.26.7.el7uek.x86_64&lt;br /&gt;Node: ogg-hub&lt;br /&gt;Machine: Linux&lt;br /&gt;&lt;br /&gt;Database:&lt;br /&gt;PostgreSQL&lt;br /&gt;Version 12.06.0000 PostgreSQL 12.6&lt;br /&gt;ODBC Version 03.52.0000&lt;br /&gt;Driver Information:&lt;br /&gt;GGpsql25.so&lt;br /&gt;Version 07.16.0353 (B0519, U0369)&lt;br /&gt;ODBC Version 03.52&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;odbc.ini&lt;/h3&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;[ODBC Data Sources]&lt;br /&gt;testdb=PostgreSQL on testdb&lt;br /&gt;&lt;br /&gt;[ODBC]&lt;br /&gt;IANAAppCodePage=106&lt;br /&gt;InstallDir=/u01/app/oracle/product/19/ogg_pg_home1&lt;br /&gt;&lt;br /&gt;[testdb]&lt;br /&gt;Driver=/u01/app/oracle/product/19/ogg_pg_home1/lib/GGpsql25.so&lt;br /&gt;Description=PostgreSQL 12.6&lt;br /&gt;Database=testdb&lt;br /&gt;HostName=postgres&lt;br /&gt;PortNumber=5432&lt;br /&gt;TransactionErrorBehavior=2&lt;br /&gt;&lt;/pre&gt;&lt;h1&gt;Initial Data&lt;/h1&gt;There is a table in the Oracle database: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; create table tc.test(&lt;br /&gt;  2    id int primary key,&lt;br /&gt;  3    n1 number,&lt;br /&gt;  4    n2 number);&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert into tc.test values (0, 123.0123456789, 123.0123456789);&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from tc.test;&lt;br /&gt;&lt;br /&gt;             ID              N1              N2&lt;br /&gt;--------------- --------------- ---------------&lt;br /&gt;              0  123.0123456789  123.0123456789&lt;br /&gt;&lt;/pre&gt;The corresponding PostgreSQL table is this: &lt;pre class="brush:sql"&gt;&lt;br /&gt;testdb=# create table tc.test(&lt;br /&gt;testdb(#   id bigint primary key,&lt;br /&gt;testdb(#   n1 numeric,&lt;br /&gt;testdb(#   n2 numeric(38,10));&lt;br /&gt;CREATE TABLE&lt;br /&gt;testdb=# \d tc.test&lt;br /&gt;                     Table "tc.test"&lt;br /&gt; Column |      Type      | Collation | Nullable | Default&lt;br /&gt;--------+----------------+-----------+----------+---------&lt;br /&gt; id     | bigint         |           | not null |&lt;br /&gt; n1     | numeric        |           |          |&lt;br /&gt; n2     | numeric(38,10) |           |          |&lt;br /&gt;Indexes:&lt;br /&gt;    "test_pkey" PRIMARY KEY, btree (id)&lt;br /&gt;&lt;/pre&gt;&lt;h1&gt;GoldenGate Initial Load Processes&lt;/h1&gt;&lt;h3&gt;Extract&lt;/h3&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;GGSCI (ogg-hub) 1&gt; view params einit&lt;br /&gt;&lt;br /&gt;EXTRACT einit&lt;br /&gt;USERIDALIAS oggadmin&lt;br /&gt;RMTHOST ogg-hub, MGRPORT 7810&lt;br /&gt;RMTTASK REPLICAT, GROUP rinit&lt;br /&gt;&lt;br /&gt;TABLE pdb.tc.test;&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Replicat&lt;/h3&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;GGSCI (ogg-hub) 1&gt; view params rinit&lt;br /&gt;&lt;br /&gt;REPLICAT rinit&lt;br /&gt;SETENV (PGCLIENTENCODING="UTF8")&lt;br /&gt;SETENV (ODBCINI="/home/ogg/pg/odbc.ini" )&lt;br /&gt;TARGETDB testdb, USERIDALIAS ggadmin&lt;br /&gt;DISCARDFILE ./dirrpt/rinit.dsc, PURGE&lt;br /&gt;&lt;br /&gt;MAP pdb.*.*, TARGET *.*;&lt;br /&gt;&lt;/pre&gt;&lt;h1&gt;Performing Initial Load&lt;/h1&gt;&lt;h3&gt;Extract&lt;/h3&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;GGSCI (ogg-hub) 1&gt; start extract einit&lt;br /&gt;&lt;br /&gt;Sending START request to MANAGER ...&lt;br /&gt;EXTRACT EINIT starting&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Replicat Report File&lt;/h3&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;***********************************************************************&lt;br /&gt;               Oracle GoldenGate Delivery for PostgreSQL&lt;br /&gt; Version 19.1.0.0.200714 OGGCORE_19.1.0.0.0OGGBP_PLATFORMS_200628.2141&lt;br /&gt;   Linux, x64, 64bit (optimized), PostgreSQL on Jun 29 2020 04:06:46&lt;br /&gt;&lt;br /&gt;Copyright (C) 1995, 2019, Oracle and/or its affiliates. All rights reserved.&lt;br /&gt;&lt;br /&gt;                    Starting at 2021-03-08 18:05:04&lt;br /&gt;***********************************************************************&lt;br /&gt;&lt;br /&gt;Operating System Version:&lt;br /&gt;Linux&lt;br /&gt;Version #2 SMP Fri Mar 29 17:05:02 PDT 2019, Release 4.1.12-124.26.7.el7uek.x86_64&lt;br /&gt;Node: ogg-hub&lt;br /&gt;Machine: x86_64&lt;br /&gt;                         soft limit   hard limit&lt;br /&gt;Address Space Size   :    unlimited    unlimited&lt;br /&gt;Heap Size            :    unlimited    unlimited&lt;br /&gt;File Size            :    unlimited    unlimited&lt;br /&gt;CPU Time             :    unlimited    unlimited&lt;br /&gt;&lt;br /&gt;Process id: 15745&lt;br /&gt;&lt;br /&gt;Description:&lt;br /&gt;&lt;br /&gt;***********************************************************************&lt;br /&gt;**            Running with the following parameters                  **&lt;br /&gt;***********************************************************************&lt;br /&gt;&lt;br /&gt;2021-03-08 18:05:09  INFO    OGG-03059  Operating system character set identified as UTF-8.&lt;br /&gt;&lt;br /&gt;2021-03-08 18:05:09  INFO    OGG-02695  ANSI SQL parameter syntax is used for parameter parsing.&lt;br /&gt;&lt;br /&gt;2021-03-08 18:05:09  INFO    OGG-02095  Successfully set environment variable PGCLIENTENCODING=UTF8.&lt;br /&gt;&lt;br /&gt;2021-03-08 18:05:09  INFO    OGG-02095  Successfully set environment variable ODBCINI=/home/ogg/pg/odbc.ini.&lt;br /&gt;&lt;br /&gt;2021-03-08 18:05:09  INFO    OGG-01360  REPLICAT is running in Remote Task mode.&lt;br /&gt;REPLICAT rinit&lt;br /&gt;SETENV (PGCLIENTENCODING="UTF8")&lt;br /&gt;SETENV (ODBCINI="/home/ogg/pg/odbc.ini" )&lt;br /&gt;TARGETDB testdb, USERIDALIAS ggadmin&lt;br /&gt;&lt;br /&gt;2021-03-08 18:05:09  INFO    OGG-03036  Database character set identified as UTF-8. Locale: en_US.UTF-8.&lt;br /&gt;&lt;br /&gt;2021-03-08 18:05:09  INFO    OGG-03037  Session character set identified as UTF-8.&lt;br /&gt;DISCARDFILE ./dirrpt/rinit.dsc, purge&lt;br /&gt;MAP pdb.*.*, TARGET *.*;&lt;br /&gt;&lt;br /&gt;2021-03-08 18:05:09  INFO    OGG-01815  Virtual Memory Facilities for: COM&lt;br /&gt;    anon alloc: mmap(MAP_ANON)  anon free: munmap&lt;br /&gt;    file alloc: mmap(MAP_SHARED)  file free: munmap&lt;br /&gt;    target directories:&lt;br /&gt;    /u01/app/oracle/product/19/ogg_pg_home1/dirtmp.&lt;br /&gt;&lt;br /&gt;2021-03-08 18:05:09  INFO    OGG-25340&lt;br /&gt;Database Version:&lt;br /&gt;PostgreSQL&lt;br /&gt;Version 12.06.0000 PostgreSQL 12.6&lt;br /&gt;ODBC Version 03.52.0000&lt;br /&gt;&lt;br /&gt;Driver Information:&lt;br /&gt;GGpsql25.so&lt;br /&gt;Version 07.16.0353 (B0519, U0369)&lt;br /&gt;ODBC Version 03.52.&lt;br /&gt;&lt;br /&gt;2021-03-08 18:05:09  INFO    OGG-25341&lt;br /&gt;Database Language and Character Set:&lt;br /&gt;SERVER_ENCODING = "UTF8"&lt;br /&gt;LC_CTYPE        = "en_US.UTF-8"&lt;br /&gt;TIMEZONE        = "Europe/Dublin".&lt;br /&gt;&lt;br /&gt;***********************************************************************&lt;br /&gt;**                     Run Time Messages                             **&lt;br /&gt;***********************************************************************&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;2021-03-08 18:05:10  INFO    OGG-06506  Wildcard MAP resolved (entry pdb.*.*): MAP "PDB"."TC"."TEST", TARGET "TC"."TEST".&lt;br /&gt;&lt;br /&gt;2021-03-08 18:05:10  INFO    OGG-02756  The definition for table PDB.TC.TEST is obtained from the trail file.&lt;br /&gt;&lt;br /&gt;2021-03-08 18:05:10  INFO    OGG-06511  Using following columns in default map by name: id, n1, n2.&lt;br /&gt;&lt;br /&gt;2021-03-08 18:05:10  INFO    OGG-06510  Using the following key columns for target table tc.test: id.&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;PostgreSQL&lt;/h3&gt;&lt;pre class="brush:sql;highlight:[4,12]"&gt;&lt;br /&gt;testdb=# select * from tc.test;&lt;br /&gt; id |     n1     |       n2&lt;br /&gt;----+------------+----------------&lt;br /&gt;  0 | 123.012346 | 123.0123456789&lt;br /&gt;(1 row)&lt;br /&gt;&lt;br /&gt;testdb=# \d tc.test&lt;br /&gt;                     Table "tc.test"&lt;br /&gt; Column |      Type      | Collation | Nullable | Default&lt;br /&gt;--------+----------------+-----------+----------+---------&lt;br /&gt; id     | bigint         |           | not null |&lt;br /&gt; n1     | numeric        |           |          |&lt;br /&gt; n2     | numeric(38,10) |           |          |&lt;br /&gt;Indexes:&lt;br /&gt;    "test_pkey" PRIMARY KEY, btree (id)&lt;br /&gt;&lt;/pre&gt;It can be seen that the column &lt;code&gt;n1&lt;/code&gt; has value &lt;b&gt;123.012346&lt;/b&gt; rather than the expected value &lt;b&gt;123.0123456789&lt;/b&gt;.&lt;br/&gt;It is also worth noting that the column &lt;code&gt;n2&lt;/code&gt; defined as &lt;code&gt;numeric(38,10)&lt;/code&gt; has the proper value as it is in the source Oracle database. &lt;h1&gt;Thoughts and Fix&lt;/h1&gt;The issue itself is that the number was truncated to 6 decimal places. It is quite easy to find the same issue was already reported in 2018, but it is still not resolved: &lt;a href="https://community.oracle.com/mosc/discussion/4126912/golden-gate-truncating-decimal-places-for-number-data-type-post-migration"&gt;Golden Gate truncating decimal places for number data type post migration&lt;/a&gt;.&lt;br/&gt;&lt;br/&gt;Firstly, when I encountered that issue, I tried to identify what component is causing this: GoldenGate for Oracle, GoldenGate for PostgreSQL, or may be PostgreSQL itself. GoldenGate for PostgreSQL uses Progress DataDirect driver that has an interesting setting: &lt;a href="https://media.datadirect.com/download/docs/odbc/allodbc/index.html#page/odbc%2Funbounded-numeric-scale.html%23"&gt;Unbounded Numeric Scale&lt;/a&gt; that has a default value of &lt;b&gt;6&lt;/b&gt;. Well it looked like something. I added that parameter to &lt;b&gt;odbc.ini&lt;/b&gt;: &lt;pre class="brush:sql;highlight:[8]"&gt;&lt;br /&gt;[testdb]&lt;br /&gt;Driver=/u01/app/oracle/product/19/ogg_pg_home1/lib/GGpsql25.so&lt;br /&gt;Description=PostgreSQL 12.6&lt;br /&gt;Database=testdb&lt;br /&gt;HostName=ora&lt;br /&gt;PortNumber=5432&lt;br /&gt;TransactionErrorBehavior=2&lt;br /&gt;UnboundedNumericScale=10&lt;br /&gt;&lt;/pre&gt;Having rerun the load from scratch, I finally got the correct number in PostgreSQL: &lt;pre class="brush:sql;highlight:[4]"&gt;&lt;br /&gt;testdb=# select * from tc.test;&lt;br /&gt; id |       n1       |       n2&lt;br /&gt;----+----------------+----------------&lt;br /&gt;  0 | 123.0123456789 | 123.0123456789&lt;br /&gt;(1 row)&lt;br /&gt;&lt;/pre&gt;&lt;h1&gt;Conclusion&lt;/h1&gt;The ODBC driver used by GoldenGate truncates unbounded numeric columns to 6 decimal places by default. Thankfully, there is an option to alter it: &lt;a href="https://media.datadirect.com/download/docs/odbc/allodbc/index.html#page/odbc%2Funbounded-numeric-scale.html%23"&gt;Unbounded Numeric Scale&lt;/a&gt;. I am disposed to think that it is usually more reliable to specify a certain scale in the target database than relying on such settings.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/818827394184648004/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/03/oracle-to-postgresql-replication.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/818827394184648004'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/818827394184648004'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/03/oracle-to-postgresql-replication.html' title='Oracle to PostgreSQL Replication: Numbers Truncated to 6 Decimal Places'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-2926432301066901243</id><published>2021-02-27T02:09:00.004+06:00</published><updated>2021-02-27T02:14:23.568+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='rman'/><title type='text'>Create Standby Skip Pluggable Database</title><content type='html'>&lt;h2&gt;Goal&lt;/h2&gt;Let us assume there is a need to create a standby database that excludes some pluggable databases of the primary, e.g. the PDBs must not be restored during standby database creation, and the standby will ignore any redo related to them.&lt;br/&gt;It is known that the DUPLICATE command does not allow that: &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/rcmrf/DUPLICATE.html#d43747e1626"&gt;Backup and Recovery Reference&lt;/a&gt;&lt;blockquote cite="https://docs.oracle.com/en/database/oracle/oracle-database/19/rcmrf/DUPLICATE.html#d43747e1626"&gt;  &lt;b&gt;Note:&lt;/b&gt; RMAN does not support partial PDB duplication. Therefore, you cannot use the &lt;code&gt;SKIP TABLESPACE&lt;/code&gt;, &lt;code&gt;TABLESPACE&lt;/code&gt;, &lt;code&gt;SKIP PLUGGABLE DATABASE&lt;/code&gt;, and &lt;code&gt;PLUGGABLE DATABASE&lt;/code&gt; options when creating a standby database.  &lt;/blockquote&gt;This blog post describes how the desired can be accomplished. &lt;h2&gt;Idea&lt;/h2&gt;&lt;ul&gt;  &lt;li&gt;Skip the tablespaces of the pluggable databases that should not be protected by Data Guard: &lt;code&gt;SKIP [FOREVER] TABLESPACE&lt;/code&gt; clause of the &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/rcmrf/RESTORE.html#d82198e2317"&gt;RESTORE&lt;/a&gt; command can be used&lt;/li&gt;  &lt;li&gt;Drop the excluded data files on the standby&lt;/li&gt;  &lt;li&gt;Set &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/refrn/ENABLED_PDBS_ON_STANDBY.html#GUID-A2EC2381-D9C0-4612-87C9-A225C7BCE8C4"&gt;ENABLED_PDBS_ON_STANDBY&lt;/a&gt; to apply redo only to certain PDBs&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;Setup&lt;/h2&gt;&lt;h3&gt;Primary and Standby&lt;/h3&gt;&lt;ul&gt;  &lt;li&gt;db_name: &lt;code&gt;orcl&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;Oracle version: &lt;code&gt;19.10&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;Primary&lt;/h3&gt;&lt;ul&gt;  &lt;li&gt;Hostname: &lt;code&gt;servera&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;db_unique_name: &lt;code&gt;orcla&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;instance_name: &lt;code&gt;orcla1&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;Pluggable Databases: &lt;code&gt;PDB1-3&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;Standby&lt;/h3&gt;&lt;ul&gt;  &lt;li&gt;Hostname: &lt;code&gt;serverb&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;db_unique_name: &lt;code&gt;orclb&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;instance_name: &lt;code&gt;orclb1&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;Pluggable Database: &lt;code&gt;PDB1&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h3&gt;Creating Primary&lt;/h3&gt;The primary database was created by the following DBCA command: &lt;pre class="brush:sql"&gt;&lt;br /&gt;dbca -silent -createDatabase \&lt;br /&gt;  -responseFile NO_VALUE \&lt;br /&gt;  -gdbName orcl \&lt;br /&gt;  -sid orcla1 \&lt;br /&gt;  -templateName New_Database.dbt \&lt;br /&gt;  -createAsContainerDatabase true \&lt;br /&gt;    -numberOfPDBs 3 \&lt;br /&gt;    -pdbName pdb \&lt;br /&gt;    -pdbAdminPassword Oracle123 \&lt;br /&gt;  -sysPassword Oracle123 \&lt;br /&gt;  -systemPassword Oracle123 \&lt;br /&gt;  -recoveryAreaDestination +FRA \&lt;br /&gt;    -recoveryAreaSize 10000 \&lt;br /&gt;  -storageType ASM \&lt;br /&gt;    -datafileDestination +DATA \&lt;br /&gt;  -enableArchive true \&lt;br /&gt;  -memoryMgmtType AUTO_SGA \&lt;br /&gt;  -dbOptions "APEX:false,DV:false,CWMLITE:false,IMEDIA:false,JSERVER:false,OMS:false,ORACLE_TEXT:false,SAMPLE_SCHEMA:false,SPATIAL:false" \&lt;br /&gt;  -initParams "db_unique_name=orcla,dg_broker_start=true"&lt;br /&gt;&lt;/pre&gt;The actual output from the terminal: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@servera ~]$ dbca -silent -createDatabase \&lt;br /&gt;&gt;   -responseFile NO_VALUE \&lt;br /&gt;&gt;   -gdbName orcl \&lt;br /&gt;&gt;   -sid orcla1 \&lt;br /&gt;&gt;   -templateName New_Database.dbt \&lt;br /&gt;&gt;   -createAsContainerDatabase true \&lt;br /&gt;&gt;     -numberOfPDBs 3 \&lt;br /&gt;&gt;     -pdbName pdb \&lt;br /&gt;&gt;     -pdbAdminPassword Oracle123 \&lt;br /&gt;&gt;   -sysPassword Oracle123 \&lt;br /&gt;&gt;   -systemPassword Oracle123 \&lt;br /&gt;&gt;   -recoveryAreaDestination +FRA \&lt;br /&gt;&gt;     -recoveryAreaSize 10000 \&lt;br /&gt;&gt;   -storageType ASM \&lt;br /&gt;&gt;     -datafileDestination +DATA \&lt;br /&gt;&gt;   -enableArchive true \&lt;br /&gt;&gt;   -memoryMgmtType AUTO_SGA \&lt;br /&gt;&gt;   -dbOptions "APEX:false,DV:false,CWMLITE:false,IMEDIA:false,JSERVER:false,OMS:false,ORACLE_TEXT:false,SAMPLE_SCHEM&lt;br /&gt;A:false,SPATIAL:false" \&lt;br /&gt;&gt;   -initParams "db_unique_name=orcla,dg_broker_start=true"&lt;br /&gt;[WARNING] [DBT-06801] Specified Fast Recovery Area size (10,000 MB) is less than the recommended value.&lt;br /&gt;   CAUSE: Fast Recovery Area size should at least be three times the database size (8,897 MB).&lt;br /&gt;   ACTION: Specify Fast Recovery Area Size to be at least three times the database size.&lt;br /&gt;[WARNING] [DBT-06801] Specified Fast Recovery Area size (10,000 MB) is less than the recommended value.&lt;br /&gt;   CAUSE: Fast Recovery Area size should at least be three times the database size (4,502 MB).&lt;br /&gt;   ACTION: Specify Fast Recovery Area Size to be at least three times the database size.&lt;br /&gt;Prepare for db operation&lt;br /&gt;6% complete&lt;br /&gt;Registering database with Oracle Restart&lt;br /&gt;10% complete&lt;br /&gt;Creating and starting Oracle instance&lt;br /&gt;12% complete&lt;br /&gt;16% complete&lt;br /&gt;Creating database files&lt;br /&gt;17% complete&lt;br /&gt;23% complete&lt;br /&gt;Creating data dictionary views&lt;br /&gt;25% complete&lt;br /&gt;29% complete&lt;br /&gt;32% complete&lt;br /&gt;34% complete&lt;br /&gt;36% complete&lt;br /&gt;38% complete&lt;br /&gt;42% complete&lt;br /&gt;Creating cluster database views&lt;br /&gt;43% complete&lt;br /&gt;55% complete&lt;br /&gt;Completing Database Creation&lt;br /&gt;59% complete&lt;br /&gt;61% complete&lt;br /&gt;Creating Pluggable Databases&lt;br /&gt;65% complete&lt;br /&gt;69% complete&lt;br /&gt;73% complete&lt;br /&gt;81% complete&lt;br /&gt;Executing Post Configuration Actions&lt;br /&gt;100% complete&lt;br /&gt;Database creation complete. For details check the logfiles at:&lt;br /&gt; /u01/app/oracle/cfgtoollogs/dbca/orcla.&lt;br /&gt;Database Information:&lt;br /&gt;Global Database Name:orcla&lt;br /&gt;System Identifier(SID):orcla1&lt;br /&gt;Look at the log file "/u01/app/oracle/cfgtoollogs/dbca/orcla/orcla.log" for further details.&lt;br /&gt;[oracle@servera ~]$&lt;br /&gt;&lt;/pre&gt;There are three pluggable databases created: &lt;code&gt;PDB1-3&lt;/code&gt;. &lt;code&gt;PDB1&lt;/code&gt; should be replicated as usual. Both &lt;code&gt;PDB2&lt;/code&gt; and &lt;code&gt;PDB3&lt;/code&gt; should not be available on standby. &lt;h2&gt;Creating Standby&lt;/h2&gt;&lt;h3&gt;Adding Static Service to Listener&lt;/h3&gt;I edited &lt;code&gt;/u01/app/19.3.0/grid/network/admin/listener.ora&lt;/code&gt; and added a static registration for my standby instance: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SID_LIST_LISTENER=&lt;br /&gt;  (SID_LIST=&lt;br /&gt;      (SID_DESC=&lt;br /&gt;         (GLOBAL_DBNAME=orclb)&lt;br /&gt;         (SID_NAME=orclb1)&lt;br /&gt;         (ORACLE_HOME=/u01/app/oracle/product/19.3.0/dbhome_1)&lt;br /&gt;       )&lt;br /&gt;   )&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Copying password file&lt;/h3&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@serverb ~]$ scp servera:$ORACLE_HOME/dbs/orapworcla1 $ORACLE_HOME/dbs/orapworclb1&lt;br /&gt;Warning: Permanently added 'servera' (ECDSA) to the list of known hosts.&lt;br /&gt;orapworcla1                                                                        100% 2048   860.9KB/s   00:00&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Bootstrap init.ora&lt;/h3&gt;&lt;pre class="brush:sql;highlight:[8]"&gt;&lt;br /&gt;db_name=orcl&lt;br /&gt;db_unique_name=orclb&lt;br /&gt;instance_name=orclb1&lt;br /&gt;enable_pluggable_database=true&lt;br /&gt;db_recovery_file_dest=+FRA&lt;br /&gt;db_recovery_file_dest_size=10G&lt;br /&gt;dg_broker_start=true&lt;br /&gt;enabled_pdbs_on_standby=pdb1&lt;br /&gt;&lt;/pre&gt;Only &lt;code&gt;PDB1&lt;/code&gt; will be enabled on the standby database. &lt;h3&gt;Starting Standby Instance&lt;/h3&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@serverb ~]$ sqlplus / as sysdba&lt;br /&gt;&lt;br /&gt;SQL*Plus: Release 19.0.0.0.0 - Production on Fri Feb 26 15:00:55 2021&lt;br /&gt;Version 19.10.0.0.0&lt;br /&gt;&lt;br /&gt;Copyright (c) 1982, 2020, Oracle.  All rights reserved.&lt;br /&gt;&lt;br /&gt;Connected to an idle instance.&lt;br /&gt;&lt;br /&gt;SQL&gt; startup nomount pfile=/tmp/init.ora&lt;br /&gt;ORACLE instance started.&lt;br /&gt;&lt;br /&gt;Total System Global Area  457176832 bytes&lt;br /&gt;Fixed Size                  9135872 bytes&lt;br /&gt;Variable Size             306184192 bytes&lt;br /&gt;Database Buffers          134217728 bytes&lt;br /&gt;Redo Buffers                7639040 bytes&lt;br /&gt;SQL&gt; Disconnected from Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production&lt;br /&gt;Version 19.10.0.0.0&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Restoring Standby Control File and Mounting Standby Database&lt;/h3&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@serverb ~]$ rman&lt;br /&gt;&lt;br /&gt;Recovery Manager: Release 19.0.0.0.0 - Production on Fri Feb 26 15:01:04 2021&lt;br /&gt;Version 19.10.0.0.0&lt;br /&gt;&lt;br /&gt;Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.&lt;br /&gt;&lt;br /&gt;RMAN&gt; connect target sys/Oracle123@servera/orcla&lt;br /&gt;&lt;br /&gt;connected to target database: ORCL (DBID=1593309578)&lt;br /&gt;&lt;br /&gt;RMAN&gt; connect auxiliary sys/Oracle123@serverb/orclb&lt;br /&gt;&lt;br /&gt;connected to auxiliary database: ORCL (not mounted)&lt;br /&gt;&lt;br /&gt;RMAN&gt; run&lt;br /&gt;{&lt;br /&gt;   sql clone 'create spfile from memory';&lt;br /&gt;   shutdown clone immediate;&lt;br /&gt;   startup clone nomount;&lt;br /&gt;   restore clone from service  'servera/orcla' standby controlfile;&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;2&gt; 3&gt; 4&gt; 5&gt; 6&gt; 7&gt;&lt;br /&gt;using target database control file instead of recovery catalog&lt;br /&gt;sql statement: create spfile from memory&lt;br /&gt;&lt;br /&gt;Oracle instance shut down&lt;br /&gt;&lt;br /&gt;connected to auxiliary database (not started)&lt;br /&gt;Oracle instance started&lt;br /&gt;&lt;br /&gt;Total System Global Area     457176832 bytes&lt;br /&gt;&lt;br /&gt;Fixed Size                     9135872 bytes&lt;br /&gt;Variable Size                306184192 bytes&lt;br /&gt;Database Buffers             134217728 bytes&lt;br /&gt;Redo Buffers                   7639040 bytes&lt;br /&gt;&lt;br /&gt;Starting restore at 26.02.2021 15:02:27&lt;br /&gt;allocated channel: ORA_AUX_DISK_1&lt;br /&gt;channel ORA_AUX_DISK_1: SID=76 device type=DISK&lt;br /&gt;&lt;br /&gt;channel ORA_AUX_DISK_1: starting datafile backup set restore&lt;br /&gt;channel ORA_AUX_DISK_1: using network backup set from service servera/orcla&lt;br /&gt;channel ORA_AUX_DISK_1: restoring control file&lt;br /&gt;channel ORA_AUX_DISK_1: restore complete, elapsed time: 00:00:02&lt;br /&gt;output file name=+FRA/ORCLB/CONTROLFILE/current.256.1065538951&lt;br /&gt;Finished restore at 26.02.2021 15:02:31&lt;br /&gt;&lt;br /&gt;RMAN&gt;&lt;br /&gt;RMAN&gt; run&lt;br /&gt;{&lt;br /&gt;   sql clone 'alter database mount standby database';&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;2&gt; 3&gt; 4&gt;&lt;br /&gt;sql statement: alter database mount standby database&lt;br /&gt;&lt;br /&gt;RMAN&gt;&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Restoring Standby Database&lt;/h3&gt;Here are the primary data files: &lt;pre class="brush:sql;highlight:[22,23,24,25,26,27,28,29]"&gt;&lt;br /&gt;alter session set "_exclude_seed_cdb_view"=false;&lt;br /&gt;&lt;br /&gt;select p.pdb_name pdb_name, f.file_id, f.file_name&lt;br /&gt;  from cdb_data_files f, dba_pdbs p&lt;br /&gt; where p.pdb_id(+) = f.con_id&lt;br /&gt; order by f.file_id, p.pdb_id;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;PDB_NAME      FILE_ID FILE_NAME&lt;br /&gt;---------- ---------- --------------------------------------------------------------------------------&lt;br /&gt;                    1 +DATA/ORCLA/DATAFILE/system.260.1065528853&lt;br /&gt;PDB$SEED            2 +DATA/ORCLA/BC3D34CE047E62F0E0530600000AF770/DATAFILE/system.261.1065528859&lt;br /&gt;                    3 +DATA/ORCLA/DATAFILE/sysaux.262.1065528863&lt;br /&gt;PDB$SEED            4 +DATA/ORCLA/BC3D34CE047E62F0E0530600000AF770/DATAFILE/sysaux.263.1065528865&lt;br /&gt;                    5 +DATA/ORCLA/DATAFILE/undotbs1.264.1065528867&lt;br /&gt;PDB$SEED            6 +DATA/ORCLA/BC3D34CE047E62F0E0530600000AF770/DATAFILE/undotbs1.265.1065528869&lt;br /&gt;                    7 +DATA/ORCLA/DATAFILE/users.268.1065528883&lt;br /&gt;PDB1                8 +DATA/ORCLA/BC3DBECD0A3C07D3E0530600000A8D82/DATAFILE/system.272.1065531169&lt;br /&gt;PDB1                9 +DATA/ORCLA/BC3DBECD0A3C07D3E0530600000A8D82/DATAFILE/sysaux.270.1065531169&lt;br /&gt;PDB1               10 +DATA/ORCLA/BC3DBECD0A3C07D3E0530600000A8D82/DATAFILE/undotbs1.271.1065531169&lt;br /&gt;PDB1               11 +DATA/ORCLA/BC3DBECD0A3C07D3E0530600000A8D82/DATAFILE/users.274.1065531177&lt;br /&gt;PDB2               12 +DATA/ORCLA/BC3DBF5BB0310A08E0530600000A91B8/DATAFILE/system.277.1065531179&lt;br /&gt;PDB2               13 +DATA/ORCLA/BC3DBF5BB0310A08E0530600000A91B8/DATAFILE/sysaux.275.1065531179&lt;br /&gt;PDB2               14 +DATA/ORCLA/BC3DBF5BB0310A08E0530600000A91B8/DATAFILE/undotbs1.276.1065531179&lt;br /&gt;PDB2               15 +DATA/ORCLA/BC3DBF5BB0310A08E0530600000A91B8/DATAFILE/users.279.1065531185&lt;br /&gt;PDB3               16 +DATA/ORCLA/BC3DBFD5112A0AB0E0530600000AE27E/DATAFILE/system.282.1065531187&lt;br /&gt;PDB3               17 +DATA/ORCLA/BC3DBFD5112A0AB0E0530600000AE27E/DATAFILE/sysaux.280.1065531187&lt;br /&gt;PDB3               18 +DATA/ORCLA/BC3DBFD5112A0AB0E0530600000AE27E/DATAFILE/undotbs1.281.1065531187&lt;br /&gt;PDB3               19 +DATA/ORCLA/BC3DBFD5112A0AB0E0530600000AE27E/DATAFILE/users.284.1065531193&lt;br /&gt;&lt;/pre&gt;All data files of pluggable databases &lt;code&gt;PDB2&lt;/code&gt; and &lt;code&gt;PDB3&lt;/code&gt; should not be restored on the standby site, so that I would like to skip data files 12-19.&lt;br/&gt;The command to restore the standby database and its output are as follows: &lt;pre class="brush:sql"&gt;&lt;br /&gt;run&lt;br /&gt;{&lt;br /&gt;   set newname for tempfile 1 to '+DATA';&lt;br /&gt;   set newname for tempfile 2 to '+DATA';&lt;br /&gt;   set newname for tempfile 3 to '+DATA';&lt;br /&gt;   set newname for tempfile 4 to '+DATA';&lt;br /&gt;   set newname for tempfile 5 to '+DATA';&lt;br /&gt;   switch clone tempfile all;&lt;br /&gt;   set newname for database to '+DATA';&lt;br /&gt;   restore&lt;br /&gt;   from service 'servera/orcla' clone database&lt;br /&gt;   skip forever tablespace&lt;br /&gt;     pdb2:sysaux, pdb2:system, pdb2:undotbs1, pdb2:users,&lt;br /&gt;     pdb3:sysaux, pdb3:system, pdb3:undotbs1, pdb3:users&lt;br /&gt;   ;&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;executing command: SET NEWNAME&lt;br /&gt;&lt;br /&gt;executing command: SET NEWNAME&lt;br /&gt;&lt;br /&gt;executing command: SET NEWNAME&lt;br /&gt;&lt;br /&gt;executing command: SET NEWNAME&lt;br /&gt;&lt;br /&gt;executing command: SET NEWNAME&lt;br /&gt;&lt;br /&gt;renamed tempfile 1 to +DATA in control file&lt;br /&gt;renamed tempfile 2 to +DATA in control file&lt;br /&gt;renamed tempfile 3 to +DATA in control file&lt;br /&gt;renamed tempfile 4 to +DATA in control file&lt;br /&gt;renamed tempfile 5 to +DATA in control file&lt;br /&gt;&lt;br /&gt;executing command: SET NEWNAME&lt;br /&gt;&lt;br /&gt;Starting restore at 26.02.2021 15:03:50&lt;br /&gt;using channel ORA_AUX_DISK_1&lt;br /&gt;&lt;br /&gt;channel ORA_AUX_DISK_1: starting datafile backup set restore&lt;br /&gt;channel ORA_AUX_DISK_1: using network backup set from service servera/orcla&lt;br /&gt;channel ORA_AUX_DISK_1: specifying datafile(s) to restore from backup set&lt;br /&gt;channel ORA_AUX_DISK_1: restoring datafile 00001 to +DATA&lt;br /&gt;channel ORA_AUX_DISK_1: restore complete, elapsed time: 00:00:07&lt;br /&gt;channel ORA_AUX_DISK_1: starting datafile backup set restore&lt;br /&gt;channel ORA_AUX_DISK_1: using network backup set from service servera/orcla&lt;br /&gt;channel ORA_AUX_DISK_1: specifying datafile(s) to restore from backup set&lt;br /&gt;channel ORA_AUX_DISK_1: restoring datafile 00002 to +DATA&lt;br /&gt;channel ORA_AUX_DISK_1: restore complete, elapsed time: 00:00:07&lt;br /&gt;channel ORA_AUX_DISK_1: starting datafile backup set restore&lt;br /&gt;channel ORA_AUX_DISK_1: using network backup set from service servera/orcla&lt;br /&gt;channel ORA_AUX_DISK_1: specifying datafile(s) to restore from backup set&lt;br /&gt;channel ORA_AUX_DISK_1: restoring datafile 00003 to +DATA&lt;br /&gt;channel ORA_AUX_DISK_1: restore complete, elapsed time: 00:00:07&lt;br /&gt;channel ORA_AUX_DISK_1: starting datafile backup set restore&lt;br /&gt;channel ORA_AUX_DISK_1: using network backup set from service servera/orcla&lt;br /&gt;channel ORA_AUX_DISK_1: specifying datafile(s) to restore from backup set&lt;br /&gt;channel ORA_AUX_DISK_1: restoring datafile 00004 to +DATA&lt;br /&gt;channel ORA_AUX_DISK_1: restore complete, elapsed time: 00:00:03&lt;br /&gt;channel ORA_AUX_DISK_1: starting datafile backup set restore&lt;br /&gt;channel ORA_AUX_DISK_1: using network backup set from service servera/orcla&lt;br /&gt;channel ORA_AUX_DISK_1: specifying datafile(s) to restore from backup set&lt;br /&gt;channel ORA_AUX_DISK_1: restoring datafile 00005 to +DATA&lt;br /&gt;channel ORA_AUX_DISK_1: restore complete, elapsed time: 00:00:03&lt;br /&gt;channel ORA_AUX_DISK_1: starting datafile backup set restore&lt;br /&gt;channel ORA_AUX_DISK_1: using network backup set from service servera/orcla&lt;br /&gt;channel ORA_AUX_DISK_1: specifying datafile(s) to restore from backup set&lt;br /&gt;channel ORA_AUX_DISK_1: restoring datafile 00006 to +DATA&lt;br /&gt;channel ORA_AUX_DISK_1: restore complete, elapsed time: 00:00:04&lt;br /&gt;channel ORA_AUX_DISK_1: starting datafile backup set restore&lt;br /&gt;channel ORA_AUX_DISK_1: using network backup set from service servera/orcla&lt;br /&gt;channel ORA_AUX_DISK_1: specifying datafile(s) to restore from backup set&lt;br /&gt;channel ORA_AUX_DISK_1: restoring datafile 00007 to +DATA&lt;br /&gt;channel ORA_AUX_DISK_1: restore complete, elapsed time: 00:00:01&lt;br /&gt;channel ORA_AUX_DISK_1: starting datafile backup set restore&lt;br /&gt;channel ORA_AUX_DISK_1: using network backup set from service servera/orcla&lt;br /&gt;channel ORA_AUX_DISK_1: specifying datafile(s) to restore from backup set&lt;br /&gt;channel ORA_AUX_DISK_1: restoring datafile 00008 to +DATA&lt;br /&gt;channel ORA_AUX_DISK_1: restore complete, elapsed time: 00:00:03&lt;br /&gt;channel ORA_AUX_DISK_1: starting datafile backup set restore&lt;br /&gt;channel ORA_AUX_DISK_1: using network backup set from service servera/orcla&lt;br /&gt;channel ORA_AUX_DISK_1: specifying datafile(s) to restore from backup set&lt;br /&gt;channel ORA_AUX_DISK_1: restoring datafile 00009 to +DATA&lt;br /&gt;channel ORA_AUX_DISK_1: restore complete, elapsed time: 00:00:03&lt;br /&gt;channel ORA_AUX_DISK_1: starting datafile backup set restore&lt;br /&gt;channel ORA_AUX_DISK_1: using network backup set from service servera/orcla&lt;br /&gt;channel ORA_AUX_DISK_1: specifying datafile(s) to restore from backup set&lt;br /&gt;channel ORA_AUX_DISK_1: restoring datafile 00010 to +DATA&lt;br /&gt;channel ORA_AUX_DISK_1: restore complete, elapsed time: 00:00:03&lt;br /&gt;channel ORA_AUX_DISK_1: starting datafile backup set restore&lt;br /&gt;channel ORA_AUX_DISK_1: using network backup set from service servera/orcla&lt;br /&gt;channel ORA_AUX_DISK_1: specifying datafile(s) to restore from backup set&lt;br /&gt;channel ORA_AUX_DISK_1: restoring datafile 00011 to +DATA&lt;br /&gt;channel ORA_AUX_DISK_1: restore complete, elapsed time: 00:00:01&lt;br /&gt;Finished restore at 26.02.2021 15:04:33&lt;br /&gt;&lt;br /&gt;RMAN&gt;&lt;br /&gt;&lt;/pre&gt;It can be seen that data files 12-19 were not restored. &lt;h3&gt;Updating Standby Control File&lt;/h3&gt;I reconnect to the standby database and run &lt;code&gt;SWITCH TO COPY&lt;/code&gt; commands: &lt;pre class="brush:sql"&gt;&lt;br /&gt;RMAN&gt;&lt;br /&gt;&lt;br /&gt;Recovery Manager complete.&lt;br /&gt;[oracle@serverb ~]$ rman target sys/Oracle123@serverb/orclb&lt;br /&gt;&lt;br /&gt;Recovery Manager: Release 19.0.0.0.0 - Production on Fri Feb 26 15:06:55 2021&lt;br /&gt;Version 19.10.0.0.0&lt;br /&gt;&lt;br /&gt;Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.&lt;br /&gt;&lt;br /&gt;connected to target database: ORCL (DBID=1593309578, not open)&lt;br /&gt;&lt;br /&gt;RMAN&gt; switch database root to copy;&lt;br /&gt;&lt;br /&gt;Starting implicit crosscheck backup at 26.02.2021 15:06:59&lt;br /&gt;using target database control file instead of recovery catalog&lt;br /&gt;allocated channel: ORA_DISK_1&lt;br /&gt;channel ORA_DISK_1: SID=76 device type=DISK&lt;br /&gt;Crosschecked 1 objects&lt;br /&gt;Finished implicit crosscheck backup at 26.02.2021 15:06:59&lt;br /&gt;&lt;br /&gt;Starting implicit crosscheck copy at 26.02.2021 15:06:59&lt;br /&gt;using channel ORA_DISK_1&lt;br /&gt;Crosschecked 11 objects&lt;br /&gt;Finished implicit crosscheck copy at 26.02.2021 15:07:00&lt;br /&gt;&lt;br /&gt;searching for all files in the recovery area&lt;br /&gt;cataloging files...&lt;br /&gt;no files cataloged&lt;br /&gt;&lt;br /&gt;datafile 1 switched to datafile copy "+DATA/ORCLB/DATAFILE/system.257.1065539031"&lt;br /&gt;datafile 3 switched to datafile copy "+DATA/ORCLB/DATAFILE/sysaux.258.1065539045"&lt;br /&gt;datafile 5 switched to datafile copy "+DATA/ORCLB/DATAFILE/undotbs1.259.1065539055"&lt;br /&gt;datafile 7 switched to datafile copy "+DATA/ORCLB/DATAFILE/users.260.1065539063"&lt;br /&gt;&lt;br /&gt;RMAN&gt; switch pluggable database "PDB$SEED", pdb1 to copy;&lt;br /&gt;&lt;br /&gt;datafile 2 switched to datafile copy "+DATA/ORCLB/BC3D34CE047E62F0E0530600000AF770/DATAFILE/system.261.1065539039"&lt;br /&gt;datafile 4 switched to datafile copy "+DATA/ORCLB/BC3D34CE047E62F0E0530600000AF770/DATAFILE/sysaux.262.1065539053"&lt;br /&gt;datafile 6 switched to datafile copy "+DATA/ORCLB/BC3D34CE047E62F0E0530600000AF770/DATAFILE/undotbs1.256.1065539059"&lt;br /&gt;datafile 8 switched to datafile copy "+DATA/ORCLB/BC3DBECD0A3C07D3E0530600000A8D82/DATAFILE/system.263.1065539063"&lt;br /&gt;datafile 9 switched to datafile copy "+DATA/ORCLB/BC3DBECD0A3C07D3E0530600000A8D82/DATAFILE/sysaux.264.1065539067"&lt;br /&gt;datafile 10 switched to datafile copy "+DATA/ORCLB/BC3DBECD0A3C07D3E0530600000A8D82/DATAFILE/undotbs1.265.1065539069"&lt;br /&gt;datafile 11 switched to datafile copy "+DATA/ORCLB/BC3DBECD0A3C07D3E0530600000A8D82/DATAFILE/users.266.1065539073"&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Dropping Excluded Data Files&lt;/h3&gt;I can drop all data files of pluggable databases &lt;code&gt;PDB2&lt;/code&gt; and &lt;code&gt;PDB3&lt;/code&gt; on standby: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; alter session set container=pdb2;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; alter database datafile 12,13,14,15 offline drop;&lt;br /&gt;&lt;br /&gt;Database altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; alter session set container=pdb3;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; alter database datafile 16,17,18,19 offline drop;&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Creating Data Guard Configuration&lt;/h3&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@serverb ~]$ dgmgrl&lt;br /&gt;DGMGRL for Linux: Release 19.0.0.0.0 - Production on Fri Feb 26 15:13:12 2021&lt;br /&gt;Version 19.10.0.0.0&lt;br /&gt;&lt;br /&gt;Copyright (c) 1982, 2019, Oracle and/or its affiliates.  All rights reserved.&lt;br /&gt;&lt;br /&gt;Welcome to DGMGRL, type "help" for information.&lt;br /&gt;DGMGRL&gt; connect sys/Oracle123@servera/orcla&lt;br /&gt;Connected to "orcla"&lt;br /&gt;Connected as SYSDBA.&lt;br /&gt;DGMGRL&gt;&lt;br /&gt;DGMGRL&gt; create configuration orcl as primary database is orcla connect identifier is '//servera/orcla';&lt;br /&gt;Configuration "orcl" created with primary database "orcla"&lt;br /&gt;DGMGRL&gt; add database orclb as connect identifier is '//serverb/orclb';&lt;br /&gt;Database "orclb" added&lt;br /&gt;DGMGRL&gt; enable configuration;&lt;br /&gt;Enabled.&lt;br /&gt;DGMGRL&gt; show configuration;&lt;br /&gt;&lt;br /&gt;Configuration - orcl&lt;br /&gt;&lt;br /&gt;  Protection Mode: MaxPerformance&lt;br /&gt;  Members:&lt;br /&gt;  orcla - Primary database&lt;br /&gt;    Warning: ORA-16789: standby redo logs configured incorrectly&lt;br /&gt;&lt;br /&gt;    orclb - Physical standby database&lt;br /&gt;      Warning: ORA-16809: multiple warnings detected for the member&lt;br /&gt;&lt;br /&gt;Fast-Start Failover:  Disabled&lt;br /&gt;&lt;br /&gt;Configuration Status:&lt;br /&gt;WARNING   (status updated 50 seconds ago)&lt;br /&gt;&lt;br /&gt;DGMGRL&gt; show database verbose orclb;&lt;br /&gt;&lt;br /&gt;Database - orclb&lt;br /&gt;&lt;br /&gt;  Role:               PHYSICAL STANDBY&lt;br /&gt;  Intended State:     APPLY-ON&lt;br /&gt;  Transport Lag:      14 seconds (computed 5 seconds ago)&lt;br /&gt;  Apply Lag:          14 seconds (computed 5 seconds ago)&lt;br /&gt;  Average Apply Rate: 3.65 MByte/s&lt;br /&gt;  Active Apply Rate:  0 Byte/s&lt;br /&gt;  Maximum Apply Rate: 0 Byte/s&lt;br /&gt;  Real Time Query:    OFF&lt;br /&gt;  Instance(s):&lt;br /&gt;    orclb1&lt;br /&gt;&lt;br /&gt;  Database Warning(s):&lt;br /&gt;    ORA-16789: standby redo logs configured incorrectly&lt;br /&gt;&lt;br /&gt;  Properties:&lt;br /&gt;    DGConnectIdentifier             = '//serverb/orclb'&lt;br /&gt;    ObserverConnectIdentifier       = ''&lt;br /&gt;    FastStartFailoverTarget         = ''&lt;br /&gt;    PreferredObserverHosts          = ''&lt;br /&gt;    LogShipping                     = 'ON'&lt;br /&gt;    RedoRoutes                      = ''&lt;br /&gt;    LogXptMode                      = 'ASYNC'&lt;br /&gt;    DelayMins                       = '0'&lt;br /&gt;    Binding                         = 'optional'&lt;br /&gt;    MaxFailure                      = '0'&lt;br /&gt;    ReopenSecs                      = '300'&lt;br /&gt;    NetTimeout                      = '30'&lt;br /&gt;    RedoCompression                 = 'DISABLE'&lt;br /&gt;    PreferredApplyInstance          = ''&lt;br /&gt;    ApplyInstanceTimeout            = '0'&lt;br /&gt;    ApplyLagThreshold               = '30'&lt;br /&gt;    TransportLagThreshold           = '30'&lt;br /&gt;    TransportDisconnectedThreshold  = '30'&lt;br /&gt;    ApplyParallel                   = 'AUTO'&lt;br /&gt;    ApplyInstances                  = '0'&lt;br /&gt;    StandbyFileManagement           = ''&lt;br /&gt;    ArchiveLagTarget                = '0'&lt;br /&gt;    LogArchiveMaxProcesses          = '0'&lt;br /&gt;    LogArchiveMinSucceedDest        = '0'&lt;br /&gt;    DataGuardSyncLatency            = '0'&lt;br /&gt;    LogArchiveTrace                 = '0'&lt;br /&gt;    LogArchiveFormat                = ''&lt;br /&gt;    DbFileNameConvert               = ''&lt;br /&gt;    LogFileNameConvert              = ''&lt;br /&gt;    ArchiveLocation                 = ''&lt;br /&gt;    AlternateLocation               = ''&lt;br /&gt;    StandbyArchiveLocation          = ''&lt;br /&gt;    StandbyAlternateLocation        = ''&lt;br /&gt;    InconsistentProperties          = '(monitor)'&lt;br /&gt;    InconsistentLogXptProps         = '(monitor)'&lt;br /&gt;    LogXptStatus                    = '(monitor)'&lt;br /&gt;    SendQEntries                    = '(monitor)'&lt;br /&gt;    RecvQEntries                    = '(monitor)'&lt;br /&gt;    HostName                        = 'serverb.example.com'&lt;br /&gt;    StaticConnectIdentifier         = '(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=serverb.example.com)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=orclb_DGMGRL)(INSTANCE_NAME=orclb1)(SERVER=DEDICATED)))'&lt;br /&gt;    TopWaitEvents                   = '(monitor)'&lt;br /&gt;    SidName                         = '(monitor)'&lt;br /&gt;&lt;br /&gt;  Log file locations:&lt;br /&gt;    Alert log               : /u01/app/oracle/diag/rdbms/orclb/orclb1/trace/alert_orclb1.log&lt;br /&gt;    Data Guard Broker log   : /u01/app/oracle/diag/rdbms/orclb/orclb1/trace/drcorclb1.log&lt;br /&gt;&lt;br /&gt;Database Status:&lt;br /&gt;WARNING&lt;br /&gt;&lt;/pre&gt;I can ignore standby log file warnings. They are not important for this exercise. &lt;h2&gt;Running Tests&lt;/h2&gt;&lt;h3&gt;Opening Standby Database Read-Only&lt;/h3&gt;Let us open the standby database: &lt;pre class="brush:sql;highlight:[34]"&gt;&lt;br /&gt;DGMGRL&gt; edit database orclb set state='apply-off';&lt;br /&gt;Succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt; alter database open read only;&lt;br /&gt;&lt;br /&gt;Database altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; select name from v$tempfile;&lt;br /&gt;&lt;br /&gt;NAME&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;+DATA/ORCLB/TEMPFILE/temp.267.1065539757&lt;br /&gt;+DATA/ORCLB/BC3D34CE047E62F0E0530600000AF770/TEMPFILE/temp.268.1065539759&lt;br /&gt;+DATA&lt;br /&gt;+DATA&lt;br /&gt;+DATA&lt;br /&gt;&lt;br /&gt;SQL&gt; sho pdbs&lt;br /&gt;&lt;br /&gt;    CON_ID CON_NAME                       OPEN MODE  RESTRICTED&lt;br /&gt;---------- ------------------------------ ---------- ----------&lt;br /&gt;         2 PDB$SEED                       READ ONLY  NO&lt;br /&gt;         3 PDB1                           MOUNTED&lt;br /&gt;         4 PDB2                           MOUNTED&lt;br /&gt;         5 PDB3                           MOUNTED&lt;br /&gt;SQL&gt; alter pluggable database pdb1 open read only;&lt;br /&gt;&lt;br /&gt;Pluggable database altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; alter pluggable database pdb2 open read only;&lt;br /&gt;alter pluggable database pdb2 open read only&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-01147: SYSTEM tablespace file 12 is offline&lt;br /&gt;&lt;/pre&gt;While &lt;code&gt;PDB1&lt;/code&gt; can be opened just fine, the pluggable database &lt;code&gt;PDB2&lt;/code&gt; cannot be opened as expected. Neither can &lt;code&gt;PDB3&lt;/code&gt;.&lt;br/&gt;&lt;br/&gt;Enabling standby recovery: &lt;pre class="brush:sql"&gt;&lt;br /&gt;DGMGRL&gt; edit database orclb set state='apply-on';&lt;br /&gt;Succeeded.&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Testing Data Guard Replication&lt;/h3&gt;Finally, I can check that the data guard replication works as expected: &lt;pre class="brush:sql;highlight:[5,9,27,31]"&gt;&lt;br /&gt;STANDBY&gt; alter session set container=pdb1;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;STANDBY&gt; select count(*) from new_table;&lt;br /&gt;select count(*) from new_table&lt;br /&gt;                     *&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-00942: table or view does not exist&lt;br /&gt;&lt;br /&gt;PRIMARY&gt; alter session set container=pdb1;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;PRIMARY&gt; create table new_table as select * from dba_objects;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;PRIMARY&gt; alter session set container=cdb$root;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;PRIMARY&gt; alter system archive log current;&lt;br /&gt;&lt;br /&gt;System altered.&lt;br /&gt;&lt;br /&gt;STANDBY&gt; select count(*) from new_table;&lt;br /&gt;&lt;br /&gt;  COUNT(*)&lt;br /&gt;----------&lt;br /&gt;     23043&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Adding new Pluggable Database&lt;/h3&gt;A newly added pluggable database will not be replicated due to the current &lt;code&gt;ENABLED_PDBS_ON_STANDBY&lt;/code&gt; setting. Depending on the parameter, some PDBs can be excluded and others can be replicated by default. &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; create pluggable database pdb4 admin user pdb_admin identified by pdb_admin;&lt;br /&gt;&lt;br /&gt;Pluggable database created.&lt;br /&gt;&lt;br /&gt;SQL&gt; alter pluggable database pdb4 open;&lt;br /&gt;&lt;br /&gt;Pluggable database altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; alter system archive log current;&lt;br /&gt;&lt;br /&gt;System altered.&lt;br /&gt;&lt;/pre&gt;The standby alert log shows that the PDB data files were not created: &lt;pre class="brush:sql"&gt;&lt;br /&gt;2021-02-26T15:19:29.147366+00:00&lt;br /&gt;PR00 (PID:4163): Media Recovery Log +FRA/ORCLB/ARCHIVELOG/2021_02_26/thread_1_seq_16.263.1065539909&lt;br /&gt;Recovery created pluggable database PDB4&lt;br /&gt;PDB4(6):File copy for ts-SYSTEM skipped for excluded/offline tablespace&lt;br /&gt;PDB4(6):File #20 added to control file as 'UNNAMED00020'. Originally created as:&lt;br /&gt;PDB4(6):'+DATA/ORCLA/BC3FCA17DFEB23DEE0530600000AF95F/DATAFILE/system.287.1065539949'&lt;br /&gt;PDB4(6):because the pluggable database was created with nostandby&lt;br /&gt;PDB4(6):or the tablespace belonging to the pluggable database is&lt;br /&gt;PDB4(6):offline.&lt;br /&gt;PDB4(6):File copy for ts-SYSAUX skipped for excluded/offline tablespace&lt;br /&gt;PDB4(6):File #21 added to control file as 'UNNAMED00021'. Originally created as:&lt;br /&gt;PDB4(6):'+DATA/ORCLA/BC3FCA17DFEB23DEE0530600000AF95F/DATAFILE/sysaux.285.1065539949'&lt;br /&gt;PDB4(6):because the pluggable database was created with nostandby&lt;br /&gt;PDB4(6):or the tablespace belonging to the pluggable database is&lt;br /&gt;PDB4(6):offline.&lt;br /&gt;PDB4(6):File copy for ts-UNDOTBS1 skipped for excluded/offline tablespace&lt;br /&gt;PDB4(6):File #22 added to control file as 'UNNAMED00022'. Originally created as:&lt;br /&gt;PDB4(6):'+DATA/ORCLA/BC3FCA17DFEB23DEE0530600000AF95F/DATAFILE/undotbs1.286.1065539949'&lt;br /&gt;PDB4(6):because the pluggable database was created with nostandby&lt;br /&gt;PDB4(6):or the tablespace belonging to the pluggable database is&lt;br /&gt;PDB4(6):offline.&lt;br /&gt;PDB4(6):File copy for ts-TEMP skipped for excluded/offline tablespace&lt;br /&gt;PR00 (PID:4163): Media Recovery Waiting for T-1.S-17 (in transit)&lt;br /&gt;&lt;/pre&gt;&lt;h2&gt;Conclusion&lt;/h2&gt;Oracle already has enough features to create a standby database that includes subset PDBs of the primary. Although it is possible to create a clone (non-standby) that excludes certain PDBs using the &lt;code&gt;DUPLICATE&lt;/code&gt; command, the &lt;code&gt;SKIP PLUGGABLE DATABASE&lt;/code&gt; clause cannot be used while duplicating for standby. Instead, this blog post provides an alternative solution. Another option is to use &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/multi/introduction-to-the-multitenant-architecture.html#GUID-D5AE0EBD-76CA-4E7C-8637-1D6B56597021"&gt;Refreshable Clone PDBs&lt;/a&gt; - they can be considered as a standby replacement with certain restrictions.&lt;br/&gt;&lt;br/&gt;The situation itself reminds me the Snapshot Standby Feature. I used it even before Oracle introduced the feature with a much of fuss. Depending on the customers' demand, Oracle can extend &lt;code&gt;DUPLICATE DATABASE FOR STANDBY&lt;/code&gt; to start supporting the &lt;code&gt;SKIP PLUGGABLE DATABASE&lt;/code&gt; clause.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/2926432301066901243/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/02/create-standby-skip-pluggable-database.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/2926432301066901243'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/2926432301066901243'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/02/create-standby-skip-pluggable-database.html' title='Create Standby Skip Pluggable Database'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-9146122310423454720</id><published>2021-02-24T01:13:00.000+06:00</published><updated>2021-02-24T01:13:01.179+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='OEM'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='rac'/><title type='text'>CHA Alert CHA_DBWR_CKPT_IO_COMPLETE in OEM</title><content type='html'>A customer was getting the following alerts from Oracle Enterprise Manager (OEM): &lt;pre class="brush:sql"&gt;&lt;br /&gt;Host=rac1.example.com&lt;br /&gt;Target type=Cluster&lt;br /&gt;Target name=myrac&lt;br /&gt;Message=DB Checkpoint Performance on Host rac1 Database/Cluster racdba Instance racdba1.&lt;br /&gt;The Cluster Health Advisor (CHA) detected that Database Writer (DBW) checkpoints were slow because the database writes took longer than expected to complete.&lt;br /&gt;Increase the number of DBWR processes. Add additional disks to the disk group for the database.&lt;br /&gt;Relocate the database files to faster disks or to Solid State Devices.&lt;br /&gt;If the storage subsystem supports a storage write back cache, check that the storage cache is functioning properly.&lt;br /&gt;Severity=Warning&lt;br /&gt;Event reported time=Feb 23, 2021 12:04:53 PM GMT&lt;br /&gt;Operating System=Linux&lt;br /&gt;Platform=x86_64&lt;br /&gt;Event Type=Metric Alert&lt;br /&gt;Event name=cha_alerts:cha_alert_level&lt;br /&gt;Metric Group=CHA Alerts&lt;br /&gt;Metric=Alert Level&lt;br /&gt;Metric value=Warning&lt;br /&gt;Key Value=CHA_INCIDENT_STATE_CHANGE_DATABASE_racdba_racdba1_CHA_DBWR_CKPT_IO_COMPLETE&lt;br /&gt;Key Column 1=Key&lt;br /&gt;Rule Name=SYSMAN Monitor Targets,rule 61&lt;br /&gt;Rule Owner=SYSMAN&lt;br /&gt;Update Details:&lt;br /&gt;DB Checkpoint Performance on Host rac1 Database/Cluster racdba Instance racdba1.&lt;br /&gt;The Cluster Health Advisor (CHA) detected that Database Writer (DBW) checkpoints were slow because the database writes took longer than expected to complete.&lt;br /&gt;Increase the number of DBWR processes. Add additional disks to the disk group for the database.&lt;br /&gt;Relocate the database files to faster disks or to Solid State Devices.&lt;br /&gt;If the storage subsystem supports a storage write back cache, check that the storage cache is functioning properly.&lt;br /&gt;&lt;/pre&gt;I observed some infamous checkpoint not complete messages in the alert log, so I suspected that they might be the real cause.&lt;br/&gt;Thus, I created quite small log files 20MB in size: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select group#, thread#, bytes from v$log;&lt;br /&gt;&lt;br /&gt;    GROUP#    THREAD#      BYTES&lt;br /&gt;---------- ---------- ----------&lt;br /&gt;         5          1   20971520&lt;br /&gt;         6          1   20971520&lt;br /&gt;         7          1   20971520&lt;br /&gt;         8          2   20971520&lt;br /&gt;         9          2   20971520&lt;br /&gt;        10          2   20971520&lt;br /&gt;&lt;br /&gt;6 rows selected.&lt;br /&gt;&lt;/pre&gt;Then, I wrote a script that generates a lot of redo: &lt;pre class="brush:sql"&gt;&lt;br /&gt;create table t&lt;br /&gt;as&lt;br /&gt;select o.*&lt;br /&gt;  from dba_objects o,&lt;br /&gt;       xmltable('1 to 50');&lt;br /&gt;&lt;br /&gt;update t&lt;br /&gt;   set object_name=object_name;&lt;br /&gt;&lt;/pre&gt;I ran the script and here is an excerpt from the alert log showing checkpoint not complete messages: &lt;pre class="brush:sql;highlight:[8,17,26,35]"&gt;&lt;br /&gt;2021-02-23T12:04:47.234452+00:00&lt;br /&gt;Thread 1 advanced to log sequence 114 (LGWR switch),  current SCN: 7677512&lt;br /&gt;  Current log# 6 seq# 114 mem# 0: +DATA/RACDBA/ONLINELOG/group_6.290.1065267481&lt;br /&gt;2021-02-23T12:04:47.506174+00:00&lt;br /&gt;PDB(3):Resize operation completed for file# 12, old size 645120K, new size 650240K&lt;br /&gt;2021-02-23T12:04:47.848002+00:00&lt;br /&gt;Thread 1 cannot allocate new log, sequence 115&lt;br /&gt;Checkpoint not complete&lt;br /&gt;  Current log# 6 seq# 114 mem# 0: +DATA/RACDBA/ONLINELOG/group_6.290.1065267481&lt;br /&gt;2021-02-23T12:04:50.392351+00:00&lt;br /&gt;Thread 1 advanced to log sequence 115 (LGWR switch),  current SCN: 7677540&lt;br /&gt;  Current log# 7 seq# 115 mem# 0: +DATA/RACDBA/ONLINELOG/group_7.291.1065267483&lt;br /&gt;2021-02-23T12:04:50.661220+00:00&lt;br /&gt;PDB(3):Resize operation completed for file# 12, old size 650240K, new size 655360K&lt;br /&gt;2021-02-23T12:04:50.993950+00:00&lt;br /&gt;Thread 1 cannot allocate new log, sequence 116&lt;br /&gt;Checkpoint not complete&lt;br /&gt;  Current log# 7 seq# 115 mem# 0: +DATA/RACDBA/ONLINELOG/group_7.291.1065267483&lt;br /&gt;2021-02-23T12:04:53.576282+00:00&lt;br /&gt;Thread 1 advanced to log sequence 116 (LGWR switch),  current SCN: 7677574&lt;br /&gt;  Current log# 5 seq# 116 mem# 0: +DATA/RACDBA/ONLINELOG/group_5.289.1065267477&lt;br /&gt;2021-02-23T12:04:53.845381+00:00&lt;br /&gt;PDB(3):Resize operation completed for file# 12, old size 655360K, new size 660480K&lt;br /&gt;2021-02-23T12:04:54.183174+00:00&lt;br /&gt;Thread 1 cannot allocate new log, sequence 117&lt;br /&gt;Checkpoint not complete&lt;br /&gt;  Current log# 5 seq# 116 mem# 0: +DATA/RACDBA/ONLINELOG/group_5.289.1065267477&lt;br /&gt;2021-02-23T12:04:56.721595+00:00&lt;br /&gt;Thread 1 advanced to log sequence 117 (LGWR switch),  current SCN: 7677600&lt;br /&gt;  Current log# 6 seq# 117 mem# 0: +DATA/RACDBA/ONLINELOG/group_6.290.1065267481&lt;br /&gt;2021-02-23T12:04:56.995439+00:00&lt;br /&gt;PDB(3):Resize operation completed for file# 12, old size 660480K, new size 665600K&lt;br /&gt;2021-02-23T12:04:57.332102+00:00&lt;br /&gt;Thread 1 cannot allocate new log, sequence 118&lt;br /&gt;Checkpoint not complete&lt;br /&gt;  Current log# 6 seq# 117 mem# 0: +DATA/RACDBA/ONLINELOG/group_6.290.1065267481&lt;br /&gt;&lt;/pre&gt;Shortly afterwards, I got a new CHA alert in the OEM: &lt;div class="separator" style="clear: both;"&gt;&lt;a href="https://1.bp.blogspot.com/-1bkkch7d7b8/YDT8BNcbQtI/AAAAAAAAHjM/v9D8sir_SmQGvSfzf4o6P4jBOPqleV1xgCLcBGAsYHQ/s0/oem_cha_dbwr.png" style="display: block; padding: 1em 0; text-align: center; "&gt;&lt;img alt="" border="0" width="1200" data-original-height="942" data-original-width="1897" src="https://1.bp.blogspot.com/-1bkkch7d7b8/YDT8BNcbQtI/AAAAAAAAHjM/v9D8sir_SmQGvSfzf4o6P4jBOPqleV1xgCLcBGAsYHQ/s0/oem_cha_dbwr.png"/&gt;&lt;/a&gt;&lt;/div&gt;&lt;br/&gt;To understand what is happening, firstly, I started looking for some clues in the CHA log: &lt;code&gt;/u01/app/grid/crsdata/rac1/trace/chad/ochad.trc.0&lt;/code&gt;, in which &lt;code&gt;/u01/app/grid&lt;/code&gt; is ORACLE_BASE of the grid user. &lt;pre class="brush:sql"&gt;&lt;br /&gt;[Thread-22] [ 2021-02-23 12:04:53.390 UTC ] [BNet.validate:422]  INFO: Tue Feb 23 12:04:50 UTC 2021 Decided CHA_DBWR_CKPT_IO_COMPLETE NORMAL (Belief= 94.900925  %) --&gt; ABNORMAL (Belief= 81.315659  %)&lt;br /&gt;[Thread-22] [ 2021-02-23 12:04:53.390 UTC ] [BNet.validate:429]  INFO: Tue Feb 23 12:04:50 UTC 2021      Children&lt;br /&gt;[Thread-22] [ 2021-02-23 12:04:53.391 UTC ] [BNet.validate:446]  INFO: Tue Feb 23 12:04:50 UTC 2021           DBWR IO Completion= NORMAL&lt;br /&gt;[Thread-22] [ 2021-02-23 12:04:53.391 UTC ] [BNet.validate:446]  INFO: Tue Feb 23 12:04:50 UTC 2021           log_file_switch_checkpoint_incompleteRANGE3= HIGH&lt;br /&gt;[Thread-22] [ 2021-02-23 12:04:53.391 UTC ] [EventPublisher$EventRequest.dump:193]  INFO: type:DATABASE, target:racdba, host:rac1, instance:racdba1, &lt;br /&gt;problem:CHA_DBWR_CKPT_IO_COMPLETE, state:ABNORMAL, time:2021-02-23 12:04:50,&lt;br /&gt;evidence:[{"signal":"log_file_switch_checkpoint_incomplete", "fd":"log_file_switch_checkpoint_incompleteRANGE3", "state":"HIGH", "value":1.09745E06, "pred":null, "since":"2021-02-23 12:04:50"}]&lt;br /&gt;&lt;/pre&gt;Based on the evidence above, I can conclude that CHA is checking the &lt;b&gt;log file switch (checkpoint incomplete)&lt;/b&gt; wait event: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select event, total_waits, total_timeouts, time_waited_micro&lt;br /&gt;  2    from v$system_event&lt;br /&gt;  3   where event='log file switch (checkpoint incomplete)'&lt;br /&gt;  4  /&lt;br /&gt;&lt;br /&gt;EVENT                                    TOTAL_WAITS TOTAL_TIMEOUTS TIME_WAITED_MICRO&lt;br /&gt;---------------------------------------- ----------- -------------- -----------------&lt;br /&gt;log file switch (checkpoint incomplete)          166              0         196362926&lt;br /&gt;&lt;/pre&gt;The following process accesses this file: &lt;pre class="brush:sql;highlight:[8]"&gt;&lt;br /&gt;[grid@rac1 grid]$ fuser /u01/app/grid/crsdata/rac1/trace/chad/ochad.trc.0&lt;br /&gt;/u01/app/grid/crsdata/rac1/trace/chad/ochad.trc.0: 13858&lt;br /&gt;[grid@rac1 grid]$ ps fww -p 13858&lt;br /&gt;  PID TTY      STAT   TIME COMMAND&lt;br /&gt;13858 ?        Sl     0:37 /u01/app/19.3.0/grid/jdk/bin/java -server -Xms30M -Xmx512M &lt;br /&gt;-Djava.awt.headless=true -Ddisable.checkForUpdate=true -DTRACING.ENABLED=false &lt;br /&gt;-XX:ParallelGCThreads=1 -cp /u01/app/19.3.0/grid/jlib/cha.jar:/u01/app/19.3.0/grid/jlib/chaconfig.jar:/u01/app/19.3.0/grid/jlib/cha-diag-msg.jar:/u01/app/19.3.0/grid/jlib/clsce.jar:/u01/app/19.3.0/grid/jlib/srvm.jar:/u01/app/19.3.0/grid/jlib/srvmhas.jar:/u01/app/19.3.0/grid/jlib/srvmasm.jar:/u01/app/19.3.0/grid/jlib/netcfg.jar:/u01/app/19.3.0/grid/jdbc/lib/ojdbc8.jar:/u01/app/19.3.0/grid/ucp/lib/ucp.jar:/u01/app/19.3.0/grid/jlib/fte.jar:/u01/app/19.3.0/grid/jlib/jai_core.jar:/u01/app/19.3.0/grid/jlib/mlibwrapper_jai.jar:/u01/app/19.3.0/grid/jlib/vecmath.jar:/u01/app/19.3.0/grid/jlib/jai_codec.jar:/u01/app/19.3.0/grid/jlib/jh.jar&lt;br /&gt;oracle.cha.server.CHADDriver&lt;br /&gt;&lt;/pre&gt;The corresponding CRS resource is ora.chad: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[grid@rac1 trace]$ crsctl stat res ora.chad -t&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Name           Target  State        Server                   State details&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Local Resources&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;ora.chad&lt;br /&gt;               ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;               ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;&lt;/pre&gt;It can be managed by srvctl commands: &lt;code&gt;srvctl stop/status/start cha&lt;/code&gt;.&lt;br/&gt;&lt;br/&gt;CHA is tightly integrated with the Grid Infrastructure Management Repository (GIMR). In fact, most &lt;b&gt;chactl&lt;/b&gt; commands cannot work without it. However, I do not use GIMR, and it appears that some CHA functionality is still available, at least part of it that can publish database related events to OEM. It is explained in the following whitepaper: &lt;a href="https://www.oracle.com/technetwork/database/options/clustering/ahf/learnmore/cluster-health-advisor-3867511.pdf"&gt;Oracle Database 12c Rel. 2 Cluster Health Advisor - Deep Dive How it Works and How to Use It&lt;/a&gt;&lt;br/&gt;&lt;h3&gt;Conclusion&lt;/h3&gt;I do not think that the message produced by the CHA_DBWR_CKPT_IO_COMPLETE alert has appropriate solutions: &lt;blockquote&gt;DB Checkpoint Performance on Host rac1 Database/Cluster racdba Instance racdba1. The Cluster Health Advisor (CHA) detected that Database Writer (DBW) checkpoints were slow because the database writes took longer than expected to complete. Increase the number of DBWR processes. Add additional disks to the disk group for the database. Relocate the database files to faster disks or to Solid State Devices. If the storage subsystem supports a storage write back cache, check that the storage cache is functioning properly. &lt;/blockquote&gt;It is usually much easier to increase the total redo size, either by adding additional log groups, changing the size of the existing ones, or both. All of these actions give more chances to DBWR to catch up.&lt;br/&gt;&lt;br/&gt;When there are CHA alerts in OEM, it makes sense to check the CHA log: &lt;code&gt;/u01/app/grid/crsdata/rac1/trace/chad/ochad.trc.0&lt;/code&gt;. It has some invaluable information that could reveal exactly the cause.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/9146122310423454720/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/02/cha-alert-chadbwrckptiocomplete-in-oem.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/9146122310423454720'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/9146122310423454720'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/02/cha-alert-chadbwrckptiocomplete-in-oem.html' title='CHA Alert CHA_DBWR_CKPT_IO_COMPLETE in OEM'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://1.bp.blogspot.com/-1bkkch7d7b8/YDT8BNcbQtI/AAAAAAAAHjM/v9D8sir_SmQGvSfzf4o6P4jBOPqleV1xgCLcBGAsYHQ/s72-c/oem_cha_dbwr.png' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8814487006728287460</id><published>2021-02-23T00:58:00.003+06:00</published><updated>2021-02-23T00:58:47.685+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='wrong_results'/><category scheme='http://www.blogger.com/atom/ns#' term='CBO'/><title type='text'>SU bypassed: More than 1 column in connect condition</title><content type='html'>&lt;a href="https://www.freelists.org/post/oracle-l/Optimizer-enhancements-in-199"&gt;A recent thread&lt;/a&gt; on oracle-l discussed a CBO regression that was encountered following 19.8-&gt;19.9 Release Update application.&lt;br/&gt;A simplified example that demonstrates the observed behavior: &lt;pre class="brush:sql"&gt;&lt;br /&gt;create table departments&lt;br /&gt;as&lt;br /&gt;select rownum department_id,&lt;br /&gt;       10 manager_count,&lt;br /&gt;       100 employee_count&lt;br /&gt;  from dual&lt;br /&gt;  connect by level&amp;lt;=10;&lt;br /&gt;&lt;br /&gt;create table employees&lt;br /&gt;as&lt;br /&gt;select rownum employee_id,&lt;br /&gt;       department_id,&lt;br /&gt;       lpad('x', 100, 'x') name&lt;br /&gt;  from departments,&lt;br /&gt;       lateral(&lt;br /&gt;         select level &lt;br /&gt;           from dual&lt;br /&gt;           connect by level&amp;lt;=employee_count&lt;br /&gt;       )(+);&lt;br /&gt;&lt;br /&gt;alter session set events 'trace[sql_optimizer.*]';&lt;br /&gt;explain plan for&lt;br /&gt;select *&lt;br /&gt;  from departments d&lt;br /&gt; where manager_count &gt; employee_count&lt;br /&gt;                       + (select --+ unnest&lt;br /&gt;                                 count(*)&lt;br /&gt;                            from employees e&lt;br /&gt;                           where e.department_id = d.department_id);&lt;br /&gt;&lt;/pre&gt;The last query has the following execution plans in 19.8 and 19.9 correspondingly: &lt;pre class="brush:sql;highlight:[13,14,40,58]"&gt;&lt;br /&gt;-- ----------------------------------------------------------------------------------&lt;br /&gt;-- 19.8&lt;br /&gt;-- ----------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;-------------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 1545815388&lt;br /&gt;&lt;br /&gt;------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation            | Name        | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT     |             |     1 |    35 |    11  (10)| 00:00:01 |&lt;br /&gt;|*  1 |  HASH JOIN           |             |     1 |    35 |    11  (10)| 00:00:01 |&lt;br /&gt;|   2 |   VIEW               | VW_SQ_1     |    10 |   260 |     8  (13)| 00:00:01 |&lt;br /&gt;|   3 |    HASH GROUP BY     |             |    10 |    30 |     8  (13)| 00:00:01 |&lt;br /&gt;|   4 |     TABLE ACCESS FULL| EMPLOYEES   |  1000 |  3000 |     7   (0)| 00:00:01 |&lt;br /&gt;|   5 |   TABLE ACCESS FULL  | DEPARTMENTS |    10 |    90 |     3   (0)| 00:00:01 |&lt;br /&gt;------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   1 - access("ITEM_0"="D"."DEPARTMENT_ID")&lt;br /&gt;       filter("MANAGER_COUNT"&gt;"EMPLOYEE_COUNT"+"COUNT(*)")&lt;br /&gt;&lt;br /&gt;18 rows selected.&lt;br /&gt;&lt;br /&gt;-- ----------------------------------------------------------------------------------&lt;br /&gt;-- 19.9&lt;br /&gt;-- ----------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;-------------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 1015098386&lt;br /&gt;&lt;br /&gt;-----------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation           | Name        | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;-----------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT    |             |     1 |     9 |    38   (0)| 00:00:01 |&lt;br /&gt;|*  1 |  FILTER             |             |       |       |            |          |&lt;br /&gt;|   2 |   TABLE ACCESS FULL | DEPARTMENTS |    10 |    90 |     3   (0)| 00:00:01 |&lt;br /&gt;|   3 |   SORT AGGREGATE    |             |     1 |     3 |            |          |&lt;br /&gt;|*  4 |    TABLE ACCESS FULL| EMPLOYEES   |   100 |   300 |     7   (0)| 00:00:01 |&lt;br /&gt;-----------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   1 - filter("MANAGER_COUNT"&gt;"EMPLOYEE_COUNT"+ (SELECT /*+ UNNEST */&lt;br /&gt;              COUNT(*) FROM "EMPLOYEES" "E" WHERE "E"."DEPARTMENT_ID"=:B1))&lt;br /&gt;   4 - filter("E"."DEPARTMENT_ID"=:B1)&lt;br /&gt;&lt;br /&gt;Hint Report (identified by operation id / Query Block Name / Object Alias):&lt;br /&gt;Total hints for statement: 1 (U - Unused (1))&lt;br /&gt;---------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;   3 -  SEL$2&lt;br /&gt;         U -  unnest / Failed basic validity checks&lt;br /&gt;&lt;br /&gt;25 rows selected.&lt;br /&gt;&lt;/pre&gt;It can be seen that subquery unnesting does not happen in 19.9 anymore. Even worse than that, the outline/SQL Plan Baseline from 19.8 fails to reproduce in 19.9. That change by itself can have an adverse effect on the existing queries, e.g.: &lt;pre class="brush:sql;highlight:[15,28,46,59]"&gt;&lt;br /&gt;SQL&gt; select --+ gather_plan_statistics&lt;br /&gt;  2         *&lt;br /&gt;  3    from departments d&lt;br /&gt;  4   where manager_count &gt; employee_count&lt;br /&gt;  5                         + (select --+ unnest&lt;br /&gt;  6                                   count(*)&lt;br /&gt;  7                              from employees e&lt;br /&gt;  8                             where e.department_id = d.department_id);&lt;br /&gt;&lt;br /&gt;no rows selected&lt;br /&gt;&lt;br /&gt;SQL&gt; select * from dbms_xplan.display_cursor(format=&gt; 'allstats last');&lt;br /&gt;&lt;br /&gt;-- ----------------------------------------------------------------------------------&lt;br /&gt;-- 19.8&lt;br /&gt;-- ----------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL_ID  8gcr6b9xkkqv0, child number 0&lt;br /&gt;-------------------------------------&lt;br /&gt;&lt;br /&gt;Plan hash value: 1545815388&lt;br /&gt;&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation            | Name        | Starts | E-Rows | A-Rows |   A-Time   | Buffers | Reads  |  OMem |  1Mem | Used-Mem |&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT     |             |      1 |        |      0 |00:00:00.01 |      20 |     16 |       |       |          |&lt;br /&gt;|*  1 |  HASH JOIN           |             |      1 |      1 |      0 |00:00:00.01 |      20 |     16 |  2078K|  2078K|  551K (0)|&lt;br /&gt;|   2 |   VIEW               | VW_SQ_1     |      1 |     10 |     10 |00:00:00.01 |      18 |     16 |       |       |          |&lt;br /&gt;|   3 |    HASH GROUP BY     |             |      1 |     10 |     10 |00:00:00.01 |      18 |     16 |  1558K|  1558K|  666K (0)|&lt;br /&gt;|   4 |     TABLE ACCESS FULL| EMPLOYEES   |      1 |   1000 |   1000 |00:00:00.01 |      18 |     16 |       |       |          |&lt;br /&gt;|   5 |   TABLE ACCESS FULL  | DEPARTMENTS |      1 |     10 |     10 |00:00:00.01 |       2 |      0 |       |       |          |&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   1 - access("ITEM_0"="D"."DEPARTMENT_ID")&lt;br /&gt;       filter("MANAGER_COUNT"&gt;"EMPLOYEE_COUNT"+"COUNT(*)")&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;27 rows selected.&lt;br /&gt;&lt;br /&gt;-- ----------------------------------------------------------------------------------&lt;br /&gt;-- 19.9&lt;br /&gt;-- ----------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL_ID  8gcr6b9xkkqv0, child number 0&lt;br /&gt;-------------------------------------&lt;br /&gt;&lt;br /&gt;Plan hash value: 1015098386&lt;br /&gt;&lt;br /&gt;------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation           | Name        | Starts | E-Rows | A-Rows |   A-Time   | Buffers | Reads  |&lt;br /&gt;------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT    |             |      1 |        |      0 |00:00:00.01 |     182 |     16 |&lt;br /&gt;|*  1 |  FILTER             |             |      1 |        |      0 |00:00:00.01 |     182 |     16 |&lt;br /&gt;|   2 |   TABLE ACCESS FULL | DEPARTMENTS |      1 |     10 |     10 |00:00:00.01 |       2 |      0 |&lt;br /&gt;|   3 |   SORT AGGREGATE    |             |     10 |      1 |     10 |00:00:00.01 |     180 |     16 |&lt;br /&gt;|*  4 |    TABLE ACCESS FULL| EMPLOYEES   |     10 |    100 |   1000 |00:00:00.01 |     180 |     16 |&lt;br /&gt;------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   1 - filter("MANAGER_COUNT"&gt;"EMPLOYEE_COUNT"+)&lt;br /&gt;   4 - filter("E"."DEPARTMENT_ID"=:B1)&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;26 rows selected.&lt;br /&gt;&lt;/pre&gt;The buffer gets goes from 20 in 19.8 to 182 in 19.9 for this simple query.&lt;br/&gt;The 10053 trace file provides more details regarding that SU bypass: &lt;pre class="brush:sql;highlight:[16]"&gt;&lt;br /&gt;SQE: Query after SQ elimination:******* UNPARSED QUERY IS *******&lt;br /&gt;SELECT "D"."DEPARTMENT_ID" "DEPARTMENT_ID",&lt;br /&gt;       "D"."MANAGER_COUNT" "MANAGER_COUNT",&lt;br /&gt;       "D"."EMPLOYEE_COUNT" "EMPLOYEE_COUNT"&lt;br /&gt;  FROM "TC"."DEPARTMENTS" "D"&lt;br /&gt; WHERE "D"."MANAGER_COUNT"&gt;"D"."EMPLOYEE_COUNT"&lt;br /&gt;                          + (SELECT /*+ UNNEST */ &lt;br /&gt;                                    COUNT(*) "COUNT(*)"&lt;br /&gt;                               FROM "TC"."EMPLOYEES" "E"&lt;br /&gt;                              WHERE "E"."DEPARTMENT_ID"="D"."DEPARTMENT_ID")&lt;br /&gt;SU: Considering subquery unnesting in query block SEL$1 (#0)&lt;br /&gt;********************&lt;br /&gt;Subquery Unnest (SU)&lt;br /&gt;********************&lt;br /&gt;SU:   Checking validity of unnesting subquery SEL$2 (#0)&lt;br /&gt;SU:     SU bypassed: More than 1 column in connect condition.&lt;br /&gt;SU:     SU bypassed: Failed basic validity checks.&lt;br /&gt;SU:   Validity checks failed.&lt;br /&gt;&lt;/pre&gt;I believe the SU bypass was introduced by the fix for &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=30593046.8"&gt;bug 30593046 - A query having a scalar subquery returned a wrong result (Doc ID 30593046.8)&lt;/a&gt;.&lt;br/&gt;To demonstrate that, let us add a new department to the DEPARTMENTS table that has no corresponding row in EMPLOYEES: &lt;pre class="brush:sql;highlight:[16,19,34,52,57,72]"&gt;&lt;br /&gt;SQL&gt; insert into departments values (100, 1, 0);&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select --+ gather_plan_statistics&lt;br /&gt;  2         *&lt;br /&gt;  3    from departments d&lt;br /&gt;  4   where manager_count &gt; employee_count&lt;br /&gt;  5                         + (select --+ unnest&lt;br /&gt;  6                                   count(*)&lt;br /&gt;  7                              from employees e&lt;br /&gt;  8                             where e.department_id = d.department_id);&lt;br /&gt;  &lt;br /&gt;-- ----------------------------------------------------------------------------------&lt;br /&gt;-- 19.8 - PRODUCES WRONG RESULTS! no rows selected &lt;br /&gt;-- ----------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;no rows selected&lt;br /&gt;&lt;br /&gt;SQL&gt; select * from dbms_xplan.display_cursor(format=&gt; 'allstats last');&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL_ID  8gcr6b9xkkqv0, child number 0&lt;br /&gt;-------------------------------------&lt;br /&gt;&lt;br /&gt;Plan hash value: 1545815388&lt;br /&gt;&lt;br /&gt;-------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation            | Name        | Starts | E-Rows | A-Rows |   A-Time   | Buffers |  OMem |  1Mem | Used-Mem |&lt;br /&gt;-------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT     |             |      1 |        |      0 |00:00:00.01 |      24 |       |       |          |&lt;br /&gt;|*  1 |  HASH JOIN           |             |      1 |      1 |      0 |00:00:00.01 |      24 |  2078K|  2078K|  545K (0)|&lt;br /&gt;|   2 |   VIEW               | VW_SQ_1     |      1 |     10 |     10 |00:00:00.01 |      18 |       |       |          |&lt;br /&gt;|   3 |    HASH GROUP BY     |             |      1 |     10 |     10 |00:00:00.01 |      18 |  1558K|  1558K|  659K (0)|&lt;br /&gt;|   4 |     TABLE ACCESS FULL| EMPLOYEES   |      1 |   1000 |   1000 |00:00:00.01 |      18 |       |       |          |&lt;br /&gt;|   5 |   TABLE ACCESS FULL  | DEPARTMENTS |      1 |     10 |     11 |00:00:00.01 |       6 |       |       |          |&lt;br /&gt;-------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   1 - access("ITEM_0"="D"."DEPARTMENT_ID")&lt;br /&gt;       filter("MANAGER_COUNT"&gt;"EMPLOYEE_COUNT"+"COUNT(*)")&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;27 rows selected.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;-- ----------------------------------------------------------------------------------&lt;br /&gt;-- 19.9 - CORRECTLY RETURNS ONE ROW&lt;br /&gt;-- ----------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;DEPARTMENT_ID MANAGER_COUNT EMPLOYEE_COUNT&lt;br /&gt;------------- ------------- --------------&lt;br /&gt;          100             1              0&lt;br /&gt;&lt;br /&gt;SQL&gt; select * from dbms_xplan.display_cursor(format=&gt; 'allstats last');&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL_ID  8gcr6b9xkkqv0, child number 0&lt;br /&gt;-------------------------------------&lt;br /&gt;&lt;br /&gt;Plan hash value: 1015098386&lt;br /&gt;&lt;br /&gt;---------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation           | Name        | Starts | E-Rows | A-Rows |   A-Time   | Buffers |&lt;br /&gt;---------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT    |             |      1 |        |      1 |00:00:00.01 |     204 |&lt;br /&gt;|*  1 |  FILTER             |             |      1 |        |      1 |00:00:00.01 |     204 |&lt;br /&gt;|   2 |   TABLE ACCESS FULL | DEPARTMENTS |      1 |     10 |     11 |00:00:00.01 |       6 |&lt;br /&gt;|   3 |   SORT AGGREGATE    |             |     11 |      1 |     11 |00:00:00.01 |     198 |&lt;br /&gt;|*  4 |    TABLE ACCESS FULL| EMPLOYEES   |     11 |    100 |   1000 |00:00:00.01 |     198 |&lt;br /&gt;---------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   1 - filter("MANAGER_COUNT"&gt;"EMPLOYEE_COUNT"+)&lt;br /&gt;   4 - filter("E"."DEPARTMENT_ID"=:B1)&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;26 rows selected.&lt;br /&gt;&lt;/pre&gt;It is worth noting that a similar query that uses one column from DEPARTMENTS has a proper outer join in both 19.8 and 19.9: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; explain plan for&lt;br /&gt;  2  select *&lt;br /&gt;  3    from departments d&lt;br /&gt;  4   where employee_count &gt; (select --+ unnest&lt;br /&gt;  5                                  count(*)&lt;br /&gt;  6                             from employees e&lt;br /&gt;  7                            where e.department_id = d.department_id);&lt;br /&gt;&lt;br /&gt;Explained.&lt;br /&gt;&lt;br /&gt;SQL&gt; select * from dbms_xplan.display();&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;-------------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 4272783132&lt;br /&gt;&lt;br /&gt;-------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation             | Name        | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;-------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT      |             |    10 |   350 |    11  (10)| 00:00:01 |&lt;br /&gt;|*  1 |  FILTER               |             |       |       |            |          |&lt;br /&gt;|*  2 |   HASH JOIN OUTER     |             |    10 |   350 |    11  (10)| 00:00:01 |&lt;br /&gt;|   3 |    TABLE ACCESS FULL  | DEPARTMENTS |    10 |    90 |     3   (0)| 00:00:01 |&lt;br /&gt;|   4 |    VIEW               | VW_SQ_1     |    10 |   260 |     8  (13)| 00:00:01 |&lt;br /&gt;|   5 |     HASH GROUP BY     |             |    10 |    30 |     8  (13)| 00:00:01 |&lt;br /&gt;|   6 |      TABLE ACCESS FULL| EMPLOYEES   |  1000 |  3000 |     7   (0)| 00:00:01 |&lt;br /&gt;-------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   1 - filter("COUNT(*)" IS NULL AND "EMPLOYEE_COUNT"&gt;0 OR&lt;br /&gt;              "EMPLOYEE_COUNT"&gt;"COUNT(*)")&lt;br /&gt;   2 - access("ITEM_1"(+)="D"."DEPARTMENT_ID")&lt;br /&gt;&lt;br /&gt;20 rows selected.&lt;br /&gt;&lt;/pre&gt;It made me think that it should be possible to obtain the desired transformation in 19.9 by rewriting the query. Sure enough, I verified that both non-mergeable view or temp table transformation can be used for that: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; explain plan for&lt;br /&gt;  2  with d as (&lt;br /&gt;  3    select --+ no_merge&lt;br /&gt;  4           d.*, manager_count - employee_count employee_diff&lt;br /&gt;  5      from departments d)&lt;br /&gt;  6  select *&lt;br /&gt;  7    from d&lt;br /&gt;  8   where employee_diff &gt; (select --+ unnest&lt;br /&gt;  9                                 count(*)&lt;br /&gt; 10                            from employees e&lt;br /&gt; 11                           where e.department_id = d.department_id);&lt;br /&gt;&lt;br /&gt;Explained.&lt;br /&gt;&lt;br /&gt;SQL&gt; select * from dbms_xplan.display();&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;-------------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 1773562247&lt;br /&gt;&lt;br /&gt;-------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation             | Name        | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;-------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT      |             |    10 |   780 |    11  (10)| 00:00:01 |&lt;br /&gt;|*  1 |  FILTER               |             |       |       |            |          |&lt;br /&gt;|*  2 |   HASH JOIN OUTER     |             |    10 |   780 |    11  (10)| 00:00:01 |&lt;br /&gt;|   3 |    VIEW               |             |    10 |   520 |     3   (0)| 00:00:01 |&lt;br /&gt;|   4 |     TABLE ACCESS FULL | DEPARTMENTS |    10 |    90 |     3   (0)| 00:00:01 |&lt;br /&gt;|   5 |    VIEW               | VW_SQ_1     |    10 |   260 |     8  (13)| 00:00:01 |&lt;br /&gt;|   6 |     HASH GROUP BY     |             |    10 |    30 |     8  (13)| 00:00:01 |&lt;br /&gt;|   7 |      TABLE ACCESS FULL| EMPLOYEES   |  1000 |  3000 |     7   (0)| 00:00:01 |&lt;br /&gt;-------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   1 - filter("COUNT(*)" IS NULL AND "EMPLOYEE_DIFF"&gt;0 OR&lt;br /&gt;              "EMPLOYEE_DIFF"&gt;"COUNT(*)")&lt;br /&gt;   2 - access("ITEM_1"(+)="D"."DEPARTMENT_ID")&lt;br /&gt;&lt;br /&gt;21 rows selected.&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Conclusion&lt;/h3&gt;&lt;a href="https://www.freelists.org/post/oracle-l/Optimizer-enhancements-in-199,3"&gt;As Jonathan Lewis remarked&lt;/a&gt; there are usually certain reasons for such changes of the existing optimizer behavior: &lt;blockquote cite="https://www.freelists.org/post/oracle-l/Optimizer-enhancements-in-199,3"&gt;Various possibilties.&lt;br/&gt;a) Oracle Corp. has realised that there's a boundary condition with this pattern that could produce wrong results and blocks the transformation (e.g. are either of lastmoddate and lastmodtime declared not null - if not the unnest ought to be invalid) &lt;br/&gt;b) Oracle Corp. has modified the optimizer code to produced more efficient plans in almost all cases, but the change introduces certain restrictiions that your SQL now meets (e.g. even if both lastmoddate and lastmodetime the code may now assume that to_char() or to_date() could produce a null from a non-null. &lt;br/&gt;c) Some relatively simple code change has introduced a bug &lt;/blockquote&gt;Although it is quite unfortunate there is no fix control or any other backout switching bringing back the old behavior (as far as I am aware), Oracle actually introduced a fix for the wrong results issue. It might be the lesser of two evils.&lt;br/&gt;The script to this post is available in &lt;a href="https://github.com/mvelikikh/oracle/blob/master/blog/202102_su_bypassed_more_than_1_column_in_connect_condition/su.sql"&gt;my GitHub repo&lt;/a&gt;.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/8814487006728287460/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/02/su-bypassed-more-than-1-column-in.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8814487006728287460'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8814487006728287460'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/02/su-bypassed-more-than-1-column-in.html' title='SU bypassed: More than 1 column in connect condition'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-7238625606958994994</id><published>2021-02-12T22:39:00.004+06:00</published><updated>2021-02-12T23:12:58.153+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='re'/><category scheme='http://www.blogger.com/atom/ns#' term='_kgl_debug'/><title type='text'>Tracing Library Cache Locks Using _kgl_debug</title><content type='html'>&lt;a href="https://nenadnoveljic.com/blog/library-cache-lock-debugger/"&gt;A recent blog post&lt;/a&gt; from Nenad Noveljic prompted me to review the library cache tracing facilities available in Oracle database.&lt;br/&gt;&lt;br/&gt;After a bit of tinkering I discovered the actual library cache lock tracing is governed by the &lt;b&gt;&lt;i&gt;_kgl_debug&lt;/i&gt;&lt;/b&gt; parameter.&lt;br/&gt;&lt;br/&gt;Here is a little sample code to demonstrate that - I borrowed part of it from &lt;a href="https://nenadnoveljic.com/blog/library-cache-lock-debugger/"&gt;the excellent Nenad's blog post&lt;/a&gt;: &lt;pre class="brush:sql;highlight:[14]"&gt;&lt;br /&gt;SQL&gt; create table t (n1 integer,n2 integer);&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt; create index ix_t on t(n1,n2);&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;br /&gt;SQL&gt; exec dbms_stats.gather_table_stats ('', 'T', cascade =&gt; true)&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter system set "_kgl_debug"=32 scope=memory;&lt;br /&gt;&lt;br /&gt;System altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter index ix_t invisible ;&lt;br /&gt;&lt;br /&gt;Index altered.&lt;br /&gt;&lt;/pre&gt;In a nutshell, &lt;b&gt;&lt;i&gt;_kgl_debug=32&lt;/i&gt;&lt;/b&gt; appears to result in writing information about library cache locks in the trace file. Here is how it looks: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; col trace_file old_v tf for a72&lt;br /&gt;SQL&gt; col dirname old_v dn for a50&lt;br /&gt;SQL&gt; col basename old_v bn for a21&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select value trace_file,&lt;br /&gt;  2         substr(value, 1, instr(value, '/', -1)-1) dirname,&lt;br /&gt;  3         substr(value, instr(value, '/', -1)+1) basename&lt;br /&gt;  4    from v$diag_info&lt;br /&gt;  5   where name='Default Trace File';&lt;br /&gt;&lt;br /&gt;TRACE_FILE                                                               DIRNAME                                            BASENAME&lt;br /&gt;------------------------------------------------------------------------ -------------------------------------------------- ---------------------&lt;br /&gt;/u01/app/oracle/diag/rdbms/racdba/racdba1/trace/racdba1_ora_16440.trc    /u01/app/oracle/diag/rdbms/racdba/racdba1/trace    racdba1_ora_16440.trc&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; ho tail -64 &amp;tf.&lt;br /&gt;    &amp;lt;Mode&gt;N&amp;lt;/Mode&gt;&lt;br /&gt;  &amp;lt;/LibraryObjectLock&gt;&lt;br /&gt;&amp;lt;/KGLTRACE&gt;&lt;br /&gt;&amp;lt;KGLTRACE&gt;&lt;br /&gt;  &amp;lt;Timestamp&gt;2021-02-12 15:41:23.656&amp;lt;/Timestamp&gt;&lt;br /&gt;  &amp;lt;SID&gt;136&amp;lt;/SID&gt;&lt;br /&gt;  &amp;lt;Function&gt;kglLock&amp;lt;/Function&gt;&lt;br /&gt;  &amp;lt;Reason&gt;TRACELOCK&amp;lt;/Reason&gt;&lt;br /&gt;  &amp;lt;Param1&gt;0x706c20e0&amp;lt;/Param1&gt;&lt;br /&gt;  &amp;lt;Param2&gt;1&amp;lt;/Param2&gt;&lt;br /&gt;  &amp;lt;LibraryHandle&gt;&lt;br /&gt;    &amp;lt;Address&gt;0x67f78888&amp;lt;/Address&gt;&lt;br /&gt;    &amp;lt;Hash&gt;94e2179b&amp;lt;/Hash&gt;&lt;br /&gt;    &amp;lt;LockMode&gt;N&amp;lt;/LockMode&gt;&lt;br /&gt;    &amp;lt;PinMode&gt;0&amp;lt;/PinMode&gt;&lt;br /&gt;    &amp;lt;LoadLockMode&gt;0&amp;lt;/LoadLockMode&gt;&lt;br /&gt;    &amp;lt;Status&gt;VALD&amp;lt;/Status&gt;&lt;br /&gt;    &amp;lt;ObjectName&gt;&lt;br /&gt;      &amp;lt;Name&gt;select value trace_file,&lt;br /&gt;       substr(value, 1, instr(value, '/', -1)-1) dirname,&lt;br /&gt;       substr(value, instr(value, '/', -1)+1) basename&lt;br /&gt;  from v$diag_info&lt;br /&gt; where name='Default Trace File'&amp;lt;/Name&gt;&lt;br /&gt;      &amp;lt;FullHashValue&gt;8c302f585b9b9a83239f686f94e2179b&amp;lt;/FullHashValue&gt;&lt;br /&gt;      &amp;lt;Namespace&gt;SQL AREA(00)&amp;lt;/Namespace&gt;&lt;br /&gt;      &amp;lt;Type&gt;CURSOR(00)&amp;lt;/Type&gt;&lt;br /&gt;      &amp;lt;ContainerId&gt;1&amp;lt;/ContainerId&gt;&lt;br /&gt;      &amp;lt;ContainerUid&gt;1&amp;lt;/ContainerUid&gt;&lt;br /&gt;      &amp;lt;Identifier&gt;2497845147&amp;lt;/Identifier&gt;&lt;br /&gt;      &amp;lt;OwnerIdn&gt;89&amp;lt;/OwnerIdn&gt;&lt;br /&gt;    &amp;lt;/ObjectName&gt;&lt;br /&gt;  &amp;lt;/LibraryHandle&gt;&lt;br /&gt;  &amp;lt;LibraryObjectLock&gt;&lt;br /&gt;    &amp;lt;Address&gt;0x706c20e0&amp;lt;/Address&gt;&lt;br /&gt;    &amp;lt;Handle&gt;0x67f78888&amp;lt;/Handle&gt;&lt;br /&gt;    &amp;lt;Mode&gt;N&amp;lt;/Mode&gt;&lt;br /&gt;  &amp;lt;/LibraryObjectLock&gt;&lt;br /&gt;&amp;lt;/KGLTRACE&gt;&lt;br /&gt;&amp;lt;KGLTRACE&gt;&lt;br /&gt;  &amp;lt;Timestamp&gt;2021-02-12 15:41:23.657&amp;lt;/Timestamp&gt;&lt;br /&gt;  &amp;lt;SID&gt;136&amp;lt;/SID&gt;&lt;br /&gt;  &amp;lt;Function&gt;kgllkal&amp;lt;/Function&gt;&lt;br /&gt;  &amp;lt;Reason&gt;TRACELOCK&amp;lt;/Reason&gt;&lt;br /&gt;  &amp;lt;Param1&gt;0x706c1ff8&amp;lt;/Param1&gt;&lt;br /&gt;  &amp;lt;Param2&gt;0&amp;lt;/Param2&gt;&lt;br /&gt;  &amp;lt;LibraryHandle&gt;&lt;br /&gt;    &amp;lt;Address&gt;0x67f78328&amp;lt;/Address&gt;&lt;br /&gt;    &amp;lt;Hash&gt;0&amp;lt;/Hash&gt;&lt;br /&gt;    &amp;lt;LockMode&gt;N&amp;lt;/LockMode&gt;&lt;br /&gt;    &amp;lt;PinMode&gt;0&amp;lt;/PinMode&gt;&lt;br /&gt;    &amp;lt;LoadLockMode&gt;0&amp;lt;/LoadLockMode&gt;&lt;br /&gt;    &amp;lt;Status&gt;VALD&amp;lt;/Status&gt;&lt;br /&gt;    &amp;lt;Name&gt;&lt;br /&gt;      &amp;lt;Namespace&gt;SQL AREA(00)&amp;lt;/Namespace&gt;&lt;br /&gt;      &amp;lt;Type&gt;CURSOR(00)&amp;lt;/Type&gt;&lt;br /&gt;      &amp;lt;ContainerId&gt;3&amp;lt;/ContainerId&gt;&lt;br /&gt;    &amp;lt;/Name&gt;&lt;br /&gt;  &amp;lt;/LibraryHandle&gt;&lt;br /&gt;  &amp;lt;LibraryObjectLock&gt;&lt;br /&gt;    &amp;lt;Address&gt;0x706c1ff8&amp;lt;/Address&gt;&lt;br /&gt;    &amp;lt;Handle&gt;0x67f78328&amp;lt;/Handle&gt;&lt;br /&gt;    &amp;lt;Mode&gt;N&amp;lt;/Mode&gt;&lt;br /&gt;  &amp;lt;/LibraryObjectLock&gt;&lt;br /&gt;&amp;lt;/KGLTRACE&gt;&lt;br /&gt;&lt;/pre&gt;It is quite convenient that the trace data is provided in XML - it can be parsed easily: &lt;pre class="brush:sql;highlight:[40,43]"&gt;&lt;br /&gt;SQL&gt; create or replace directory trace_dir as '&amp;dn.';&lt;br /&gt;old   1: create or replace directory trace_dir as '&amp;dn.'&lt;br /&gt;new   1: create or replace directory trace_dir as '/u01/app/oracle/diag/rdbms/racdba/racdba1/trace'&lt;br /&gt;&lt;br /&gt;Directory created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create table trace_ext (&lt;br /&gt;  2    trace_data clob&lt;br /&gt;  3  )&lt;br /&gt;  4  organization external (&lt;br /&gt;  5    type oracle_loader&lt;br /&gt;  6    default directory trace_dir&lt;br /&gt;  7    access parameters (&lt;br /&gt;  8      records&lt;br /&gt;  9      xmltag ("KGLTRACE")&lt;br /&gt; 10      fields ldrtrim&lt;br /&gt; 11      missing field values are null (&lt;br /&gt; 12        trace_data char(1000000)&lt;br /&gt; 13      )&lt;br /&gt; 14    )&lt;br /&gt; 15    location ('&amp;bn.')&lt;br /&gt; 16  )&lt;br /&gt; 17  reject limit unlimited;&lt;br /&gt;old  15:   location ('&amp;bn.')&lt;br /&gt;new  15:   location ('racdba1_ora_16440.trc')&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select count(*) from trace_ext;&lt;br /&gt;&lt;br /&gt;  COUNT(*)&lt;br /&gt;----------&lt;br /&gt;       275&lt;br /&gt;&lt;br /&gt;SQL&gt; ho grep KGLTRACE &amp;tf. | wc -l&lt;br /&gt;550&lt;br /&gt;&lt;/pre&gt;Looks good. 275 rows in the external table for 550 KGLTRACE tags - these are both opening and closing tags, so that the number of rows matches precisely the number of XML elements in the trace file.&lt;br/&gt;&lt;br/&gt;Finally, we can retrieve the information about &lt;b&gt;&lt;i&gt;kgllkal&lt;/i&gt;&lt;/b&gt; calls for interesting objects: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select xt."Timestamp",&lt;br /&gt;  2         xt."Function",&lt;br /&gt;  3         xt."Reason",&lt;br /&gt;  4         xt."Param1",&lt;br /&gt;  5         lh."LockMode",&lt;br /&gt;  6         lh."PinMode",&lt;br /&gt;  7         obj."Name",&lt;br /&gt;  8         obj."Namespace",&lt;br /&gt;  9         obj."Type",&lt;br /&gt; 10         lol."Address" lol_address,&lt;br /&gt; 11         lol."Mode" lol_mode&lt;br /&gt; 12    from trace_ext,&lt;br /&gt; 13         xmltable('/KGLTRACE' passing xmltype(trace_data)&lt;br /&gt; 14           columns "Timestamp" varchar2(24),&lt;br /&gt; 15                   sid number,&lt;br /&gt; 16                   "Function" varchar2(20),&lt;br /&gt; 17                   "Reason" varchar2(10),&lt;br /&gt; 18                   "Param1" varchar2(14),&lt;br /&gt; 19                   "Param2" number,&lt;br /&gt; 20                   "LibraryHandle" xmltype,&lt;br /&gt; 21                   "LibraryObjectLock" xmltype&lt;br /&gt; 22         )(+) xt,&lt;br /&gt; 23         xmltable('/LibraryHandle' passing xt."LibraryHandle"&lt;br /&gt; 24           columns "Address" varchar2(10),&lt;br /&gt; 25                   "Hash" varchar2(10),&lt;br /&gt; 26                   "LockMode" varchar2(8),&lt;br /&gt; 27                   "PinMode" varchar2(8),&lt;br /&gt; 28                   "LoadLockMode" varchar2(8),&lt;br /&gt; 29                   "Status" varchar2(10),&lt;br /&gt; 30                   "ObjectName" xmltype&lt;br /&gt; 31         )(+) lh,&lt;br /&gt; 32         xmltable('/ObjectName' passing lh."ObjectName"&lt;br /&gt; 33           columns "Name" varchar2(64),&lt;br /&gt; 34                   "FullHashValue" varchar2(32),&lt;br /&gt; 35                   "Namespace" varchar2(32),&lt;br /&gt; 36                   "Type" varchar2(32),&lt;br /&gt; 37                   "ContainerId" number,&lt;br /&gt; 38                   "ContainerUid" number,&lt;br /&gt; 39                   "Identifier" number,&lt;br /&gt; 40                   "OwnerIdn" number&lt;br /&gt; 41         )(+) obj,&lt;br /&gt; 42         xmltable('/LibraryObjectLock' passing xt."LibraryObjectLock"&lt;br /&gt; 43           columns "Address" varchar2(10),&lt;br /&gt; 44                   "Handle" varchar2(10),&lt;br /&gt; 45                   "Mode"   varchar2(4)&lt;br /&gt; 46         )(+) lol&lt;br /&gt; 47   where 1=1&lt;br /&gt; 48     and obj."Name" like '%PDB.TC.%'&lt;br /&gt; 49     and xt."Function"='kgllkal';&lt;br /&gt;&lt;br /&gt;Timestamp                Function Reason     Param1         LockMode PinMode  Name            Namespace            Type       LOL_ADDRES LOL_MODE&lt;br /&gt;------------------------ -------- ---------- -------------- -------- -------- --------------- -------------------- ---------- ---------- --------&lt;br /&gt;2021-02-12 15:41:23.595  kgllkal  TRACELOCK  0x62da2ef0     S        0        PDB.TC.IX_T     INDEX(04)            INDEX(01)  0x62da2ef0 S&lt;br /&gt;2021-02-12 15:41:23.598  kgllkal  TRACELOCK  0x62da2ef0     S        0        PDB.TC.T        TABLE/PROCEDURE(01)  TABLE(02)  0x62da2ef0 S&lt;br /&gt;2021-02-12 15:41:23.599  kgllkal  TRACELOCK  0x62c9f8d0     S        0        PDB.TC.IX_T     INDEX(04)            INDEX(01)  0x62c9f8d0 S&lt;br /&gt;2021-02-12 15:41:23.601  kgllkal  TRACELOCK  0x62c9f8d0     S        S        PDB.TC.T        TABLE/PROCEDURE(01)  TABLE(02)  0x62c9f8d0 S&lt;br /&gt;2021-02-12 15:41:23.613  kgllkal  TRACELOCK  0x65db4480     S        0        PDB.TC.IX_T     INDEX(04)            INDEX(01)  0x65db4480 S&lt;br /&gt;2021-02-12 15:41:23.617  kgllkal  TRACELOCK  0x65db4480     S        0        PDB.TC.T        TABLE/PROCEDURE(01)  TABLE(02)  0x65db4480 S&lt;br /&gt;2021-02-12 15:41:23.618  kgllkal  TRACELOCK  0x62db5708     S        0        PDB.TC.IX_T     INDEX(04)            INDEX(01)  0x62db5708 S&lt;br /&gt;2021-02-12 15:41:23.626  kgllkal  TRACELOCK  0x65db4480     S        0        PDB.TC.IX_T     INDEX(04)            INDEX(01)  0x65db4480 S&lt;br /&gt;2021-02-12 15:41:23.629  kgllkal  TRACELOCK  0x65db4480     X        0        PDB.TC.T        TABLE/PROCEDURE(01)  TABLE(02)  0x65db4480 X&lt;br /&gt;2021-02-12 15:41:23.632  kgllkal  TRACELOCK  0x62da2ef0     X        0        PDB.TC.IX_T     INDEX(04)            INDEX(01)  0x62da2ef0 X&lt;br /&gt;&lt;br /&gt;10 rows selected.&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Conclusion&lt;/h3&gt;We can trace library cache locks, or more specifically certain &lt;b&gt;&lt;i&gt;kgllkal&lt;/i&gt;&lt;/b&gt; calls. The resulting trace data is written to the trace file in the XML format. It can be loaded into the database for further analysis. &lt;h3&gt;Usual disclaimer&lt;/h3&gt;This blog post is a pure speculation. Although the results might be be reasonable and suggestive, I have no idea whether or not &lt;b&gt;&lt;i&gt;_kgl_debug=32&lt;/i&gt;&lt;/b&gt; covers all or most library cache locks. </content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/7238625606958994994/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/02/tracing-library-cache-locks-using.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7238625606958994994'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7238625606958994994'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/02/tracing-library-cache-locks-using.html' title='Tracing Library Cache Locks Using _kgl_debug'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-2164482405422350541</id><published>2021-02-12T02:23:00.000+06:00</published><updated>2021-02-12T02:23:35.613+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='rac'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><title type='text'>Diagnosing Cluster Verification Utility (CVU) Errors</title><content type='html'>A cluster verification utility (CVU) command failed with the following error: &lt;pre class="brush:sql;highlight:[3,10]"&gt;&lt;br /&gt;[grid@rac1 ~]$ cluvfy comp vdisk -n rac1 -verbose&lt;br /&gt;&lt;br /&gt;Verifying Voting Disk ...FAILED (PRVF-5157, PRVF-5431)&lt;br /&gt;&lt;br /&gt;Verification of Voting Disk was unsuccessful on all the specified nodes.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Failures were encountered during execution of CVU verification request "Voting Disk".&lt;br /&gt;&lt;br /&gt;Verifying Voting Disk ...FAILED&lt;br /&gt;PRVF-5157 : could not verify ASM disk group "GRID" for voting disk location&lt;br /&gt;"/dev/flashgrid/racq.lun1" is available on node "rac1"&lt;br /&gt;PRVF-5157 : could not verify ASM disk group "GRID" for voting disk location&lt;br /&gt;"/dev/flashgrid/rac1.lun1" is available on node "rac1"&lt;br /&gt;PRVF-5157 : could not verify ASM disk group "GRID" for voting disk location&lt;br /&gt;"/dev/flashgrid/rac2.lun1" is available on node "rac1"&lt;br /&gt;PRVF-5431 : Oracle Cluster Voting Disk configuration check failed&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;CVU operation performed:      Voting Disk&lt;br /&gt;Date:                         Feb 11, 2021 6:18:51 PM&lt;br /&gt;CVU home:                     /u01/app/19.3.0/grid/&lt;br /&gt;User:                         grid&lt;br /&gt;&lt;/pre&gt;It can be seen that the command already had the verbose option which did not give any hint about the cause of the error.&lt;br/&gt;The documentation &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/cwadd/cluster-verification-utility-reference.html#GUID-405E2CE7-D8B0-4D72-8E53-741DB6A8E919"&gt;says&lt;/a&gt; that CVU generates trace data by default unless it has been disabled. The default trace file location is &lt;code&gt;$ORACLE_BASE/crsdata/host_name/cvu&lt;/code&gt;. A non-default location can be specified using the &lt;code&gt;CV_TRACELOC&lt;/code&gt; environment variable.&lt;br/&gt;&lt;br/&gt;That is what I got in the aforementioned directory: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[grid@rac1 ~]$ cd $ORACLE_BASE/crsdata/$(hostname -s)/cvu&lt;br /&gt;[grid@rac1 cvu]$ ll&lt;br /&gt;total 4&lt;br /&gt;drwxrwxrwt 2 grid   oinstall 4096 Feb 11 14:01 cvulog&lt;br /&gt;drwxrwxrwt 2 grid   oinstall  144 Feb 11 14:03 cvutrc&lt;br /&gt;drwxr-xr-x 2 grid   oinstall   78 Feb 11 18:18 grid&lt;br /&gt;drwxr-xr-x 2 grid   oinstall    6 Feb 11 14:03 init&lt;br /&gt;drwxr-xr-x 2 oracle oinstall   28 Feb  2 20:48 oracle&lt;br /&gt;[grid@rac1 cvu]$ cd grid&lt;br /&gt;[grid@rac1 grid]$ ll&lt;br /&gt;total 11272&lt;br /&gt;-rw-r----- 1 grid oinstall   641638 Feb 11 18:18 cvuhelper.log.0&lt;br /&gt;-rw-r--r-- 1 grid oinstall        0 Jan  4 12:12 cvuhelper.log.0.lck&lt;br /&gt;-rw-r--r-- 1 grid oinstall 10899074 Feb 11 18:18 cvutrace.log.0&lt;br /&gt;&lt;/pre&gt;The &lt;code&gt;cvutrace.log.0&lt;/code&gt; contained actual trace data in which the following lines drew my eye: &lt;pre class="brush:sql;highlight:[20,21,22]"&gt;&lt;br /&gt;[main] [ 2021-02-11 18:18:57.681 UTC ] [ClusterConfig.block:624]  block acquired semnum=0&lt;br /&gt;[main] [ 2021-02-11 18:18:57.681 UTC ] [ClusterConfig.submit:573]  Out of block&lt;br /&gt;[main] [ 2021-02-11 18:18:57.681 UTC ] [ClusterConfig.submit:590]  status=true&lt;br /&gt;[main] [ 2021-02-11 18:18:57.681 UTC ] [ClusterConfig.destroy:468]  destroying resources for client thread Thread[main,5,main]&lt;br /&gt;[main] [ 2021-02-11 18:18:57.681 UTC ] [ResultSet.traceResultTable:1065]&lt;br /&gt;&lt;br /&gt;ResultTable Info ===&gt;&lt;br /&gt;&lt;br /&gt;        contents of resultTable&lt;br /&gt;&lt;br /&gt;Dumping Result data.&lt;br /&gt;  Status     : SUCCESSFUL&lt;br /&gt;  Name       : rac1&lt;br /&gt;  Type       : Node&lt;br /&gt;  Has Results: No&lt;br /&gt;  Exp. value : null&lt;br /&gt;  Act. value : null&lt;br /&gt;&lt;br /&gt;  Errors  :&lt;br /&gt;    PRVG-2043 : Command "/u01/app/19.3.0/grid/bin/kfod op=GROUPS nohdr=true " failed on node "rac1" and produced the following output:&lt;br /&gt;KFOD-00101: LRM error [110] while parsing command line arguments&lt;br /&gt;KFOD-00103: LRM message: LRM-00118: syntax error at '=' at the end of input&lt;br /&gt;&lt;/pre&gt;As the above output demonstrates, CVU called &lt;code&gt;kfod&lt;/code&gt; which was failing. Thus, I decided to run it myself and got the same LRM errors: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[grid@rac1 ~]$ /u01/app/19.3.0/grid/bin/kfod op=GROUPS nohdr=true&lt;br /&gt;KFOD-00101: LRM error [110] while parsing command line arguments&lt;br /&gt;KFOD-00103: LRM message: LRM-00118: syntax error at '=' at the end of input&lt;br /&gt;[grid@rac1 ~]$ /u01/app/19.3.0/grid/bin/kfod op=GROUPS&lt;br /&gt;KFOD-00101: LRM error [110] while parsing command line arguments&lt;br /&gt;KFOD-00103: LRM message: LRM-00118: syntax error at '=' at the end of input&lt;br /&gt;&lt;/pre&gt;LRM seems to be the parameter manager, but it did not ring a bell yet: &lt;pre class="brush:sql;highlight:[7]"&gt;&lt;br /&gt;[grid@rac1 ~]$ head -9 $ORACLE_HOME/oracore/mesg/lrmus.msg&lt;br /&gt;/&lt;br /&gt;/ $Header: lrmus.msg 19-jun-2003.17:48:08 Exp $&lt;br /&gt;/&lt;br /&gt;/ Copyright (c) 1996, 2003, Oracle.  All rights reserved.&lt;br /&gt;/   NAME&lt;br /&gt;/     lrmus.msg - CORE error message file for the parameter manager (LRM)&lt;br /&gt;/   DESCRIPTION&lt;br /&gt;/     Listing of all CORE error messages for LRM&lt;br /&gt;/&lt;br /&gt;&lt;/pre&gt;&lt;code&gt;kfod&lt;/code&gt; is just a shell script that invokes its binary counterpart &lt;code&gt;kfod.bin&lt;/code&gt; similar to what many other Grid Infrastructure (GI) utilities do.&lt;br/&gt;They obviously interact with the operating system, so that we can trace system calls being invoked. That is what I did: &lt;pre class="brush:sql;highlight:[6]"&gt;&lt;br /&gt;[grid@rac1 ~]$ strace -f -e trace=open,write -s 256 /u01/app/19.3.0/grid/bin/kfod op=GROUPS&lt;br /&gt;..&lt;br /&gt;&amp;lt;skip&gt;&lt;br /&gt;..&lt;br /&gt;open("/u01/app/19.3.0/grid/nls/data/lx40011.nlb", O_RDONLY) = 7&lt;br /&gt;open("/u01/app/19.3.0/grid/dbs/init+ASM1.ora", O_RDONLY) = 7&lt;br /&gt;open("/u01/app/19.3.0/grid/rdbms/mesg/kfodus.msb", O_RDONLY) = 7&lt;br /&gt;write(1, "KFOD-00101: LRM error [110] while parsing command line arguments\n", 65KFOD-00101: LRM error [110] while parsing command line arguments&lt;br /&gt;) = 65&lt;br /&gt;..&lt;br /&gt;&lt;/pre&gt;In a nutshell, the process opened &lt;code&gt;/u01/app/19.3.0/grid/dbs/init+ASM1.ora&lt;/code&gt;. It then went to &lt;code&gt;/u01/app/19.3.0/grid/rdbms/mesg/kfodus.msb&lt;/code&gt;, which is a binary message file. After that it put a KFOD error to stdout.&lt;br/&gt;Therefore, it made sense to check that parameter file: &lt;pre class="brush:sql;highlight:[2]"&gt;&lt;br /&gt;[grid@rac1 ~]$ cat /u01/app/19.3.0/grid/dbs/init+ASM1.ora&lt;br /&gt;SPFILE=&lt;br /&gt;&lt;/pre&gt;It became obvious that the parameter file is the main culprit of these LRM errors: &lt;pre class="brush:sql"&gt;&lt;br /&gt;KFOD-00101: LRM error [110] while parsing command line arguments&lt;br /&gt;KFOD-00103: LRM message: LRM-00118: syntax error at '=' at the end of input&lt;br /&gt;&lt;/pre&gt;To confirm that, I renamed the file and reran both &lt;code&gt;kfod&lt;/code&gt; and &lt;code&gt;cluvfy&lt;/code&gt; commands successfully: &lt;pre class="brush:sql;highlight:[8,10,12]"&gt;&lt;br /&gt;[grid@rac1 ~]$ mv /u01/app/19.3.0/grid/dbs/init+ASM1.ora{,.bak}&lt;br /&gt;[grid@rac1 ~]$ /u01/app/19.3.0/grid/bin/kfod op=GROUPS&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Group          Size          Free Redundancy Name&lt;br /&gt;================================================================================&lt;br /&gt;   1:      10240 MB       3712 MB     NORMAL GRID&lt;br /&gt;   3:      65536 MB       3712 MB     NORMAL DATA&lt;br /&gt;[grid@rac1 ~]$ cluvfy comp vdisk -n rac1 -verbose&lt;br /&gt;&lt;br /&gt;Verifying Voting Disk ...PASSED&lt;br /&gt;&lt;br /&gt;Verification of Voting Disk was successful.&lt;br /&gt;&lt;br /&gt;CVU operation performed:      Voting Disk&lt;br /&gt;Date:                         Feb 11, 2021 6:50:38 PM&lt;br /&gt;CVU home:                     /u01/app/19.3.0/grid/&lt;br /&gt;User:                         grid&lt;br /&gt;&lt;/pre&gt;I still do not know why that parameter file was created, but it is a neat example of how Oracle tools can be debugged.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/2164482405422350541/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/02/diagnosing-cluster-verification-utility.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/2164482405422350541'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/2164482405422350541'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/02/diagnosing-cluster-verification-utility.html' title='Diagnosing Cluster Verification Utility (CVU) Errors'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8871045182969858790</id><published>2021-02-06T04:56:00.001+06:00</published><updated>2021-02-13T03:08:40.151+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><title type='text'>Using SEHA Features in EE</title><content type='html'>I installed a non-RAC Enterprise Edition 19.10 database home on my cluster. Then I created a new database on ACFS: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@rac1 ~]$ srvctl config database -db si&lt;br /&gt;Database unique name: si&lt;br /&gt;Database name: si&lt;br /&gt;Oracle home: /u01/app/oracle/product/19.3.0/dbhome_non_rac&lt;br /&gt;Oracle user: oracle&lt;br /&gt;Spfile: /acfsmounts/acfs1/SI/spfilesi.ora&lt;br /&gt;Password file:&lt;br /&gt;Domain:&lt;br /&gt;Start options: open&lt;br /&gt;Stop options: immediate&lt;br /&gt;Database role: PRIMARY&lt;br /&gt;Management policy: AUTOMATIC&lt;br /&gt;Server pools:&lt;br /&gt;Disk Groups:&lt;br /&gt;Mount point paths: /acfsmounts/acfs1&lt;br /&gt;Services:&lt;br /&gt;Type: SINGLE&lt;br /&gt;OSDBA group: dba&lt;br /&gt;OSOPER group: oper&lt;br /&gt;Database instance: si&lt;br /&gt;Configured nodes: rac1&lt;br /&gt;CSS critical: no&lt;br /&gt;CPU count: 0&lt;br /&gt;Memory target: 0&lt;br /&gt;Maximum memory: 0&lt;br /&gt;Default network number for database services:&lt;br /&gt;Database is administrator managed&lt;br /&gt;&lt;/pre&gt;Let us assume I want to utilize some of &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/admin/creating-and-configuring-an-oracle-database.html#GUID-4B255433-4F5D-4A75-BB05-EBAB41361B5E"&gt;Standard Edition High Availability (SEHA) features&lt;/a&gt; in this database: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@rac1 ~]$ srvctl modify database -db si -node rac1,rac2&lt;br /&gt;PRCD-1302 : failed to retrieve the node hosting this single-instance database&lt;br /&gt;PRCD-2088 : failed to configure the single instance database si with multiple nodes because it is not a Standard Edition database&lt;br /&gt;&lt;br /&gt;[oracle@rac1 ~]$ srvctl relocate database -db si -node rac2&lt;br /&gt;PRKF-1421 : cannot relocate database "si"; invalid database type&lt;br /&gt;&lt;/pre&gt;As expected, &lt;code&gt;srvctl&lt;/code&gt; disallows such operations. However, the edition check uses the &lt;code&gt;$ORACLE_HOME/lib/libedtn19.a&lt;/code&gt; file which I described in the following post: &lt;a href="&lt;$BlogURL$&gt;/2020/09/determining-oracle-database-edition.html"&gt;Determining Oracle Database Edition&lt;/a&gt;.&lt;br/&gt;It turns out it is enough to copy the standard edition library to make these &lt;code&gt;srvctl&lt;/code&gt; commands work: &lt;pre class="brush:sql;highlight:[25]"&gt;&lt;br /&gt;[oracle@rac1 lib]$ cp libedtn19_std.a libedtn19.a&lt;br /&gt;&lt;br /&gt;[oracle@rac1 ~]$ srvctl modify database -db si -node rac1,rac2&lt;br /&gt;&lt;br /&gt;[oracle@rac1 ~]$ srvctl config database -db si&lt;br /&gt;Database unique name: si&lt;br /&gt;Database name: si&lt;br /&gt;Oracle home: /u01/app/oracle/product/19.3.0/dbhome_non_rac&lt;br /&gt;Oracle user: oracle&lt;br /&gt;Spfile: /acfsmounts/acfs1/SI/spfilesi.ora&lt;br /&gt;Password file:&lt;br /&gt;Domain:&lt;br /&gt;Start options: open&lt;br /&gt;Stop options: immediate&lt;br /&gt;Database role: PRIMARY&lt;br /&gt;Management policy: AUTOMATIC&lt;br /&gt;Server pools:&lt;br /&gt;Disk Groups:&lt;br /&gt;Mount point paths: /acfsmounts/acfs1&lt;br /&gt;Services:&lt;br /&gt;Type: SINGLE&lt;br /&gt;OSDBA group: dba&lt;br /&gt;OSOPER group: oper&lt;br /&gt;Database instance: si&lt;br /&gt;Configured nodes: rac1,rac2&lt;br /&gt;CSS critical: no&lt;br /&gt;CPU count: 0&lt;br /&gt;Memory target: 0&lt;br /&gt;Maximum memory: 0&lt;br /&gt;Default network number for database services:&lt;br /&gt;Database is administrator managed&lt;br /&gt;&lt;/pre&gt;My clusterware resources before doing the &lt;code&gt;relocate&lt;/code&gt; command: &lt;pre class="brush:sql;highlight:[68,69]"&gt;&lt;br /&gt;[grid@rac2 ~]$ crsctl stat res -t&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Name           Target  State        Server                   State details&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Local Resources&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;ora.DATA.VOLUME1.advm&lt;br /&gt;               ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;               ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.LISTENER.lsnr&lt;br /&gt;               ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;               ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.chad&lt;br /&gt;               ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;               ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.data.volume1.acfs&lt;br /&gt;               ONLINE  ONLINE       rac1                     mounted on /acfsmoun&lt;br /&gt;                                                             ts/acfs1,STABLE&lt;br /&gt;               ONLINE  ONLINE       rac2                     mounted on /acfsmoun&lt;br /&gt;                                                             ts/acfs1,STABLE&lt;br /&gt;ora.net1.network&lt;br /&gt;               ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;               ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.ons&lt;br /&gt;               ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;               ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.proxy_advm&lt;br /&gt;               ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;               ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Cluster Resources&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;ora.ASMNET1LSNR_ASM.lsnr(ora.asmgroup)&lt;br /&gt;      1        ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;      2        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.DATA.dg(ora.asmgroup)&lt;br /&gt;      1        ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;      2        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.GRID.dg(ora.asmgroup)&lt;br /&gt;      1        ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;      2        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.LISTENER_SCAN1.lsnr&lt;br /&gt;      1        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.LISTENER_SCAN2.lsnr&lt;br /&gt;      1        ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;ora.LISTENER_SCAN3.lsnr&lt;br /&gt;      1        ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;ora.asm(ora.asmgroup)&lt;br /&gt;      1        ONLINE  ONLINE       rac1                     Started,STABLE&lt;br /&gt;      2        ONLINE  ONLINE       rac2                     Started,STABLE&lt;br /&gt;ora.asmnet1.asmnetwork(ora.asmgroup)&lt;br /&gt;      1        ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;      2        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.cvu&lt;br /&gt;      1        ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;ora.qosmserver&lt;br /&gt;      1        ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;ora.rac1.vip&lt;br /&gt;      1        ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;ora.rac2.vip&lt;br /&gt;      1        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.scan1.vip&lt;br /&gt;      1        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.scan2.vip&lt;br /&gt;      1        ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;ora.scan3.vip&lt;br /&gt;      1        ONLINE  ONLINE       rac1                     STABLE&lt;br /&gt;ora.si.db&lt;br /&gt;      1        ONLINE  ONLINE       rac1                     Open,HOME=/u01/app/o&lt;br /&gt;                                                             racle/product/19.3.0&lt;br /&gt;                                                             /dbhome_non_rac,STAB&lt;br /&gt;                                                             LE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;&lt;/pre&gt;Running &lt;code&gt;relocate&lt;/code&gt;: &lt;pre class="brush:sql;highlight:[3]"&gt;&lt;br /&gt;[oracle@rac1 ~]$ srvctl relocate database -db si -node rac2&lt;br /&gt;[oracle@rac1 ~]$ srvctl status database -db si&lt;br /&gt;Instance si is running on node rac2&lt;br /&gt;&lt;/pre&gt;Clusterware also restarts that database on a working node in case the node it was running on fails. To test that, I initiated a kernel panic on the &lt;code&gt;rac1&lt;/code&gt; node where my database was running: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[root@rac1 ~]# echo c &gt; /proc/sysrq-trigger&lt;br /&gt;&lt;/pre&gt;After a while, the database was started on the other node: &lt;pre class="brush:sql;highlight:[60,61]"&gt;&lt;br /&gt;[grid@rac2 ~]$ crsctl stat res -t&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Name           Target  State        Server                   State details&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Local Resources&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;ora.DATA.VOLUME1.advm&lt;br /&gt;               ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.LISTENER.lsnr&lt;br /&gt;               ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.chad&lt;br /&gt;               ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.data.volume1.acfs&lt;br /&gt;               ONLINE  ONLINE       rac2                     mounted on /acfsmoun&lt;br /&gt;                                                             ts/acfs1,STABLE&lt;br /&gt;ora.net1.network&lt;br /&gt;               ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.ons&lt;br /&gt;               ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.proxy_advm&lt;br /&gt;               ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Cluster Resources&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;ora.ASMNET1LSNR_ASM.lsnr(ora.asmgroup)&lt;br /&gt;      1        ONLINE  OFFLINE                               STABLE&lt;br /&gt;      2        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.DATA.dg(ora.asmgroup)&lt;br /&gt;      1        ONLINE  OFFLINE                               STABLE&lt;br /&gt;      2        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.GRID.dg(ora.asmgroup)&lt;br /&gt;      1        ONLINE  OFFLINE                               STABLE&lt;br /&gt;      2        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.LISTENER_SCAN1.lsnr&lt;br /&gt;      1        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.LISTENER_SCAN2.lsnr&lt;br /&gt;      1        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.LISTENER_SCAN3.lsnr&lt;br /&gt;      1        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.asm(ora.asmgroup)&lt;br /&gt;      1        ONLINE  OFFLINE                               STABLE&lt;br /&gt;      2        ONLINE  ONLINE       rac2                     Started,STABLE&lt;br /&gt;ora.asmnet1.asmnetwork(ora.asmgroup)&lt;br /&gt;      1        ONLINE  OFFLINE                               STABLE&lt;br /&gt;      2        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.cvu&lt;br /&gt;      1        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.qosmserver&lt;br /&gt;      1        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.rac1.vip&lt;br /&gt;      1        ONLINE  INTERMEDIATE rac2                     FAILED OVER,STABLE&lt;br /&gt;ora.rac2.vip&lt;br /&gt;      1        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.scan1.vip&lt;br /&gt;      1        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.scan2.vip&lt;br /&gt;      1        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.scan3.vip&lt;br /&gt;      1        ONLINE  ONLINE       rac2                     STABLE&lt;br /&gt;ora.si.db&lt;br /&gt;      1        ONLINE  ONLINE       rac2                     Open,HOME=/u01/app/o&lt;br /&gt;                                                             racle/product/19.3.0&lt;br /&gt;                                                             /dbhome_non_rac,STAB&lt;br /&gt;                                                             LE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;&lt;/pre&gt;I am unsure about the exact repercussions of that library change. Obviously &lt;code&gt;srvctl&lt;/code&gt; uses &lt;code&gt;libedtn19.a&lt;/code&gt; as it was demonstrated above. Whether or not it can cause any adverse effects - I do not know.&lt;br/&gt;&lt;br/&gt;Evidently such configuration is anything but supported by Oracle. The officially supported way of making them on non-RAC environments uses custom Clusterware resources, which I personally find clunky. I wish those SEHA features were available on EE, but it is not the case at present.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/8871045182969858790/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/02/using-seha-features-in-ee.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8871045182969858790'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8871045182969858790'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/02/using-seha-features-in-ee.html' title='Using SEHA Features in EE'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-4716203819076498867</id><published>2021-02-03T02:27:00.001+06:00</published><updated>2021-02-03T02:27:26.452+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><title type='text'>Updating non Key-Preserved Table</title><content type='html'>There used to be the &lt;b&gt;&lt;i&gt;BYPASS_UJVC&lt;/i&gt;&lt;/b&gt; hint that allowed to update a non key-preserved table. It is still there, but it must have stopped working around 11.2. It turns out that Oracle introduced a fix control that seems to be doing the same in 19.10. &lt;br/&gt;&lt;br/&gt;Here is a short demonstration of this fix control. &lt;pre class="brush:sql;highlight:[72,80]"&gt;&lt;br /&gt;SQL&gt; select banner_full from v$version;&lt;br /&gt;&lt;br /&gt;BANNER_FULL&lt;br /&gt;----------------------------------------------------------------------------------------------------&lt;br /&gt;Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production&lt;br /&gt;Version 19.10.0.0.0&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col fix_control for a90&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select xmltype.createxml(cursor(&lt;br /&gt;  2           select *&lt;br /&gt;  3             from v$system_fix_control&lt;br /&gt;  4            where bugno = 19138896)) fix_control&lt;br /&gt;  5    from dual;&lt;br /&gt;&lt;br /&gt;FIX_CONTROL&lt;br /&gt;------------------------------------------------------------------------------------------&lt;br /&gt;&amp;lt;?xml version="1.0"?&gt;&lt;br /&gt;&amp;lt;ROWSET&gt;&lt;br /&gt;  &amp;lt;ROW&gt;&lt;br /&gt;    &amp;lt;BUGNO&gt;19138896&amp;lt;/BUGNO&gt;&lt;br /&gt;    &amp;lt;VALUE&gt;0&amp;lt;/VALUE&gt;&lt;br /&gt;    &amp;lt;SQL_FEATURE&gt;QKSFM_DML_19138896&amp;lt;/SQL_FEATURE&gt;&lt;br /&gt;    &amp;lt;DESCRIPTION&gt;allow update of join view without key preserved property&amp;lt;/DESCRIPTION&gt;&lt;br /&gt;    &amp;lt;EVENT&gt;0&amp;lt;/EVENT&gt;&lt;br /&gt;    &amp;lt;IS_DEFAULT&gt;1&amp;lt;/IS_DEFAULT&gt;&lt;br /&gt;    &amp;lt;CON_ID&gt;3&amp;lt;/CON_ID&gt;&lt;br /&gt;  &amp;lt;/ROW&gt;&lt;br /&gt;&amp;lt;/ROWSET&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create table t1 (&lt;br /&gt;  2    pk_col int,&lt;br /&gt;  3    t1_col varchar2(30));&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create table t2 (&lt;br /&gt;  2    pk_col int,&lt;br /&gt;  3    t2_col varchar2(30));&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert into t1 values (1, 't1_1');&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt; insert into t1 values (2, 't1_2');&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert into t2 values (2, 't2_2');&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt; insert into t2 values (3, 't2_3');&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from t1;&lt;br /&gt;&lt;br /&gt;    PK_COL T1_COL&lt;br /&gt;---------- ------------------------------&lt;br /&gt;         1 t1_1&lt;br /&gt;         2 t1_2&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from t2;&lt;br /&gt;&lt;br /&gt;    PK_COL T2_COL&lt;br /&gt;---------- ------------------------------&lt;br /&gt;         2 t2_2&lt;br /&gt;         3 t2_3&lt;br /&gt;&lt;/pre&gt;Let us try to update all rows in &lt;code&gt;T2&lt;/code&gt; with the matching value from &lt;code&gt;T1&lt;/code&gt;: &lt;pre class="brush:sql;highlight:[8]"&gt;&lt;br /&gt;SQL&gt; update (select t2_col, t1_col&lt;br /&gt;  2            from t1, t2&lt;br /&gt;  3           where t2.pk_col = t1.pk_col)&lt;br /&gt;  4     set t2_col = t1_col;&lt;br /&gt;   set t2_col = t1_col&lt;br /&gt;       *&lt;br /&gt;ERROR at line 4:&lt;br /&gt;ORA-01779: cannot modify a column which maps to a non key-preserved table&lt;br /&gt;&lt;/pre&gt;Cannot do that. &lt;b&gt;&lt;i&gt;BYPASS_UJVC&lt;/i&gt;&lt;/b&gt; does not work either. &lt;pre class="brush:sql;highlight:[9]"&gt;&lt;br /&gt;SQL&gt; update --+ bypass_ujvc&lt;br /&gt;  2         (select t2_col, t1_col&lt;br /&gt;  3            from t1, t2&lt;br /&gt;  4           where t2.pk_col = t1.pk_col)&lt;br /&gt;  5     set t2_col = t1_col;&lt;br /&gt;   set t2_col = t1_col&lt;br /&gt;       *&lt;br /&gt;ERROR at line 5:&lt;br /&gt;ORA-01779: cannot modify a column which maps to a non key-preserved table&lt;br /&gt;&lt;/pre&gt;Now with fix control &lt;b&gt;&lt;i&gt;19138896&lt;/i&gt;&lt;/b&gt;: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; update --+ opt_param('_fix_control' '19138896:1')&lt;br /&gt;  2         (select t2_col, t1_col&lt;br /&gt;  3            from t1, t2&lt;br /&gt;  4           where t2.pk_col = t1.pk_col)&lt;br /&gt;  5     set t2_col = t1_col;&lt;br /&gt;&lt;br /&gt;1 row updated.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from t2;&lt;br /&gt;&lt;br /&gt;    PK_COL T2_COL&lt;br /&gt;---------- ------------------------------&lt;br /&gt;         2 t1_2&lt;br /&gt;         3 t2_3&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; roll&lt;br /&gt;Rollback complete.&lt;br /&gt;&lt;/pre&gt;If I try to add a duplicate row to &lt;code&gt;T1&lt;/code&gt; making this update non-deterministic, so that there is an attempt to update one row from &lt;code&gt;T2&lt;/code&gt; more than once, I get an error: &lt;pre class="brush:sql;highlight:[13]"&gt;&lt;br /&gt;SQL&gt; insert into t1 values (2, 't1_22');&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt; update --+ opt_param('_fix_control' '19138896:1')&lt;br /&gt;  2         (select t2_col, t1_col&lt;br /&gt;  3            from t1, t2&lt;br /&gt;  4           where t2.pk_col = t1.pk_col)&lt;br /&gt;  5     set t2_col = t1_col;&lt;br /&gt;          from t1, t2&lt;br /&gt;               *&lt;br /&gt;ERROR at line 3:&lt;br /&gt;ORA-30926: unable to get a stable set of rows in the source tables&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Conclusion&lt;/h3&gt;Altrough I generally prefer either rewriting such statements to &lt;b&gt;&lt;i&gt;MERGE&lt;/i&gt;&lt;/b&gt; or adding missing constraints, the fix control &lt;b&gt;&lt;i&gt;19138896&lt;/i&gt;&lt;/b&gt; brings another option to the table. It also has certain advantages, to name a few: &lt;ul&gt;  &lt;li&gt;There is no need to rewrite the query. The fix control can be added through an SQL patch, for example.&lt;/li&gt;  &lt;li&gt;The fix control can be set at the session or instance levels.&lt;/li&gt;&lt;/ul&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/4716203819076498867/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/02/updating-non-key-preserved-table.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4716203819076498867'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4716203819076498867'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/02/updating-non-key-preserved-table.html' title='Updating non Key-Preserved Table'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-4487842022767485976</id><published>2021-01-28T03:45:00.000+06:00</published><updated>2021-01-28T03:45:17.921+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='opatchauto'/><category scheme='http://www.blogger.com/atom/ns#' term='18c'/><title type='text'>OPATCHAUTO-72043 and JCE</title><content type='html'>I was applying Grid Infrastructure Jan 2021 Release Update (GI RU) 18.13.0.0.210119 to an 18c cluster the other day.&lt;br/&gt;opatchauto failed with the errors as follows: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[root@rac1 ~]# /u01/app/18.3.0/grid/OPatch/opatchauto apply -analyze /u01/swtmp/32226219/ -oh /u01/app/18.3.0/grid/&lt;br /&gt;&lt;br /&gt;OPatchauto session is initiated at Wed Jan 27 20:40:45 2021&lt;br /&gt;&lt;br /&gt;System initialization log file is /u01/app/18.3.0/grid/cfgtoollogs/opatchautodb/systemconfig2021-01-27_08-40-48PM.log.&lt;br /&gt;&lt;br /&gt;Session log file is /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/opatchauto2021-01-27_08-40-51PM.log&lt;br /&gt;The id for this session is 56VW&lt;br /&gt;OPATCHAUTO-72043: Patch collection failed.&lt;br /&gt;OPATCHAUTO-72043: Failed to create bundle patch object.&lt;br /&gt;OPATCHAUTO-72043: Please verify the patch supplied.&lt;br /&gt;OPatchAuto failed.&lt;br /&gt;&lt;br /&gt;OPatchauto session completed at Wed Jan 27 20:40:53 2021&lt;br /&gt;Time taken to complete the session 0 minute, 8 seconds&lt;br /&gt;&lt;br /&gt; opatchauto failed with error code 42&lt;br /&gt;&lt;/pre&gt;The session log file: &lt;pre class="brush:sql"&gt;&lt;br /&gt;2021-01-27 20:40:51,664 INFO  [1] com.oracle.glcm.patch.auto.OPatchAuto - OPatchAuto version: 13.9.4.5.0&lt;br /&gt;2021-01-27 20:40:51,666 INFO  [1] com.oracle.cie.common.util.reporting.CommonReporter - Reporting console output : Message{id='null', message='Session log file is /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/opatchauto2021-01-27_08-40-51PM.log'}&lt;br /&gt;2021-01-27 20:40:51,733 INFO  [1] oracle.dbsysmodel.driver.sdk.productdriver.ClusterInformationLoader - crsType: SOFTWARE_INSTALLATION_ONLY&lt;br /&gt;2021-01-27 20:40:51,733 INFO  [1] oracle.dbsysmodel.driver.sdk.productdriver.ClusterInformationLoader - running: false&lt;br /&gt;2021-01-27 20:40:52,354 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - OPatchAutoOptions configured options:&lt;br /&gt;2021-01-27 20:40:52,354 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: patch.location:patch-location Value:/u01/swtmp/32226219/&lt;br /&gt;2021-01-27 20:40:52,354 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: home:-oh Value:/u01/app/18.3.0/grid/&lt;br /&gt;2021-01-27 20:40:52,354 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: log:-log Value:/u01/app/18.3.0/grid/cfgtoollogs/opatchauto/opatchauto2021-01-27_08-40-51PM.log&lt;br /&gt;2021-01-27 20:40:52,355 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: log_priority:-logLevel Value:INFO&lt;br /&gt;2021-01-27 20:40:52,355 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: customLogDir:-customLogDir Value:/u01/app/18.3.0/grid/cfgtoollogs&lt;br /&gt;2021-01-27 20:40:52,355 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: analyze:-analyze Value:true&lt;br /&gt;2021-01-27 20:40:52,355 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: inventory.pointer.location:-invPtrLoc Value:/u01/app/18.3.0/grid//oraInst.loc&lt;br /&gt;2021-01-27 20:40:52,355 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: host:-host Value:rac1.example.com&lt;br /&gt;2021-01-27 20:40:52,355 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: patch.plan:-plan Value:crs-rolling&lt;br /&gt;2021-01-27 20:40:52,355 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: format:-format Value:xml&lt;br /&gt;2021-01-27 20:40:52,355 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: output:-output Value:console&lt;br /&gt;2021-01-27 20:40:52,355 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: customconfigdir:-customConfigDir Value:/u01/app/18.3.0/grid/opatchautocfg/db&lt;br /&gt;2021-01-27 20:40:52,355 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: nonrolling:-nonrolling Value:false&lt;br /&gt;2021-01-27 20:40:52,355 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: session:-session Value:56VW&lt;br /&gt;2021-01-27 20:40:52,545 INFO  [1] com.oracle.glcm.patch.auto.OPatchAuto - The id for this session is 56VW&lt;br /&gt;2021-01-27 20:40:52,545 INFO  [1] com.oracle.cie.common.util.reporting.CommonReporter - Reporting console output : Message{id='null', message='The id for this session is 56VW'}&lt;br /&gt;2021-01-27 20:40:52,549 WARNING [1] com.oracle.glcm.patch.auto.credential.CredentialManager - Unable to locate credential for host rac1&lt;br /&gt;2021-01-27 20:40:52,584 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoHelper - Executing command [bash, -c, ORACLE_HOME=/u01/app/18.3.0/grid /u01/app/18.3.0/grid/bin/orabasehome]&lt;br /&gt;2021-01-27 20:40:52,602 INFO  [1] com.oracle.helper.util.HelperUtility - Orabasehome Output :&lt;br /&gt;/u01/app/18.3.0/grid&lt;br /&gt;&lt;br /&gt;2021-01-27 20:40:52,602 INFO  [1] com.oracle.helper.util.HelperUtility - Oracle Base Home for /u01/app/18.3.0/grid is /u01/app/18.3.0/grid&lt;br /&gt;2021-01-27 20:40:52,603 WARNING [1] com.oracle.glcm.patch.auto.credential.CredentialManager - Unable to locate credential for host rac1&lt;br /&gt;2021-01-27 20:40:52,616 INFO  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.impl.PatchPackageFactoryImpl - Entering getPatchPackageFromDir, getting patch object for the given patch location /u01/swtmp/32226219&lt;br /&gt;2021-01-27 20:40:53,135 INFO  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.OPatchBundlePatchValidatorAndGenerator - Bundle.xml does not exist&lt;br /&gt;2021-01-27 20:40:53,135 INFO  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.OPatchSingletonPatchValidatorAndGenerator - inventory.xml found at /u01/swtmp/32226219/32216973/etc/config/inventory.xml which implies it is an OPatch Singleton patch&lt;br /&gt;2021-01-27 20:40:53,137 INFO  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.PatchMetadaReader - Command for patch metadata::/u01/app/18.3.0/grid/perl/bin/perl  /u01/app/18.3.0/grid/OPatch/auto/database/bin/OPatchAutoBinary.pl query patchinfo -patch_location /u01/swtmp/32226219/32216973 -result /u01/app/18.3.0/grid/OPatch/auto/dbtmp/result.ser&lt;br /&gt;2021-01-27 20:40:53,741 INFO  [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - Is retry required=false&lt;br /&gt;2021-01-27 20:40:53,742 WARNING [1] com.oracle.glcm.patch.auto.db.integration.model.plan.PatchingProcessInitializer - Patch Collection failed: &lt;br /&gt;2021-01-27 20:40:53,743 INFO  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBBaseProductSupport - Space available after session: 32874 MB&lt;br /&gt;2021-01-27 20:40:53,766 SEVERE [1] com.oracle.glcm.patch.auto.OPatchAuto - OPatchAuto failed.&lt;br /&gt;com.oracle.glcm.patch.auto.OPatchAutoException: OPATCHAUTO-72043: Patch collection failed.&lt;br /&gt;OPATCHAUTO-72043: Failed to create bundle patch object.&lt;br /&gt;OPATCHAUTO-72043: Please verify the patch supplied.&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.plan.PatchingProcessInitializer.initializePatchPackageBag(PatchingProcessInitializer.java:97)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.plan.PatchingProcessInitializer.processInit(PatchingProcessInitializer.java:66)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBCommonSupport.initializePatchData(DBCommonSupport.java:126)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBBaseProductSupport.initializePatchData(DBBaseProductSupport.java:408)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBCommonSupport.loadTopology(DBCommonSupport.java:163)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBBaseProductSupport.loadTopology(DBBaseProductSupport.java:195)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBProductSupport.loadTopology(DBProductSupport.java:69)&lt;br /&gt;	at com.oracle.glcm.patch.auto.OPatchAuto.loadTopology(OPatchAuto.java:1732)&lt;br /&gt;	at com.oracle.glcm.patch.auto.OPatchAuto.prepareOrchestration(OPatchAuto.java:730)&lt;br /&gt;	at com.oracle.glcm.patch.auto.OPatchAuto.orchestrate(OPatchAuto.java:397)&lt;br /&gt;	at com.oracle.glcm.patch.auto.OPatchAuto.orchestrate(OPatchAuto.java:344)&lt;br /&gt;	at com.oracle.glcm.patch.auto.OPatchAuto.main(OPatchAuto.java:212)&lt;br /&gt;Caused by: com.oracle.glcm.patch.auto.db.integration.model.productsupport.patch.PatchCollectionException: &lt;br /&gt;	at com.oracle.glcm.patch.auto.db.framework.core.patch.OPatchSingletonPatchValidatorAndGenerator.generate(OPatchSingletonPatchValidatorAndGenerator.java:151)&lt;br /&gt;	at oracle.dbsysmodel.patchsdk.PatchFactory.getInstance(PatchFactory.java:246)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.framework.core.patch.impl.PatchPackageFactoryImpl.getPatchPackageFromDir(PatchPackageFactoryImpl.java:75)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.product.patch.BundlePatchObject.prcoessPatch(BundlePatchObject.java:131)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.product.patch.BundlePatchObject.createPatchBagForPatchLocation(BundlePatchObject.java:124)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.product.patch.BundlePatchObject.&amp;lt;init&gt;(BundlePatchObject.java:77)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.productsupport.patch.PatchInformationInitializer.createPatch(PatchInformationInitializer.java:43)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.plan.PatchingProcessInitializer.initializePatchPackageBag(PatchingProcessInitializer.java:80)&lt;br /&gt;	... 11 more&lt;br /&gt;2021-01-27 20:40:53,767 INFO  [1] com.oracle.cie.common.util.reporting.CommonReporter - Reporting console output : Message{id='null', message='OPATCHAUTO-72043: Patch collection failed.&lt;br /&gt;OPATCHAUTO-72043: Failed to create bundle patch object.&lt;br /&gt;OPATCHAUTO-72043: Please verify the patch supplied.'}&lt;br /&gt;2021-01-27 20:40:53,767 INFO  [1] com.oracle.cie.common.util.reporting.CommonReporter - Reporting console output : Message{id='null', message='OPatchAuto failed.'}&lt;br /&gt;&lt;/pre&gt;There are several common scenarios when I see such errors: &lt;ul&gt;  &lt;li&gt;Wrong permissions on patch files&lt;/li&gt;  &lt;li&gt;A wrong folder passed to opatchauto&lt;/li&gt;  &lt;li&gt;Wrong opatch version&lt;/li&gt;&lt;/ul&gt;None of these was the case: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[grid@rac1 ~]$ /u01/app/18.3.0/grid/OPatch/opatch version&lt;br /&gt;OPatch Version: 12.2.0.1.23&lt;br /&gt;&lt;br /&gt;OPatch succeeded.&lt;br /&gt;&lt;/pre&gt;After checking the usual suspects, I had to enable logging: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[root@rac1 ~]# /u01/app/18.3.0/grid/OPatch/opatchauto apply -analyze /u01/swtmp/32226219/ -logLevel FINEST -oh /u01/app/18.3.0/grid/&lt;br /&gt;&lt;br /&gt;OPatchauto session is initiated at Wed Jan 27 20:52:04 2021&lt;br /&gt;&lt;br /&gt;System initialization log file is /u01/app/18.3.0/grid/cfgtoollogs/opatchautodb/systemconfig2021-01-27_08-52-07PM.log.&lt;br /&gt;&lt;br /&gt;Session log file is /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/opatchauto2021-01-27_08-52-10PM.log&lt;br /&gt;The id for this session is 7NBB&lt;br /&gt;OPATCHAUTO-72043: Patch collection failed.&lt;br /&gt;OPATCHAUTO-72043: Failed to create bundle patch object.&lt;br /&gt;OPATCHAUTO-72043: Please verify the patch supplied.&lt;br /&gt;OPatchAuto failed.&lt;br /&gt;&lt;br /&gt;OPatchauto session completed at Wed Jan 27 20:52:12 2021&lt;br /&gt;Time taken to complete the session 0 minute, 8 seconds&lt;br /&gt;&lt;br /&gt; opatchauto failed with error code 42&lt;br /&gt;&lt;/pre&gt;This time around I got something new: &lt;pre class="brush:sql;highlight:[130,152,172,175]"&gt;&lt;br /&gt;2021-01-27 20:52:10,508 FINEST [1] com.oracle.cie.common.util.reporting.Reporting - Adding reporter com.oracle.cie.common.util.reporting.console.ConsoleReporter@4445629&lt;br /&gt;2021-01-27 20:52:10,510 INFO  [1] com.oracle.glcm.patch.auto.OPatchAuto - OPatchAuto version: 13.9.4.5.0&lt;br /&gt;2021-01-27 20:52:10,511 INFO  [1] com.oracle.cie.common.util.reporting.CommonReporter - Reporting console output : Message{id='null', message='Session log file is /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/opatchauto2021-01-27_08-52-10PM.log'}&lt;br /&gt;2021-01-27 20:52:10,517 FINER [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBProductSupport -  ShardedDatabase set as false&lt;br /&gt;2021-01-27 20:52:10,517 FINER [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBProductSupport -  DataGuard primary set as : null&lt;br /&gt;2021-01-27 20:52:10,517 FINER [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBProductSupport -  ShardGroup set as : null&lt;br /&gt;2021-01-27 20:52:10,517 FINER [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBProductSupport -  ShardSpace set as : null&lt;br /&gt;2021-01-27 20:52:10,517 FINER [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBProductSupport -  productSupport initialize: com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBBaseProductSupport@48fa0f47&lt;br /&gt;2021-01-27 20:52:10,517 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.DBPatchingHelper - switchSession: false&lt;br /&gt;2021-01-27 20:52:10,577 INFO  [1] oracle.dbsysmodel.driver.sdk.productdriver.ClusterInformationLoader - crsType: SOFTWARE_INSTALLATION_ONLY&lt;br /&gt;2021-01-27 20:52:10,577 INFO  [1] oracle.dbsysmodel.driver.sdk.productdriver.ClusterInformationLoader - running: false&lt;br /&gt;2021-01-27 20:52:10,577 FINER [1] oracle.dbsysmodel.driver.sdk.productdriver.ClusterInformationLoader - ENTRY&lt;br /&gt;2021-01-27 20:52:10,577 FINE  [1] oracle.dbsysmodel.driver.sdk.productdriver.ClusterInformationLoader - CRS stack is down. Now getting crs version by OUI.&lt;br /&gt;2021-01-27 20:52:10,660 FINEST [1] oracle.dbsysmodel.driver.sdk.productdriver.OUIDriver - Added Component:oracle.crs&lt;br /&gt;2021-01-27 20:52:10,660 FINEST [1] oracle.dbsysmodel.driver.sdk.productdriver.OUIDriver - Added OUI Info to:OraGI18Home1&lt;br /&gt;2021-01-27 20:52:10,660 FINER [1] oracle.dbsysmodel.driver.sdk.productdriver.OUIDriver - ENTRY&lt;br /&gt;2021-01-27 20:52:10,660 FINEST [1] oracle.dbsysmodel.driver.sdk.productdriver.OUIDriver - Executing OPatch/opatch version for OracleHome at /u01/app/18.3.0/grid&lt;br /&gt;2021-01-27 20:52:10,968 FINE  [1] oracle.dbsysmodel.driver.sdk.productdriver.OUIDriver - /u01/app/18.3.0/grid has OPatch Version 12.2.0.1.23&lt;br /&gt;2021-01-27 20:52:10,968 FINER [1] oracle.dbsysmodel.driver.sdk.productdriver.OUIDriver - RETURN&lt;br /&gt;2021-01-27 20:52:10,969 FINER [1] oracle.dbsysmodel.driver.sdk.productdriver.OUIDriver - ENTRY&lt;br /&gt;2021-01-27 20:52:10,969 FINE  [1] oracle.dbsysmodel.driver.sdk.productdriver.OUIDriver - ORACLE_BASE for /u01/app/18.3.0/grid is /u01/app/grid&lt;br /&gt;2021-01-27 20:52:10,969 FINER [1] oracle.dbsysmodel.driver.sdk.productdriver.OUIDriver - RETURN&lt;br /&gt;2021-01-27 20:52:10,969 FINEST [1] oracle.dbsysmodel.driver.sdk.productdriver.OUIDriver - Found Local Home:/u01/app/18.3.0/grid&lt;br /&gt;2021-01-27 20:52:10,969 CONFIG [1] oracle.dbsysmodel.driver.sdk.productdriver.ClusterInformationLoader - Found local home at /u01/app/18.3.0/grid&lt;br /&gt;2021-01-27 20:52:11,108 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.DBPatchingHelper - switchSession: false&lt;br /&gt;2021-01-27 20:52:11,108 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.DBPatchingHelper - isSingleSession: false&lt;br /&gt;2021-01-27 20:52:11,108 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.DBPatchingHelper - prepareSession: false&lt;br /&gt;2021-01-27 20:52:11,108 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.DBPatchingHelper - switchSession: false&lt;br /&gt;2021-01-27 20:52:11,108 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.DBPatchingHelper - oopEnabled: false&lt;br /&gt;2021-01-27 20:52:11,112 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.CRSTopologyBuilder - SIDBonly is set to false&lt;br /&gt;2021-01-27 20:52:11,113 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.DBPatchingHelper - switchSession: false&lt;br /&gt;2021-01-27 20:52:11,142 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property LocalHost&lt;br /&gt;2021-01-27 20:52:11,142 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property logDir&lt;br /&gt;2021-01-27 20:52:11,142 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property SessionID&lt;br /&gt;2021-01-27 20:52:11,142 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property OracleHome&lt;br /&gt;2021-01-27 20:52:11,142 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property LogFileLevel&lt;br /&gt;2021-01-27 20:52:11,143 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property ConsoleLogLevel&lt;br /&gt;2021-01-27 20:52:11,143 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property OPlanLocation&lt;br /&gt;2021-01-27 20:52:11,143 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property ConfigXML&lt;br /&gt;2021-01-27 20:52:11,143 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property invPtrLoc&lt;br /&gt;2021-01-27 20:52:11,143 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property UserInvokingOplan&lt;br /&gt;2021-01-27 20:52:11,143 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property RootUser&lt;br /&gt;2021-01-27 20:52:11,143 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property TmpFilesDir&lt;br /&gt;2021-01-27 20:52:11,143 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property ExecutionMode&lt;br /&gt;2021-01-27 20:52:11,144 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property AdminServerURL&lt;br /&gt;2021-01-27 20:52:11,144 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property AdminServerUser&lt;br /&gt;2021-01-27 20:52:11,144 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property AdminServerPassword&lt;br /&gt;2021-01-27 20:52:11,144 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property BundlePatchLocation&lt;br /&gt;2021-01-27 20:52:11,145 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property RACPatchLocations&lt;br /&gt;2021-01-27 20:52:11,145 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property GIPatchLocations&lt;br /&gt;2021-01-27 20:52:11,145 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property AllPatchLocations&lt;br /&gt;2021-01-27 20:52:11,145 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property PatchIDs&lt;br /&gt;2021-01-27 20:52:11,145 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property Operation&lt;br /&gt;2021-01-27 20:52:11,145 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property SkipConfigValidation&lt;br /&gt;2021-01-27 20:52:11,145 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property ProductFamily&lt;br /&gt;2021-01-27 20:52:11,145 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property NodeNumberPerReadme&lt;br /&gt;2021-01-27 20:52:11,146 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property MoveConfigToOH&lt;br /&gt;2021-01-27 20:52:11,146 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property SelectivePatchingEnabled&lt;br /&gt;2021-01-27 20:52:11,146 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property ConfigurationSnapshot&lt;br /&gt;2021-01-27 20:52:11,146 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property MinimumOPatchVersion&lt;br /&gt;2021-01-27 20:52:11,146 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property IntgFactoryClass&lt;br /&gt;2021-01-27 20:52:11,146 FINEST [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Found property customLogPath&lt;br /&gt;2021-01-27 20:52:11,154 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.CRSTopologyBuilder - Creating config graph from instance&lt;br /&gt;2021-01-27 20:52:11,179 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBBaseProductSupport - Actions loaded...&lt;br /&gt;2021-01-27 20:52:11,182 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.SDBProductSupport - Actions loaded...&lt;br /&gt;2021-01-27 20:52:11,208 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.DBPatchingHelper - isSingleSession: false&lt;br /&gt;2021-01-27 20:52:11,208 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.DBPatchingHelper - prepareSession: false&lt;br /&gt;2021-01-27 20:52:11,208 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.DBPatchingHelper - switchSession: false&lt;br /&gt;2021-01-27 20:52:11,208 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.DBPatchingHelper - oopEnabled: false&lt;br /&gt;2021-01-27 20:52:11,211 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - OPatchAutoOptions configured options:&lt;br /&gt;2021-01-27 20:52:11,212 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: patch.location:patch-location Value:/u01/swtmp/32226219/&lt;br /&gt;2021-01-27 20:52:11,212 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: home:-oh Value:/u01/app/18.3.0/grid/&lt;br /&gt;2021-01-27 20:52:11,212 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: log:-log Value:/u01/app/18.3.0/grid/cfgtoollogs/opatchauto/opatchauto2021-01-27_08-52-10PM.log&lt;br /&gt;2021-01-27 20:52:11,212 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: log_priority:-logLevel Value:FINEST&lt;br /&gt;2021-01-27 20:52:11,212 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: customLogDir:-customLogDir Value:/u01/app/18.3.0/grid/cfgtoollogs&lt;br /&gt;2021-01-27 20:52:11,212 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: analyze:-analyze Value:true&lt;br /&gt;2021-01-27 20:52:11,212 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: inventory.pointer.location:-invPtrLoc Value:/u01/app/18.3.0/grid//oraInst.loc&lt;br /&gt;2021-01-27 20:52:11,212 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: host:-host Value:rac1.example.com&lt;br /&gt;2021-01-27 20:52:11,212 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: patch.plan:-plan Value:crs-rolling&lt;br /&gt;2021-01-27 20:52:11,213 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: format:-format Value:xml&lt;br /&gt;2021-01-27 20:52:11,213 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: output:-output Value:console&lt;br /&gt;2021-01-27 20:52:11,213 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: customconfigdir:-customConfigDir Value:/u01/app/18.3.0/grid/opatchautocfg/db&lt;br /&gt;2021-01-27 20:52:11,213 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: nonrolling:-nonrolling Value:false&lt;br /&gt;2021-01-27 20:52:11,213 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoOptions - Option: session:-session Value:7NBB&lt;br /&gt;2021-01-27 20:52:11,215 FINE  [1] com.oracle.glcm.patch.auto.tracking.PatchTracking - Adding new execution with id 1 to patch tracking session 7NBB&lt;br /&gt;2021-01-27 20:52:11,222 FINE  [1] com.oracle.glcm.patch.auto.tracking.PatchTracking - Saving patch tracking session to /u01/app/18.3.0/grid/opatchautocfg/db/sessioninfo/7NBB.json&lt;br /&gt;2021-01-27 20:52:11,421 INFO  [1] com.oracle.glcm.patch.auto.OPatchAuto - The id for this session is 7NBB&lt;br /&gt;2021-01-27 20:52:11,422 INFO  [1] com.oracle.cie.common.util.reporting.CommonReporter - Reporting console output : Message{id='null', message='The id for this session is 7NBB'}&lt;br /&gt;2021-01-27 20:52:11,424 FINEST [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.DBPatchingHelper - requestedHostName: rac1.example.com&lt;br /&gt;2021-01-27 20:52:11,425 FINEST [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.DBPatchingHelper - formattedHostName: rac1&lt;br /&gt;2021-01-27 20:52:11,425 WARNING [1] com.oracle.glcm.patch.auto.credential.CredentialManager - Unable to locate credential for host rac1&lt;br /&gt;2021-01-27 20:52:11,425 FINE  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.topology.DBPatchingHelper - Permissions: 700&lt;br /&gt;2021-01-27 20:52:11,428 FINE  [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - System Call command is: [/bin/su, root, -m, -c, chmod 700 /u01/app/18.3.0/grid/.patch_storage]&lt;br /&gt;2021-01-27 20:52:11,448 FINEST [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - Output message:&lt;br /&gt;2021-01-27 20:52:11,448 FINEST [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - Return code: 0&lt;br /&gt;2021-01-27 20:52:11,448 FINEST [1] com.oracle.glcm.patch.auto.db.integration.model.plan.PatchingProcessInitializer - Operation type:apply&lt;br /&gt;2021-01-27 20:52:11,453 FINER [1] com.oracle.glcm.patch.auto.db.framework.sdk.patchplanner.PatchPlanEnv - Unrecognized property "autoDeploymentSubType"&lt;br /&gt;2021-01-27 20:52:11,460 INFO  [1] com.oracle.glcm.patch.auto.OPatchAutoHelper - Executing command [bash, -c, ORACLE_HOME=/u01/app/18.3.0/grid /u01/app/18.3.0/grid/bin/orabasehome]&lt;br /&gt;2021-01-27 20:52:11,461 FINE  [1] com.oracle.glcm.patch.auto.OPatchAutoHelper - Executing command [bash, -c, ORACLE_HOME=/u01/app/18.3.0/grid /u01/app/18.3.0/grid/bin/orabasehome] in dir null with env null&lt;br /&gt;2021-01-27 20:52:11,477 INFO  [1] com.oracle.helper.util.HelperUtility - Orabasehome Output :&lt;br /&gt;/u01/app/18.3.0/grid&lt;br /&gt;&lt;br /&gt;2021-01-27 20:52:11,477 INFO  [1] com.oracle.helper.util.HelperUtility - Oracle Base Home for /u01/app/18.3.0/grid is /u01/app/18.3.0/grid&lt;br /&gt;2021-01-27 20:52:11,478 WARNING [1] com.oracle.glcm.patch.auto.credential.CredentialManager - Unable to locate credential for host rac1&lt;br /&gt;2021-01-27 20:52:11,478 FINE  [1] com.oracle.glcm.patch.auto.db.framework.core.oplan.IOUtils - Change the permission of the file /u01/app/18.3.0/grid/cfgtoollogs/opatchautodbto 775&lt;br /&gt;2021-01-27 20:52:11,478 FINE  [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - System Call command is: [/bin/su, grid, -m, -c, chmod 775 /u01/app/18.3.0/grid/cfgtoollogs/opatchautodb]&lt;br /&gt;2021-01-27 20:52:11,492 FINEST [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - Output message:&lt;br /&gt;2021-01-27 20:52:11,492 FINEST [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - Return code: 0&lt;br /&gt;2021-01-27 20:52:11,494 INFO  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.impl.PatchPackageFactoryImpl - Entering getPatchPackageFromDir, getting patch object for the given patch location /u01/swtmp/32226219&lt;br /&gt;2021-01-27 20:52:11,495 FINE  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.impl.PatchPackageFactoryImpl - Adding to the patch factory all supported PatchValidatorsAndGenerators. &lt;br /&gt;2021-01-27 20:52:11,499 FINE  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.impl.PatchPackageFactoryImpl - Adding PatchValidatorAndGenerator class com.oracle.glcm.patch.auto.db.framework.core.patch.OPatchBundlePatchValidatorAndGenerator&lt;br /&gt;2021-01-27 20:52:11,499 FINEST [1] oracle.dbsysmodel.patchsdk.PatchFactory - ENTRY&lt;br /&gt;2021-01-27 20:52:11,499 FINE  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.impl.PatchPackageFactoryImpl - Adding PatchValidatorAndGenerator class com.oracle.glcm.patch.auto.db.framework.core.patch.OPatchSingletonPatchValidatorAndGenerator&lt;br /&gt;2021-01-27 20:52:11,499 FINEST [1] oracle.dbsysmodel.patchsdk.PatchFactory - ENTRY&lt;br /&gt;2021-01-27 20:52:11,499 FINE  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.impl.PatchPackageFactoryImpl - Adding PatchValidatorAndGenerator class com.oracle.glcm.patch.auto.db.framework.core.patch.CompositePatchValidatorAndGenerator&lt;br /&gt;2021-01-27 20:52:11,500 FINEST [1] oracle.dbsysmodel.patchsdk.PatchFactory - ENTRY&lt;br /&gt;2021-01-27 20:52:11,500 FINE  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.impl.PatchPackageFactoryImpl - Adding PatchValidatorAndGenerator class com.oracle.glcm.patch.auto.db.framework.core.patch.ExapatchPatchValidatorAndGenerator&lt;br /&gt;2021-01-27 20:52:11,500 FINEST [1] oracle.dbsysmodel.patchsdk.PatchFactory - ENTRY&lt;br /&gt;2021-01-27 20:52:11,500 FINE  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.impl.PatchPackageFactoryImpl - Adding PatchValidatorAndGenerator class com.oracle.glcm.patch.auto.db.framework.core.patch.DefaultPatchValidatorAndGenerator&lt;br /&gt;2021-01-27 20:52:11,500 FINEST [1] oracle.dbsysmodel.patchsdk.PatchFactory - ENTRY&lt;br /&gt;2021-01-27 20:52:11,500 FINEST [1] oracle.dbsysmodel.patchsdk.PatchFactory - ENTRY&lt;br /&gt;2021-01-27 20:52:11,500 FINEST [1] oracle.dbsysmodel.patchsdk.PatchFactory - patchLocation /u01/swtmp/32226219&lt;br /&gt;2021-01-27 20:52:12,036 FINE  [1] oracle.dbsysmodel.patchsdk.PatchFactory - Patch represented by the given patch location /u01/swtmp/32226219 is an Engineered System Patch.&lt;br /&gt;2021-01-27 20:52:12,078 FINE  [1] oracle.dbsysmodel.patchsdk.PatchFactory - Trying to create sub patch with the PatchValidatorAndGenerator com.oracle.glcm.patch.auto.db.framework.core.patch.OPatchBundlePatchValidatorAndGenerator&lt;br /&gt;2021-01-27 20:52:12,078 INFO  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.OPatchBundlePatchValidatorAndGenerator - Bundle.xml does not exist&lt;br /&gt;2021-01-27 20:52:12,079 FINE  [1] oracle.dbsysmodel.patchsdk.PatchFactory - Trying to create sub patch with the PatchValidatorAndGenerator com.oracle.glcm.patch.auto.db.framework.core.patch.OPatchSingletonPatchValidatorAndGenerator&lt;br /&gt;2021-01-27 20:52:12,079 INFO  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.OPatchSingletonPatchValidatorAndGenerator - inventory.xml found at /u01/swtmp/32226219/32216973/etc/config/inventory.xml which implies it is an OPatch Singleton patch&lt;br /&gt;2021-01-27 20:52:12,081 INFO  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.PatchMetadaReader - Command for patch metadata::/u01/app/18.3.0/grid/perl/bin/perl  /u01/app/18.3.0/grid/OPatch/auto/database/bin/OPatchAutoBinary.pl query patchinfo -patch_location /u01/swtmp/32226219/32216973 -result /u01/app/18.3.0/grid/OPatch/auto/dbtmp/result.ser&lt;br /&gt;2021-01-27 20:52:12,081 FINE  [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - System Call command is: [/bin/su, grid, -m, -c, /u01/app/18.3.0/grid/perl/bin/perl  /u01/app/18.3.0/grid/OPatch/auto/database/bin/OPatchAutoBinary.pl query patchinfo -patch_location /u01/swtmp/32226219/32216973 -result /u01/app/18.3.0/grid/OPatch/auto/dbtmp/result.ser]&lt;br /&gt;2021-01-27 20:52:12,657 FINEST [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - Error message:Exception in thread "main" java.util.ServiceConfigurationError: java.nio.file.spi.FileSystemProvider: Provider org.apache.sshd.client.subsystem.sftp.fs.SftpFileSystemProvider could not be instantiated&lt;br /&gt;	at java.util.ServiceLoader.fail(ServiceLoader.java:232)&lt;br /&gt;	at java.util.ServiceLoader.access$100(ServiceLoader.java:185)&lt;br /&gt;	at java.util.ServiceLoader$LazyIterator.nextService(ServiceLoader.java:384)&lt;br /&gt;	at java.util.ServiceLoader$LazyIterator.next(ServiceLoader.java:404)&lt;br /&gt;	at java.util.ServiceLoader$1.next(ServiceLoader.java:480)&lt;br /&gt;	at java.nio.file.spi.FileSystemProvider.loadInstalledProviders(FileSystemProvider.java:119)&lt;br /&gt;	at java.nio.file.spi.FileSystemProvider.access$000(FileSystemProvider.java:77)&lt;br /&gt;	at java.nio.file.spi.FileSystemProvider$1.run(FileSystemProvider.java:169)&lt;br /&gt;	at java.nio.file.spi.FileSystemProvider$1.run(FileSystemProvider.java:166)&lt;br /&gt;	at java.security.AccessController.doPrivileged(Native Method)&lt;br /&gt;	at java.nio.file.spi.FileSystemProvider.installedProviders(FileSystemProvider.java:166)&lt;br /&gt;	at java.nio.file.FileSystems.newFileSystem(FileSystems.java:388)&lt;br /&gt;	at oracle.opatch.wrappers.WrapperFactory.loadWrapperProvider(WrapperFactory.java:144)&lt;br /&gt;	at oracle.opatch.wrappers.WrapperFactory.loadWrapperProvider(WrapperFactory.java:103)&lt;br /&gt;	at oracle.opatch.wrappers.WrapperFactory.getNioServiceWrapper(WrapperFactory.java:71)&lt;br /&gt;	at oracle.opatch.opatchutil.OUSession.phbasedir(OUSession.java:2594)&lt;br /&gt;	at oracle.opatch.opatchsdk.OPatchPatch.getPatches(OPatchPatch.java:486)&lt;br /&gt;	at oracle.opatch.opatchsdk.OPatchPatch.getPatchesNoSymbolResolve(OPatchPatch.java:456)&lt;br /&gt;	at oracle.opatchauto.core.utility.operation.PatchMetadataQueryOperation.getPatchInfo(PatchMetadataQueryOperation.java:45)&lt;br /&gt;	at oracle.opatchauto.core.utility.operation.PatchMetadataQueryOperation.execute(PatchMetadataQueryOperation.java:26)&lt;br /&gt;	at oracle.opatchauto.core.OpatchAutoCoreUtility.main(OpatchAutoCoreUtility.java:41)&lt;br /&gt;Caused by: java.lang.ExceptionInInitializerError&lt;br /&gt;	at javax.crypto.JceSecurityManager.&amp;lt;clinit&gt;(JceSecurityManager.java:65)&lt;br /&gt;	at javax.crypto.Cipher.getConfiguredPermission(Cipher.java:2590)&lt;br /&gt;	at javax.crypto.Cipher.getMaxAllowedKeyLength(Cipher.java:2614)&lt;br /&gt;	at org.apache.sshd.common.cipher.Cipher.checkSupported(Cipher.java:80)&lt;br /&gt;	at org.apache.sshd.common.cipher.BuiltinCiphers.&amp;lt;init&gt;(BuiltinCiphers.java:104)&lt;br /&gt;	at org.apache.sshd.common.cipher.BuiltinCiphers.&amp;lt;clinit&gt;(BuiltinCiphers.java:55)&lt;br /&gt;	at org.apache.sshd.common.BaseBuilder.&amp;lt;clinit&gt;(BaseBuilder.java:70)&lt;br /&gt;	at org.apache.sshd.client.SshClient.setUpDefaultClient(SshClient.java:778)&lt;br /&gt;	at org.apache.sshd.client.subsystem.sftp.fs.SftpFileSystemProvider.&amp;lt;init&gt;(SftpFileSystemProvider.java:170)&lt;br /&gt;	at org.apache.sshd.client.subsystem.sftp.fs.SftpFileSystemProvider.&amp;lt;init&gt;(SftpFileSystemProvider.java:161)&lt;br /&gt;	at org.apache.sshd.client.subsystem.sftp.fs.SftpFileSystemProvider.&amp;lt;init&gt;(SftpFileSystemProvider.java:157)&lt;br /&gt;	at org.apache.sshd.client.subsystem.sftp.fs.SftpFileSystemProvider.&amp;lt;init&gt;(SftpFileSystemProvider.java:144)&lt;br /&gt;	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br /&gt;	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)&lt;br /&gt;	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)&lt;br /&gt;	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)&lt;br /&gt;	at java.lang.Class.newInstance(Class.java:442)&lt;br /&gt;	at java.util.ServiceLoader$LazyIterator.nextService(ServiceLoader.java:380)&lt;br /&gt;	... 18 more&lt;br /&gt;Caused by: java.lang.SecurityException: Can not initialize cryptographic mechanism&lt;br /&gt;	at javax.crypto.JceSecurity.&amp;lt;clinit&gt;(JceSecurity.java:93)&lt;br /&gt;	... 36 more&lt;br /&gt;Caused by: java.lang.SecurityException: The jurisdiction policy files are not signed by the expected signer! (Policy files are specific per major JDK release.Ensure the correct version is installed.)&lt;br /&gt;	at javax.crypto.JarVerifier.verifyPolicySigned(JarVerifier.java:336)&lt;br /&gt;	at javax.crypto.JceSecurity.loadPolicies(JceSecurity.java:378)&lt;br /&gt;	at javax.crypto.JceSecurity.setupJurisdictionPolicies(JceSecurity.java:323)&lt;br /&gt;	at javax.crypto.JceSecurity.access$000(JceSecurity.java:50)&lt;br /&gt;	at javax.crypto.JceSecurity$1.run(JceSecurity.java:85)&lt;br /&gt;	at java.security.AccessController.doPrivileged(Native Method)&lt;br /&gt;	at javax.crypto.JceSecurity.&amp;lt;clinit&gt;(JceSecurity.java:82)&lt;br /&gt;	... 36 more&lt;br /&gt;&lt;br /&gt;2021-01-27 20:52:12,657 FINEST [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - Output message:&lt;br /&gt;2021-01-27 20:52:12,657 FINEST [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - Return code: 1&lt;br /&gt;2021-01-27 20:52:12,657 INFO  [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - Is retry required=false&lt;br /&gt;2021-01-27 20:52:12,657 FINE  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.PatchMetadaReader - Query output::&lt;br /&gt;2021-01-27 20:52:12,657 FINE  [1] com.oracle.glcm.patch.auto.db.framework.core.patch.PatchMetadaReader - Query err::Exception in thread "main" java.util.ServiceConfigurationError: java.nio.file.spi.FileSystemProvider: Provider org.apache.sshd.client.subsystem.sftp.fs.SftpFileSystemProvider could not be instantiated&lt;br /&gt;	at java.util.ServiceLoader.fail(ServiceLoader.java:232)&lt;br /&gt;	at java.util.ServiceLoader.access$100(ServiceLoader.java:185)&lt;br /&gt;	at java.util.ServiceLoader$LazyIterator.nextService(ServiceLoader.java:384)&lt;br /&gt;	at java.util.ServiceLoader$LazyIterator.next(ServiceLoader.java:404)&lt;br /&gt;	at java.util.ServiceLoader$1.next(ServiceLoader.java:480)&lt;br /&gt;	at java.nio.file.spi.FileSystemProvider.loadInstalledProviders(FileSystemProvider.java:119)&lt;br /&gt;	at java.nio.file.spi.FileSystemProvider.access$000(FileSystemProvider.java:77)&lt;br /&gt;	at java.nio.file.spi.FileSystemProvider$1.run(FileSystemProvider.java:169)&lt;br /&gt;	at java.nio.file.spi.FileSystemProvider$1.run(FileSystemProvider.java:166)&lt;br /&gt;	at java.security.AccessController.doPrivileged(Native Method)&lt;br /&gt;	at java.nio.file.spi.FileSystemProvider.installedProviders(FileSystemProvider.java:166)&lt;br /&gt;	at java.nio.file.FileSystems.newFileSystem(FileSystems.java:388)&lt;br /&gt;	at oracle.opatch.wrappers.WrapperFactory.loadWrapperProvider(WrapperFactory.java:144)&lt;br /&gt;	at oracle.opatch.wrappers.WrapperFactory.loadWrapperProvider(WrapperFactory.java:103)&lt;br /&gt;	at oracle.opatch.wrappers.WrapperFactory.getNioServiceWrapper(WrapperFactory.java:71)&lt;br /&gt;	at oracle.opatch.opatchutil.OUSession.phbasedir(OUSession.java:2594)&lt;br /&gt;	at oracle.opatch.opatchsdk.OPatchPatch.getPatches(OPatchPatch.java:486)&lt;br /&gt;	at oracle.opatch.opatchsdk.OPatchPatch.getPatchesNoSymbolResolve(OPatchPatch.java:456)&lt;br /&gt;	at oracle.opatchauto.core.utility.operation.PatchMetadataQueryOperation.getPatchInfo(PatchMetadataQueryOperation.java:45)&lt;br /&gt;	at oracle.opatchauto.core.utility.operation.PatchMetadataQueryOperation.execute(PatchMetadataQueryOperation.java:26)&lt;br /&gt;	at oracle.opatchauto.core.OpatchAutoCoreUtility.main(OpatchAutoCoreUtility.java:41)&lt;br /&gt;Caused by: java.lang.ExceptionInInitializerError&lt;br /&gt;	at javax.crypto.JceSecurityManager.&amp;lt;clinit&gt;(JceSecurityManager.java:65)&lt;br /&gt;	at javax.crypto.Cipher.getConfiguredPermission(Cipher.java:2590)&lt;br /&gt;	at javax.crypto.Cipher.getMaxAllowedKeyLength(Cipher.java:2614)&lt;br /&gt;	at org.apache.sshd.common.cipher.Cipher.checkSupported(Cipher.java:80)&lt;br /&gt;	at org.apache.sshd.common.cipher.BuiltinCiphers.&amp;lt;init&gt;(BuiltinCiphers.java:104)&lt;br /&gt;	at org.apache.sshd.common.cipher.BuiltinCiphers.&amp;lt;clinit&gt;(BuiltinCiphers.java:55)&lt;br /&gt;	at org.apache.sshd.common.BaseBuilder.&amp;lt;clinit&gt;(BaseBuilder.java:70)&lt;br /&gt;	at org.apache.sshd.client.SshClient.setUpDefaultClient(SshClient.java:778)&lt;br /&gt;	at org.apache.sshd.client.subsystem.sftp.fs.SftpFileSystemProvider.&amp;lt;init&gt;(SftpFileSystemProvider.java:170)&lt;br /&gt;	at org.apache.sshd.client.subsystem.sftp.fs.SftpFileSystemProvider.&amp;lt;init&gt;(SftpFileSystemProvider.java:161)&lt;br /&gt;	at org.apache.sshd.client.subsystem.sftp.fs.SftpFileSystemProvider.&amp;lt;init&gt;(SftpFileSystemProvider.java:157)&lt;br /&gt;	at org.apache.sshd.client.subsystem.sftp.fs.SftpFileSystemProvider.&amp;lt;init&gt;(SftpFileSystemProvider.java:144)&lt;br /&gt;	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br /&gt;	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)&lt;br /&gt;	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)&lt;br /&gt;	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)&lt;br /&gt;	at java.lang.Class.newInstance(Class.java:442)&lt;br /&gt;	at java.util.ServiceLoader$LazyIterator.nextService(ServiceLoader.java:380)&lt;br /&gt;	... 18 more&lt;br /&gt;Caused by: java.lang.SecurityException: Can not initialize cryptographic mechanism&lt;br /&gt;	at javax.crypto.JceSecurity.&amp;lt;clinit&gt;(JceSecurity.java:93)&lt;br /&gt;	... 36 more&lt;br /&gt;Caused by: java.lang.SecurityException: The jurisdiction policy files are not signed by the expected signer! (Policy files are specific per major JDK release.Ensure the correct version is installed.)&lt;br /&gt;	at javax.crypto.JarVerifier.verifyPolicySigned(JarVerifier.java:336)&lt;br /&gt;	at javax.crypto.JceSecurity.loadPolicies(JceSecurity.java:378)&lt;br /&gt;	at javax.crypto.JceSecurity.setupJurisdictionPolicies(JceSecurity.java:323)&lt;br /&gt;	at javax.crypto.JceSecurity.access$000(JceSecurity.java:50)&lt;br /&gt;	at javax.crypto.JceSecurity$1.run(JceSecurity.java:85)&lt;br /&gt;	at java.security.AccessController.doPrivileged(Native Method)&lt;br /&gt;	at javax.crypto.JceSecurity.&amp;lt;clinit&gt;(JceSecurity.java:82)&lt;br /&gt;	... 36 more&lt;br /&gt;&lt;br /&gt;2021-01-27 20:52:12,658 FINE  [1] com.oracle.cie.common.util.ResourceBundleManager - The code () is null or not an integer.&lt;br /&gt;2021-01-27 20:52:12,658 WARNING [1] com.oracle.glcm.patch.auto.db.integration.model.plan.PatchingProcessInitializer - Patch Collection failed: &lt;br /&gt;2021-01-27 20:52:12,659 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.db.framework.core.patch.OPatchSingletonPatchValidatorAndGenerator.generate(OPatchSingletonPatchValidatorAndGenerator.java:151)&lt;br /&gt;2021-01-27 20:52:12,659 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - oracle.dbsysmodel.patchsdk.PatchFactory.getInstance(PatchFactory.java:246)&lt;br /&gt;2021-01-27 20:52:12,659 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.db.framework.core.patch.impl.PatchPackageFactoryImpl.getPatchPackageFromDir(PatchPackageFactoryImpl.java:75)&lt;br /&gt;2021-01-27 20:52:12,659 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.db.product.patch.BundlePatchObject.prcoessPatch(BundlePatchObject.java:131)&lt;br /&gt;2021-01-27 20:52:12,659 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.db.product.patch.BundlePatchObject.createPatchBagForPatchLocation(BundlePatchObject.java:124)&lt;br /&gt;2021-01-27 20:52:12,659 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.db.product.patch.BundlePatchObject.&amp;lt;init&gt;(BundlePatchObject.java:77)&lt;br /&gt;2021-01-27 20:52:12,659 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.db.integration.model.productsupport.patch.PatchInformationInitializer.createPatch(PatchInformationInitializer.java:43)&lt;br /&gt;2021-01-27 20:52:12,659 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.db.integration.model.plan.PatchingProcessInitializer.initializePatchPackageBag(PatchingProcessInitializer.java:80)&lt;br /&gt;2021-01-27 20:52:12,659 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.db.integration.model.plan.PatchingProcessInitializer.processInit(PatchingProcessInitializer.java:66)&lt;br /&gt;2021-01-27 20:52:12,659 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBCommonSupport.initializePatchData(DBCommonSupport.java:126)&lt;br /&gt;2021-01-27 20:52:12,659 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBBaseProductSupport.initializePatchData(DBBaseProductSupport.java:408)&lt;br /&gt;2021-01-27 20:52:12,660 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBCommonSupport.loadTopology(DBCommonSupport.java:163)&lt;br /&gt;2021-01-27 20:52:12,660 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBBaseProductSupport.loadTopology(DBBaseProductSupport.java:195)&lt;br /&gt;2021-01-27 20:52:12,660 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBProductSupport.loadTopology(DBProductSupport.java:69)&lt;br /&gt;2021-01-27 20:52:12,660 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.OPatchAuto.loadTopology(OPatchAuto.java:1732)&lt;br /&gt;2021-01-27 20:52:12,660 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.OPatchAuto.prepareOrchestration(OPatchAuto.java:730)&lt;br /&gt;2021-01-27 20:52:12,660 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.OPatchAuto.orchestrate(OPatchAuto.java:397)&lt;br /&gt;2021-01-27 20:52:12,660 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.OPatchAuto.orchestrate(OPatchAuto.java:344)&lt;br /&gt;2021-01-27 20:52:12,660 FINE  [1] com.oracle.glcm.patch.auto.db.product.GILogger - com.oracle.glcm.patch.auto.OPatchAuto.main(OPatchAuto.java:212)&lt;br /&gt;2021-01-27 20:52:12,660 FINE  [1] com.oracle.cie.common.util.ResourceBundleManager - The code (OPATCHAUTO-72043: Patch collection failed.&lt;br /&gt;OPATCHAUTO-72043: Failed to create bundle patch object.&lt;br /&gt;OPATCHAUTO-72043: Please verify the patch supplied.) is null or not an integer.&lt;br /&gt;2021-01-27 20:52:12,660 INFO  [1] com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBBaseProductSupport - Space available after session: 32877 MB&lt;br /&gt;2021-01-27 20:52:12,662 FINE  [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - System Call command is: [/bin/su, root, -m, -c, cp /tmp/patchingsummary.xml /u01/app/18.3.0/grid/opatchautocfg/db/sessioninfo/]&lt;br /&gt;2021-01-27 20:52:12,673 FINEST [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - Output message:&lt;br /&gt;2021-01-27 20:52:12,673 FINEST [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - Return code: 0&lt;br /&gt;2021-01-27 20:52:12,674 FINE  [1] com.oracle.glcm.patch.auto.db.framework.core.oplan.IOUtils - Change the permission of the file /u01/app/18.3.0/grid/opatchautocfg/db/sessioninfo/patchingsummary.xmlto 775&lt;br /&gt;2021-01-27 20:52:12,674 FINE  [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - System Call command is: [/bin/su, root, -m, -c, chmod 775 /u01/app/18.3.0/grid/opatchautocfg/db/sessioninfo/patchingsummary.xml]&lt;br /&gt;2021-01-27 20:52:12,683 FINEST [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - Output message:&lt;br /&gt;2021-01-27 20:52:12,684 FINEST [1] com.oracle.glcm.patch.auto.db.product.executor.GISystemCall - Return code: 0&lt;br /&gt;2021-01-27 20:52:12,684 SEVERE [1] com.oracle.glcm.patch.auto.OPatchAuto - OPatchAuto failed.&lt;br /&gt;com.oracle.glcm.patch.auto.OPatchAutoException: OPATCHAUTO-72043: Patch collection failed.&lt;br /&gt;OPATCHAUTO-72043: Failed to create bundle patch object.&lt;br /&gt;OPATCHAUTO-72043: Please verify the patch supplied.&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.plan.PatchingProcessInitializer.initializePatchPackageBag(PatchingProcessInitializer.java:97)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.plan.PatchingProcessInitializer.processInit(PatchingProcessInitializer.java:66)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBCommonSupport.initializePatchData(DBCommonSupport.java:126)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBBaseProductSupport.initializePatchData(DBBaseProductSupport.java:408)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBCommonSupport.loadTopology(DBCommonSupport.java:163)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBBaseProductSupport.loadTopology(DBBaseProductSupport.java:195)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.productsupport.DBProductSupport.loadTopology(DBProductSupport.java:69)&lt;br /&gt;	at com.oracle.glcm.patch.auto.OPatchAuto.loadTopology(OPatchAuto.java:1732)&lt;br /&gt;	at com.oracle.glcm.patch.auto.OPatchAuto.prepareOrchestration(OPatchAuto.java:730)&lt;br /&gt;	at com.oracle.glcm.patch.auto.OPatchAuto.orchestrate(OPatchAuto.java:397)&lt;br /&gt;	at com.oracle.glcm.patch.auto.OPatchAuto.orchestrate(OPatchAuto.java:344)&lt;br /&gt;	at com.oracle.glcm.patch.auto.OPatchAuto.main(OPatchAuto.java:212)&lt;br /&gt;Caused by: com.oracle.glcm.patch.auto.db.integration.model.productsupport.patch.PatchCollectionException: &lt;br /&gt;	at com.oracle.glcm.patch.auto.db.framework.core.patch.OPatchSingletonPatchValidatorAndGenerator.generate(OPatchSingletonPatchValidatorAndGenerator.java:151)&lt;br /&gt;	at oracle.dbsysmodel.patchsdk.PatchFactory.getInstance(PatchFactory.java:246)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.framework.core.patch.impl.PatchPackageFactoryImpl.getPatchPackageFromDir(PatchPackageFactoryImpl.java:75)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.product.patch.BundlePatchObject.prcoessPatch(BundlePatchObject.java:131)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.product.patch.BundlePatchObject.createPatchBagForPatchLocation(BundlePatchObject.java:124)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.product.patch.BundlePatchObject.&amp;lt;init&gt;(BundlePatchObject.java:77)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.productsupport.patch.PatchInformationInitializer.createPatch(PatchInformationInitializer.java:43)&lt;br /&gt;	at com.oracle.glcm.patch.auto.db.integration.model.plan.PatchingProcessInitializer.initializePatchPackageBag(PatchingProcessInitializer.java:80)&lt;br /&gt;	... 11 more&lt;br /&gt;2021-01-27 20:52:12,685 INFO  [1] com.oracle.cie.common.util.reporting.CommonReporter - Reporting console output : Message{id='null', message='OPATCHAUTO-72043: Patch collection failed.&lt;br /&gt;OPATCHAUTO-72043: Failed to create bundle patch object.&lt;br /&gt;OPATCHAUTO-72043: Please verify the patch supplied.'}&lt;br /&gt;2021-01-27 20:52:12,685 INFO  [1] com.oracle.cie.common.util.reporting.CommonReporter - Reporting console output : Message{id='null', message='OPatchAuto failed.'}&lt;br /&gt;&lt;/pre&gt;The errors pointed out to Java: &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=31997805.8"&gt;Bug 31997805 - Exception In Thread "root thread" java.lang.exceptionininitializererror in 12.2 Database (Doc ID 31997805.8)&lt;/a&gt;. To verify that hypothesis, I downloaded &lt;a href="https://www.oracle.com/java/technologies/javase-jce8-downloads.html"&gt;Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy Files 8&lt;/a&gt;. I copied both &lt;code&gt;local_policy.jar&lt;/code&gt; and &lt;code&gt;US_export_policy.jar&lt;/code&gt; to &lt;code&gt;/u01/app/18.3.0/grid/OPatch/jre/lib/security&lt;/code&gt;, and reran &lt;code&gt;opatchauto&lt;/code&gt;.&lt;br/&gt;Sure enough, the analyze command was successful: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[root@rac1 ~]# /u01/app/18.3.0/grid/OPatch/opatchauto apply -analyze /u01/swtmp/32226219/ -oh /u01/app/18.3.0/grid/  &lt;br /&gt;OPatchauto session is initiated at Wed Jan 27 21:02:05 2021&lt;br /&gt;&lt;br /&gt;System initialization log file is /u01/app/18.3.0/grid/cfgtoollogs/opatchautodb/systemconfig2021-01-27_09-02-08PM.log.&lt;br /&gt;&lt;br /&gt;Session log file is /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/opatchauto2021-01-27_09-02-10PM.log&lt;br /&gt;The id for this session is D2B1&lt;br /&gt;&lt;br /&gt;Executing OPatch prereq operations to verify patch applicability on home /u01/app/18.3.0/grid&lt;br /&gt;Patch applicability verified successfully on home /u01/app/18.3.0/grid&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Executing patch validation checks on home /u01/app/18.3.0/grid&lt;br /&gt;Patch validation checks successfully completed on home /u01/app/18.3.0/grid&lt;br /&gt;&lt;br /&gt;OPatchAuto successful.&lt;br /&gt;&lt;br /&gt;--------------------------------Summary--------------------------------&lt;br /&gt;&lt;br /&gt;Analysis for applying patches has completed successfully:&lt;br /&gt;&lt;br /&gt;Host:rac1&lt;br /&gt;CRS Home:/u01/app/18.3.0/grid&lt;br /&gt;Version:18.0.0.0.0&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;==Following patches were SUCCESSFULLY analyzed to be applied:&lt;br /&gt;&lt;br /&gt;Patch: /u01/swtmp/32226219/32216973&lt;br /&gt;Log: /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2021-01-27_21-02-24PM_1.log&lt;br /&gt;&lt;br /&gt;Patch: /u01/swtmp/32226219/32216944&lt;br /&gt;Log: /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2021-01-27_21-02-24PM_1.log&lt;br /&gt;&lt;br /&gt;Patch: /u01/swtmp/32226219/28655963&lt;br /&gt;Log: /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2021-01-27_21-02-24PM_1.log&lt;br /&gt;&lt;br /&gt;Patch: /u01/swtmp/32226219/32240606&lt;br /&gt;Log: /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2021-01-27_21-02-24PM_1.log&lt;br /&gt;&lt;br /&gt;Patch: /u01/swtmp/32226219/32204699&lt;br /&gt;Log: /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2021-01-27_21-02-24PM_1.log&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;OPatchauto session completed at Wed Jan 27 21:02:38 2021&lt;br /&gt;Time taken to complete the session 0 minute, 33 seconds&lt;br /&gt;&lt;/pre&gt;The policy files themselves should not be needed since Java 8 Update 161: &lt;a href="https://www.oracle.com/java/technologies/javase/8u161-relnotes.html#JDK-8170157"&gt;Unlimited cryptography enabled by default&lt;/a&gt;.&lt;br/&gt;The Java version that comes with OPatch 12.2.0.1.23 is newer, so that it should contain the fix: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[grid@rac1 bin]$ /u01/app/18.3.0/grid/OPatch/jre/bin/java -version&lt;br /&gt;java version "1.8.0_271"&lt;br /&gt;Java(TM) SE Runtime Environment (build 1.8.0_271-b03)&lt;br /&gt;Java HotSpot(TM) 64-Bit Server VM (build 25.271-b03, mixed mode)&lt;br /&gt;&lt;/pre&gt;I also checked with several 19c clusters that these policy files were not there. How come if the OPatch version was the same?&lt;br/&gt;&lt;br/&gt;Turns out that when the OPatch was updated, the proper update procedure was not followed: &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=274526.1"&gt;How To Download And Install The Latest OPatch(6880880) Version (Doc ID 274526.1)&lt;/a&gt;: &lt;ul&gt;  &lt;li&gt;Policy files are present in a vanilla 18c home:&lt;pre class="brush:sql"&gt;[grid@rac1 grid]$ unzip -l /u01/swtmp/LINUX.X64_180000_grid_home.zip | grep "OPatch/jre/lib/security/.*.jar"&lt;br /&gt;     3026  06-04-2018 00:52   OPatch/jre/lib/security/US_export_policy.jar&lt;br /&gt;     3527  06-04-2018 00:52   OPatch/jre/lib/security/local_policy.jar&lt;br /&gt;&lt;/pre&gt;&lt;/li&gt;  &lt;li&gt;The old OPatch directory was not removed. Instead a newer OPatch version was copied over the existing OPatch folder.&lt;/li&gt;  &lt;li&gt;Since the old OPatch directory was not removed, the policy files were kept after the newer OPatch version was deployed&lt;/li&gt;&lt;/ul&gt;I just moved the existing OPatch folder and did a clean OPatch deployment: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[grid@rac1 grid]$ mv OPatch/ OPatch_$(date +%Y%m%d)/&lt;br /&gt;[grid@rac1 grid]$ unzip /u01/swtmp/p6880880_190000_Linux-x86-64.zip&lt;br /&gt;&lt;/pre&gt;The apply analyze command ran without errors and I applied the release update later on: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[root@rac1 ~]# /u01/app/18.3.0/grid/OPatch/opatchauto apply -analyze /u01/swtmp/32226219/ -oh /u01/app/18.3.0/grid/&lt;br /&gt;&lt;br /&gt;OPatchauto session is initiated at Wed Jan 27 21:12:01 2021&lt;br /&gt;&lt;br /&gt;System initialization log file is /u01/app/18.3.0/grid/cfgtoollogs/opatchautodb/systemconfig2021-01-27_09-12-04PM.log.&lt;br /&gt;&lt;br /&gt;Session log file is /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/opatchauto2021-01-27_09-12-07PM.log&lt;br /&gt;The id for this session is 3IKL&lt;br /&gt;&lt;br /&gt;Executing OPatch prereq operations to verify patch applicability on home /u01/app/18.3.0/grid&lt;br /&gt;Patch applicability verified successfully on home /u01/app/18.3.0/grid&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Executing patch validation checks on home /u01/app/18.3.0/grid&lt;br /&gt;Patch validation checks successfully completed on home /u01/app/18.3.0/grid&lt;br /&gt;&lt;br /&gt;OPatchAuto successful.&lt;br /&gt;&lt;br /&gt;--------------------------------Summary--------------------------------&lt;br /&gt;&lt;br /&gt;Analysis for applying patches has completed successfully:&lt;br /&gt;&lt;br /&gt;Host:rac1&lt;br /&gt;CRS Home:/u01/app/18.3.0/grid&lt;br /&gt;Version:18.0.0.0.0&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;==Following patches were SUCCESSFULLY analyzed to be applied:&lt;br /&gt;&lt;br /&gt;Patch: /u01/swtmp/32226219/32216973&lt;br /&gt;Log: /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2021-01-27_21-12-21PM_1.log&lt;br /&gt;&lt;br /&gt;Patch: /u01/swtmp/32226219/32216944&lt;br /&gt;Log: /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2021-01-27_21-12-21PM_1.log&lt;br /&gt;&lt;br /&gt;Patch: /u01/swtmp/32226219/28655963&lt;br /&gt;Log: /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2021-01-27_21-12-21PM_1.log&lt;br /&gt;&lt;br /&gt;Patch: /u01/swtmp/32226219/32240606&lt;br /&gt;Log: /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2021-01-27_21-12-21PM_1.log&lt;br /&gt;&lt;br /&gt;Patch: /u01/swtmp/32226219/32204699&lt;br /&gt;Log: /u01/app/18.3.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2021-01-27_21-12-21PM_1.log&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;OPatchauto session completed at Wed Jan 27 21:12:36 2021&lt;br /&gt;Time taken to complete the session 0 minute, 35 seconds&lt;br /&gt;&lt;/pre&gt;It is crucial to follow Oracle instructions to the letter when it makes sense.&lt;br/&gt;Otherwise, it can lead to such uncommon errors. It is also disappointing that &lt;code&gt;opatchauto&lt;/code&gt; did not give any clue what was going on with the default logging level. Thankfully, the logging level can be easily changed. It is a bit verbose but it usually does the job and gives enough information about the cause of an issue.&lt;br/&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/4487842022767485976/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/01/opatchauto-72043-and-jce.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4487842022767485976'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4487842022767485976'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/01/opatchauto-72043-and-jce.html' title='OPATCHAUTO-72043 and JCE'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-5021712743012288694</id><published>2021-01-28T01:52:00.000+06:00</published><updated>2021-01-28T01:52:30.435+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='12.2'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='18c'/><title type='text'>SYS and Extended Data Types</title><content type='html'>It is a widely known fact that Oracle supports a maximum size of 32,767 bytes for the &lt;code&gt;VARCHAR2&lt;/code&gt;, &lt;code&gt;NVARCHAR2&lt;/code&gt;, and &lt;code&gt;RAW&lt;/code&gt; data types (&lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/sqlrf/Data-Types.html#GUID-8EFA29E9-E8D8-40A6-A43E-954908C954A4"&gt;Extended Data Types&lt;/a&gt;) provided that &lt;code&gt;MAX_STRING_SIZE = EXTENDED&lt;/code&gt;. What I recently discovered is that SYS can create such columns even when &lt;code&gt;MAX_STRING_SIZE = STANDARD&lt;/code&gt;. It is possible in 12.2, 18c, 19c. I am unsure about 12.1 since I do not have any of those. &lt;br/&gt;&lt;br/&gt;Firstly, let us try to create a table with a &lt;code&gt;VARCHAR2(32767)&lt;/code&gt; column as non-SYS user: &lt;pre class="brush:sql;highlight:[7,20]"&gt;&lt;br /&gt;SQL&gt; conn tc/tc@localhost/pdb2&lt;br /&gt;Connected.&lt;br /&gt;SQL&gt; sho parameter max_string_size&lt;br /&gt;&lt;br /&gt;NAME                                 TYPE        VALUE&lt;br /&gt;------------------------------------ ----------- ------------------------------&lt;br /&gt;max_string_size                      string      STANDARD&lt;br /&gt;SQL&gt; select banner_full from v$version;&lt;br /&gt;&lt;br /&gt;BANNER_FULL&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production&lt;br /&gt;Version 19.10.0.0.0&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt; create table t(c varchar2(32767));&lt;br /&gt;create table t(c varchar2(32767))&lt;br /&gt;                          *&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-00910: specified length too long for its datatype&lt;br /&gt;&lt;/pre&gt;It fails as expected.&lt;br/&gt;&lt;br/&gt;Now I try the same as SYS - I also switch to my root container to verify that &lt;code&gt;MAX_STRING_SIZE = STANDARD&lt;/code&gt; everywhere: &lt;pre class="brush:sql;highlight:[36]"&gt;&lt;br /&gt;SQL&gt; conn sys/Oracle123@localhost/orcl2 as sysdba&lt;br /&gt;Connected.&lt;br /&gt;SQL&gt; alter session set container=cdb$root;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; sho parameter max_string_size&lt;br /&gt;&lt;br /&gt;NAME                                 TYPE        VALUE&lt;br /&gt;------------------------------------ ----------- ------------------------------&lt;br /&gt;max_string_size                      string      STANDARD&lt;br /&gt;SQL&gt; alter session set container=pdb2;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; sho parameter max_string_size&lt;br /&gt;&lt;br /&gt;NAME                                 TYPE        VALUE&lt;br /&gt;------------------------------------ ----------- ------------------------------&lt;br /&gt;max_string_size                      string      STANDARD&lt;br /&gt;SQL&gt; select banner_full from v$version;&lt;br /&gt;&lt;br /&gt;BANNER_FULL&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production&lt;br /&gt;Version 19.10.0.0.0&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt; create table t(c varchar2(32767));&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt; desc t&lt;br /&gt; Name                                      Null?    Type&lt;br /&gt; ----------------------------------------- -------- ----------------------------&lt;br /&gt; C                                                  VARCHAR2(32767)&lt;br /&gt;&lt;/pre&gt;Let us try to run a DML command: &lt;pre class="brush:sql;highlight:[1,9]"&gt;&lt;br /&gt;SQL&gt; insert into t values (lpad('x',32767,'x'));&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt; select length(c) from t;&lt;br /&gt;&lt;br /&gt; LENGTH(C)&lt;br /&gt;----------&lt;br /&gt;      4000&lt;br /&gt;&lt;/pre&gt;Although it was possible to create a 32K column, somewhere between &lt;code&gt;LPAD&lt;/code&gt; and the data layer I still got 4,000 bytes only.&lt;br/&gt;But is it limited to 4,000 bytes? Not really as the example below demonstrates: &lt;pre class="brush:sql;highlight:[73,81,88]"&gt;&lt;br /&gt;SQL&gt; update t&lt;br /&gt;  2     set c=c||'y';&lt;br /&gt;&lt;br /&gt;1 row updated.&lt;br /&gt;&lt;br /&gt;SQL&gt; select length(c) from t;&lt;br /&gt;&lt;br /&gt; LENGTH(C)&lt;br /&gt;----------&lt;br /&gt;      4001&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; update t&lt;br /&gt;  2     set c=c||c;&lt;br /&gt;&lt;br /&gt;1 row updated.&lt;br /&gt;&lt;br /&gt;SQL&gt; select length(c) from t;&lt;br /&gt;&lt;br /&gt; LENGTH(C)&lt;br /&gt;----------&lt;br /&gt;      8002&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; update t&lt;br /&gt;  2     set c=c||c;&lt;br /&gt;&lt;br /&gt;1 row updated.&lt;br /&gt;&lt;br /&gt;SQL&gt; select length(c) from t;&lt;br /&gt;&lt;br /&gt; LENGTH(C)&lt;br /&gt;----------&lt;br /&gt;     16004&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; update t&lt;br /&gt;  2     set c=c||c;&lt;br /&gt;&lt;br /&gt;1 row updated.&lt;br /&gt;&lt;br /&gt;SQL&gt; select length(c) from t;&lt;br /&gt;&lt;br /&gt; LENGTH(C)&lt;br /&gt;----------&lt;br /&gt;     32008&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; update t&lt;br /&gt;  2     set c=c||c;&lt;br /&gt;update t&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-01489: result of string concatenation is too long&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt; select length(c) from t;&lt;br /&gt;&lt;br /&gt; LENGTH(C)&lt;br /&gt;----------&lt;br /&gt;     32008&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; update t&lt;br /&gt;  2     set c=c||lpad('x',759,'x');&lt;br /&gt;&lt;br /&gt;1 row updated.&lt;br /&gt;&lt;br /&gt;SQL&gt; select length(c) from t;&lt;br /&gt;&lt;br /&gt; LENGTH(C)&lt;br /&gt;----------&lt;br /&gt;     32767&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; update t&lt;br /&gt;  2     set c=c||'x';&lt;br /&gt;update t&lt;br /&gt;       *&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-01489: result of string concatenation is too long&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt; select length(c) from t;&lt;br /&gt;&lt;br /&gt; LENGTH(C)&lt;br /&gt;----------&lt;br /&gt;     32767&lt;br /&gt;&lt;/pre&gt;As expected Oracle stores the column as LOB under the hood: &lt;pre class="brush:sql;highlight:[23]"&gt;&lt;br /&gt;SQL&gt; select dbms_metadata.get_ddl('TABLE', 'T') from dual;&lt;br /&gt;&lt;br /&gt;DBMS_METADATA.GET_DDL('TABLE','T')&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;  CREATE TABLE "SYS"."T"&lt;br /&gt;   (    "C" VARCHAR2(32767)&lt;br /&gt;   ) PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255&lt;br /&gt; NOCOMPRESS LOGGING&lt;br /&gt;  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645&lt;br /&gt;  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1&lt;br /&gt;  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)&lt;br /&gt;  TABLESPACE "SYSTEM"&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select column_name, segment_name, index_name, securefile&lt;br /&gt;  2    from user_lobs&lt;br /&gt;  3   where table_name='T';&lt;br /&gt;&lt;br /&gt;COLUMN_NAME SEGMENT_NAME              INDEX_NAME                SECUREFILE&lt;br /&gt;----------- ------------------------- ------------------------- ----------&lt;br /&gt;C           SYS_LOB0000023954C00001$$ SYS_IL0000023954C00001$$  NO&lt;br /&gt;&lt;/pre&gt;Turns out that Oracle uses that internally: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; drop table t;&lt;br /&gt;&lt;br /&gt;Table dropped.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select table_name, column_name, data_length&lt;br /&gt;  2    from user_tab_cols&lt;br /&gt;  3   where data_type = 'VARCHAR2'&lt;br /&gt;  4     and data_length &gt; 4000;&lt;br /&gt;&lt;br /&gt;TABLE_NAME                COLUMN_NAME          DATA_LENGTH&lt;br /&gt;------------------------- -------------------- -----------&lt;br /&gt;OPATCH_SQL_PATCHES        NODE_NAMES                 32000&lt;br /&gt;SYSDBIMFS_METADATA$       VALUE                       4096&lt;br /&gt;SCHEDULER$_CREDENTIAL     KEY                        32767&lt;br /&gt;V_$DIAG_LOG_EXT           SUPPLEMENTAL_DETAILS        4003&lt;br /&gt;&lt;/pre&gt;Originally I discovered that Oracle uses &lt;code&gt;VARCHAR2(32767)&lt;/code&gt; in its scripts which threw me into a tizzy since the scripts were running without errors in &lt;code&gt;MAX_STRING_SIZE = STANDARD&lt;/code&gt; databases.&lt;br/&gt;It is yet another confirmation that it is not a good idea to use &lt;code&gt;SYS&lt;/code&gt; to do things. &lt;code&gt;SYS&lt;/code&gt; is &lt;a href="https://asktom.oracle.com/pls/apex/f?p=100:11:0::::P11_QUESTION_ID:18785088712670"&gt;a "special" user&lt;/a&gt;.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/5021712743012288694/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/01/sys-and-extended-data-types.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5021712743012288694'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5021712743012288694'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/01/sys-and-extended-data-types.html' title='SYS and Extended Data Types'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-5626387108369749560</id><published>2021-01-23T00:11:00.000+06:00</published><updated>2021-01-23T00:11:05.352+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><title type='text'>Creating a Table for Exchange and Copying Indexes</title><content type='html'>It is something Oracle added in one of the latest Release Updates of 19c. I believe I discovered it either in 19.7 or 19.8 originally. I used 19.10 in this post. &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select banner_full from v$version;&lt;br /&gt;&lt;br /&gt;BANNER_FULL&lt;br /&gt;----------------------------------------------------------------------------------------------------&lt;br /&gt;Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production&lt;br /&gt;Version 19.10.0.0.0&lt;br /&gt;&lt;/pre&gt;&lt;br/&gt;Creating a partitioned table with some local indexes: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; create table t (&lt;br /&gt;  2    created date,&lt;br /&gt;  3    c1 int,&lt;br /&gt;  4    c2 int&lt;br /&gt;  5  )&lt;br /&gt;  6  partition by range(created) interval(numtoyminterval(1, 'year')) (&lt;br /&gt;  7    partition values less than(date'2019-01-01')&lt;br /&gt;  8  );&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create index t_c1_i on t(c2) local;&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;br /&gt;SQL&gt; create index t_c1_c2_i on t(c1, c2) local;&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;br /&gt;SQL&gt; create index t_created_c1_i on t(trunc(created), c1) local;&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;br /&gt;SQL&gt; create index t_desc_i on t(c1 desc, c2) local;&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;/pre&gt;Populating it with some data: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; insert into t values (date'2018-01-01', 1, 10);&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt; insert into t values (date'2019-01-01', 2, 20);&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt; insert into t values (date'2020-01-01', 3, 30);&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;/pre&gt;Now is the actual enhancement - the &lt;b&gt;&lt;i&gt;CLONE INDEXES&lt;/i&gt;&lt;/b&gt; clause: &lt;pre class="brush:sql;highlight:[5]"&gt;&lt;br /&gt;SQL&gt; alter session set events 'trace[sql_ddl]';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; create table tex for exchange with table t clone indexes;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt; alter session set events 'trace[sql_ddl] off';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;/pre&gt;I enabled the SQL_DDL trace event to see the actual DDL statements executed under the hood. &lt;br/&gt;Let us see what indexes are actually created: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; exec dbms_metadata.set_transform_param( -&lt;br /&gt;&gt;   dbms_metadata.session_transform, -&lt;br /&gt;&gt;   'SQLTERMINATOR', true)&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select dbms_metadata.get_ddl('INDEX', index_name) from ind where table_name='TEX';&lt;br /&gt;&lt;br /&gt;DBMS_METADATA.GET_DDL('INDEX',INDEX_NAME)&lt;br /&gt;----------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;  CREATE INDEX "TC"."I_SYS_23689_T_C1_I" ON "TC"."TEX" ("C2")&lt;br /&gt;  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS&lt;br /&gt;  TABLESPACE "USERS" ;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;  CREATE INDEX "TC"."I_SYS_23689_T_C1_C2_I" ON "TC"."TEX" ("C1", "C2")&lt;br /&gt;  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS&lt;br /&gt;  TABLESPACE "USERS" ;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;  CREATE INDEX "TC"."I_SYS_23689_T_CREATED_C1_I" ON "TC"."TEX" (TRUNC("CREATED"), "C1")&lt;br /&gt;  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS&lt;br /&gt;  TABLESPACE "USERS" ;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;  CREATE INDEX "TC"."I_SYS_23689_T_DESC_I" ON "TC"."TEX" ("C1" DESC, "C2")&lt;br /&gt;  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS&lt;br /&gt;  TABLESPACE "USERS" ;&lt;br /&gt;&lt;/pre&gt;Looks good. Let us try to exchange a partition with that table: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; alter table t&lt;br /&gt;  2    exchange partition for (date'2018-01-01')&lt;br /&gt;  3    with table tex&lt;br /&gt;  4    including indexes;&lt;br /&gt;&lt;br /&gt;Table altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from t;&lt;br /&gt;&lt;br /&gt;CREATED           C1         C2&lt;br /&gt;--------- ---------- ----------&lt;br /&gt;01-JAN-19          2         20&lt;br /&gt;01-JAN-20          3         30&lt;br /&gt;&lt;br /&gt;SQL&gt; select * from tex;&lt;br /&gt;&lt;br /&gt;CREATED           C1         C2&lt;br /&gt;--------- ---------- ----------&lt;br /&gt;01-JAN-18          1         10&lt;br /&gt;&lt;/pre&gt;The entries in the trace file: &lt;pre class="brush:sql;highlight:[13,21,30,34,46,58,62,72,84,96,100,110,120,132,144,148,158,168,178,190]"&gt;&lt;br /&gt;*** 2021-01-22T17:45:20.340547+00:00 (PDB2(3))&lt;br /&gt;*** SESSION ID:(5.40211) 2021-01-22T17:45:20.340569+00:00&lt;br /&gt;*** CLIENT ID:() 2021-01-22T17:45:20.340573+00:00&lt;br /&gt;*** SERVICE NAME:(pdb2) 2021-01-22T17:45:20.340576+00:00&lt;br /&gt;*** MODULE NAME:(SQL*Plus) 2021-01-22T17:45:20.340579+00:00&lt;br /&gt;*** ACTION NAME:() 2021-01-22T17:45:20.340583+00:00&lt;br /&gt;*** CLIENT DRIVER:(SQL*PLUS) 2021-01-22T17:45:20.340585+00:00&lt;br /&gt;*** CONTAINER ID:(3) 2021-01-22T17:45:20.340588+00:00&lt;br /&gt;&lt;br /&gt;DDL begin in opiprs&lt;br /&gt;session id 5 inc 40211 pgadep 0 sqlid fabsxw9ass76q oct 1 txn 0xaed56ac8 autocommit 1&lt;br /&gt;----- Current SQL Statement for this session (sql_id=fabsxw9ass76q) -----&lt;br /&gt;create table tex for exchange with table t clone indexes&lt;br /&gt;&lt;br /&gt;DCSTRC: Deferred Segment Creation Enabled for objn 0.&lt;br /&gt;ctcdrv&lt;br /&gt;session id 5 inc 40211 pgadep 0 sqlid fabsxw9ass76q DDL on 23689 op-alter_table 0&lt;br /&gt;DCSTRC: Inserting into deferred_stg$ objn:23689&lt;br /&gt;stg:0x95fbff70 ts: objno:23689 dobjno:23689 pctfree:127 pctused:127 size:32767 initrans:2147483647 maxtrans:2147483647 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x8 imcflag: 0x0----- Current SQL Statement for this session (sql_id=fabsxw9ass76q) -----&lt;br /&gt;create table tex for exchange with table t clone indexes&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkpoids_insert_deferred_stg&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&amp;lt;-opiodr&amp;lt;-ttcpip&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x753b1c2f5bde975f&lt;br /&gt;DCSTRC: Data Segment for ObjNo: 23689 Not Created&lt;br /&gt;DDL begin in opiprs&lt;br /&gt;session id 17 inc 56060 pgadep 1 sqlid gpda0upp7xs4x oct 9 txn 0xaed56ac8 autocommit 0&lt;br /&gt;----- Current SQL Statement for this session (sql_id=gpda0upp7xs4x) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_C1_I" ON "TC"."TEX"("C2") NOPARALLEL&lt;br /&gt;&lt;br /&gt;DCSTRC: Selecting from deferred_stg$ objn:23689&lt;br /&gt;----- Current SQL Statement for this session (sql_id=gpda0upp7xs4x) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_C1_I" ON "TC"."TEX"("C2") NOPARALLEL&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkposds_select_deferred_stg&amp;lt;-kkpo_rcinfo_defstg&amp;lt;-ktsircinfo&amp;lt;-kkdlgstd&amp;lt;-kkmfcbloCbk&amp;lt;-kkmpfcbk&amp;lt;-qcsprfro&amp;lt;-qcsprfro_tree&amp;lt;-qcsprfro_tree&amp;lt;-qcspafq&amp;lt;-qcspqbDescendents&amp;lt;-qcspqb&amp;lt;-kkmdrv&amp;lt;-opiSem&amp;lt;-opiprs&amp;lt;-kksParseChildCursor&amp;lt;-rpiswu2&amp;lt;-kksLoadChild&amp;lt;-kxsGetRuntimeLock&lt;br /&gt;&amp;lt;-kksfbc&amp;lt;-kkspsc0&amp;lt;-kksParseCursor&amp;lt;-opiosq0&amp;lt;-opiall0&amp;lt;-opikpr&amp;lt;-opiodr&amp;lt;-rpidrus&amp;lt;-skgmstack&amp;lt;-rpidru&amp;lt;-rpiswu2&amp;lt;-kprball&amp;lt;-kkpofmc_form_msq_cix&amp;lt;-kglsscn&amp;lt;-kkpocim_create_indexes_modpart&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&amp;lt;-opiodr&amp;lt;-ttcpip&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&lt;br /&gt;&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x41a77ef85a8b5b0f&lt;br /&gt;stg:0x7fff61c4c838 ts: objno:0 dobjno:0 pctfree:127 pctused:127 size:32767 initrans:2147483647 maxtrans:2147483647 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x8 imcflag: 0x0ktagetg_ddl sessionid 17 inc 56060 pgadep 1 txn 0xaed56ac8 table 23689 mode 4&lt;br /&gt;DCSTRC: Inserting into deferred_stg$ objn:23690&lt;br /&gt;stg:0x98722108 ts: objno:23690 dobjno:23690 pctfree:10 pctused:127 size:32767 initrans:2 maxtrans:255 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x0 imcflag: 0x0----- Current SQL Statement for this session (sql_id=gpda0upp7xs4x) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_C1_I" ON "TC"."TEX"("C2") NOPARALLEL&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkpoids_insert_deferred_stg&amp;lt;-kdicrws&amp;lt;-kdicdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-opiall0&amp;lt;-opikpr&amp;lt;-opiodr&amp;lt;-rpidrus&amp;lt;-skgmstack&amp;lt;-rpidru&amp;lt;-rpiswu2&amp;lt;-kprball&amp;lt;-kkpofmc_form_msq_cix&amp;lt;-kglsscn&amp;lt;-kkpocim_create_indexes_modpart&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&amp;lt;-opiodr&amp;lt;-ttcpip&lt;br /&gt;&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x67b767b3ee346cb2&lt;br /&gt;DCSTRC: Index Segment for ObjNo:23690 Not Created&lt;br /&gt;DDL end in opiexe&lt;br /&gt;session id 17 inc 56060 pgadep 1 sqlid gpda0upp7xs4x txn 0xaed56ac8 autocommit 0 commited 0&lt;br /&gt;DDL begin in opiprs&lt;br /&gt;session id 17 inc 56060 pgadep 1 sqlid 890bc4g127vkt oct 9 txn 0xaed56ac8 autocommit 0&lt;br /&gt;----- Current SQL Statement for this session (sql_id=890bc4g127vkt) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_C1_C2_I" ON "TC"."TEX"("C1" , "C2") NOPARALLEL&lt;br /&gt;&lt;br /&gt;DCSTRC: Selecting from deferred_stg$ objn:23689&lt;br /&gt;----- Current SQL Statement for this session (sql_id=890bc4g127vkt) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_C1_C2_I" ON "TC"."TEX"("C1" , "C2") NOPARALLEL&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkposds_select_deferred_stg&amp;lt;-kkpo_rcinfo_defstg&amp;lt;-ktsircinfo&amp;lt;-kkdlgstd&amp;lt;-kkmfcbloCbk&amp;lt;-kkmpfcbk&amp;lt;-qcsprfro&amp;lt;-qcsprfro_tree&amp;lt;-qcsprfro_tree&amp;lt;-qcspafq&amp;lt;-qcspqbDescendents&amp;lt;-qcspqb&amp;lt;-kkmdrv&amp;lt;-opiSem&amp;lt;-opiprs&amp;lt;-kksParseChildCursor&amp;lt;-rpiswu2&amp;lt;-kksLoadChild&amp;lt;-kxsGetRuntimeLock&lt;br /&gt;&amp;lt;-kksfbc&amp;lt;-kkspsc0&amp;lt;-kksParseCursor&amp;lt;-opiosq0&amp;lt;-opiall0&amp;lt;-opikpr&amp;lt;-opiodr&amp;lt;-rpidrus&amp;lt;-skgmstack&amp;lt;-rpidru&amp;lt;-rpiswu2&amp;lt;-kprball&amp;lt;-kkpofmc_form_msq_cix&amp;lt;-kglsscn&amp;lt;-kkpocim_create_indexes_modpart&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&amp;lt;-opiodr&amp;lt;-ttcpip&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&lt;br /&gt;&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x41a77ef85a8b5b0f&lt;br /&gt;stg:0x7fff61c4c838 ts: objno:0 dobjno:0 pctfree:127 pctused:127 size:32767 initrans:2147483647 maxtrans:2147483647 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x8 imcflag: 0x0DCSTRC: Selecting from deferred_stg$ objn:23690&lt;br /&gt;----- Current SQL Statement for this session (sql_id=890bc4g127vkt) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_C1_C2_I" ON "TC"."TEX"("C1" , "C2") NOPARALLEL&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkposds_select_deferred_stg&amp;lt;-kkpo_rcinfo_defstg&amp;lt;-ktsircinfo&amp;lt;-kdigetspace2&amp;lt;-kdigetspace&amp;lt;-kkdl1ck&amp;lt;-kkdlack&amp;lt;-kkmfcbbt&amp;lt;-kkmfcbloCbk&amp;lt;-kkmpfcbk&amp;lt;-qcsprfro&amp;lt;-qcsprfro_tree&amp;lt;-qcsprfro_tree&amp;lt;-qcspafq&amp;lt;-qcspqbDescendents&amp;lt;-qcspqb&amp;lt;-kkmdrv&amp;lt;-opiSem&amp;lt;-opiprs&amp;lt;-kksParseChildCursor&lt;br /&gt;&amp;lt;-rpiswu2&amp;lt;-kksLoadChild&amp;lt;-kxsGetRuntimeLock&amp;lt;-kksfbc&amp;lt;-kkspsc0&amp;lt;-kksParseCursor&amp;lt;-opiosq0&amp;lt;-opiall0&amp;lt;-opikpr&amp;lt;-opiodr&amp;lt;-rpidrus&amp;lt;-skgmstack&amp;lt;-rpidru&amp;lt;-rpiswu2&amp;lt;-kprball&amp;lt;-kkpofmc_form_msq_cix&amp;lt;-kglsscn&amp;lt;-kkpocim_create_indexes_modpart&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&lt;br /&gt;&amp;lt;-opiodr&amp;lt;-ttcpip&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x2e48dfa364bfeef0&lt;br /&gt;stg:0x7fff61c4cd98 ts: objno:0 dobjno:0 pctfree:10 pctused:127 size:32767 initrans:2 maxtrans:255 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x0 imcflag: 0x0ktagetg_ddl sessionid 17 inc 56060 pgadep 1 txn 0xaed56ac8 table 23689 mode 4&lt;br /&gt;DCSTRC: Inserting into deferred_stg$ objn:23691&lt;br /&gt;stg:0x98701d48 ts: objno:23691 dobjno:23691 pctfree:10 pctused:127 size:32767 initrans:2 maxtrans:255 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x0 imcflag: 0x0----- Current SQL Statement for this session (sql_id=890bc4g127vkt) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_C1_C2_I" ON "TC"."TEX"("C1" , "C2") NOPARALLEL&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkpoids_insert_deferred_stg&amp;lt;-kdicrws&amp;lt;-kdicdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-opiall0&amp;lt;-opikpr&amp;lt;-opiodr&amp;lt;-rpidrus&amp;lt;-skgmstack&amp;lt;-rpidru&amp;lt;-rpiswu2&amp;lt;-kprball&amp;lt;-kkpofmc_form_msq_cix&amp;lt;-kglsscn&amp;lt;-kkpocim_create_indexes_modpart&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&amp;lt;-opiodr&amp;lt;-ttcpip&lt;br /&gt;&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x67b767b3ee346cb2&lt;br /&gt;DCSTRC: Index Segment for ObjNo:23691 Not Created&lt;br /&gt;DDL end in opiexe&lt;br /&gt;session id 17 inc 56060 pgadep 1 sqlid 890bc4g127vkt txn 0xaed56ac8 autocommit 0 commited 0&lt;br /&gt;DDL begin in opiprs&lt;br /&gt;session id 17 inc 56060 pgadep 1 sqlid dv4r3pvxwh4az oct 9 txn 0xaed56ac8 autocommit 0&lt;br /&gt;----- Current SQL Statement for this session (sql_id=dv4r3pvxwh4az) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_CREATED_C1_I" ON "TC"."TEX"(TRUNC("CREATED") , "C1") NOPARALLEL&lt;br /&gt;&lt;br /&gt;DCSTRC: Selecting from deferred_stg$ objn:23689&lt;br /&gt;----- Current SQL Statement for this session (sql_id=dv4r3pvxwh4az) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_CREATED_C1_I" ON "TC"."TEX"(TRUNC("CREATED") , "C1") NOPARALLEL&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkposds_select_deferred_stg&amp;lt;-kkpo_rcinfo_defstg&amp;lt;-ktsircinfo&amp;lt;-kkdlgstd&amp;lt;-kkmfcbloCbk&amp;lt;-kkmpfcbk&amp;lt;-qcsprfro&amp;lt;-qcsprfro_tree&amp;lt;-qcsprfro_tree&amp;lt;-qcspafq&amp;lt;-qcspqbDescendents&amp;lt;-qcspqb&amp;lt;-kkmdrv&amp;lt;-opiSem&amp;lt;-opiprs&amp;lt;-kksParseChildCursor&amp;lt;-rpiswu2&amp;lt;-kksLoadChild&amp;lt;-kxsGetRuntimeLock&lt;br /&gt;&amp;lt;-kksfbc&amp;lt;-kkspsc0&amp;lt;-kksParseCursor&amp;lt;-opiosq0&amp;lt;-opiall0&amp;lt;-opikpr&amp;lt;-opiodr&amp;lt;-rpidrus&amp;lt;-skgmstack&amp;lt;-rpidru&amp;lt;-rpiswu2&amp;lt;-kprball&amp;lt;-kkpofmc_form_msq_cix&amp;lt;-kglsscn&amp;lt;-kkpocim_create_indexes_modpart&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&amp;lt;-opiodr&amp;lt;-ttcpip&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&lt;br /&gt;&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x41a77ef85a8b5b0f&lt;br /&gt;stg:0x7fff61c4c838 ts: objno:0 dobjno:0 pctfree:127 pctused:127 size:32767 initrans:2147483647 maxtrans:2147483647 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x8 imcflag: 0x0DCSTRC: Selecting from deferred_stg$ objn:23691&lt;br /&gt;----- Current SQL Statement for this session (sql_id=dv4r3pvxwh4az) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_CREATED_C1_I" ON "TC"."TEX"(TRUNC("CREATED") , "C1") NOPARALLEL&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkposds_select_deferred_stg&amp;lt;-kkpo_rcinfo_defstg&amp;lt;-ktsircinfo&amp;lt;-kdigetspace2&amp;lt;-kdigetspace&amp;lt;-kkdl1ck&amp;lt;-kkdlack&amp;lt;-kkmfcbbt&amp;lt;-kkmfcbloCbk&amp;lt;-kkmpfcbk&amp;lt;-qcsprfro&amp;lt;-qcsprfro_tree&amp;lt;-qcsprfro_tree&amp;lt;-qcspafq&amp;lt;-qcspqbDescendents&amp;lt;-qcspqb&amp;lt;-kkmdrv&amp;lt;-opiSem&amp;lt;-opiprs&amp;lt;-kksParseChildCursor&lt;br /&gt;&amp;lt;-rpiswu2&amp;lt;-kksLoadChild&amp;lt;-kxsGetRuntimeLock&amp;lt;-kksfbc&amp;lt;-kkspsc0&amp;lt;-kksParseCursor&amp;lt;-opiosq0&amp;lt;-opiall0&amp;lt;-opikpr&amp;lt;-opiodr&amp;lt;-rpidrus&amp;lt;-skgmstack&amp;lt;-rpidru&amp;lt;-rpiswu2&amp;lt;-kprball&amp;lt;-kkpofmc_form_msq_cix&amp;lt;-kglsscn&amp;lt;-kkpocim_create_indexes_modpart&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&lt;br /&gt;&amp;lt;-opiodr&amp;lt;-ttcpip&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x2e48dfa364bfeef0&lt;br /&gt;stg:0x7fff61c4cd98 ts: objno:0 dobjno:0 pctfree:10 pctused:127 size:32767 initrans:2 maxtrans:255 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x0 imcflag: 0x0DCSTRC: Selecting from deferred_stg$ objn:23690&lt;br /&gt;----- Current SQL Statement for this session (sql_id=dv4r3pvxwh4az) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_CREATED_C1_I" ON "TC"."TEX"(TRUNC("CREATED") , "C1") NOPARALLEL&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkposds_select_deferred_stg&amp;lt;-kkpo_rcinfo_defstg&amp;lt;-ktsircinfo&amp;lt;-kdigetspace2&amp;lt;-kdigetspace&amp;lt;-kkdl1ck&amp;lt;-kkdlack&amp;lt;-kkmfcbbt&amp;lt;-kkmfcbloCbk&amp;lt;-kkmpfcbk&amp;lt;-qcsprfro&amp;lt;-qcsprfro_tree&amp;lt;-qcsprfro_tree&amp;lt;-qcspafq&amp;lt;-qcspqbDescendents&amp;lt;-qcspqb&amp;lt;-kkmdrv&amp;lt;-opiSem&amp;lt;-opiprs&amp;lt;-kksParseChildCursor&lt;br /&gt;&amp;lt;-rpiswu2&amp;lt;-kksLoadChild&amp;lt;-kxsGetRuntimeLock&amp;lt;-kksfbc&amp;lt;-kkspsc0&amp;lt;-kksParseCursor&amp;lt;-opiosq0&amp;lt;-opiall0&amp;lt;-opikpr&amp;lt;-opiodr&amp;lt;-rpidrus&amp;lt;-skgmstack&amp;lt;-rpidru&amp;lt;-rpiswu2&amp;lt;-kprball&amp;lt;-kkpofmc_form_msq_cix&amp;lt;-kglsscn&amp;lt;-kkpocim_create_indexes_modpart&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&lt;br /&gt;&amp;lt;-opiodr&amp;lt;-ttcpip&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x2e48dfa364bfeef0&lt;br /&gt;stg:0x7fff61c4cd98 ts: objno:0 dobjno:0 pctfree:10 pctused:127 size:32767 initrans:2 maxtrans:255 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x0 imcflag: 0x0ktagetg_ddl sessionid 17 inc 56060 pgadep 1 txn 0xaed56ac8 table 23689 mode 4&lt;br /&gt;DCSTRC: Inserting into deferred_stg$ objn:23692&lt;br /&gt;stg:0x986e5b68 ts: objno:23692 dobjno:23692 pctfree:10 pctused:127 size:32767 initrans:2 maxtrans:255 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x0 imcflag: 0x0----- Current SQL Statement for this session (sql_id=dv4r3pvxwh4az) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_CREATED_C1_I" ON "TC"."TEX"(TRUNC("CREATED") , "C1") NOPARALLEL&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkpoids_insert_deferred_stg&amp;lt;-kdicrws&amp;lt;-kdicdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-opiall0&amp;lt;-opikpr&amp;lt;-opiodr&amp;lt;-rpidrus&amp;lt;-skgmstack&amp;lt;-rpidru&amp;lt;-rpiswu2&amp;lt;-kprball&amp;lt;-kkpofmc_form_msq_cix&amp;lt;-kglsscn&amp;lt;-kkpocim_create_indexes_modpart&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&amp;lt;-opiodr&amp;lt;-ttcpip&lt;br /&gt;&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x67b767b3ee346cb2&lt;br /&gt;DCSTRC: Index Segment for ObjNo:23692 Not Created&lt;br /&gt;DDL end in opiexe&lt;br /&gt;session id 17 inc 56060 pgadep 1 sqlid dv4r3pvxwh4az txn 0xaed56ac8 autocommit 0 commited 0&lt;br /&gt;DDL begin in opiprs&lt;br /&gt;session id 17 inc 56060 pgadep 1 sqlid cukauv41bbw51 oct 9 txn 0xaed56ac8 autocommit 0&lt;br /&gt;----- Current SQL Statement for this session (sql_id=cukauv41bbw51) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_DESC_I" ON "TC"."TEX"("C1" DESC , "C2") NOPARALLEL&lt;br /&gt;&lt;br /&gt;DCSTRC: Selecting from deferred_stg$ objn:23689&lt;br /&gt;----- Current SQL Statement for this session (sql_id=cukauv41bbw51) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_DESC_I" ON "TC"."TEX"("C1" DESC , "C2") NOPARALLEL&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkposds_select_deferred_stg&amp;lt;-kkpo_rcinfo_defstg&amp;lt;-ktsircinfo&amp;lt;-kkdlgstd&amp;lt;-kkmfcbloCbk&amp;lt;-kkmpfcbk&amp;lt;-qcsprfro&amp;lt;-qcsprfro_tree&amp;lt;-qcsprfro_tree&amp;lt;-qcspafq&amp;lt;-qcspqbDescendents&amp;lt;-qcspqb&amp;lt;-kkmdrv&amp;lt;-opiSem&amp;lt;-opiprs&amp;lt;-kksParseChildCursor&amp;lt;-rpiswu2&amp;lt;-kksLoadChild&amp;lt;-kxsGetRuntimeLock&lt;br /&gt;&amp;lt;-kksfbc&amp;lt;-kkspsc0&amp;lt;-kksParseCursor&amp;lt;-opiosq0&amp;lt;-opiall0&amp;lt;-opikpr&amp;lt;-opiodr&amp;lt;-rpidrus&amp;lt;-skgmstack&amp;lt;-rpidru&amp;lt;-rpiswu2&amp;lt;-kprball&amp;lt;-kkpofmc_form_msq_cix&amp;lt;-kglsscn&amp;lt;-kkpocim_create_indexes_modpart&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&amp;lt;-opiodr&amp;lt;-ttcpip&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&lt;br /&gt;&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x41a77ef85a8b5b0f&lt;br /&gt;stg:0x7fff61c4c838 ts: objno:0 dobjno:0 pctfree:127 pctused:127 size:32767 initrans:2147483647 maxtrans:2147483647 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x8 imcflag: 0x0DCSTRC: Selecting from deferred_stg$ objn:23692&lt;br /&gt;----- Current SQL Statement for this session (sql_id=cukauv41bbw51) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_DESC_I" ON "TC"."TEX"("C1" DESC , "C2") NOPARALLEL&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkposds_select_deferred_stg&amp;lt;-kkpo_rcinfo_defstg&amp;lt;-ktsircinfo&amp;lt;-kdigetspace2&amp;lt;-kdigetspace&amp;lt;-kkdl1ck&amp;lt;-kkdlack&amp;lt;-kkmfcbbt&amp;lt;-kkmfcbloCbk&amp;lt;-kkmpfcbk&amp;lt;-qcsprfro&amp;lt;-qcsprfro_tree&amp;lt;-qcsprfro_tree&amp;lt;-qcspafq&amp;lt;-qcspqbDescendents&amp;lt;-qcspqb&amp;lt;-kkmdrv&amp;lt;-opiSem&amp;lt;-opiprs&amp;lt;-kksParseChildCursor&lt;br /&gt;&amp;lt;-rpiswu2&amp;lt;-kksLoadChild&amp;lt;-kxsGetRuntimeLock&amp;lt;-kksfbc&amp;lt;-kkspsc0&amp;lt;-kksParseCursor&amp;lt;-opiosq0&amp;lt;-opiall0&amp;lt;-opikpr&amp;lt;-opiodr&amp;lt;-rpidrus&amp;lt;-skgmstack&amp;lt;-rpidru&amp;lt;-rpiswu2&amp;lt;-kprball&amp;lt;-kkpofmc_form_msq_cix&amp;lt;-kglsscn&amp;lt;-kkpocim_create_indexes_modpart&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&lt;br /&gt;&amp;lt;-opiodr&amp;lt;-ttcpip&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x2e48dfa364bfeef0&lt;br /&gt;stg:0x7fff61c4cd98 ts: objno:0 dobjno:0 pctfree:10 pctused:127 size:32767 initrans:2 maxtrans:255 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x0 imcflag: 0x0DCSTRC: Selecting from deferred_stg$ objn:23691&lt;br /&gt;----- Current SQL Statement for this session (sql_id=cukauv41bbw51) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_DESC_I" ON "TC"."TEX"("C1" DESC , "C2") NOPARALLEL&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkposds_select_deferred_stg&amp;lt;-kkpo_rcinfo_defstg&amp;lt;-ktsircinfo&amp;lt;-kdigetspace2&amp;lt;-kdigetspace&amp;lt;-kkdl1ck&amp;lt;-kkdlack&amp;lt;-kkmfcbbt&amp;lt;-kkmfcbloCbk&amp;lt;-kkmpfcbk&amp;lt;-qcsprfro&amp;lt;-qcsprfro_tree&amp;lt;-qcsprfro_tree&amp;lt;-qcspafq&amp;lt;-qcspqbDescendents&amp;lt;-qcspqb&amp;lt;-kkmdrv&amp;lt;-opiSem&amp;lt;-opiprs&amp;lt;-kksParseChildCursor&lt;br /&gt;&amp;lt;-rpiswu2&amp;lt;-kksLoadChild&amp;lt;-kxsGetRuntimeLock&amp;lt;-kksfbc&amp;lt;-kkspsc0&amp;lt;-kksParseCursor&amp;lt;-opiosq0&amp;lt;-opiall0&amp;lt;-opikpr&amp;lt;-opiodr&amp;lt;-rpidrus&amp;lt;-skgmstack&amp;lt;-rpidru&amp;lt;-rpiswu2&amp;lt;-kprball&amp;lt;-kkpofmc_form_msq_cix&amp;lt;-kglsscn&amp;lt;-kkpocim_create_indexes_modpart&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&lt;br /&gt;&amp;lt;-opiodr&amp;lt;-ttcpip&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x2e48dfa364bfeef0&lt;br /&gt;stg:0x7fff61c4cd98 ts: objno:0 dobjno:0 pctfree:10 pctused:127 size:32767 initrans:2 maxtrans:255 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x0 imcflag: 0x0DCSTRC: Selecting from deferred_stg$ objn:23690&lt;br /&gt;----- Current SQL Statement for this session (sql_id=cukauv41bbw51) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_DESC_I" ON "TC"."TEX"("C1" DESC , "C2") NOPARALLEL&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkposds_select_deferred_stg&amp;lt;-kkpo_rcinfo_defstg&amp;lt;-ktsircinfo&amp;lt;-kdigetspace2&amp;lt;-kdigetspace&amp;lt;-kkdl1ck&amp;lt;-kkdlack&amp;lt;-kkmfcbbt&amp;lt;-kkmfcbloCbk&amp;lt;-kkmpfcbk&amp;lt;-qcsprfro&amp;lt;-qcsprfro_tree&amp;lt;-qcsprfro_tree&amp;lt;-qcspafq&amp;lt;-qcspqbDescendents&amp;lt;-qcspqb&amp;lt;-kkmdrv&amp;lt;-opiSem&amp;lt;-opiprs&amp;lt;-kksParseChildCursor&lt;br /&gt;&amp;lt;-rpiswu2&amp;lt;-kksLoadChild&amp;lt;-kxsGetRuntimeLock&amp;lt;-kksfbc&amp;lt;-kkspsc0&amp;lt;-kksParseCursor&amp;lt;-opiosq0&amp;lt;-opiall0&amp;lt;-opikpr&amp;lt;-opiodr&amp;lt;-rpidrus&amp;lt;-skgmstack&amp;lt;-rpidru&amp;lt;-rpiswu2&amp;lt;-kprball&amp;lt;-kkpofmc_form_msq_cix&amp;lt;-kglsscn&amp;lt;-kkpocim_create_indexes_modpart&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&lt;br /&gt;&amp;lt;-opiodr&amp;lt;-ttcpip&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x2e48dfa364bfeef0&lt;br /&gt;stg:0x7fff61c4cd98 ts: objno:0 dobjno:0 pctfree:10 pctused:127 size:32767 initrans:2 maxtrans:255 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x0 imcflag: 0x0ktagetg_ddl sessionid 17 inc 56060 pgadep 1 txn 0xaed56ac8 table 23689 mode 4&lt;br /&gt;DCSTRC: Inserting into deferred_stg$ objn:23693&lt;br /&gt;stg:0x986caa78 ts: objno:23693 dobjno:23693 pctfree:10 pctused:127 size:32767 initrans:2 maxtrans:255 initial:4294967295 next:4294967295 optimal:4294967295 minextents:2147483647 maxextents:2147483647 pctinc:2147483647 maxins:0 frlins:65535 tabno:0 NOCOMPRESS/NO ROW LEVEL LOCKING/&lt;br /&gt;flags: 0x0 imcflag: 0x0----- Current SQL Statement for this session (sql_id=cukauv41bbw51) -----&lt;br /&gt;CREATE INDEX "TC"."I_SYS_23689_T_DESC_I" ON "TC"."TEX"("C1" DESC , "C2") NOPARALLEL&lt;br /&gt;----- Abridged Call Stack Trace -----&lt;br /&gt;ksedsts&amp;lt;-kkpoids_insert_deferred_stg&amp;lt;-kdicrws&amp;lt;-kdicdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-opiall0&amp;lt;-opikpr&amp;lt;-opiodr&amp;lt;-rpidrus&amp;lt;-skgmstack&amp;lt;-rpidru&amp;lt;-rpiswu2&amp;lt;-kprball&amp;lt;-kkpofmc_form_msq_cix&amp;lt;-kglsscn&amp;lt;-kkpocim_create_indexes_modpart&amp;lt;-ctcdrv&amp;lt;-opiexe&amp;lt;-opiosq0&amp;lt;-kpooprx&amp;lt;-kpoal8&amp;lt;-opiodr&amp;lt;-ttcpip&lt;br /&gt;&amp;lt;-opitsk&amp;lt;-opiino&amp;lt;-opiodr&amp;lt;-opidrv&amp;lt;-sou2o&amp;lt;-opimai_real&amp;lt;-ssthrdmain&amp;lt;-main&amp;lt;-__libc_start_main&lt;br /&gt;----- End of Abridged Call Stack Trace -----&lt;br /&gt;Partial short call stack signature: 0x67b767b3ee346cb2&lt;br /&gt;DCSTRC: Index Segment for ObjNo:23693 Not Created&lt;br /&gt;DDL end in opiexe&lt;br /&gt;session id 17 inc 56060 pgadep 1 sqlid cukauv41bbw51 txn 0xaed56ac8 autocommit 0 commited 0&lt;br /&gt;DDL end in opiexe&lt;br /&gt;session id 5 inc 40211 pgadep 0 sqlid fabsxw9ass76q txn 0xaed56ac8 autocommit 1 commited 1&lt;br /&gt;&lt;/pre&gt;Probably we will see this improvement documented one day. Not sure whether it is stable or not. I have tested it for some simple examples and it was working well. </content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/5626387108369749560/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/01/creating-table-for-exchange-and-copying.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5626387108369749560'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5626387108369749560'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/01/creating-table-for-exchange-and-copying.html' title='Creating a Table for Exchange and Copying Indexes'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-552974218485445135</id><published>2021-01-16T03:15:00.001+06:00</published><updated>2021-01-16T03:15:03.569+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='rac'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><title type='text'>Pluggable Database not Opened on all RAC Instances Following Switchover</title><content type='html'>&lt;h3&gt;Environment&lt;/h3&gt;&lt;ul&gt;  &lt;li&gt;GI and DB version: 19.9&lt;/li&gt;&lt;/ul&gt;&lt;br/&gt;&lt;h4&gt;Site A&lt;/h4&gt;&lt;ul&gt;  &lt;li&gt;Hostnames: &lt;code&gt;raca1.example.com, raca2.example.com&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;db_unique_name: &lt;code&gt;racdba&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;Instance Names: &lt;code&gt;racdba1, racdba2&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;Configuration Type: &lt;code&gt;RAC&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;br/&gt;&lt;h4&gt;Site B&lt;/h4&gt;&lt;ul&gt;  &lt;li&gt;Hostnames: &lt;code&gt;racb1.example.com, racb2.example.com&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;db_unique_name: &lt;code&gt;racdbb&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;Instance Names: &lt;code&gt;racdbb1, racdbb2&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;Configuration Type: &lt;code&gt;RAC&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;br/&gt;&lt;h3&gt;Initial State&lt;/h3&gt;&lt;h4&gt;Data Guard Configuration&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;DGMGRL&gt; show configuration;&lt;br /&gt;&lt;br /&gt;Configuration - racdb&lt;br /&gt;&lt;br /&gt;  Protection Mode: MaxPerformance&lt;br /&gt;  Members:&lt;br /&gt;  racdba - Primary database&lt;br /&gt;    racdbb - Physical standby database&lt;br /&gt;&lt;br /&gt;Fast-Start Failover:  Disabled&lt;br /&gt;&lt;br /&gt;Configuration Status:&lt;br /&gt;SUCCESS   (status updated 116 seconds ago)&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;RACDBA: primary&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;SYS@RACDBA&gt; select database_role from v$database;&lt;br /&gt;&lt;br /&gt;DATABASE_ROLE&lt;br /&gt;----------------&lt;br /&gt;PRIMARY&lt;br /&gt;&lt;br /&gt;SYS@RACDBA&gt;&lt;br /&gt;SYS@RACDBA&gt; select *&lt;br /&gt;  2    from dba_pdb_saved_states&lt;br /&gt;  3   order by con_id, instance_name;&lt;br /&gt;&lt;br /&gt; CON_ID CON_NAME INSTANCE_NAME    CON_UID GUID                             STATE          RESTRICTED&lt;br /&gt;------- -------- ------------- ---------- -------------------------------- -------------- ----------&lt;br /&gt;      3 PDB      racdba1       1682177871 B8C71D7FC2B07CAAE0530101A8C0CF42 OPEN           NO&lt;br /&gt;      3 PDB      racdba2       1682177871 B8C71D7FC2B07CAAE0530101A8C0CF42 OPEN           NO&lt;br /&gt;      3 PDB      racdbb1       1682177871 B8C71D7FC2B07CAAE0530101A8C0CF42 OPEN           NO&lt;br /&gt;      3 PDB      racdbb2       1682177871 B8C71D7FC2B07CAAE0530101A8C0CF42 OPEN           NO&lt;br /&gt;&lt;br /&gt;SYS@RACDBA&gt;&lt;br /&gt;SYS@RACDBA&gt;&lt;br /&gt;SYS@RACDBA&gt; select inst_id, name, open_mode&lt;br /&gt;  2    from gv$pdbs&lt;br /&gt;  3   order by inst_id, name;&lt;br /&gt;&lt;br /&gt; INST_ID NAME       OPEN_MODE&lt;br /&gt;-------- ---------- ----------&lt;br /&gt;       1 PDB        READ WRITE&lt;br /&gt;       1 PDB$SEED   READ ONLY&lt;br /&gt;       2 PDB        READ WRITE&lt;br /&gt;       2 PDB$SEED   READ ONLY&lt;br /&gt;&lt;br /&gt;SYS@RACDBA&gt;&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;RACDBB: standby&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;SYS@RACDBB&gt; select database_role from v$database;&lt;br /&gt;&lt;br /&gt;DATABASE_ROLE&lt;br /&gt;----------------&lt;br /&gt;PHYSICAL STANDBY&lt;br /&gt;&lt;br /&gt;SYS@RACDBB&gt;&lt;br /&gt;SYS@RACDBB&gt; select *&lt;br /&gt;  2    from dba_pdb_saved_states&lt;br /&gt;  3   order by con_id, instance_name;&lt;br /&gt;&lt;br /&gt; CON_ID CON_NAME INSTANCE_NAME    CON_UID GUID                             STATE          RESTRICTED&lt;br /&gt;------- -------- ------------- ---------- -------------------------------- -------------- ----------&lt;br /&gt;      3 PDB      racdba1       1682177871 B8C71D7FC2B07CAAE0530101A8C0CF42 OPEN           NO&lt;br /&gt;      3 PDB      racdba2       1682177871 B8C71D7FC2B07CAAE0530101A8C0CF42 OPEN           NO&lt;br /&gt;      3 PDB      racdbb1       1682177871 B8C71D7FC2B07CAAE0530101A8C0CF42 OPEN           NO&lt;br /&gt;      3 PDB      racdbb2       1682177871 B8C71D7FC2B07CAAE0530101A8C0CF42 OPEN           NO&lt;br /&gt;&lt;br /&gt;SYS@RACDBB&gt;&lt;br /&gt;SYS@RACDBB&gt;&lt;br /&gt;SYS@RACDBB&gt; select inst_id, name, open_mode&lt;br /&gt;  2    from gv$pdbs&lt;br /&gt;  3   order by inst_id, name;&lt;br /&gt;&lt;br /&gt; INST_ID NAME       OPEN_MODE&lt;br /&gt;-------- ---------- ----------&lt;br /&gt;       1 PDB        READ ONLY&lt;br /&gt;       1 PDB$SEED   READ ONLY&lt;br /&gt;       2 PDB        READ ONLY&lt;br /&gt;       2 PDB$SEED   READ ONLY&lt;br /&gt;&lt;br /&gt;SYS@RACDBB&gt;&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Switchover&lt;/h3&gt;&lt;h4&gt;dgmgrl&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;DGMGRL&gt; switchover to racdbb;&lt;br /&gt;Performing switchover NOW, please wait...&lt;br /&gt;Operation requires a connection to database "racdbb"&lt;br /&gt;Connecting ...&lt;br /&gt;Connected to "racdbb"&lt;br /&gt;Connected as SYSDBA.&lt;br /&gt;New primary database "racdbb" is opening...&lt;br /&gt;Oracle Clusterware is restarting database "racdba" ...&lt;br /&gt;Connected to "racdba"&lt;br /&gt;Connected to "racdba"&lt;br /&gt;Switchover succeeded, new primary is "racdbb"&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;RACDBA: new standby, old primary&lt;/h4&gt;&lt;pre class="brush:sql;highlight:[16]"&gt;&lt;br /&gt;SYS@RACDBA&gt; select database_role from v$database;&lt;br /&gt;&lt;br /&gt;DATABASE_ROLE&lt;br /&gt;----------------&lt;br /&gt;PHYSICAL STANDBY&lt;br /&gt;&lt;br /&gt;SYS@RACDBA&gt;&lt;br /&gt;SYS@RACDBA&gt; select inst_id, name, open_mode&lt;br /&gt;  2    from gv$pdbs&lt;br /&gt;  3   order by inst_id, name;&lt;br /&gt;&lt;br /&gt; INST_ID NAME       OPEN_MODE&lt;br /&gt;-------- ---------- ----------&lt;br /&gt;       1 PDB        READ ONLY&lt;br /&gt;       1 PDB$SEED   READ ONLY&lt;br /&gt;       2 PDB        MOUNTED&lt;br /&gt;       2 PDB$SEED   READ ONLY&lt;br /&gt;&lt;br /&gt;SYS@RACDBA&gt;&lt;br /&gt;&lt;/pre&gt;The upshot of that is that PDB is not opened on all instances. &lt;br/&gt;&lt;br/&gt;&lt;h4&gt;RACDBB: new primary, old standby&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;SYS@RACDBB&gt; select database_role from v$database;&lt;br /&gt;&lt;br /&gt;DATABASE_ROLE&lt;br /&gt;----------------&lt;br /&gt;PRIMARY&lt;br /&gt;&lt;br /&gt;SYS@RACDBB&gt;&lt;br /&gt;SYS@RACDBB&gt; select inst_id, name, open_mode&lt;br /&gt;  2    from gv$pdbs&lt;br /&gt;  3   order by inst_id, name;&lt;br /&gt;&lt;br /&gt; INST_ID NAME       OPEN_MODE&lt;br /&gt;-------- ---------- ----------&lt;br /&gt;       1 PDB        READ WRITE&lt;br /&gt;       1 PDB$SEED   READ ONLY&lt;br /&gt;       2 PDB        READ WRITE&lt;br /&gt;       2 PDB$SEED   READ ONLY&lt;br /&gt;&lt;br /&gt;SYS@RACDBB&gt;&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;alert_racdba1.log&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;2021-01-14T11:06:34.301193+00:00&lt;br /&gt;PDB$SEED(2):This instance was first to open pluggable database PDB$SEED (container=2)&lt;br /&gt;PDB$SEED(2):Endian type of dictionary set to little&lt;br /&gt;PDB$SEED(2):Undo initialization finished serial:0 start:2456242 end:2456242 diff:0 ms (0.0 seconds)&lt;br /&gt;PDB$SEED(2):Database Characterset for PDB$SEED is AL32UTF8&lt;br /&gt;PDB$SEED(2):Opening pdb with no Resource Manager plan active&lt;br /&gt;2021-01-14T11:06:34.854870+00:00&lt;br /&gt;Unable to restore open state for pluggable databases due to               the following errors.&lt;br /&gt;2021-01-14T11:06:34.855107+00:00&lt;br /&gt;Errors in file /u01/app/oracle/diag/rdbms/racdba/racdba1/trace/racdba1_ora_15488.trc:&lt;br /&gt;ORA-65054: Cannot open a pluggable database in the desired mode.&lt;br /&gt;Physical standby database opened for read only access.&lt;br /&gt;2021-01-14T11:06:34.999598+00:00&lt;br /&gt;Completed: ALTER DATABASE OPEN READ ONLY /* db agent *//* {1:39212:957} */&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;racdba1_ora_15488.trc&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;*** 2021-01-14T11:06:33.488203+00:00 (CDB$ROOT(1))&lt;br /&gt;kjznppl0: database in migration or not writable&lt;br /&gt;kjac_dpinfo_open: direct path not initialized, reason: in readable standby mode&lt;br /&gt;&lt;br /&gt;*** 2021-01-14T11:06:34.082190+00:00 (CDB$ROOT(1))&lt;br /&gt;* Set mstr_rdy 1, lmon_pnpchk 1 &lt;br /&gt;&amp;lt;error barrier&gt; at 0x7fffb4489030 placed kpdb.c@21504&lt;br /&gt;ORA-65054: Cannot open a pluggable database in the desired mode.&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;drcracdba1.log&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;2021-01-14T11:05:21.783+00:00&lt;br /&gt;Initiating a healthcheck...&lt;br /&gt;2021-01-14T11:05:23.298+00:00&lt;br /&gt;SWITCHOVER TO racdbb&lt;br /&gt;Switchover to physical standby database cannot be initiated from the primary database&lt;br /&gt;redirecting connection to switchover target database racdbb...&lt;br /&gt;...using connect identifier: //myracb-scan/racdbb&lt;br /&gt;SWITCHOVER TO racdbb&lt;br /&gt;2021-01-14T11:05:26.004+00:00&lt;br /&gt;Notifying Oracle Clusterware to prepare primary database for switchover&lt;br /&gt;Switchover in progress...&lt;br /&gt;2021-01-14T11:05:27.263+00:00&lt;br /&gt;Executing SQL: [ALTER DATABASE SWITCHOVER TO 'racdbb']&lt;br /&gt;2021-01-14T11:05:57.144+00:00&lt;br /&gt;SQL [ALTER DATABASE SWITCHOVER TO 'racdbb'] executed successfully&lt;br /&gt;2021-01-14T11:05:58.295+00:00&lt;br /&gt;Switchover successful&lt;br /&gt;2021-01-14T11:06:03.892+00:00&lt;br /&gt;Notifying Clusterware to restart this instance for Switchover&lt;br /&gt;2021-01-14T11:06:06.080+00:00&lt;br /&gt;Shutting down instance after Switchover&lt;br /&gt;2021-01-14T11:06:26.438+00:00&lt;br /&gt;&gt;&gt; Starting Data Guard Broker bootstrap &amp;lt;&amp;lt;&lt;br /&gt;Broker Configuration File Locations:&lt;br /&gt;      dg_broker_config_file1 = "+DATA/RACDBA/dr1racdba"&lt;br /&gt;      dg_broker_config_file2 = "+DATA/RACDBA/dr2racdba"&lt;br /&gt;2021-01-14T11:06:26.438+00:00                      DMON: Attach state object&lt;br /&gt;2021-01-14T11:06:26.440+00:00                      DMON: Initialization of broker state requires reconciliation&lt;br /&gt;2021-01-14T11:06:26.440+00:00                      DMON: Broker state reconciled, version = 0, state = 00000000&lt;br /&gt;2021-01-14T11:06:26.440+00:00                      DMON: Broker State Initialized&lt;br /&gt;2021-01-14T11:06:26.440+00:00                            Version = 1&lt;br /&gt;2021-01-14T11:06:26.440+00:00                            State = 00000000&lt;br /&gt;2021-01-14T11:06:26.440+00:00                      DMON: Creating INSV process&lt;br /&gt;2021-01-14T11:06:29.458+00:00                      INSV: Opening configuration file '+DATA/RACDBA/dr1racdba' with blocksize 4096&lt;br /&gt;2021-01-14T11:06:29.461+00:00                      INSV: Successfully opened configuration file '+DATA/RACDBA/dr1racdba'&lt;br /&gt;2021-01-14T11:06:29.474+00:00                      INSV: home block of +DATA/RACDBA/dr1racdba: zzz=0x40, Seq.MIV=12.1, fsfo flags=0x0, version=0, pstseq=0.0&lt;br /&gt;2021-01-14T11:06:29.474+00:00                      INSV: Opening configuration file '+DATA/RACDBA/dr2racdba' with blocksize 4096&lt;br /&gt;2021-01-14T11:06:29.476+00:00                      INSV: Successfully opened configuration file '+DATA/RACDBA/dr2racdba'&lt;br /&gt;2021-01-14T11:06:29.480+00:00                      INSV: home block of +DATA/RACDBA/dr2racdba: zzz=0x40, Seq.MIV=13.0, fsfo flags=0x0, version=0, pstseq=0.0&lt;br /&gt;2021-01-14T11:06:29.480+00:00                      INSV: Set current metadata file ID to 2 (Seq.MIV=13.0)&lt;br /&gt;2021-01-14T11:06:29.480+00:00                      INSV: Opening configuration file '+DATA/RACDBA/dr2racdba' with blocksize 4096&lt;br /&gt;2021-01-14T11:06:29.483+00:00                      INSV: Successfully opened configuration file '+DATA/RACDBA/dr2racdba'&lt;br /&gt;2021-01-14T11:06:29.485+00:00                      INSV: Uploading persisted FSFO state:&lt;br /&gt;2021-01-14T11:06:29.485+00:00                             flags=0x00000000, version=0, pstseq=0, target=0, obid=1&lt;br /&gt;2021-01-14T11:06:29.485+00:00                             envsn=0, ackseq=0, new_target=255, new_obid=0&lt;br /&gt;2021-01-14T11:06:29.485+00:00                      	pmyshut=1, aft=30, laglim=30, obslim=30&lt;br /&gt;2021-01-14T11:06:29.485+00:00                      INSV: FSFO state RAC reconcile started&lt;br /&gt;2021-01-14T11:06:29.486+00:00                      INSV: FSFO state RAC reconcile finished&lt;br /&gt;2021-01-14T11:06:29.486+00:00                      INSV: INSV is ready&lt;br /&gt;2021-01-14T11:06:30.455+00:00                      DMON: rfm_get_chief_lock() called for CTL_BOOTSTRAP, reason BOOTSTRAP, called from rfm_dmon_wakeup_fn&lt;br /&gt;2021-01-14T11:06:30.455+00:00 7fffffff           0 DMON: start task execution: broker initialization&lt;br /&gt;2021-01-14T11:06:30.455+00:00                      DMON: Boot configuration (0.0.0), loading from "+DATA/RACDBA/dr2racdba"&lt;br /&gt;2021-01-14T11:06:30.465+00:00                      DMON: My instance_name is racdba1 (SID racdba1), broker profile found at (1.2)&lt;br /&gt;2021-01-14T11:06:30.465+00:00                      DMON: Verifying configuration service racdb_CFG&lt;br /&gt;2021-01-14T11:06:30.465+00:00                      DMON: Configuration service not registered&lt;br /&gt;2021-01-14T11:06:30.465+00:00                      DMON: Adding configuration service... racdb_CFG&lt;br /&gt;2021-01-14T11:06:30.465+00:00                      DMON: Registering 1 service/s with listener(s)&lt;br /&gt;2021-01-14T11:06:30.465+00:00                      DMON: Executing SQL [ALTER SYSTEM REGISTER]&lt;br /&gt;2021-01-14T11:06:30.466+00:00                      SQL [ALTER SYSTEM REGISTER] Executed successfully&lt;br /&gt;2021-01-14T11:06:30.466+00:00                      DMON: SCI harvested (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(Host=raca1.example.com)(Port=1522))(CONNECT_DATA=(SERVICE_NAME=racdba_DGMGRL)(INSTANCE_NAME=racdba1)(SERVER=DEDICATED)))&lt;br /&gt;Broker Configuration:             racdb&lt;br /&gt;  Oracle Release:                 19.0.0.0.0&lt;br /&gt;  Oracle Version:                 19.9.0.0.0&lt;br /&gt;  Metadata Version:               4.1 / UID=0x34ca0bad / Seq.MIV=13.0 / blksz.grain=4096.8&lt;br /&gt;  Protection Mode:                Maximum Performance&lt;br /&gt;  Fast-Start Failover (FSFO): DISABLED, flags=0x0, version=0&lt;br /&gt;  Name                            Member Type                Handle      Enabled&lt;br /&gt;  racdbb                          Primary Database           0x02010000  YES&lt;br /&gt;  racdba                          Physical Standby Database  0x01010000  YES&lt;br /&gt;2021-01-14T11:06:30.495+00:00&lt;br /&gt;Physical standby restart after broker operation requires Oracle Clusterware buildup&lt;br /&gt;Notifying Oracle Clusterware to buildup&lt;br /&gt;2021-01-14T11:06:33.484+00:00&lt;br /&gt;Configuration Validation Results:&lt;br /&gt;      Primary database racdbb returned: ORA-0: normal, successful completion&lt;br /&gt;Member racdba successfully completed version check&lt;br /&gt;Broker configuration file is current, completing initialization&lt;br /&gt;2021-01-14T11:06:47.143+00:00&lt;br /&gt;Starting redo apply services...&lt;br /&gt;2021-01-14T11:06:52.764+00:00&lt;br /&gt;instance 2 requested FSFO state reconciliation&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;alert_racdba2.log&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;2021-01-14T11:06:55.357652+00:00&lt;br /&gt;PDB$SEED(2):Endian type of dictionary set to little&lt;br /&gt;PDB$SEED(2):Undo initialization finished serial:0 start:2478578 end:2478578 diff:0 ms (0.0 seconds)&lt;br /&gt;PDB$SEED(2):Database Characterset for PDB$SEED is AL32UTF8&lt;br /&gt;2021-01-14T11:06:55.996836+00:00&lt;br /&gt;PDB$SEED(2):Opening pdb with no Resource Manager plan active&lt;br /&gt;Unable to restore open state for pluggable databases due to               the following errors.&lt;br /&gt;2021-01-14T11:06:56.094252+00:00&lt;br /&gt;Errors in file /u01/app/oracle/diag/rdbms/racdba/racdba2/trace/racdba2_ora_20683.trc:&lt;br /&gt;ORA-65054: Cannot open a pluggable database in the desired mode.&lt;br /&gt;Physical standby database opened for read only access.&lt;br /&gt;Completed: ALTER DATABASE OPEN READ ONLY /* db agent *//* {1:39212:1040} */&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;racdba2_ora_20683.trc&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;*** 2021-01-14T11:06:54.338847+00:00 (CDB$ROOT(1))&lt;br /&gt;kjznppl0: database in migration or not writable&lt;br /&gt;kjac_dpinfo_open: direct path not initialized, reason: in readable standby mode&lt;br /&gt;&lt;br /&gt;*** 2021-01-14T11:06:55.135200+00:00 (CDB$ROOT(1))&lt;br /&gt;* Set mstr_rdy 1, lmon_pnpchk 1 &lt;br /&gt;&lt;br /&gt;*** 2021-01-14T11:06:56.094148+00:00 (CDB$ROOT(1))&lt;br /&gt;&amp;lt;error barrier&gt; at 0x7ffe4296eeb0 placed kpdb.c@21504&lt;br /&gt;ORA-65054: Cannot open a pluggable database in the desired mode.&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;drcracdba2.log&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;2021-01-14T11:05:25.005+00:00&lt;br /&gt;Updated broker configuration file available, loading from "+DATA/RACDBA/dr1racdba"&lt;br /&gt;2021-01-14T11:06:49.513+00:00&lt;br /&gt;&gt;&gt; Starting Data Guard Broker bootstrap &amp;lt;&amp;lt;&lt;br /&gt;Broker Configuration File Locations:&lt;br /&gt;      dg_broker_config_file1 = "+DATA/RACDBA/dr1racdba"&lt;br /&gt;      dg_broker_config_file2 = "+DATA/RACDBA/dr2racdba"&lt;br /&gt;2021-01-14T11:06:49.513+00:00                      DMON: Attach state object&lt;br /&gt;2021-01-14T11:06:49.521+00:00                      DMON: Broker State Initialized&lt;br /&gt;2021-01-14T11:06:49.521+00:00                            Version = 3&lt;br /&gt;2021-01-14T11:06:49.521+00:00                            State = 00000000&lt;br /&gt;2021-01-14T11:06:49.521+00:00                      DMON: Creating INSV process&lt;br /&gt;2021-01-14T11:06:52.746+00:00                      INSV: Opening configuration file '+DATA/RACDBA/dr1racdba' with blocksize 4096&lt;br /&gt;2021-01-14T11:06:52.749+00:00                      INSV: Successfully opened configuration file '+DATA/RACDBA/dr1racdba'&lt;br /&gt;2021-01-14T11:06:52.752+00:00                      INSV: home block of +DATA/RACDBA/dr1racdba: zzz=0x40, Seq.MIV=12.1, fsfo flags=0x0, version=0, pstseq=0.0&lt;br /&gt;2021-01-14T11:06:52.753+00:00                      INSV: Opening configuration file '+DATA/RACDBA/dr2racdba' with blocksize 4096&lt;br /&gt;2021-01-14T11:06:52.755+00:00                      INSV: Successfully opened configuration file '+DATA/RACDBA/dr2racdba'&lt;br /&gt;2021-01-14T11:06:52.757+00:00                      INSV: home block of +DATA/RACDBA/dr2racdba: zzz=0x40, Seq.MIV=13.0, fsfo flags=0x0, version=0, pstseq=0.0&lt;br /&gt;2021-01-14T11:06:52.757+00:00                      INSV: Set current metadata file ID to 2 (Seq.MIV=13.0)&lt;br /&gt;2021-01-14T11:06:52.757+00:00                      INSV: Opening configuration file '+DATA/RACDBA/dr2racdba' with blocksize 4096&lt;br /&gt;2021-01-14T11:06:52.758+00:00                      INSV: Successfully opened configuration file '+DATA/RACDBA/dr2racdba'&lt;br /&gt;2021-01-14T11:06:52.763+00:00                      INSV: Uploading persisted FSFO state:&lt;br /&gt;2021-01-14T11:06:52.763+00:00                             flags=0x00000000, version=0, pstseq=0, target=0, obid=1&lt;br /&gt;2021-01-14T11:06:52.763+00:00                             envsn=0, ackseq=0, new_target=255, new_obid=0&lt;br /&gt;2021-01-14T11:06:52.763+00:00                      	pmyshut=1, aft=30, laglim=30, obslim=30&lt;br /&gt;2021-01-14T11:06:52.763+00:00                      INSV: FSFO state RAC reconcile started&lt;br /&gt;2021-01-14T11:06:52.764+00:00                      INSV: Received reconcile FSFO state from instance #1&lt;br /&gt;2021-01-14T11:06:52.764+00:00                      INSV:        flags=0x00000000, version=0, pstseq=0, target=0, obid=1&lt;br /&gt;2021-01-14T11:06:52.764+00:00                             envsn=0, ackseq=0, new_target=255, new_obid=0&lt;br /&gt;2021-01-14T11:06:52.764+00:00                      INSV: FSFO state RAC reconcile finished&lt;br /&gt;2021-01-14T11:06:52.765+00:00                      INSV: INSV is ready&lt;br /&gt;2021-01-14T11:06:53.534+00:00                      DMON: rfm_get_chief_lock() called for CTL_BOOTSTRAP, reason BOOTSTRAP, called from rfm_dmon_wakeup_fn&lt;br /&gt;2021-01-14T11:06:53.539+00:00 7fffffff           0 DMON: start task execution: broker initialization&lt;br /&gt;2021-01-14T11:06:53.539+00:00                      DMON: Boot configuration (0.0.0), loading from "+DATA/RACDBA/dr2racdba"&lt;br /&gt;2021-01-14T11:06:53.553+00:00                      DMON: My instance_name is racdba2 (SID racdba2), broker profile found at (1.1)&lt;br /&gt;2021-01-14T11:06:53.553+00:00                      DMON: Verifying configuration service racdb_CFG&lt;br /&gt;2021-01-14T11:06:53.553+00:00                      DMON: Configuration service not registered&lt;br /&gt;2021-01-14T11:06:53.553+00:00                      DMON: Adding configuration service... racdb_CFG&lt;br /&gt;2021-01-14T11:06:53.554+00:00                      DMON: Registering 1 service/s with listener(s)&lt;br /&gt;2021-01-14T11:06:53.554+00:00                      DMON: Executing SQL [ALTER SYSTEM REGISTER]&lt;br /&gt;2021-01-14T11:06:53.555+00:00                      SQL [ALTER SYSTEM REGISTER] Executed successfully&lt;br /&gt;2021-01-14T11:06:53.555+00:00                      DMON: SCI harvested (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(Host=raca2.example.com)(Port=1522))(CONNECT_DATA=(SERVICE_NAME=racdba_DGMGRL)(INSTANCE_NAME=racdba2)(SERVER=DEDICATED)))&lt;br /&gt;Broker Configuration:             racdb&lt;br /&gt;  Oracle Release:                 19.0.0.0.0&lt;br /&gt;  Oracle Version:                 19.9.0.0.0&lt;br /&gt;  Metadata Version:               4.1 / UID=0x34ca0bad / Seq.MIV=13.0 / blksz.grain=4096.8&lt;br /&gt;  Protection Mode:                Maximum Performance&lt;br /&gt;  Fast-Start Failover (FSFO): DISABLED, flags=0x0, version=0&lt;br /&gt;  Name                            Member Type                Handle      Enabled&lt;br /&gt;  racdbb                          Primary Database           0x02010000  YES&lt;br /&gt;  racdba                          Physical Standby Database  0x01010000  YES&lt;br /&gt;2021-01-14T11:06:56.334+00:00&lt;br /&gt;Configuration Validation Results:&lt;br /&gt;      Primary database racdbb returned: ORA-0: normal, successful completion&lt;br /&gt;Member racdba successfully completed version check&lt;br /&gt;Broker configuration file is current, completing initialization&lt;br /&gt;2021-01-14T11:07:00.357+00:00&lt;br /&gt;Starting redo apply services...&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Thoughts and Fix&lt;/h3&gt;The problem is that a new standby database does not open a non-seed pluggable database on all instances.&lt;br/&gt;The exact cause is still unclear, but there are certain references in the Oracle documentation that explain how Switchover works when RAC is involved:&lt;br/&gt;&lt;br/&gt;&lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/dgbkr/oracle-data-guard-broker-commands.html#GUID-1B802555-FD50-4926-A2B4-8E15B01DCF0B"&gt;SWITCHOVER&lt;/a&gt;&lt;blockquote cite="https://docs.oracle.com/en/database/oracle/oracle-database/19/dgbkr/oracle-data-guard-broker-commands.html#GUID-1B802555-FD50-4926-A2B4-8E15B01DCF0B"&gt;&lt;div&gt;If an Oracle RAC primary database is becoming a physical standby database, all but one instance of the primary database will be shut down before performing the switchover. See Switchover for details. &lt;/div&gt;&lt;/blockquote&gt;&lt;br/&gt;&lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/dgbkr/oracle-data-guard-broker-commands.html#GUID-1B802555-FD50-4926-A2B4-8E15B01DCF0B"&gt;How the Broker Performs a Switchover&lt;/a&gt;&lt;blockquote cite="https://docs.oracle.com/en/database/oracle/oracle-database/19/dgbkr/oracle-data-guard-broker-commands.html#GUID-1B802555-FD50-4926-A2B4-8E15B01DCF0B"&gt;&lt;div&gt;Restarts the new standby (former primary) database if the switchover occurs to a physical standby database, and Redo Apply begins applying redo data from the new primary database. If this is an Oracle RAC physical standby database managed by Oracle Clusterware, then the broker directs Oracle Clusterware to restart the new standby database. &lt;br/&gt;The new primary database is opened in read/write mode and redo transport services are started. &lt;br/&gt;If the former physical standby database was running with real-time query enabled, the new physical standby database will run with real-time query enabled. &lt;/div&gt;&lt;/blockquote&gt;&lt;br/&gt;I tend to think that the current behaviour is not quite consistent. Either all standby instances should open PDB or neither should open it.&lt;br/&gt;There are several workarounds possible to achieve the desired effect.&lt;br/&gt;Oracle itself recommends using user-defined services:&lt;br/&gt;&lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/multi/administering-pdbs-with-sql-plus.html#GUID-5A2471BC-8501-4E38-BD28-7EE182F3B3A7"&gt;Default and User-Defined Services&lt;/a&gt;&lt;blockquote cite="https://docs.oracle.com/en/database/oracle/oracle-database/19/multi/administering-pdbs-with-sql-plus.html#GUID-5A2471BC-8501-4E38-BD28-7EE182F3B3A7"&gt;&lt;div&gt;Always use user-defined services for applications. The reason is that you can customize user-defined services to fit the requirements of your applications. Oracle recommends that you not use the default PDB service for applications. &lt;/div&gt;&lt;/blockquote&gt;&lt;br/&gt;I am quite fond of that approach, albeit I do not see it is widely used in the field.&lt;br/&gt;Let us create one PDB service for both primary and standby roles: &lt;pre class="brush:sql"&gt;&lt;br /&gt;# RACDBA&lt;br /&gt;srvctl add service -db racdba -service pdb_svc -pdb pdb -preferred racdba1,racdba2 -role primary,physical_standby&lt;br /&gt;srvctl start service -db racdba -service pdb_svc&lt;br /&gt;&lt;br /&gt;# RACDBB&lt;br /&gt;srvctl add service -db racdbb -service pdb_svc -pdb pdb -preferred racdbb1,racdbb2 -role primary,physical_standby&lt;br /&gt;srvctl start service -db racdbb -service pdb_svc&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Another Switchover&lt;/h3&gt;&lt;br/&gt;&lt;h4&gt;dgmgrl&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;DGMGRL&gt; switchover to racdbb;&lt;br /&gt;Performing switchover NOW, please wait...&lt;br /&gt;Operation requires a connection to database "racdbb"&lt;br /&gt;Connecting ...&lt;br /&gt;Connected to "racdbb"&lt;br /&gt;Connected as SYSDBA.&lt;br /&gt;New primary database "racdbb" is opening...&lt;br /&gt;Oracle Clusterware is restarting database "racdba" ...&lt;br /&gt;Connected to "racdba"&lt;br /&gt;Connected to "racdba"&lt;br /&gt;Switchover succeeded, new primary is "racdbb"&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;RACDBA: new standby, old primary&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;SYS@RACDBA&gt; select inst_id, name, open_mode&lt;br /&gt;  2    from gv$pdbs&lt;br /&gt;  3   order by inst_id, name;&lt;br /&gt;&lt;br /&gt; INST_ID NAME       OPEN_MODE&lt;br /&gt;-------- ---------- ----------&lt;br /&gt;       1 PDB        READ ONLY&lt;br /&gt;       1 PDB$SEED   READ ONLY&lt;br /&gt;       2 PDB        READ ONLY&lt;br /&gt;       2 PDB$SEED   READ ONLY&lt;br /&gt;&lt;br /&gt;SYS@RACDBA&gt;&lt;br /&gt;&lt;/pre&gt;PDB is opened on all instances this time around. &lt;br/&gt;&lt;br/&gt;&lt;h4&gt;RACDBB: new primary, old standby&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;SYS@RACDBB&gt; select inst_id, name, open_mode&lt;br /&gt;  2    from gv$pdbs&lt;br /&gt;  3   order by inst_id, name;&lt;br /&gt;&lt;br /&gt; INST_ID NAME       OPEN_MODE&lt;br /&gt;-------- ---------- ----------&lt;br /&gt;       1 PDB        READ WRITE&lt;br /&gt;       1 PDB$SEED   READ ONLY&lt;br /&gt;       2 PDB        READ WRITE&lt;br /&gt;       2 PDB$SEED   READ ONLY&lt;br /&gt;&lt;br /&gt;SYS@RACDBB&gt;&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;alert_racdba1.log&lt;/h4&gt;&lt;pre class="brush:sql;highlight:[16,20,33]"&gt;&lt;br /&gt;2021-01-14T11:27:31.788825+00:00&lt;br /&gt;PDB$SEED(2):Endian type of dictionary set to little&lt;br /&gt;PDB$SEED(2):Undo initialization finished serial:0 start:3713780 end:3713780 diff:0 ms (0.0 seconds)&lt;br /&gt;PDB$SEED(2):Database Characterset for PDB$SEED is AL32UTF8&lt;br /&gt;2021-01-14T11:27:31.988785+00:00&lt;br /&gt;Set LMHB to elevated priority&lt;br /&gt;2021-01-14T11:27:32.638396+00:00&lt;br /&gt;Starting background process RSM0&lt;br /&gt;2021-01-14T11:27:32.660794+00:00&lt;br /&gt;RSM0 started with pid=75, OS id=2007 &lt;br /&gt;2021-01-14T11:27:32.986896+00:00&lt;br /&gt;PDB$SEED(2):Opening pdb with no Resource Manager plan active&lt;br /&gt;Unable to restore open state for pluggable databases due to               the following errors.&lt;br /&gt;2021-01-14T11:27:33.111145+00:00&lt;br /&gt;Errors in file /u01/app/oracle/diag/rdbms/racdba/racdba1/trace/racdba1_ora_1534.trc:&lt;br /&gt;ORA-65054: Cannot open a pluggable database in the desired mode.&lt;br /&gt;Physical standby database opened for read only access.&lt;br /&gt;Completed: ALTER DATABASE OPEN READ ONLY /* db agent *//* {2:24204:2659} */&lt;br /&gt;2021-01-14T11:27:33.820334+00:00&lt;br /&gt;ALTER PLUGGABLE DATABASE pdb OPEN   /* svc agent *//* {2:24204:2659} */&lt;br /&gt;2021-01-14T11:27:34.048502+00:00&lt;br /&gt;ALTER SYSTEM SET remote_listener=' myraca-scan.example.com:1521' SCOPE=MEMORY SID='racdba1';&lt;br /&gt;2021-01-14T11:27:34.050341+00:00&lt;br /&gt;ALTER SYSTEM SET listener_networks='' SCOPE=MEMORY SID='racdba1';&lt;br /&gt;PDB(3):Autotune of undo retention is turned on. &lt;br /&gt;2021-01-14T11:27:34.073923+00:00&lt;br /&gt;PDB(3):Endian type of dictionary set to little&lt;br /&gt;PDB(3):Undo initialization finished serial:0 start:3716088 end:3716088 diff:0 ms (0.0 seconds)&lt;br /&gt;PDB(3):Database Characterset for PDB is AL32UTF8&lt;br /&gt;2021-01-14T11:27:35.152791+00:00&lt;br /&gt;PDB(3):Opening pdb with no Resource Manager plan active&lt;br /&gt;Pluggable database PDB opened read only&lt;br /&gt;Completed: ALTER PLUGGABLE DATABASE pdb OPEN   /* svc agent *//* {2:24204:2659} */&lt;br /&gt;2021-01-14T11:27:35.703268+00:00&lt;br /&gt;PDB(3):Started service pdb_svc/pdb_svc/pdb_svc&lt;br /&gt;&lt;/pre&gt;Although the ORA-65054 error is still there, the pluggable database is opened shortly afterwards by the Clusterware. &lt;br/&gt;&lt;br/&gt;&lt;h4&gt;racdba1_ora_1534.trc&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;*** 2021-01-14T11:27:20.529675+00:00 (CDB$ROOT(1))&lt;br /&gt;*** SESSION ID:(377.9495) 2021-01-14T11:27:20.529708+00:00&lt;br /&gt;*** CLIENT ID:() 2021-01-14T11:27:20.529717+00:00&lt;br /&gt;*** SERVICE NAME:() 2021-01-14T11:27:20.529724+00:00&lt;br /&gt;*** MODULE NAME:(oraagent.bin@raca1.example.com (TNS V1-V3)) 2021-01-14T11:27:20.529731+00:00&lt;br /&gt;*** ACTION NAME:() 2021-01-14T11:27:20.529739+00:00&lt;br /&gt;*** CLIENT DRIVER:() 2021-01-14T11:27:20.529745+00:00&lt;br /&gt;*** CONTAINER ID:(1) 2021-01-14T11:27:20.529753+00:00&lt;br /&gt; &lt;br /&gt;kcrrmnt: RT: Role transition work is not done&lt;br /&gt;&lt;br /&gt;*** 2021-01-14T11:27:20.865334+00:00 (CDB$ROOT(1))&lt;br /&gt;*** 2021-01-14 11:27:20.865323 [krsn.c:548]&lt;br /&gt;krsn_dbrole_change: Database role set to PHYSICAL STANDBY [kcvfdb.c:9212]&lt;br /&gt;krsd_cb_role_change: role 2&lt;br /&gt;*** 2021-01-14 11:27:20.993319 [krsh.c:6348]&lt;br /&gt;Archiving previously deferred ORLs&lt;br /&gt;*** 2021-01-14 11:27:20.993982 [krsq.c:3772]&lt;br /&gt;krsq_arch_all_complete: Finished archiving all complete, unarchived ORLs&lt;br /&gt;&lt;br /&gt;*** 2021-01-14T11:27:30.695367+00:00 (CDB$ROOT(1))&lt;br /&gt;kjznppl0: database in migration or not writable&lt;br /&gt;&lt;br /&gt;*** 2021-01-14T11:27:30.999497+00:00 (CDB$ROOT(1))&lt;br /&gt;kjac_dpinfo_open: direct path not initialized, reason: in readable standby mode&lt;br /&gt;* Set mstr_rdy 1, lmon_pnpchk 1 &lt;br /&gt;&lt;br /&gt;*** 2021-01-14T11:27:32.249955+00:00 (PDB$SEED(2))&lt;br /&gt;IPCLW:[0.0]{-}[WAIT]:PROTO: [1610623652249736]ipclw_data_chunk_process:1165 Discarding msg with seq # 2043340599, expecting 2043340603&lt;br /&gt;&lt;br /&gt;*** 2021-01-14T11:27:33.111040+00:00 (CDB$ROOT(1))&lt;br /&gt;&amp;lt;error barrier&gt; at 0x7ffc3992e030 placed kpdb.c@21504&lt;br /&gt;ORA-65054: Cannot open a pluggable database in the desired mode.&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;drcracdba1.log&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;2021-01-14T11:27:25.254+00:00&lt;br /&gt;&gt;&gt; Starting Data Guard Broker bootstrap &amp;lt;&amp;lt;&lt;br /&gt;Broker Configuration File Locations:&lt;br /&gt;      dg_broker_config_file1 = "+DATA/RACDBA/dr1racdba"&lt;br /&gt;      dg_broker_config_file2 = "+DATA/RACDBA/dr2racdba"&lt;br /&gt;2021-01-14T11:27:25.254+00:00                      DMON: Attach state object&lt;br /&gt;2021-01-14T11:27:25.261+00:00                      DMON: Broker State Initialized&lt;br /&gt;2021-01-14T11:27:25.261+00:00                            Version = 3&lt;br /&gt;2021-01-14T11:27:25.261+00:00                            State = 00000000&lt;br /&gt;2021-01-14T11:27:25.261+00:00                      DMON: Creating INSV process&lt;br /&gt;2021-01-14T11:27:28.282+00:00                      INSV: Opening configuration file '+DATA/RACDBA/dr1racdba' with blocksize 4096&lt;br /&gt;2021-01-14T11:27:28.292+00:00                      INSV: Successfully opened configuration file '+DATA/RACDBA/dr1racdba'&lt;br /&gt;2021-01-14T11:27:28.296+00:00                      INSV: home block of +DATA/RACDBA/dr1racdba: zzz=0x40, Seq.MIV=14.1, fsfo flags=0x0, version=0, pstseq=0.0&lt;br /&gt;2021-01-14T11:27:28.297+00:00                      INSV: Opening configuration file '+DATA/RACDBA/dr2racdba' with blocksize 4096&lt;br /&gt;2021-01-14T11:27:28.300+00:00                      INSV: Successfully opened configuration file '+DATA/RACDBA/dr2racdba'&lt;br /&gt;2021-01-14T11:27:28.301+00:00                      INSV: home block of +DATA/RACDBA/dr2racdba: zzz=0x40, Seq.MIV=15.0, fsfo flags=0x0, version=0, pstseq=0.0&lt;br /&gt;2021-01-14T11:27:28.301+00:00                      INSV: Set current metadata file ID to 2 (Seq.MIV=15.0)&lt;br /&gt;2021-01-14T11:27:28.301+00:00                      INSV: Opening configuration file '+DATA/RACDBA/dr2racdba' with blocksize 4096&lt;br /&gt;2021-01-14T11:27:28.303+00:00                      INSV: Successfully opened configuration file '+DATA/RACDBA/dr2racdba'&lt;br /&gt;2021-01-14T11:27:28.305+00:00                      INSV: Uploading persisted FSFO state:&lt;br /&gt;2021-01-14T11:27:28.305+00:00                             flags=0x00000000, version=0, pstseq=0, target=0, obid=1&lt;br /&gt;2021-01-14T11:27:28.305+00:00                             envsn=0, ackseq=0, new_target=255, new_obid=0&lt;br /&gt;2021-01-14T11:27:28.305+00:00                      	pmyshut=1, aft=30, laglim=30, obslim=30&lt;br /&gt;2021-01-14T11:27:28.305+00:00                      INSV: FSFO state RAC reconcile started&lt;br /&gt;2021-01-14T11:27:28.306+00:00                      INSV: Received reconcile FSFO state from instance #2&lt;br /&gt;2021-01-14T11:27:28.306+00:00                      INSV:        flags=0x00000000, version=0, pstseq=0, target=0, obid=1&lt;br /&gt;2021-01-14T11:27:28.306+00:00                             envsn=0, ackseq=0, new_target=255, new_obid=0&lt;br /&gt;2021-01-14T11:27:28.307+00:00                      INSV: FSFO state RAC reconcile finished&lt;br /&gt;2021-01-14T11:27:28.307+00:00                      INSV: INSV is ready&lt;br /&gt;2021-01-14T11:27:29.278+00:00                      DMON: rfm_get_chief_lock() called for CTL_BOOTSTRAP, reason BOOTSTRAP, called from rfm_dmon_wakeup_fn&lt;br /&gt;2021-01-14T11:27:29.284+00:00 7fffffff           0 DMON: start task execution: broker initialization&lt;br /&gt;2021-01-14T11:27:29.284+00:00                      DMON: Boot configuration (0.0.0), loading from "+DATA/RACDBA/dr2racdba"&lt;br /&gt;2021-01-14T11:27:29.301+00:00                      DMON: My instance_name is racdba1 (SID racdba1), broker profile found at (1.2)&lt;br /&gt;2021-01-14T11:27:29.301+00:00                      DMON: Verifying configuration service racdb_CFG&lt;br /&gt;2021-01-14T11:27:29.301+00:00                      DMON: Configuration service not registered&lt;br /&gt;2021-01-14T11:27:29.301+00:00                      DMON: Adding configuration service... racdb_CFG&lt;br /&gt;2021-01-14T11:27:29.303+00:00                      DMON: Registering 1 service/s with listener(s)&lt;br /&gt;2021-01-14T11:27:29.303+00:00                      DMON: Executing SQL [ALTER SYSTEM REGISTER]&lt;br /&gt;2021-01-14T11:27:29.303+00:00                      SQL [ALTER SYSTEM REGISTER] Executed successfully&lt;br /&gt;2021-01-14T11:27:29.303+00:00                      DMON: SCI harvested (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(Host=raca1.example.com)(Port=1522))(CONNECT_DATA=(SERVICE_NAME=racdba_DGMGRL)(INSTANCE_NAME=racdba1)(SERVER=DEDICATED)))&lt;br /&gt;Broker Configuration:             racdb&lt;br /&gt;  Oracle Release:                 19.0.0.0.0&lt;br /&gt;  Oracle Version:                 19.9.0.0.0&lt;br /&gt;  Metadata Version:               4.1 / UID=0x34ca0bad / Seq.MIV=15.0 / blksz.grain=4096.8&lt;br /&gt;  Protection Mode:                Maximum Performance&lt;br /&gt;  Fast-Start Failover (FSFO): DISABLED, flags=0x0, version=0&lt;br /&gt;  Name                            Member Type                Handle      Enabled&lt;br /&gt;  racdbb                          Primary Database           0x02010000  YES&lt;br /&gt;  racdba                          Physical Standby Database  0x01010000  YES&lt;br /&gt;2021-01-14T11:27:32.638+00:00&lt;br /&gt;Configuration Validation Results:&lt;br /&gt;      Primary database racdbb returned: ORA-0: normal, successful completion&lt;br /&gt;Member racdba successfully completed version check&lt;br /&gt;Broker configuration file is current, completing initialization&lt;br /&gt;2021-01-14T11:27:46.120+00:00&lt;br /&gt;Starting redo apply services...&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;alert_racdba2.log&lt;/h4&gt;&lt;pre class="brush:sql;highlight:[16,21]"&gt;&lt;br /&gt;2021-01-14T11:27:10.590468+00:00&lt;br /&gt;PDB$SEED(2):This instance was first to open pluggable database PDB$SEED (container=2)&lt;br /&gt;PDB$SEED(2):Endian type of dictionary set to little&lt;br /&gt;PDB$SEED(2):Undo initialization finished serial:0 start:3693763 end:3693763 diff:0 ms (0.0 seconds)&lt;br /&gt;PDB$SEED(2):Database Characterset for PDB$SEED is AL32UTF8&lt;br /&gt;2021-01-14T11:27:10.879141+00:00&lt;br /&gt;db_recovery_file_dest_size of 18000 MB is 15.64% used. This is a&lt;br /&gt;user-specified limit on the amount of space that will be used by this&lt;br /&gt;database for recovery-related files, and does not reflect the amount of&lt;br /&gt;space available in the underlying filesystem or ASM diskgroup.&lt;br /&gt;2021-01-14T11:27:11.038141+00:00&lt;br /&gt;PDB$SEED(2):Opening pdb with no Resource Manager plan active&lt;br /&gt;Unable to restore open state for pluggable databases due to               the following errors.&lt;br /&gt;2021-01-14T11:27:11.103829+00:00&lt;br /&gt;Errors in file /u01/app/oracle/diag/rdbms/racdba/racdba2/trace/racdba2_ora_6677.trc:&lt;br /&gt;ORA-65054: Cannot open a pluggable database in the desired mode.&lt;br /&gt;2021-01-14T11:27:11.217024+00:00&lt;br /&gt;Physical standby database opened for read only access.&lt;br /&gt;Completed: ALTER DATABASE OPEN READ ONLY /* db agent *//* {2:24204:2565} */&lt;br /&gt;2021-01-14T11:27:11.849329+00:00&lt;br /&gt;ALTER PLUGGABLE DATABASE pdb OPEN READ ONLY  /* svc agent *//* {2:24204:2565} */&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;racdb2_ora_6677.trc&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;*** 2021-01-14T11:27:09.794332+00:00 (CDB$ROOT(1))&lt;br /&gt;kjznppl0: database in migration or not writable&lt;br /&gt;kjac_dpinfo_open: direct path not initialized, reason: in readable standby mode&lt;br /&gt;* Set mstr_rdy 1, lmon_pnpchk 1 &lt;br /&gt;&lt;br /&gt;*** 2021-01-14T11:27:11.103734+00:00 (CDB$ROOT(1))&lt;br /&gt;&amp;lt;error barrier&gt; at 0x7ffdf766e730 placed kpdb.c@21504&lt;br /&gt;ORA-65054: Cannot open a pluggable database in the desired mode.&lt;br /&gt;&lt;/pre&gt;&lt;h4&gt;drcracdba2.log&lt;/h4&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;2021-01-14T11:26:06.494+00:00&lt;br /&gt;Initiating a healthcheck...&lt;br /&gt;2021-01-14T11:26:08.044+00:00&lt;br /&gt;SWITCHOVER TO racdbb&lt;br /&gt;Switchover to physical standby database cannot be initiated from the primary database&lt;br /&gt;redirecting connection to switchover target database racdbb...&lt;br /&gt;...using connect identifier: //myracb-scan/racdbb&lt;br /&gt;SWITCHOVER TO racdbb&lt;br /&gt;2021-01-14T11:26:10.771+00:00&lt;br /&gt;Notifying Oracle Clusterware to prepare primary database for switchover&lt;br /&gt;Switchover in progress...&lt;br /&gt;2021-01-14T11:26:12.048+00:00&lt;br /&gt;Executing SQL: [ALTER DATABASE SWITCHOVER TO 'racdbb']&lt;br /&gt;2021-01-14T11:26:33.855+00:00&lt;br /&gt;SQL [ALTER DATABASE SWITCHOVER TO 'racdbb'] executed successfully&lt;br /&gt;2021-01-14T11:26:35.031+00:00&lt;br /&gt;Switchover successful&lt;br /&gt;2021-01-14T11:26:40.618+00:00&lt;br /&gt;Notifying Clusterware to restart this instance for Switchover&lt;br /&gt;2021-01-14T11:26:42.824+00:00&lt;br /&gt;Shutting down instance after Switchover&lt;br /&gt;2021-01-14T11:27:02.925+00:00&lt;br /&gt;&gt;&gt; Starting Data Guard Broker bootstrap &amp;lt;&amp;lt;&lt;br /&gt;Broker Configuration File Locations:&lt;br /&gt;      dg_broker_config_file1 = "+DATA/RACDBA/dr1racdba"&lt;br /&gt;      dg_broker_config_file2 = "+DATA/RACDBA/dr2racdba"&lt;br /&gt;2021-01-14T11:27:02.925+00:00                      DMON: Attach state object&lt;br /&gt;2021-01-14T11:27:02.927+00:00                      DMON: Initialization of broker state requires reconciliation&lt;br /&gt;2021-01-14T11:27:02.927+00:00                      DMON: Broker state reconciled, version = 0, state = 00000000&lt;br /&gt;2021-01-14T11:27:02.927+00:00                      DMON: Broker State Initialized&lt;br /&gt;2021-01-14T11:27:02.927+00:00                            Version = 1&lt;br /&gt;2021-01-14T11:27:02.927+00:00                            State = 00000000&lt;br /&gt;2021-01-14T11:27:02.927+00:00                      DMON: Creating INSV process&lt;br /&gt;2021-01-14T11:27:05.944+00:00                      INSV: Opening configuration file '+DATA/RACDBA/dr1racdba' with blocksize 4096&lt;br /&gt;2021-01-14T11:27:05.946+00:00                      INSV: Successfully opened configuration file '+DATA/RACDBA/dr1racdba'&lt;br /&gt;2021-01-14T11:27:05.950+00:00                      INSV: home block of +DATA/RACDBA/dr1racdba: zzz=0x40, Seq.MIV=14.1, fsfo flags=0x0, version=0, pstseq=0.0&lt;br /&gt;2021-01-14T11:27:05.951+00:00                      INSV: Opening configuration file '+DATA/RACDBA/dr2racdba' with blocksize 4096&lt;br /&gt;2021-01-14T11:27:05.952+00:00                      INSV: Successfully opened configuration file '+DATA/RACDBA/dr2racdba'&lt;br /&gt;2021-01-14T11:27:05.954+00:00                      INSV: home block of +DATA/RACDBA/dr2racdba: zzz=0x40, Seq.MIV=15.0, fsfo flags=0x0, version=0, pstseq=0.0&lt;br /&gt;2021-01-14T11:27:05.954+00:00                      INSV: Set current metadata file ID to 2 (Seq.MIV=15.0)&lt;br /&gt;2021-01-14T11:27:05.954+00:00                      INSV: Opening configuration file '+DATA/RACDBA/dr2racdba' with blocksize 4096&lt;br /&gt;2021-01-14T11:27:05.956+00:00                      INSV: Successfully opened configuration file '+DATA/RACDBA/dr2racdba'&lt;br /&gt;2021-01-14T11:27:05.958+00:00                      INSV: Uploading persisted FSFO state:&lt;br /&gt;2021-01-14T11:27:05.958+00:00                             flags=0x00000000, version=0, pstseq=0, target=0, obid=1&lt;br /&gt;2021-01-14T11:27:05.958+00:00                             envsn=0, ackseq=0, new_target=255, new_obid=0&lt;br /&gt;2021-01-14T11:27:05.958+00:00                      	pmyshut=1, aft=30, laglim=30, obslim=30&lt;br /&gt;2021-01-14T11:27:05.958+00:00                      INSV: FSFO state RAC reconcile started&lt;br /&gt;2021-01-14T11:27:05.959+00:00                      INSV: FSFO state RAC reconcile finished&lt;br /&gt;2021-01-14T11:27:05.959+00:00                      INSV: INSV is ready&lt;br /&gt;2021-01-14T11:27:06.940+00:00                      DMON: rfm_get_chief_lock() called for CTL_BOOTSTRAP, reason BOOTSTRAP, called from rfm_dmon_wakeup_fn&lt;br /&gt;2021-01-14T11:27:06.941+00:00 7fffffff           0 DMON: start task execution: broker initialization&lt;br /&gt;2021-01-14T11:27:06.941+00:00                      DMON: Boot configuration (0.0.0), loading from "+DATA/RACDBA/dr2racdba"&lt;br /&gt;2021-01-14T11:27:06.951+00:00                      DMON: My instance_name is racdba2 (SID racdba2), broker profile found at (1.1)&lt;br /&gt;2021-01-14T11:27:06.951+00:00                      DMON: Verifying configuration service racdb_CFG&lt;br /&gt;2021-01-14T11:27:06.951+00:00                      DMON: Configuration service not registered&lt;br /&gt;2021-01-14T11:27:06.951+00:00                      DMON: Adding configuration service... racdb_CFG&lt;br /&gt;2021-01-14T11:27:06.951+00:00                      DMON: Registering 1 service/s with listener(s)&lt;br /&gt;2021-01-14T11:27:06.951+00:00                      DMON: Executing SQL [ALTER SYSTEM REGISTER]&lt;br /&gt;2021-01-14T11:27:06.952+00:00                      SQL [ALTER SYSTEM REGISTER] Executed successfully&lt;br /&gt;2021-01-14T11:27:06.952+00:00                      DMON: SCI harvested (DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(Host=raca2.example.com)(Port=1522))(CONNECT_DATA=(SERVICE_NAME=racdba_DGMGRL)(INSTANCE_NAME=racdba2)(SERVER=DEDICATED)))&lt;br /&gt;Broker Configuration:             racdb&lt;br /&gt;  Oracle Release:                 19.0.0.0.0&lt;br /&gt;  Oracle Version:                 19.9.0.0.0&lt;br /&gt;  Metadata Version:               4.1 / UID=0x34ca0bad / Seq.MIV=15.0 / blksz.grain=4096.8&lt;br /&gt;  Protection Mode:                Maximum Performance&lt;br /&gt;  Fast-Start Failover (FSFO): DISABLED, flags=0x0, version=0&lt;br /&gt;  Name                            Member Type                Handle      Enabled&lt;br /&gt;  racdbb                          Primary Database           0x02010000  YES&lt;br /&gt;  racdba                          Physical Standby Database  0x01010000  YES&lt;br /&gt;2021-01-14T11:27:06.981+00:00&lt;br /&gt;Physical standby restart after broker operation requires Oracle Clusterware buildup&lt;br /&gt;Notifying Oracle Clusterware to buildup&lt;br /&gt;2021-01-14T11:27:09.788+00:00&lt;br /&gt;Configuration Validation Results:&lt;br /&gt;      Primary database racdbb returned: ORA-0: normal, successful completion&lt;br /&gt;Member racdba successfully completed version check&lt;br /&gt;Broker configuration file is current, completing initialization&lt;br /&gt;2021-01-14T11:27:21.950+00:00&lt;br /&gt;Starting redo apply services...&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Conclusion&lt;/h3&gt;User PDB's may not open on all instances following DataGuard Switchover. This behaviour is quite inconsistent since PDB's are opened just on some instances. Thankfully, the workaround is pretty straightforward - we just need to create a dedicated service for these PDB's.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/552974218485445135/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/01/pluggable-database-not-opened-on-all.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/552974218485445135'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/552974218485445135'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/01/pluggable-database-not-opened-on-all.html' title='Pluggable Database not Opened on all RAC Instances Following Switchover'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-5533782594359308307</id><published>2021-01-07T01:14:00.000+06:00</published><updated>2021-01-07T01:14:23.256+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='aws'/><title type='text'>Reading Amazon S3 Data from Oracle on non-OCI Environment</title><content type='html'>It is known that &lt;a href="https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/dbms-cloud.html#GUID-2AFBEFA4-992E-4F53-96DB-F560084C7DA9"&gt;DBMS_CLOUD&lt;/a&gt; can be used to read Amazon S3 data. However, it is one of the packages supplied by Oracle for its Autonomous Database offering. Likewise, Amazon RDS provides some &lt;a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/oracle-s3-integration.html"&gt;S3 integration&lt;/a&gt; as well. &lt;br/&gt;&lt;br/&gt;What about customers who do not use either of these? I used to work for a company where we were using &lt;a href="https://github.com/mortenbra/alexandria-plsql-utils"&gt;alexandria-plsql-utils&lt;/a&gt; to load data from S3. Coincidentally, I have been looking for something recently on MOS and came across the following bug: &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=28867698.8"&gt;Bug 28867698 - Inclusion of DBMS_CLOUD into "STANDARD" Oracle (Doc ID 28867698.8)&lt;/a&gt;. It sounded promising, so that I decided to investigate as to how this package can be adapted for reading S3 data. &lt;br/&gt;&lt;br/&gt;&lt;h3&gt;Prerequisites&lt;/h3&gt;The fix for the bug is included in 19.9 DB October 2020 Release Update. I assume this package and its dependencies can be installed in earlier releases/release updates. However, I have no idea whether it will work there. I can imagine that there might be some issues, to name a few:  &lt;ul&gt;  &lt;li&gt;DBMS_CLOUD and its dependencies use JSON. Its support has been gradually improving over the last releases. It might be the case that some of the  functionality will not work properly in older releases.&lt;/li&gt;  &lt;li&gt;Not only is this about the package and other supplied database objects, but also it is about the ORACLE_LOADER access driver. If it does not provide the required capabilities in older releases, then again it is not something that can be fixed easily.&lt;/li&gt;&lt;/ul&gt;&lt;br/&gt;&lt;br/&gt;&lt;h3&gt;Environment&lt;/h3&gt;My environment is 19.9 CDB Single Instance on Azure: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@myhostname ~]$ $ORACLE_HOME/OPatch/opatch lspatches&lt;br /&gt;31772784;OCW RELEASE UPDATE 19.9.0.0.0 (31772784)&lt;br /&gt;31771877;Database Release Update : 19.9.0.0.201020 (31771877)&lt;br /&gt;&lt;br /&gt;OPatch succeeded.&lt;br /&gt;&lt;/pre&gt;I created a new PDB for this exercise: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; create pluggable database tc admin user pdb_admin identified by oracle;&lt;br /&gt;&lt;br /&gt;Pluggable database created.&lt;br /&gt;&lt;br /&gt;SQL&gt; alter pluggable database tc open;&lt;br /&gt;&lt;br /&gt;Pluggable database altered.&lt;br /&gt;&lt;/pre&gt;Since I am going to read data from S3, I created a new bucket &lt;code&gt;mikhail-bucket-20210104&lt;/code&gt;. It is non-public, so that I created a new IAM user, and assigned the following policy to it: &lt;pre class="brush:sql"&gt;&lt;br /&gt;{&lt;br /&gt;    "Version": "2012-10-17",&lt;br /&gt;    "Statement": [&lt;br /&gt;        {&lt;br /&gt;            "Sid": "Stmt1508867055000",&lt;br /&gt;            "Effect": "Allow",&lt;br /&gt;            "Action": [&lt;br /&gt;                "s3:GetObject"&lt;br /&gt;            ],&lt;br /&gt;            "Resource": [&lt;br /&gt;                "arn:aws:s3:::mikhail-bucket-20210104/*"&lt;br /&gt;            ]&lt;br /&gt;        }&lt;br /&gt;    ]&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;Then, I saved user's access and secret keys which will be used to establish an S3 connection from the Oracle database. &lt;br/&gt;&lt;br/&gt;&lt;h3&gt;Installation Steps&lt;/h3&gt;I used the following script to install DBMS_CLOUD as SYS: &lt;pre class="brush:sql"&gt;&lt;br /&gt;spo /tmp/dbms_cloud&lt;br /&gt;&lt;br /&gt;@?/rdbms/admin/dbms_cloud_types.sql&lt;br /&gt;@?/rdbms/admin/dbms_cloud.sql&lt;br /&gt;@?/rdbms/admin/dbms_cloud_task_catalog.sql&lt;br /&gt;@?/rdbms/admin/dbms_cloud_catalog.sql&lt;br /&gt;@?/rdbms/admin/dbms_cloud_task_views.sql&lt;br /&gt;@?/rdbms/admin/dbms_cloud_capability.sql&lt;br /&gt;@?/rdbms/admin/prvt_cloud_core.plb&lt;br /&gt;@?/rdbms/admin/prvt_cloud_core_body.plb&lt;br /&gt;@?/rdbms/admin/prvt_cloud_internal.plb&lt;br /&gt;@?/rdbms/admin/prvt_cloud_request.plb&lt;br /&gt;@?/rdbms/admin/prvt_cloud_task.plb&lt;br /&gt;@?/rdbms/admin/prvt_cloud_task_body.plb&lt;br /&gt;@?/rdbms/admin/prvt_cloud_body.plb&lt;br /&gt;@?/rdbms/admin/prvt_cloud_capability_body.plb&lt;br /&gt;@?/rdbms/admin/prvt_cloud_internal_body.plb&lt;br /&gt;@?/rdbms/admin/prvt_cloud_request_body.plb&lt;br /&gt;@?/rdbms/admin/dbms_cloud_metadata.sql&lt;br /&gt;&lt;br /&gt;spo off&lt;br /&gt;&lt;/pre&gt;These are the files that Oracle added in 19.9. Presumably they were provided by the fix for &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=28867698.8"&gt;Bug 28867698 - Inclusion of DBMS_CLOUD into "STANDARD" Oracle (Doc ID 28867698.8)&lt;/a&gt;.&lt;br/&gt;I am going to access S3 via HTTPS. Therefore, I created a new empty wallet &lt;code&gt;/u01/app/oracle/wallet&lt;/code&gt;: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@myhostname ~]$ mkdir -p /u01/app/oracle/wallet&lt;br /&gt;[oracle@myhostname ~]$ orapki wallet create -wallet /u01/app/oracle/wallet -pwd Oracle123 -auto_login&lt;br /&gt;Oracle PKI Tool Release 21.0.0.0.0 - Production&lt;br /&gt;Version 21.0.0.0.0&lt;br /&gt;Copyright (c) 2004, 2020, Oracle and/or its affiliates. All rights reserved.&lt;br /&gt;&lt;br /&gt;Operation is successfully completed.&lt;br /&gt;&lt;/pre&gt;I also need to load SSL certificates into the wallet. I use openssl to get the certificates. &lt;pre class="brush:sql;highlight:[13,18,21,26]"&gt;&lt;br /&gt;[oracle@myhostname ~]$ openssl s_client -showcerts -connect s3.amazonaws.com:443 &amp;lt;/dev/null&lt;br /&gt;CONNECTED(00000003)&lt;br /&gt;depth=2 C = IE, O = Baltimore, OU = CyberTrust, CN = Baltimore CyberTrust Root&lt;br /&gt;verify return:1&lt;br /&gt;depth=1 C = US, O = DigiCert Inc, OU = www.digicert.com, CN = DigiCert Baltimore CA-2 G2&lt;br /&gt;verify return:1&lt;br /&gt;depth=0 C = US, ST = Washington, L = Seattle, O = "Amazon.com, Inc.", CN = s3.amazonaws.com&lt;br /&gt;verify return:1&lt;br /&gt;---&lt;br /&gt;Certificate chain&lt;br /&gt; 0 s:/C=US/ST=Washington/L=Seattle/O=Amazon.com, Inc./CN=s3.amazonaws.com&lt;br /&gt;   i:/C=US/O=DigiCert Inc/OU=www.digicert.com/CN=DigiCert Baltimore CA-2 G2&lt;br /&gt;-----BEGIN CERTIFICATE-----&lt;br /&gt;MIIIGTCCBwGgAwIBAgIQDWRQa0XzDONabC3fLBi0NzANBgkqhkiG9w0BAQsFADBk&lt;br /&gt;&amp;lt;skip&gt;&lt;br /&gt;x+JAorfCzDKa+P1lgCh3+V5Lnqvla2hwCyCnYAy1RR0y1UEUB8FUYj1/PIDs9RJX&lt;br /&gt;cVq+ZBjAtIrm6j5b+Q==&lt;br /&gt;-----END CERTIFICATE-----&lt;br /&gt; 1 s:/C=US/O=DigiCert Inc/OU=www.digicert.com/CN=DigiCert Baltimore CA-2 G2&lt;br /&gt;   i:/C=IE/O=Baltimore/OU=CyberTrust/CN=Baltimore CyberTrust Root&lt;br /&gt;-----BEGIN CERTIFICATE-----&lt;br /&gt;MIIEYzCCA0ugAwIBAgIQAYL4CY6i5ia5GjsnhB+5rzANBgkqhkiG9w0BAQsFADBa&lt;br /&gt;&amp;lt;skip&gt;&lt;br /&gt;0WyzT7QrhExHkOyL4kGJE7YHRndC/bseF/r/JUuOUFfrjsxOFT+xJd1BDKCcYm1v&lt;br /&gt;upcHi9nzBhDFKdT3uhaQqNBU4UtJx5g=&lt;br /&gt;-----END CERTIFICATE-----&lt;br /&gt;---&lt;br /&gt;Server certificate&lt;br /&gt;subject=/C=US/ST=Washington/L=Seattle/O=Amazon.com, Inc./CN=s3.amazonaws.com&lt;br /&gt;issuer=/C=US/O=DigiCert Inc/OU=www.digicert.com/CN=DigiCert Baltimore CA-2 G2&lt;br /&gt;---&lt;br /&gt;No client certificate CA names sent&lt;br /&gt;Peer signing digest: SHA256&lt;br /&gt;Server Temp Key: ECDH, P-256, 256 bits&lt;br /&gt;---&lt;br /&gt;SSL handshake has read 3712 bytes and written 415 bytes&lt;br /&gt;---&lt;br /&gt;New, TLSv1/SSLv3, Cipher is ECDHE-RSA-AES128-GCM-SHA256&lt;br /&gt;Server public key is 2048 bit&lt;br /&gt;Secure Renegotiation IS supported&lt;br /&gt;Compression: NONE&lt;br /&gt;Expansion: NONE&lt;br /&gt;No ALPN negotiated&lt;br /&gt;SSL-Session:&lt;br /&gt;    Protocol  : TLSv1.2&lt;br /&gt;    Cipher    : ECDHE-RSA-AES128-GCM-SHA256&lt;br /&gt;    Session-ID: 5BE1D3D1A79399E9728D7E0B2CD4E1F041DCEC03087D4EFAEF6131AF5A8ABF80&lt;br /&gt;    Session-ID-ctx:&lt;br /&gt;    Master-Key: 7E05806771AF48B9A9EA7DC6B5DBC4E064F315825F4BE411C7D5FB97B189B0643BE7200463EB29D44A4CF12951AF2C2A&lt;br /&gt;    Key-Arg   : None&lt;br /&gt;    Krb5 Principal: None&lt;br /&gt;    PSK identity: None&lt;br /&gt;    PSK identity hint: None&lt;br /&gt;    Start Time: 1609936308&lt;br /&gt;    Timeout   : 300 (sec)&lt;br /&gt;    Verify return code: 0 (ok)&lt;br /&gt;---&lt;br /&gt;DONE&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Essentially, I have to load two certificates bounded by BEGIN/END CERTIFICATE lines. I wrote a one-liner for that - it extracts certificates using sed, and pipes it through csplit to write each certificate to a separate file: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@myhostname ~]$ openssl s_client -showcerts -connect s3.amazonaws.com:443 &amp;lt;/dev/null 2&gt;/dev/null | sed '/BEGIN/,/END/!d' | csplit -f aws -b '%d.pem' - /END/+1&lt;br /&gt;2870&lt;br /&gt;1582&lt;br /&gt;[oracle@myhostname ~]$ ll aws?.pem&lt;br /&gt;-rw-r--r-- 1 oracle oinstall 2870 Jan  6 12:33 aws0.pem&lt;br /&gt;-rw-r--r-- 1 oracle oinstall 1582 Jan  6 12:33 aws1.pem&lt;br /&gt;&lt;/pre&gt;Now I can load both certificates into the wallet: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@myhostname ~]$ orapki wallet add -wallet /u01/app/oracle/wallet -cert aws0.pem -trusted_cert -pwd Oracle123&lt;br /&gt;Oracle PKI Tool Release 21.0.0.0.0 - Production&lt;br /&gt;Version 21.0.0.0.0&lt;br /&gt;Copyright (c) 2004, 2020, Oracle and/or its affiliates. All rights reserved.&lt;br /&gt;&lt;br /&gt;Operation is successfully completed.&lt;br /&gt;[oracle@myhostname ~]$ orapki wallet add -wallet /u01/app/oracle/wallet -cert aws1.pem -trusted_cert -pwd Oracle123&lt;br /&gt;Oracle PKI Tool Release 21.0.0.0.0 - Production&lt;br /&gt;Version 21.0.0.0.0&lt;br /&gt;Copyright (c) 2004, 2020, Oracle and/or its affiliates. All rights reserved.&lt;br /&gt;&lt;br /&gt;Operation is successfully completed.&lt;br /&gt;[oracle@myhostname ~]$ orapki wallet display -wallet /u01/app/oracle/wallet&lt;br /&gt;Oracle PKI Tool Release 21.0.0.0.0 - Production&lt;br /&gt;Version 21.0.0.0.0&lt;br /&gt;Copyright (c) 2004, 2020, Oracle and/or its affiliates. All rights reserved.&lt;br /&gt;&lt;br /&gt;Requested Certificates:&lt;br /&gt;User Certificates:&lt;br /&gt;Trusted Certificates:&lt;br /&gt;Subject:        CN=DigiCert Baltimore CA-2 G2,OU=www.digicert.com,O=DigiCert Inc,C=US&lt;br /&gt;Subject:        CN=s3.amazonaws.com,O=Amazon.com\, Inc.,L=Seattle,ST=Washington,C=US&lt;br /&gt;&lt;/pre&gt;At this stage, I can fire an HTTP request: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select utl_http.request('https://mikhail-bucket-20210104.s3.amazonaws.com/sales_2020.csv',&lt;br /&gt;  2                          null,&lt;br /&gt;  3                          'file:/u01/app/oracle/wallet')&lt;br /&gt;  4           get_request&lt;br /&gt;  5    from dual;&lt;br /&gt;&lt;br /&gt;GET_REQUEST&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;&amp;lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;br /&gt;&amp;lt;Error&gt;&amp;lt;Code&gt;AccessDenied&amp;lt;/Code&gt;&amp;lt;Message&gt;Access Denied&amp;lt;/Message&gt;&amp;lt;RequestId&gt;9A9C3&lt;br /&gt;73E50A59095&amp;lt;/RequestId&gt;&amp;lt;HostId&gt;cGMOSk5WlNt0MNa++5c/N1JdIMSYH7fsSmj9ETSUHT7d1ztYO&lt;br /&gt;40CSmQDSJF2sht8W/HoX23utI8=&amp;lt;/HostId&gt;&amp;lt;/Error&gt;&lt;br /&gt;&lt;/pre&gt;The AccessDenied error is expected - I have to supply the AWS credentials. However, if it was a bucket with public access, it should work fine. &lt;br/&gt;&lt;br/&gt;&lt;h3&gt;DB User and S3 Credentials&lt;/h3&gt;Let us now create a new database user whose schema owns S3 credentials and any other application objects: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; grant dba to tc identified by tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;/pre&gt;Create new credentials using access and secret keys: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; conn tc/tc@localhost/tc&lt;br /&gt;Connected.&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec dbms_credential.create_credential( -&lt;br /&gt;&gt;   credential_name =&gt; 'S3_CREDENTIAL', -&lt;br /&gt;&gt;   username =&gt; 'A******************3', -&lt;br /&gt;&gt;   password =&gt; '1**************************************E')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;SSL Wallet&lt;/h3&gt;It is about time to add something to the S3 bucket. For that, I uploaded the &lt;code&gt;sales_2020.csv&lt;/code&gt; file to my S3 bucket: &lt;pre class="brush:sql"&gt;&lt;br /&gt;2020-01-01,1,10,100&lt;br /&gt;2020-02-01,2,5,200&lt;br /&gt;2020-03-01,2,10,400&lt;br /&gt;&lt;/pre&gt;Yet I am still not able to select anything using my S3 location: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from external (&lt;br /&gt;  3           ( sold_date date,&lt;br /&gt;  4             product_id number,&lt;br /&gt;  5             quantity_sold number(10,2),&lt;br /&gt;  6             amount_sold number(10,2)&lt;br /&gt;  7           )&lt;br /&gt;  8           type oracle_loader&lt;br /&gt;  9           default directory data_pump_dir&lt;br /&gt; 10           access parameters (&lt;br /&gt; 11             records delimited by newline&lt;br /&gt; 12             nologfile&lt;br /&gt; 13             nobadfile&lt;br /&gt; 14             nodiscardfile&lt;br /&gt; 15             readsize=10000000&lt;br /&gt; 16             credential 'S3_CREDENTIAL'&lt;br /&gt; 17             fields terminated by ','&lt;br /&gt; 18             date_format date mask 'yyyy-mm-dd')&lt;br /&gt; 19           location ('https://mikhail-bucket-20210104.s3.amazonaws.com/sales_2020.csv')&lt;br /&gt; 20           reject limit unlimited);&lt;br /&gt;select *&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-29913: error in executing ODCIEXTTABLEOPEN callout&lt;br /&gt;ORA-20000: Database property SSL_WALLET not found&lt;br /&gt;ORA-06512: at "SYS.DBMS_CLOUD", line 917&lt;br /&gt;ORA-06512: at "SYS.DBMS_CLOUD_INTERNAL", line 3823&lt;br /&gt;ORA-06512: at line 1&lt;br /&gt;&lt;/pre&gt;The package tries to find that property &lt;code&gt;SSL_WALLET&lt;/code&gt; in &lt;code&gt;DATABASE_PROPERTIES&lt;/code&gt;. At present I use a quick and dirty workaround by adding a new row into &lt;code&gt;SYS.PROPS$&lt;/code&gt; in &lt;code&gt;CDB$ROOT&lt;/code&gt;: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; insert into props$(name, value$, comment$) values ('SSL_WALLET', '/u01/app/oracle/wallet', 'SSL Wallet');&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt; commit;&lt;br /&gt;&lt;/pre&gt;There is also an undocumented system parameter &lt;code&gt;ssl_wallet&lt;/code&gt; which I assume was intended to have something to do with this. The &lt;code&gt;DBMS_CLOUD&lt;/code&gt; code, though, queries &lt;code&gt;DATABASE_PROPERTIES&lt;/code&gt; directly. Although I assume the code can be rewritten somehow to make use of the &lt;code&gt;ssl_wallet&lt;/code&gt; parameter, my intention is to use that package as is. &lt;br/&gt;Having added new &lt;code&gt;SSL_WALLET&lt;/code&gt; property, I am now finally able to access the S3 bucket: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from external (&lt;br /&gt;  3           ( sold_date date,&lt;br /&gt;  4             product_id number,&lt;br /&gt;  5             quantity_sold number(10,2),&lt;br /&gt;  6             amount_sold number(10,2)&lt;br /&gt;  7           )&lt;br /&gt;  8           type oracle_loader&lt;br /&gt;  9           default directory data_pump_dir&lt;br /&gt; 10           access parameters (&lt;br /&gt; 11             records delimited by newline&lt;br /&gt; 12             nologfile&lt;br /&gt; 13             nobadfile&lt;br /&gt; 14             nodiscardfile&lt;br /&gt; 15             readsize=10000000&lt;br /&gt; 16             credential 'S3_CREDENTIAL'&lt;br /&gt; 17             fields terminated by ','&lt;br /&gt; 18             date_format date mask 'yyyy-mm-dd')&lt;br /&gt; 19           location ('https://mikhail-bucket-20210104.s3.amazonaws.com/sales_2020.csv')&lt;br /&gt; 20           reject limit unlimited);&lt;br /&gt;&lt;br /&gt;SOLD_DATE PRODUCT_ID QUANTITY_SOLD AMOUNT_SOLD&lt;br /&gt;--------- ---------- ------------- -----------&lt;br /&gt;01-JAN-20          1            10         100&lt;br /&gt;01-FEB-20          2             5         200&lt;br /&gt;01-MAR-20          2            10         400&lt;br /&gt;&lt;/pre&gt;&lt;h3&gt;Hybrid Partitioned Table&lt;/h3&gt;As an extra exercise, I created a hybrid partitioned table - it has both external and traditional partitions: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; create table sales_hybrid&lt;br /&gt;  2    ( sold_date date,&lt;br /&gt;  3      product_id number,&lt;br /&gt;  4      quantity_sold number(10,2),&lt;br /&gt;  5      amount_sold number(10,2)&lt;br /&gt;  6    )&lt;br /&gt;  7    external partition attributes (&lt;br /&gt;  8      type oracle_loader&lt;br /&gt;  9      default directory data_pump_dir&lt;br /&gt; 10      access parameters (&lt;br /&gt; 11        records delimited by newline&lt;br /&gt; 12        nologfile&lt;br /&gt; 13        nobadfile&lt;br /&gt; 14        nodiscardfile&lt;br /&gt; 15        credential 'S3_CREDENTIAL'&lt;br /&gt; 16        fields terminated by ','&lt;br /&gt; 17        date_format date mask 'yyyy-mm-dd'&lt;br /&gt; 18      )&lt;br /&gt; 19    )&lt;br /&gt; 20    partition by range(sold_date) (&lt;br /&gt; 21      partition sales_2020 values less than (date'2021-01-01')&lt;br /&gt; 22        external location ('https://mikhail-bucket-20210104.s3.amazonaws.com/sales_2020.csv'),&lt;br /&gt; 23      partition sales_2021 values less than (date'2022-01-01')&lt;br /&gt; 24    )&lt;br /&gt; 25  ;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert into sales_hybrid values(date'2021-01-01',1,10,150);&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt; select * from sales_hybrid;&lt;br /&gt;&lt;br /&gt;SOLD_DATE PRODUCT_ID QUANTITY_SOLD AMOUNT_SOLD&lt;br /&gt;--------- ---------- ------------- -----------&lt;br /&gt;01-JAN-20          1            10         100&lt;br /&gt;01-FEB-20          2             5         200&lt;br /&gt;01-MAR-20          2            10         400&lt;br /&gt;01-JAN-21          1            10         150&lt;br /&gt;&lt;/pre&gt;Moreover, we can even access compressed files: &lt;pre class="brush:sql;highlight:[16,27]"&gt;&lt;br /&gt;SQL&gt; drop table sales_hybrid;&lt;br /&gt;&lt;br /&gt;Table dropped.&lt;br /&gt;&lt;br /&gt;SQL&gt; create table sales_hybrid&lt;br /&gt;  2    ( sold_date date,&lt;br /&gt;  3      product_id number,&lt;br /&gt;  4      quantity_sold number(10,2),&lt;br /&gt;  5      amount_sold number(10,2)&lt;br /&gt;  6    )&lt;br /&gt;  7    external partition attributes (&lt;br /&gt;  8      type oracle_loader&lt;br /&gt;  9      default directory data_pump_dir&lt;br /&gt; 10      access parameters (&lt;br /&gt; 11        records delimited by newline&lt;br /&gt; 12        compression gzip&lt;br /&gt; 13        nologfile&lt;br /&gt; 14        nobadfile&lt;br /&gt; 15        nodiscardfile&lt;br /&gt; 16        credential 'S3_CREDENTIAL'&lt;br /&gt; 17        fields terminated by ','&lt;br /&gt; 18        date_format date mask 'yyyy-mm-dd'&lt;br /&gt; 19      )&lt;br /&gt; 20    )&lt;br /&gt; 21    partition by range(sold_date) (&lt;br /&gt; 22      partition sales_2020 values less than (date'2021-01-01')&lt;br /&gt; 23        external location ('https://mikhail-bucket-20210104.s3.amazonaws.com/sales_2020.csv.gz'),&lt;br /&gt; 24      partition sales_2021 values less than (date'2022-01-01')&lt;br /&gt; 25    )&lt;br /&gt; 26  ;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert into sales_hybrid values(date'2021-01-01',1,10,150);&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from sales_hybrid;&lt;br /&gt;&lt;br /&gt;SOLD_DATE PRODUCT_ID QUANTITY_SOLD AMOUNT_SOLD&lt;br /&gt;--------- ---------- ------------- -----------&lt;br /&gt;01-JAN-20          1            10         100&lt;br /&gt;01-FEB-20          2             5         200&lt;br /&gt;01-MAR-20          2            10         400&lt;br /&gt;01-JAN-21          1            10         150&lt;br /&gt;&lt;/pre&gt;gzip, zlib, bzip2 compression schemes are supported per &lt;a href="https://docs.oracle.com/en/cloud/paas/autonomous-database/adbsa/format-options.html#GUID-08C44CDA-7C81-481A-BA0A-F7346473B703"&gt;the documentation&lt;/a&gt;. We might as well utilize &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/vldbg/partition-concepts.html#GUID-EA7EF5CB-DD49-43AF-889A-F83AAC0D7D51"&gt;the new ORA_PARTITION_VALIDATION SQL function&lt;/a&gt; to see if the rows conform to the partition definition: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select ora_partition_validation(rowid), sh.* from sales_hybrid sh;&lt;br /&gt;&lt;br /&gt;ORA_PARTITION_VALIDATION(ROWID) SOLD_DATE PRODUCT_ID QUANTITY_SOLD AMOUNT_SOLD&lt;br /&gt;------------------------------- --------- ---------- ------------- -----------&lt;br /&gt;                              1 01-JAN-20          1            10         100&lt;br /&gt;                              1 01-FEB-20          2             5         200&lt;br /&gt;                              1 01-MAR-20          2            10         400&lt;br /&gt;                              1 01-JAN-21          1            10         150&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/5533782594359308307/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2021/01/reading-amazon-s3-data-from-oracle-on.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5533782594359308307'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5533782594359308307'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2021/01/reading-amazon-s3-data-from-oracle-on.html' title='Reading Amazon S3 Data from Oracle on non-OCI Environment'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-3462565287108796760</id><published>2020-12-31T04:10:00.000+06:00</published><updated>2020-12-31T04:10:07.474+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='rac'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='18c'/><title type='text'>Creating RAC Physical Standby for Single Instance Primary</title><content type='html'>Oracle made some interesting improvements in Database Configuration Assistant (DBCA) in 18c, namely &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/18/admin/release-changes.html#GUID-7E653931-F2C9-4746-BA12-799508186F59"&gt;this&lt;/a&gt;: &lt;br/&gt;&lt;div&gt;  &lt;b&gt;Creating a copy of an Oracle RAC database&lt;/b&gt;&lt;br/&gt;A copy of an Oracle RAC database can be created using the -createDuplicateDB command option -databaseConfigType with the value of RAC or RACONENODE.  &lt;/div&gt;&lt;br/&gt;It has been possible to create a standby database using &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/12.2/admin/creating-and-configuring-an-oracle-database.html#GUID-7F4B1A64-5B08-425A-A62E-854542B3FD4E"&gt;the createDuplicateDB DBCA command&lt;/a&gt; since 12.2. &lt;br/&gt;18c added a new capability to specify the database configuration type of a new standby, such as: RAC, RAC One Node, or a regular single instance database. &lt;br/&gt;&lt;br/&gt;This method by itself requires some prerequisite actions. I do not see that these are documented, so that I am writing this blog post. &lt;br/&gt;&lt;br/&gt;&lt;h3&gt;Setup&lt;/h3&gt;&lt;h4&gt;Primary&lt;/h4&gt;&lt;ul&gt;  &lt;li&gt;Hostname: &lt;code&gt;primary&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;db_name: &lt;code&gt;orcl&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;db_unique_name: &lt;code&gt;orcl&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;Configuration Type: &lt;code&gt;Single Instance&lt;/code&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h4&gt;Standby&lt;/h4&gt;&lt;ul&gt;  &lt;li&gt;Hostnames: &lt;code&gt;rac1.example.com, rac2.example.com&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;db_unique_name: &lt;code&gt;racdb&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;Configuration Type: &lt;code&gt;RAC&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;SCAN port: &lt;code&gt;1521&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;Local listener port: &lt;code&gt;1522&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;Grid Home: &lt;code&gt;/u01/app/19.3.0/grid&lt;/code&gt;, &lt;code&gt;owner=grid&lt;/code&gt;&lt;/li&gt;  &lt;li&gt;DB Home: &lt;code&gt;/u01/app/oracle/product/19.3.0/dbhome_1&lt;/code&gt;, &lt;code&gt;owner=oracle&lt;/code&gt; (role separation)&lt;/li&gt;  &lt;li&gt;ASM disk groups: single disk group &lt;code&gt;DATA&lt;/code&gt; - it is a sandbox&lt;/li&gt;&lt;/ul&gt;The naming convention might be a bit odd, but the main purpose of this configuration is to provide some initial steps to setup a new RAC database with a view to making it a new primary. &lt;br/&gt;&lt;br/&gt;&lt;h3&gt;DBCA Command&lt;/h3&gt;This is a DBCA command that I will run to create a standby database in 19.9: &lt;pre class="brush:sql"&gt;&lt;br /&gt;dbca -createDuplicateDB -silent \&lt;br /&gt;     -gdbName orcl \&lt;br /&gt;     -primaryDBConnectionString primary:1521/orcl \&lt;br /&gt;     -sid racdb \&lt;br /&gt;     -initParams "dg_broker_start=true" \&lt;br /&gt;     -sysPassword change_on_install \&lt;br /&gt;     -adminManaged \&lt;br /&gt;     -nodelist rac1,rac2 \&lt;br /&gt;     -recoveryAreaDestination +DATA \&lt;br /&gt;       -recoveryAreaSize 10000 \&lt;br /&gt;     -databaseConfigType RAC \&lt;br /&gt;     -useOMF true \&lt;br /&gt;     -storageType ASM \&lt;br /&gt;       -datafileDestination +DATA \&lt;br /&gt;     -createAsStandby \&lt;br /&gt;       -dbUniqueName racdb \&lt;br /&gt;     -createListener rac1.example.com:1522&lt;br /&gt;&lt;/pre&gt;Firstly, let me go over the keys that are worth mentioning. &lt;ol&gt;  &lt;li&gt;&lt;code&gt;-primaryDBConnectionString primary:1521/orcl&lt;/code&gt; - it should have a specific port number even if it is default 1521&lt;/li&gt;  &lt;li&gt;&lt;code&gt;-createListener rac1.example.com:1522&lt;/code&gt; - this is the most interesting part. This is part of the RMAN block that is run to create a physical standby database: &lt;pre class="brush:sql"&gt;duplicate target database&lt;br /&gt;for standby&lt;br /&gt;from active database&lt;br /&gt;dorecover&lt;br /&gt;nofilenamecheck&lt;br /&gt;;&lt;/pre&gt;It is &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/bradv/rman-duplicating-databases.html#GUID-F446FBAC-3BEE-474A-B421-1BE1F926BB9A"&gt;the push-based method&lt;/a&gt; of active database duplication. Therefore, the primary database should be able to connect to the new standby. I specified the local listener endpoint (1522) in this example. Then, DBCA always tries to create a new listener in this configuration. I do not know how to avoid that here. Even worse, it attempts to create a new listener in DB home. Thankfully, it silently swallows an error if the listener already exists. Here is a sample excerpt from the DBCA log file to substantiate that remark with some facts:&lt;pre class="brush:sql;highlight:[3,24,36,39]"&gt;[progressPage.flowWorker] [ 2020-12-30 19:04:30.642 UTC ] [ClusterInfo.getHostName:462]  Hostname = rac1&lt;br /&gt;INFO: Dec 30, 2020 7:04:30 PM oracle.install.commons.system.process.ProcessLauncher launchProcess&lt;br /&gt;INFO: Executing [/u01/app/oracle/product/19.3.0/dbhome_1/bin/lsnrctl, start, rac1.example.com]&lt;br /&gt;&lt;br /&gt;INFO: Dec 30, 2020 7:04:30 PM oracle.install.commons.system.process.ProcessLauncher launchProcess&lt;br /&gt;INFO: Starting Output Reader Threads for process /u01/app/oracle/product/19.3.0/dbhome_1/bin/lsnrctl&lt;br /&gt;&lt;br /&gt;INFO: Dec 30, 2020 7:04:30 PM oracle.assistants.common.util.NetworkConfigHelper$2 processLine&lt;br /&gt;INFO:&lt;br /&gt;&lt;br /&gt;INFO: Dec 30, 2020 7:04:30 PM oracle.assistants.common.util.NetworkConfigHelper$2 processLine&lt;br /&gt;INFO: LSNRCTL for Linux: Version 19.0.0.0.0 - Production on 30-DEC-2020 19:04:30&lt;br /&gt;&lt;br /&gt;INFO: Dec 30, 2020 7:04:30 PM oracle.assistants.common.util.NetworkConfigHelper$2 processLine&lt;br /&gt;INFO:&lt;br /&gt;&lt;br /&gt;INFO: Dec 30, 2020 7:04:30 PM oracle.assistants.common.util.NetworkConfigHelper$2 processLine&lt;br /&gt;INFO: Copyright (c) 1991, 2020, Oracle.  All rights reserved.&lt;br /&gt;&lt;br /&gt;INFO: Dec 30, 2020 7:04:30 PM oracle.assistants.common.util.NetworkConfigHelper$2 processLine&lt;br /&gt;INFO:&lt;br /&gt;&lt;br /&gt;INFO: Dec 30, 2020 7:04:30 PM oracle.assistants.common.util.NetworkConfigHelper$2 processLine&lt;br /&gt;INFO: TNS-01106: Listener using listener name LISTENER has already been started&lt;br /&gt;&lt;br /&gt;INFO: Dec 30, 2020 7:04:30 PM oracle.install.commons.system.process.ProcessLauncher launchProcess&lt;br /&gt;INFO: The process /u01/app/oracle/product/19.3.0/dbhome_1/bin/lsnrctl exited with code 1&lt;br /&gt;&lt;br /&gt;INFO: Dec 30, 2020 7:04:30 PM oracle.install.commons.system.process.ProcessLauncher launchProcess&lt;br /&gt;INFO: Waiting for output processor threads to exit.&lt;br /&gt;&lt;br /&gt;INFO: Dec 30, 2020 7:04:30 PM oracle.install.commons.system.process.ProcessLauncher launchProcess&lt;br /&gt;INFO: Output processor threads exited.&lt;br /&gt;&lt;br /&gt;INFO: Dec 30, 2020 7:04:30 PM oracle.assistants.common.util.NetworkConfigHelper startListener&lt;br /&gt;INFO: Exit code of lsnrctl is:1&lt;br /&gt;&lt;br /&gt;INFO: Dec 30, 2020 7:04:30 PM oracle.assistants.dbca.driver.backend.steps.ListenerConfigStep createStaticListener&lt;br /&gt;INFO: Static listener created.&lt;br /&gt;&lt;br /&gt;INFO: Dec 30, 2020 7:04:30 PM oracle.assistants.dbca.driver.StepDBCAJob$1 update&lt;br /&gt;INFO: Percentage Progress got for job:Listener config step progress:100.0&lt;br /&gt;&lt;/pre&gt; There is another little drawback with this approach - it creates listener.ora in DB home which uses a static configuration. It is harmless, but I would rather clean it up after the exercise to have a nice and tidy environment.&lt;/li&gt;&lt;/ol&gt;&lt;h3&gt;Prerequisite Steps&lt;/h3&gt;It should be possible to establish a connection from the primary host using the local listener endpoint: &lt;code&gt;rac1.example.com:1522&lt;/code&gt;.&lt;br/&gt;I do not discuss DNS setup - it is implied.&lt;br/&gt;I need to configure a static registration for the new RAC instance. For that, I edit my GI listener.ora on the host I am going to run the duplicate command from (rac1): &lt;pre class="brush:sql"&gt;&lt;br /&gt;# /u01/app/19.3.0/grid/network/admin/listener.ora&lt;br /&gt;SID_LIST_LISTENER=&lt;br /&gt;  (SID_LIST=&lt;br /&gt;      (SID_DESC=&lt;br /&gt;         (SID_NAME=racdb1)&lt;br /&gt;         (ORACLE_HOME=/u01/app/oracle/product/19.3.0/dbhome_1)&lt;br /&gt;       )&lt;br /&gt;   )&lt;br /&gt;&lt;/pre&gt;That is basically it. Once I reload the local listener, I am good to continue to the next step. &lt;br/&gt;&lt;br/&gt;&lt;h3&gt;Creating RAC Physical Standby&lt;/h3&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@rac1 ~]$ dbca -createDuplicateDB -silent \&lt;br /&gt;&gt;      -gdbName orcl \&lt;br /&gt;&gt;      -primaryDBConnectionString primary:1521/orcl \&lt;br /&gt;&gt;      -sid racdb \&lt;br /&gt;&gt;      -initParams "dg_broker_start=true" \&lt;br /&gt;&gt;      -sysPassword change_on_install \&lt;br /&gt;&gt;      -adminManaged \&lt;br /&gt;&gt;      -nodelist rac1,rac2 \&lt;br /&gt;&gt;      -recoveryAreaDestination +DATA \&lt;br /&gt;&gt;        -recoveryAreaSize 10000 \&lt;br /&gt;&gt;      -databaseConfigType RAC \&lt;br /&gt;&gt;      -useOMF true \&lt;br /&gt;&gt;      -storageType ASM \&lt;br /&gt;&gt;        -datafileDestination +DATA \&lt;br /&gt;&gt;      -createAsStandby \&lt;br /&gt;&gt;        -dbUniqueName racdb \&lt;br /&gt;&gt;      -createListener rac1.example.com:1522&lt;br /&gt;Prepare for db operation&lt;br /&gt;22% complete&lt;br /&gt;Listener config step&lt;br /&gt;44% complete&lt;br /&gt;Auxiliary instance creation&lt;br /&gt;67% complete&lt;br /&gt;RMAN duplicate&lt;br /&gt;89% complete&lt;br /&gt;Post duplicate database operations&lt;br /&gt;100% complete&lt;br /&gt;&lt;br /&gt;Look at the log file "/u01/app/oracle/cfgtoollogs/dbca/racdb/racdb.log" for further details.&lt;br /&gt;&lt;/pre&gt;That is it: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select database_role from v$database;&lt;br /&gt;&lt;br /&gt;DATABASE_ROLE&lt;br /&gt;----------------&lt;br /&gt;PHYSICAL STANDBY&lt;br /&gt;&lt;br /&gt;SQL&gt; select instance_name, host_name from gv$instance;&lt;br /&gt;&lt;br /&gt;INSTANCE_NAME    HOST_NAME&lt;br /&gt;---------------- --------------------&lt;br /&gt;racdb1           rac1.example.com&lt;br /&gt;racdb2           rac2.example.com&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;&lt;br/&gt;&lt;h3&gt;Further Steps&lt;/h3&gt;&lt;ol&gt;  &lt;li&gt;Delete &lt;code&gt;/u01/app/oracle/product/19.3.0/dbhome_1/network/admin/listener.ora&lt;/code&gt;. DBCA created this file with the following content:&lt;pre class="brush:sql"&gt;SID_LIST_RAC1.EXAMPLE.COM =&lt;br /&gt;  (SID_LIST =&lt;br /&gt;    (SID_DESC =&lt;br /&gt;      (SID_NAME = racdb1)&lt;br /&gt;    )&lt;br /&gt;  )&lt;br /&gt;&lt;br /&gt;RAC1.EXAMPLE.COM =&lt;br /&gt;  (ADDRESS_LIST =&lt;br /&gt;    (ADDRESS = (PROTOCOL = TCP)(HOST = rac1.example.com)(PORT = 1522))&lt;br /&gt;  )&lt;/pre&gt;&lt;/li&gt;  &lt;li&gt;Adding standby redo logs, creating a new Data Guard Configuration, enabling &lt;code&gt;FORCE_LOGGING&lt;/code&gt;, Flashback database, etc. - I do not mention it here. The purpose of this post to show how to instantiate a new RAC standby database in one command after completing some simple preliminary steps.&lt;/li&gt;&lt;/ol&gt;&lt;h3&gt;Notable Downsides&lt;/h3&gt;There ain't no such thing as a free lunch.&lt;br/&gt;Both slow connection between the sites, and a "huge" database size limits the applicability of this method.&lt;br/&gt;I do not see how this method can utilize &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/bradv/rman-duplicating-databases.html#GUID-4A9A4F04-0D65-4BC0-AE4B-EFBD453D017F"&gt;the restartable duplication&lt;/a&gt; too.&lt;br/&gt;In all other cases, it is possible to quickly spin up a new RAC standby database using this excellent DBCA createDuplicateDB command.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/3462565287108796760/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2020/12/creating-rac-physical-standby-for.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3462565287108796760'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3462565287108796760'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2020/12/creating-rac-physical-standby-for.html' title='Creating RAC Physical Standby for Single Instance Primary'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-3878198301125908768</id><published>2020-09-30T19:51:00.000+06:00</published><updated>2020-09-30T19:51:18.985+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='18c'/><title type='text'>Determining Oracle Database Edition</title><content type='html'>The other day I debugged some Oracle provided utilities and came across another way of determining an Oracle Database edition. It does not require a running database instance. &lt;br/&gt;&lt;br/&gt;The Oracle code was checking what is inside the &lt;code&gt;$ORACLE_HOME/lib/libedtn19.a&lt;/code&gt; library: &lt;pre class='brush:sql'&gt;&lt;br /&gt;# Enterprise Edition&lt;br /&gt;[oracle@rac1 lib]$ ar t /u01/app/oracle/product/19.3.0/dbhome_1/lib/libedtn19.a&lt;br /&gt;vsnfent.o&lt;br /&gt;&lt;br /&gt;# Standard Edition&lt;br /&gt;[oracle@rac1 lib]$ ar t /u01/app/oracle/product/19.3.0/dbhome_2/lib/libedtn19.a&lt;br /&gt;vsnfstd.o&lt;br /&gt;&lt;/pre&gt; As it can be seen, it is vsnf&lt;b&gt;std&lt;/b&gt;.o for Standard vs vsnf&lt;b&gt;ent&lt;/b&gt;.o for Enterprise. &lt;br/&gt;It appears to be a file for each edition and the file &lt;code&gt;libedtn19.a&lt;/code&gt; contains the edition of that specific Oracle Home: &lt;pre class='brush:sql'&gt;&lt;br /&gt;[oracle@rac1 lib]$ find . -name 'libedtn19*a' -print -exec ar t '{}' \;&lt;br /&gt;./libedtn19_xp.a&lt;br /&gt;vsnfxp.o&lt;br /&gt;./libedtn19_ent.a&lt;br /&gt;vsnfent.o&lt;br /&gt;./libedtn19_cse.a&lt;br /&gt;vsnfcse.o&lt;br /&gt;./libedtn19_cee.a&lt;br /&gt;vsnfcee.o&lt;br /&gt;./libedtn19.a&lt;br /&gt;vsnfent.o&lt;br /&gt;./libedtn19_hp.a&lt;br /&gt;vsnfhp.o&lt;br /&gt;./libedtn19_std.a&lt;br /&gt;vsnfstd.o&lt;br /&gt;&lt;/pre&gt;It has no effect on &lt;code&gt;V$VERSION&lt;/code&gt; output whatsoever, and it obviously cannot be used to change one edition to another.&lt;br/&gt;Yet I discovered that srvctl checks that &lt;code&gt;libedtn19.a&lt;/code&gt; file in certain scenarios to determine whether or not some edition specific features should be allowed.&lt;br/&gt;Per my research, that library was introduced in Oracle 18c.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/3878198301125908768/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2020/09/determining-oracle-database-edition.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3878198301125908768'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3878198301125908768'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2020/09/determining-oracle-database-edition.html' title='Determining Oracle Database Edition'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-3450103334593720604</id><published>2020-07-11T23:40:00.000+06:00</published><updated>2020-07-11T23:40:01.553+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='rac'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-00600'/><title type='text'>ORA-600 [kglobpg_is_pkp] During Rolling RU 19.7 Apply</title><content type='html'>I came across this issue while applying RU 19.7 to my RAC database.&lt;br /&gt;That was the old ORACLE_HOME:&lt;br /&gt;&lt;pre class='brush:sql'&gt;[oracle@rac1 dbhome_1]$ OPatch/opatch lspatches&lt;br /&gt;30128191;OJVM RELEASE UPDATE: 19.5.0.0.191015 (30128191)&lt;br /&gt;30122149;OCW RELEASE UPDATE 19.5.0.0.0 (30122149)&lt;br /&gt;30125133;Database Release Update : 19.5.0.0.191015 (30125133)&lt;br /&gt;&lt;br /&gt;OPatch succeeded.&lt;br /&gt;&lt;/pre&gt;That was the new one:&lt;br /&gt;&lt;pre class='brush:sql'&gt;[oracle@rac1 dbhome_3]$ OPatch/opatch lspatches&lt;br /&gt;30805684;OJVM RELEASE UPDATE: 19.7.0.0.200414 (30805684)&lt;br /&gt;30894985;OCW RELEASE UPDATE 19.7.0.0.0 (30894985)&lt;br /&gt;30869156;Database Release Update : 19.7.0.0.200414 (30869156)&lt;br /&gt;&lt;br /&gt;OPatch succeeded.&lt;br /&gt;&lt;/pre&gt;There were two nodes in the cluster: rac1 and rac2.&lt;br /&gt;&lt;br /&gt;I set the new ORACLE_HOME for the database and restarted rac2:&lt;br /&gt;&lt;pre class='brush:sql;highlight:[18,20,22,24]'&gt;Patch Id: 30805684&lt;br /&gt;Patch Description: OJVM RELEASE UPDATE: 19.7.0.0.200414 (30805684)&lt;br /&gt;Patch Apply Time: 2020-07-09T19:38:43Z&lt;br /&gt;Bugs Fixed: 29254623,29445548,29512125,29540327,29774362,29942275,30134746,&lt;br /&gt;30160625,30534662,30855101&lt;br /&gt;===========================================================&lt;br /&gt;2020-07-11T15:39:33.323415+00:00&lt;br /&gt;Resize operation completed for file# 1, old size 993280K, new size 1003520K&lt;br /&gt;Resize operation completed for file# 1, old size 1003520K, new size 1013760K&lt;br /&gt;2020-07-11T15:39:35.107445+00:00&lt;br /&gt;Resize operation completed for file# 1, old size 1013760K, new size 1024000K&lt;br /&gt;Resize operation completed for file# 1, old size 1024000K, new size 1034240K&lt;br /&gt;2020-07-11T15:39:37.061108+00:00&lt;br /&gt;Resize operation completed for file# 1, old size 1034240K, new size 1044480K&lt;br /&gt;Resize operation completed for file# 1, old size 1044480K, new size 1054720K&lt;br /&gt;2020-07-11T15:39:38.695595+00:00&lt;br /&gt;Resize operation completed for file# 1, old size 1054720K, new size 1064960K&lt;br /&gt;jox_pujs ending in pid 23121 cid 1&lt;br /&gt;2020-07-11T15:39:39.024323+00:00&lt;br /&gt;Java patching prepare phase started.&lt;br /&gt;2020-07-11T15:39:39.068031+00:00&lt;br /&gt;## jox_ujs_status: op_instance_patched: returning TRUE in pid 22749&lt;br /&gt;2020-07-11T15:39:44.069088+00:00&lt;br /&gt;## jox_ujs_status: op_instance_patched: returning TRUE in pid 22749&lt;br /&gt;&lt;/pre&gt;pid 22749 was GEN0 and it was writing that 'jox_ujs_status' message to the alert log every 5 seconds.&lt;br /&gt;&lt;br /&gt;That was what I had on rac1:&lt;br /&gt;&lt;pre class='brush:sql;highlight:[15,17,19]'&gt;2020-07-11T15:38:52.976980+00:00&lt;br /&gt;Increasing priority of 1 RS&lt;br /&gt;Domain Action Reconfiguration started (domid 3, new da inc 6, cluster inc 8)&lt;br /&gt;Instance 2 is attaching to domain 3&lt;br /&gt; Global Resource Directory partially frozen for domain action&lt;br /&gt; Non-local Process blocks cleaned out&lt;br /&gt; Set master node info&lt;br /&gt; Dwn-cvts replayed, VALBLKs dubious&lt;br /&gt; All grantable enqueues granted&lt;br /&gt;Domain Action Reconfiguration complete (total time 0.1 secs)&lt;br /&gt;Decreasing priority of 1 RS&lt;br /&gt;2020-07-11T15:39:39.024882+00:00&lt;br /&gt;Java patching prepare phase started.&lt;br /&gt;2020-07-11T15:39:39.049868+00:00&lt;br /&gt;## jox_ujs_status: op_instance_patched: UJS active in root, ujs state present, its version does not match executable version, returning FALSE in pid 31373&lt;br /&gt;2020-07-11T15:39:44.069761+00:00&lt;br /&gt;## jox_ujs_status: op_instance_patched: UJS active in root, ujs state present, its version does not match executable version, returning FALSE in pid 31373&lt;br /&gt;2020-07-11T15:39:49.071807+00:00&lt;br /&gt;## jox_ujs_status: op_instance_patched: UJS active in root, ujs state present, its version does not match executable version, returning FALSE in pid 31373&lt;br /&gt;&lt;/pre&gt;Although it looked suspicious, I decided to continue the patching.&lt;br /&gt;Once I stopped rac1, I was not able to start it anymore:&lt;br /&gt;&lt;pre class='brush:sql;highlight:[14,24,35]'&gt;2020-07-11T15:42:40.981054+00:00&lt;br /&gt;## jox_ujs_status: op_instance_patched: returning TRUE in pid 4744&lt;br /&gt;Starting background process GTX0&lt;br /&gt;2020-07-11T15:42:41.422960+00:00&lt;br /&gt;GTX0 started with pid=63, OS id=4926&lt;br /&gt;2020-07-11T15:42:41.427547+00:00&lt;br /&gt;joxcsys_required_dirobj_exists: directory object exists with required path /u01/app/oracle/product/19.3.0/dbhome_3/javavm/admin/, pid 4844 cid 1&lt;br /&gt;Starting background process RCBG&lt;br /&gt;2020-07-11T15:42:41.492063+00:00&lt;br /&gt;RCBG started with pid=64, OS id=4928&lt;br /&gt;replication_dependency_tracking turned off (no async multimaster replication found)&lt;br /&gt;2020-07-11T15:42:41.831459+00:00&lt;br /&gt;Errors in file /u01/app/oracle/diag/rdbms/racdb/racdb1/trace/racdb1_ora_4844.trc  (incident=5249) (PDBNAME=CDB$ROOT):&lt;br /&gt;ORA-00600: internal error code, arguments: [kglobpg_is_pkp], [0x077DD9BC8], [], [], [], [], [], [], [], [], [], []&lt;br /&gt;Incident details in: /u01/app/oracle/diag/rdbms/racdb/racdb1/incident/incdir_5249/racdb1_ora_4844_i5249.trc&lt;br /&gt;Use ADRCI or Support Workbench to package the incident.&lt;br /&gt;See Note 411.1 at My Oracle Support for error and packaging details.&lt;br /&gt;..&lt;br /&gt;2020-07-11T15:42:42.782978+00:00&lt;br /&gt;## jox_ujs_status: op_instance_patched: returning TRUE in pid 4744&lt;br /&gt;Errors in file /u01/app/oracle/diag/rdbms/racdb/racdb1/trace/racdb1_ora_4844.trc  (incident=5250) (PDBNAME=CDB$ROOT):&lt;br /&gt;ORA-00603: ORACLE server session terminated by fatal error&lt;br /&gt;ORA-01092: ORACLE instance terminated. Disconnection forced&lt;br /&gt;ORA-00600: internal error code, arguments: [kglobpg_is_pkp], [0x077DD9BC8], [], [], [], [], [], [], [], [], [], []&lt;br /&gt;Incident details in: /u01/app/oracle/diag/rdbms/racdb/racdb1/incident/incdir_5250/racdb1_ora_4844_i5250.trc&lt;br /&gt;2020-07-11T15:42:42.941948+00:00&lt;br /&gt;Dumping diagnostic data in directory=[cdmp_20200711154242], requested by (instance=1, osid=4844), summary=[incident=5249].&lt;br /&gt;2020-07-11T15:42:43.784890+00:00&lt;br /&gt;## jox_ujs_status: op_instance_patched: returning TRUE in pid 4744&lt;br /&gt;2020-07-11T15:42:43.960028+00:00&lt;br /&gt;opiodr aborting process unknown ospid (4844) as a result of ORA-603&lt;br /&gt;2020-07-11T15:42:43.976310+00:00&lt;br /&gt;ORA-603 : opitsk aborting process&lt;br /&gt;License high water mark = 1&lt;br /&gt;USER(prelim) (ospid: 4844): terminating the instance due to ORA error 600&lt;br /&gt;&lt;/pre&gt;That essentially left me with rac2 whose GEN0 was spamming the following message to the alert log once in 5 seconds:&lt;br /&gt;&lt;pre class='brush:sql'&gt;## jox_ujs_status: op_instance_patched: returning TRUE in pid 22749&lt;br /&gt;&lt;/pre&gt;Any attempts to run datapatch and finish the patching ended up with the following errors:&lt;br /&gt;&lt;pre class='brush:sql'&gt;ORA-29548: Java system class reported: UJS still running&lt;br /&gt;ORA-06512: at "SYS.DBMS_JAVA_TEST", line 2&lt;br /&gt;ORA-06512: at "SYS.DBMS_JAVA_TEST", line 55&lt;br /&gt;ORA-06512: at line 4&lt;br /&gt;&lt;/pre&gt;There were some ORA-00600 [kglobpg_is_pkp] errors on My Oracle Support (MOS) but there was nothing specific that I could link to my issue.&lt;br /&gt;&lt;br /&gt;When I get no hits, I usually turn PowerView off or extend my search to include bugs, patches, etc.&lt;br /&gt;That worked out well and I found the following patch:&lt;br /&gt;&lt;a href="https://support.oracle.com/rs?type=patch&amp;id=31359215"&gt;Patch 31359215: INSTANCE STARTUP FAILS ORA-600 [KGLOBPG_IS_PKP] DURING ROLLING RU 19.7 APPLY&lt;/a&gt;&lt;br /&gt;I applied that patch to rac1 and was finally able to start that instance successfully. The remaining part of that rolling patch exercise went without a hitch.&lt;br /&gt;The patch itself was released on 7th July. I hope Oracle Support will update the Knowledge Base, or publish some alerts about this issue, or even merge that patch into 19.7 OJVM.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/3450103334593720604/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2020/07/ora-600-kglobpgispkp-during-rolling-ru.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3450103334593720604'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3450103334593720604'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2020/07/ora-600-kglobpgispkp-during-rolling-ru.html' title='ORA-600 [kglobpg_is_pkp] During Rolling RU 19.7 Apply'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-635702861970219324</id><published>2020-06-26T14:10:00.000+06:00</published><updated>2020-06-26T14:10:45.280+06:00</updated><app:control xmlns:app='http://purl.org/atom/app#'><app:draft>yes</app:draft></app:control><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='wrong_results'/><title type='text'>External Tables with Tab Terminator and LRTRIM Producing Wrong Results</title><content type='html'>&lt;br /&gt;</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/635702861970219324'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/635702861970219324'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-6496144081582298355</id><published>2020-06-13T01:07:00.004+06:00</published><updated>2020-06-13T17:30:18.456+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='wrong_results'/><category scheme='http://www.blogger.com/atom/ns#' term='18c'/><title type='text'>CURSOR Expressions Return Wrong Results in 18c/19c</title><content type='html'>That is a wrong results issue I stumbled upon this morning. A developer told me that one of their queries started returning wrong results after we upgraded one of our databases from 12.2.0.1 to 19.7. I constructed a simplified test case to demonstrate this issue which I ran on 19.4. I have been able to reproduce it on 18.3, 19.7, and &lt;a href="https://livesql.oracle.com"&gt;Live SQL&lt;/a&gt; as well. &lt;pre class='brush:sql'&gt;&lt;br /&gt;SQL&gt; create table t1(id int);&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt; create table t2(id int);&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert into t1 values (1);&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt; insert into t2 values (1);&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;/pre&gt;In a nutshell, I created two tables that have one row with a numeric 1 value. Let's now run the following query: &lt;pre class='brush:sql;highlight:[19]'&gt;&lt;br /&gt;SQL&gt; select query_type&lt;br /&gt;  2    from (select 'A' query_type&lt;br /&gt;  3            from t1 t11&lt;br /&gt;  4           where exists (&lt;br /&gt;  5                   select null&lt;br /&gt;  6                     from t2 t21&lt;br /&gt;  7                    where t21.id = t11.id)&lt;br /&gt;  8           union all&lt;br /&gt;  9          select 'B' query_type&lt;br /&gt; 10            from t1 t12&lt;br /&gt; 11           where not exists (&lt;br /&gt; 12                   select null&lt;br /&gt; 13                     from t2 t22&lt;br /&gt; 14                    where t22.id = t12.id)&lt;br /&gt; 15         );&lt;br /&gt;&lt;br /&gt;Q&lt;br /&gt;-&lt;br /&gt;A&lt;br /&gt;&lt;/pre&gt;Then, I am going to put that query into a CURSOR expression: &lt;pre class='brush:sql;highlight:[28]'&gt;&lt;br /&gt;SQL&gt; select cursor(&lt;br /&gt;  2           select query_type&lt;br /&gt;  3             from (select 'A' query_type&lt;br /&gt;  4                     from t1 t11&lt;br /&gt;  5                    where exists (&lt;br /&gt;  6                            select null&lt;br /&gt;  7                              from t2 t21&lt;br /&gt;  8                             where t21.id = t11.id)&lt;br /&gt;  9                    union all&lt;br /&gt; 10                   select 'B' query_type&lt;br /&gt; 11                     from t1 t12&lt;br /&gt; 12                    where not exists (&lt;br /&gt; 13                            select null&lt;br /&gt; 14                              from t2 t22&lt;br /&gt; 15                             where t22.id = t12.id)&lt;br /&gt; 16                  )&lt;br /&gt; 17         ) data&lt;br /&gt; 18    from dual;&lt;br /&gt;&lt;br /&gt;DATA&lt;br /&gt;--------------------&lt;br /&gt;CURSOR STATEMENT : 1&lt;br /&gt;&lt;br /&gt;CURSOR STATEMENT : 1&lt;br /&gt;&lt;br /&gt;Q&lt;br /&gt;-&lt;br /&gt;B&lt;br /&gt;&lt;/pre&gt;That is when it gets interesting. Somehow the query which returned 'A' being run separately starts returning 'B' after it comes as an input subquery into a CURSOR expression. &lt;br/&gt;&lt;br/&gt;I initially started looking at the execution plan in an attempt to figure out what changed in the execution plan between 12.2 and 19c. There are some changes but nothing that drew my eye. &lt;pre class='brush:sql'&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 2197603499&lt;br /&gt;&lt;br /&gt;-----------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;-----------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT     |      |     1 |       |    14   (0)| 00:00:01 |&lt;br /&gt;|   1 |  VIEW                |      |     2 |     6 |    12   (0)| 00:00:01 |&lt;br /&gt;|   2 |   UNION-ALL          |      |       |       |            |          |&lt;br /&gt;|*  3 |    FILTER            |      |       |       |            |          |&lt;br /&gt;|   4 |     TABLE ACCESS FULL| T1   |     1 |    13 |     3   (0)| 00:00:01 |&lt;br /&gt;|*  5 |     TABLE ACCESS FULL| T2   |     1 |    13 |     3   (0)| 00:00:01 |&lt;br /&gt;|*  6 |    FILTER            |      |       |       |            |          |&lt;br /&gt;|   7 |     TABLE ACCESS FULL| T1   |     1 |    13 |     3   (0)| 00:00:01 |&lt;br /&gt;|*  8 |     TABLE ACCESS FULL| T2   |     1 |    13 |     3   (0)| 00:00:01 |&lt;br /&gt;|   9 |  FAST DUAL           |      |     1 |       |     2   (0)| 00:00:01 |&lt;br /&gt;-----------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Query Block Name / Object Alias (identified by operation id):&lt;br /&gt;-------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;   1 - SET$1 / from$_subquery$_001@SEL$2&lt;br /&gt;   2 - SET$1&lt;br /&gt;   3 - SEL$3&lt;br /&gt;   4 - SEL$3 / T11@SEL$3&lt;br /&gt;   5 - SEL$4 / T21@SEL$4&lt;br /&gt;   6 - SEL$5&lt;br /&gt;   7 - SEL$5 / T12@SEL$5&lt;br /&gt;   8 - SEL$6 / T22@SEL$6&lt;br /&gt;   9 - SEL$1 / DUAL@SEL$1&lt;br /&gt;&lt;br /&gt;Outline Data&lt;br /&gt;-------------&lt;br /&gt;&lt;br /&gt;  /*+&lt;br /&gt;      BEGIN_OUTLINE_DATA&lt;br /&gt;      FULL(@"SEL$6" "T22"@"SEL$6")&lt;br /&gt;      FULL(@"SEL$4" "T21"@"SEL$4")&lt;br /&gt;      PQ_FILTER(@"SEL$3" SERIAL)&lt;br /&gt;      FULL(@"SEL$3" "T11"@"SEL$3")&lt;br /&gt;      PQ_FILTER(@"SEL$5" SERIAL)&lt;br /&gt;      FULL(@"SEL$5" "T12"@"SEL$5")&lt;br /&gt;      NO_ACCESS(@"SEL$2" "from$_subquery$_001"@"SEL$2")&lt;br /&gt;      OUTLINE_LEAF(@"SEL$1")&lt;br /&gt;      OUTLINE_LEAF(@"SEL$2")&lt;br /&gt;      OUTLINE_LEAF(@"SET$1")&lt;br /&gt;      OUTLINE_LEAF(@"SEL$5")&lt;br /&gt;      OUTLINE_LEAF(@"SEL$6")&lt;br /&gt;      OUTLINE_LEAF(@"SEL$3")&lt;br /&gt;      OUTLINE_LEAF(@"SEL$4")&lt;br /&gt;      ALL_ROWS&lt;br /&gt;      DB_VERSION('19.1.0')&lt;br /&gt;      OPTIMIZER_FEATURES_ENABLE('19.1.0')&lt;br /&gt;      IGNORE_OPTIM_EMBEDDED_HINTS&lt;br /&gt;      END_OUTLINE_DATA&lt;br /&gt;  */&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   3 - filter( EXISTS (SELECT 0 FROM "T2" "T21" WHERE "T21"."ID"=:B1))&lt;br /&gt;   5 - filter("T21"."ID"=:B1)&lt;br /&gt;   6 - filter( NOT EXISTS (SELECT 0 FROM "T2" "T22" WHERE&lt;br /&gt;              "T22"."ID"=:B1))&lt;br /&gt;   8 - filter("T22"."ID"=:B1)&lt;br /&gt;&lt;br /&gt;Note&lt;br /&gt;-----&lt;br /&gt;   - dynamic statistics used: dynamic sampling (level=2)&lt;br /&gt;&lt;br /&gt;68 rows selected.&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;The gather_plan_statistics hint was not really helpful as it is a nested cursor, so that it does not show the rowsource statistics from that level - the nested cursor runs separately and its rowsource statistics are not included in the top-level cursor ones: &lt;pre class='brush:sql'&gt;&lt;br /&gt;-----------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation            | Name | Starts | E-Rows | A-Rows |   A-Time   |&lt;br /&gt;-----------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT     |      |      1 |        |      1 |00:00:00.01 |&lt;br /&gt;|   1 |  VIEW                |      |      0 |      2 |      0 |00:00:00.01 |&lt;br /&gt;|   2 |   UNION-ALL          |      |      0 |        |      0 |00:00:00.01 |&lt;br /&gt;|*  3 |    FILTER            |      |      0 |        |      0 |00:00:00.01 |&lt;br /&gt;|   4 |     TABLE ACCESS FULL| T1   |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;|*  5 |     TABLE ACCESS FULL| T2   |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;|*  6 |    FILTER            |      |      0 |        |      0 |00:00:00.01 |&lt;br /&gt;|   7 |     TABLE ACCESS FULL| T1   |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;|*  8 |     TABLE ACCESS FULL| T2   |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;|   9 |  FAST DUAL           |      |      1 |      1 |      1 |00:00:00.01 |&lt;br /&gt;-----------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   3 - filter( IS NOT NULL)&lt;br /&gt;   5 - filter("T21"."ID"=:B1)&lt;br /&gt;   6 - filter( IS NULL)&lt;br /&gt;   8 - filter("T22"."ID"=:B1)&lt;br /&gt;&lt;/pre&gt;&lt;br/&gt;I found the explanation of this issue in the SQL trace file: &lt;pre class='brush:sql;highlight:[34,41,45]'&gt;&lt;br /&gt;=====================&lt;br /&gt;PARSING IN CURSOR #139973723001152 len=579 dep=0 uid=78 oct=3 lid=78 tim=4622189819 hv=2185287422 ad='68d3c950' sql&lt;br /&gt;id='0mkkpha141pry'&lt;br /&gt;select cursor(&lt;br /&gt;         select query_type&lt;br /&gt;           from (select 'A' query_type&lt;br /&gt;                   from t1 t11&lt;br /&gt;                  where exists (&lt;br /&gt;                          select null&lt;br /&gt;                            from t2 t21&lt;br /&gt;                           where t21.id = t11.id)&lt;br /&gt;                  union all&lt;br /&gt;                 select 'B' query_type&lt;br /&gt;                   from t1 t12&lt;br /&gt;                  where not exists (&lt;br /&gt;                          select null&lt;br /&gt;                            from t2 t22&lt;br /&gt;                           where t22.id = t12.id)&lt;br /&gt;                )&lt;br /&gt;       ) data&lt;br /&gt;  from dual&lt;br /&gt;END OF STMT&lt;br /&gt;PARSE #139973723001152:c=11048,e=12511,p=0,cr=45,cu=12,mis=1,r=0,dep=0,og=1,plh=2197603499,tim=4622189819&lt;br /&gt;EXEC #139973723001152:c=13,e=13,p=0,cr=0,cu=0,mis=0,r=0,dep=0,og=1,plh=2197603499,tim=4622189873&lt;br /&gt;=====================&lt;br /&gt;PARSING IN CURSOR #139973720520408 len=272 dep=2 uid=78 oct=3 lid=78 tim=4622190302 hv=3362864010 ad='68d141b0' sqlid='faj0udr472fwa'&lt;br /&gt;SELECT "A2"."QUERY_TYPE" "QUERY_TYPE" &lt;br /&gt;  FROM  ( &lt;br /&gt;          (SELECT 'A' "QUERY_TYPE" &lt;br /&gt;             FROM "T1" "A5"&lt;br /&gt;            WHERE  EXISTS (&lt;br /&gt;                     SELECT 0 &lt;br /&gt;                       FROM "T2" "A6"&lt;br /&gt;                      WHERE "A6"."ID"=:CV1$))&lt;br /&gt;           UNION ALL&lt;br /&gt;          (SELECT 'B' "QUERY_TYPE" &lt;br /&gt;             FROM "T1" "A4"&lt;br /&gt;            WHERE  NOT EXISTS (&lt;br /&gt;                     SELECT 0 &lt;br /&gt;                       FROM "T2" "A7"&lt;br /&gt;                      WHERE "A7"."ID"=:CV2$))) "A2"&lt;br /&gt;END OF STMT&lt;br /&gt;PARSE #139973720520408:c=375,e=375,p=0,cr=0,cu=0,mis=1,r=0,dep=2,og=1,plh=0,tim=4622190302&lt;br /&gt;..skip..&lt;br /&gt;BINDS #139973720520408:&lt;br /&gt;&lt;br /&gt; Bind#0&lt;br /&gt;  oacdty=02 mxl=22(00) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=11 fl2=0001 frm=00 csi=00 siz=48 off=0&lt;br /&gt;  kxsbbbfp=7f4e2be3b278  bln=22  avl=00  flg=05&lt;br /&gt; Bind#1&lt;br /&gt;  oacdty=02 mxl=22(00) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=11 fl2=0001 frm=00 csi=00 siz=0 off=24&lt;br /&gt;  kxsbbbfp=7f4e2be3b290  bln=22  avl=00  flg=01&lt;br /&gt;EXEC #139973720520408:c=9732,e=9360,p=0,cr=37,cu=0,mis=1,r=0,dep=2,og=1,plh=489056501,tim=4622199711&lt;br /&gt;FETCH #139973723001152:c=10218,e=9845,p=0,cr=37,cu=0,mis=0,r=1,dep=0,og=1,plh=2197603499,tim=4622199753&lt;br /&gt;STAT #139973723001152 id=1 cnt=0 pid=0 pos=1 obj=0 op='VIEW  (cr=0 pr=0 pw=0 str=0 time=0 us cost=12 size=6 card=2)'&lt;br /&gt;STAT #139973723001152 id=2 cnt=0 pid=1 pos=1 obj=0 op='UNION-ALL  (cr=0 pr=0 pw=0 str=0 time=0 us)'&lt;br /&gt;STAT #139973723001152 id=3 cnt=0 pid=2 pos=1 obj=0 op='FILTER  (cr=0 pr=0 pw=0 str=0 time=0 us)'&lt;br /&gt;STAT #139973723001152 id=4 cnt=0 pid=3 pos=1 obj=25013 op='TABLE ACCESS FULL T1 (cr=0 pr=0 pw=0 str=0 time=0 us cost=3 size=13 card=1)'&lt;br /&gt;STAT #139973723001152 id=5 cnt=0 pid=3 pos=2 obj=25014 op='TABLE ACCESS FULL T2 (cr=0 pr=0 pw=0 str=0 time=0 us cost=3 size=13 card=1)'&lt;br /&gt;STAT #139973723001152 id=6 cnt=0 pid=2 pos=2 obj=0 op='FILTER  (cr=0 pr=0 pw=0 str=0 time=0 us)'&lt;br /&gt;STAT #139973723001152 id=7 cnt=0 pid=6 pos=1 obj=25013 op='TABLE ACCESS FULL T1 (cr=0 pr=0 pw=0 str=0 time=0 us cost=3 size=13 card=1)'&lt;br /&gt;STAT #139973723001152 id=8 cnt=0 pid=6 pos=2 obj=25014 op='TABLE ACCESS FULL T2 (cr=0 pr=0 pw=0 str=0 time=0 us cost=3 size=13 card=1)'&lt;br /&gt;STAT #139973723001152 id=9 cnt=1 pid=0 pos=2 obj=0 op='FAST DUAL  (cr=0 pr=0 pw=0 str=1 time=0 us cost=2 size=0 card=1)'&lt;br /&gt;FETCH #139973720520408:c=178,e=177,p=0,cr=8,cu=0,mis=0,r=1,dep=0,og=1,plh=489056501,tim=4622200599&lt;br /&gt;STAT #139973720520408 id=1 cnt=1 pid=0 pos=1 obj=0 op='VIEW  (cr=9 pr=0 pw=0 str=1 time=179 us cost=12 size=6 card=2)'&lt;br /&gt;STAT #139973720520408 id=2 cnt=1 pid=1 pos=1 obj=0 op='UNION-ALL  (cr=9 pr=0 pw=0 str=1 time=177 us)'&lt;br /&gt;STAT #139973720520408 id=3 cnt=0 pid=2 pos=1 obj=0 op='FILTER  (cr=1 pr=0 pw=0 str=1 time=8 us)'&lt;br /&gt;STAT #139973720520408 id=4 cnt=0 pid=3 pos=1 obj=25013 op='TABLE ACCESS FULL T1 (cr=0 pr=0 pw=0 str=0 time=0 us cost=3 size=0 card=1)'&lt;br /&gt;STAT #139973720520408 id=5 cnt=0 pid=3 pos=2 obj=25014 op='TABLE ACCESS FULL T2 (cr=1 pr=0 pw=0 str=1 time=6 us cost=3 size=13 card=1)'&lt;br /&gt;STAT #139973720520408 id=6 cnt=1 pid=2 pos=2 obj=0 op='FILTER  (cr=8 pr=0 pw=0 str=1 time=164 us)'&lt;br /&gt;STAT #139973720520408 id=7 cnt=1 pid=6 pos=1 obj=25013 op='TABLE ACCESS FULL T1 (cr=7 pr=0 pw=0 str=1 time=144 us cost=3 size=0 card=1)'&lt;br /&gt;STAT #139973720520408 id=8 cnt=0 pid=6 pos=2 obj=25014 op='TABLE ACCESS FULL T2 (cr=1 pr=0 pw=0 str=1 time=9 us cost=3 size=13 card=1)'&lt;br /&gt;FETCH #139973723001152:c=0,e=0,p=0,cr=0,cu=0,mis=0,r=0,dep=0,og=0,plh=2197603499,tim=4622200901&lt;br /&gt;CLOSE #139973720520408:c=3,e=2,dep=1,type=0,tim=4622201312&lt;br /&gt;CLOSE #139973723001152:c=6,e=193,dep=0,type=0,tim=4622201500&lt;br /&gt;&lt;/pre&gt;That is where the most remarkable part happens. The subquery is modified in an awfully wrong way: the columns of the outer queries disappear from the inner queries, and they are replaced with some bind variables: CV1$, CV2$.&lt;br/&gt;Those variables, which are of the NUMBER data type, are set to NULL.&lt;br/&gt;Then, the 'A' branch of the UNION ALL, which uses EXISTS, returns nothing. The 'B' branch, which uses NOT EXISTS, returns the 'B' row since the NOT EXISTS subquery brings back an empty result set.&lt;br/&gt;&lt;br/&gt;At this stage the root cause of the wrong results issue is known. Obviously, I have no clue why those variables were introduced but I know why that query returns that result.&lt;br/&gt;&lt;br/&gt;I tried to tinker around with that query a little bit to see what can be done to make it work, and here is a short summary of my findings:&lt;br/&gt;&lt;ul&gt;  &lt;li&gt;Correlated subqueries are essential. The query starts returning the correct results (one 'A' row) once I decorrelate the subqueries:&lt;br/&gt;    &lt;pre class='brush:sql;highlight:[26]'&gt;&lt;br /&gt;SQL&gt; select cursor(&lt;br /&gt;  2           select query_type&lt;br /&gt;  3             from (select 'A' query_type&lt;br /&gt;  4                     from t1 t11&lt;br /&gt;  5                    where id in (&lt;br /&gt;  6                            select id&lt;br /&gt;  7                              from t2 t21)&lt;br /&gt;  8                    union all&lt;br /&gt;  9                   select 'B' query_type&lt;br /&gt; 10                     from t1 t12&lt;br /&gt; 11                    where id not in (&lt;br /&gt; 12                            select id&lt;br /&gt; 13                              from t2 t22)&lt;br /&gt; 14                  )&lt;br /&gt; 15         ) data&lt;br /&gt; 16    from dual;&lt;br /&gt;&lt;br /&gt;DATA&lt;br /&gt;--------------------&lt;br /&gt;CURSOR STATEMENT : 1&lt;br /&gt;&lt;br /&gt;CURSOR STATEMENT : 1&lt;br /&gt;&lt;br /&gt;Q&lt;br /&gt;-&lt;br /&gt;A&lt;br /&gt;    &lt;/pre&gt;  &lt;/li&gt;  &lt;li&gt;Nesting of the subqueries does matter. For instance, the query returns the correct results after I reduce the nesting level: &lt;pre class='brush:sql;highlight:[26]'&gt;&lt;br /&gt;SQL&gt; select cursor(&lt;br /&gt;  2           select 'A' query_type&lt;br /&gt;  3             from t1 t11&lt;br /&gt;  4            where exists (&lt;br /&gt;  5                    select null&lt;br /&gt;  6                      from t2 t21&lt;br /&gt;  7                     where t21.id = t11.id)&lt;br /&gt;  8            union all&lt;br /&gt;  9           select 'B' query_type&lt;br /&gt; 10             from t1 t12&lt;br /&gt; 11            where not exists (&lt;br /&gt; 12                    select null&lt;br /&gt; 13                      from t2 t22&lt;br /&gt; 14                     where t22.id = t12.id)&lt;br /&gt; 15         ) data&lt;br /&gt; 16    from dual;&lt;br /&gt;&lt;br /&gt;DATA&lt;br /&gt;--------------------&lt;br /&gt;CURSOR STATEMENT : 1&lt;br /&gt;&lt;br /&gt;CURSOR STATEMENT : 1&lt;br /&gt;&lt;br /&gt;Q&lt;br /&gt;-&lt;br /&gt;A&lt;br /&gt;&lt;/pre&gt;&lt;/li&gt;&lt;/ul&gt;Based on how Oracle modifies the subquery under the hood, certain CURSOR expressions can return: &lt;ul&gt;  &lt;li&gt;Less rows:     &lt;pre class='brush:sql;highlight:[32,58,59]'&gt;&lt;br /&gt;SQL&gt; doc&lt;br /&gt;DOC&gt;##############################&lt;br /&gt;DOC&gt;   Less rows&lt;br /&gt;DOC&gt;##############################&lt;br /&gt;DOC&gt;#&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select cursor(&lt;br /&gt;  2           select query_type&lt;br /&gt;  3             from (select 'A' query_type&lt;br /&gt;  4                     from t1 t11&lt;br /&gt;  5                    where exists (&lt;br /&gt;  6                            select null&lt;br /&gt;  7                              from t2 t21&lt;br /&gt;  8                             where t21.id = t11.id)&lt;br /&gt;  9                    union all&lt;br /&gt; 10                   select 'B' query_type&lt;br /&gt; 11                     from t1 t12&lt;br /&gt; 12                    where exists (&lt;br /&gt; 13                            select null&lt;br /&gt; 14                              from t2 t22&lt;br /&gt; 15                             where t22.id = t12.id)&lt;br /&gt; 16                  )&lt;br /&gt; 17         ) data&lt;br /&gt; 18    from dual;&lt;br /&gt;&lt;br /&gt;DATA&lt;br /&gt;--------------------&lt;br /&gt;CURSOR STATEMENT : 1&lt;br /&gt;&lt;br /&gt;CURSOR STATEMENT : 1&lt;br /&gt;&lt;br /&gt;no rows selected&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; doc&lt;br /&gt;DOC&gt;   The cursor subquery&lt;br /&gt;DOC&gt;#&lt;br /&gt;SQL&gt; select query_type&lt;br /&gt;  2    from (select 'A' query_type&lt;br /&gt;  3            from t1 t11&lt;br /&gt;  4           where exists (&lt;br /&gt;  5                   select null&lt;br /&gt;  6                     from t2 t21&lt;br /&gt;  7                    where t21.id = t11.id)&lt;br /&gt;  8           union all&lt;br /&gt;  9          select 'B' query_type&lt;br /&gt; 10            from t1 t12&lt;br /&gt; 11           where exists (&lt;br /&gt; 12                   select null&lt;br /&gt; 13                     from t2 t22&lt;br /&gt; 14                    where t22.id = t12.id)&lt;br /&gt; 15         )&lt;br /&gt; 16  ;&lt;br /&gt;&lt;br /&gt;Q&lt;br /&gt;-&lt;br /&gt;A&lt;br /&gt;B&lt;br /&gt;    &lt;/pre&gt;  &lt;/li&gt;  &lt;li&gt;More rows:     &lt;pre class='brush:sql;highlight:[30,31,52]'&gt;&lt;br /&gt;SQL&gt; doc&lt;br /&gt;DOC&gt;##############################&lt;br /&gt;DOC&gt;   More rows&lt;br /&gt;DOC&gt;##############################&lt;br /&gt;DOC&gt;#&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select cursor(&lt;br /&gt;  2           select query_type&lt;br /&gt;  3             from (select 'A' query_type&lt;br /&gt;  4                     from t1 t11&lt;br /&gt;  5                    union all&lt;br /&gt;  6                   select 'B' query_type&lt;br /&gt;  7                     from t1 t12&lt;br /&gt;  8                    where not exists (&lt;br /&gt;  9                            select null&lt;br /&gt; 10                              from t2 t22&lt;br /&gt; 11                             where t22.id = t12.id)&lt;br /&gt; 12                  )&lt;br /&gt; 13         ) data&lt;br /&gt; 14    from dual;&lt;br /&gt;&lt;br /&gt;DATA&lt;br /&gt;--------------------&lt;br /&gt;CURSOR STATEMENT : 1&lt;br /&gt;&lt;br /&gt;CURSOR STATEMENT : 1&lt;br /&gt;&lt;br /&gt;Q&lt;br /&gt;-&lt;br /&gt;A&lt;br /&gt;B&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; doc&lt;br /&gt;DOC&gt;   The cursor subquery&lt;br /&gt;DOC&gt;#&lt;br /&gt;SQL&gt; select query_type&lt;br /&gt;  2    from (select 'A' query_type&lt;br /&gt;  3            from t1 t11&lt;br /&gt;  4           union all&lt;br /&gt;  5          select 'B' query_type&lt;br /&gt;  6            from t1 t12&lt;br /&gt;  7           where not exists (&lt;br /&gt;  8                   select null&lt;br /&gt;  9                     from t2 t22&lt;br /&gt; 10                    where t22.id = t12.id)&lt;br /&gt; 11         );&lt;br /&gt;&lt;br /&gt;Q&lt;br /&gt;-&lt;br /&gt;A&lt;br /&gt;    &lt;/pre&gt;  &lt;/li&gt;  &lt;li&gt;Different values as it was demostrated in the beginning of this post&lt;/li&gt;&lt;/ul&gt;The good news is that it is a known documented issue: &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=30528947.8"&gt;Bug 30528947 - Nested Query Using CURSOR Expression Returns Wrong Result (Doc ID 30528947.8)&lt;/a&gt;. There are patches available for some release updates.&lt;br/&gt;The bad news is that the issue is not mentioned on the document I would expect it to be: &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=2606585.1"&gt;Things to Consider to Avoid Prominent Wrong Result Problems on 19C Proactively (Doc ID 2606585.1)&lt;/a&gt;. How is one supposed to avoid such issues? I always read those 'things to consider' before I devise any upgrade plans.&lt;br/&gt;The scripts, a sample trace file, and the spool file for this post are available on: &lt;a href="https://github.com/mvelikikh/oracle/tree/master/blog/202006_cursor_expressions_return_wrong_results_in_18c_19c"&gt;GitHub&lt;/a&gt;.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/6496144081582298355/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2020/06/cursor-expressions-return-wrong-results.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6496144081582298355'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6496144081582298355'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2020/06/cursor-expressions-return-wrong-results.html' title='CURSOR Expressions Return Wrong Results in 18c/19c'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-4032554088504224018</id><published>2020-06-09T01:31:00.001+06:00</published><updated>2020-06-09T01:32:05.081+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='CBO'/><title type='text'>OR Expansion and Virtual Columns: Changes in 19c</title><content type='html'>This post is a continuation of my previous one: &lt;a href="https://mvelikikh.blogspot.com/2020/05/or-expansion-and-virtual-columns.html"&gt;OR Expansion and Virtual Columns&lt;/a&gt;. The last post demonstrated that OR Expansion can somehow be affected by virtual columns in such a way that queries that did not perform OR Expansion can start using it as soon as a virtual column is created. Both an FBI and extended statistics lead to the same result provided that a certain column used in the query is included in them.&lt;br/&gt;This time around, I am going to take a look at how 19c has changed that.&lt;br/&gt;&lt;br/&gt;Firstly, I am going to recreate my initial table: &lt;a href="https://github.com/mvelikikh/oracle/blob/master/blog/202006_or_expansion_and_virtual_columns_19c/or_expand_setup.sql"&gt;or_expand_setup.sql&lt;/a&gt;: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; @or_expand_setup&lt;br /&gt;SQL&gt; drop table t1;&lt;br /&gt;&lt;br /&gt;Table dropped.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create table t1 (&lt;br /&gt;  2    part_key varchar2(8),&lt;br /&gt;  3    status   varchar2(12),&lt;br /&gt;  4    pad1     char(500)&lt;br /&gt;  5  )&lt;br /&gt;  6  partition by list(part_key) (&lt;br /&gt;  7    partition values ('P1'),&lt;br /&gt;  8    partition values (default)&lt;br /&gt;  9  )&lt;br /&gt; 10  ;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert into t1&lt;br /&gt;  2  select 'P1', status, 'X'&lt;br /&gt;  3    from (select 90 pct, 'PROCESSED' status from dual union all&lt;br /&gt;  4          select 1, 'UNPROCESSED' from dual union all&lt;br /&gt;  5          select 9, 'PENDING' from dual) params,&lt;br /&gt;  6         lateral(&lt;br /&gt;  7           select level&lt;br /&gt;  8             from dual&lt;br /&gt;  9             connect by level &lt;= params.pct * 1000&lt;br /&gt; 10         ) duplicator;&lt;br /&gt;&lt;br /&gt;100000 rows created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create index t1_status_i on t1(status) local;&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select status,&lt;br /&gt;  2         count(*),&lt;br /&gt;  3         round(ratio_to_report(count(*)) over () * 100, 2) pct&lt;br /&gt;  4    from t1&lt;br /&gt;  5   group by status&lt;br /&gt;  6   order by 1;&lt;br /&gt;&lt;br /&gt;STATUS         COUNT(*)        PCT&lt;br /&gt;------------ ---------- ----------&lt;br /&gt;PENDING            9000          9&lt;br /&gt;PROCESSED         90000         90&lt;br /&gt;UNPROCESSED        1000          1&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Secondly, I am running the &lt;a href="https://github.com/mvelikikh/oracle/blob/master/blog/202006_or_expansion_and_virtual_columns_19c/or_expand_test_vcol.sql"&gt;or_expand_test_vcol.sql&lt;/a&gt; script which was previously performed OR Expansion in both 12.2 and 18c: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; @or_expand_test_vcol&lt;br /&gt;SQL&gt; set def on lin 124 pages 100&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter table t1 add lower_status varchar2(128) generated always as (lower(status)) virtual;&lt;br /&gt;&lt;br /&gt;Table altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec dbms_stats.gather_table_stats( '', 't1', method_opt =&gt; 'for all columns size 254')&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col tfi old_v tfi nopri&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select to_char(sysdate, 'yyyymmdd_hh24miss') tfi from dual;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set tracefile_identifier='&amp;tfi.';&lt;br /&gt;old   1: alter session set tracefile_identifier='&amp;tfi.'&lt;br /&gt;new   1: alter session set tracefile_identifier='20200608_180223'&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set events 'trace[sql_optimizer.*]';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; var part_key varchar2(10)='P1'&lt;br /&gt;SQL&gt; var param    varchar2(12)='WAITING'&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select --+ gather_plan_statistics or_expand(@sel$1 (1) (2))&lt;br /&gt;  2         count(pad1)&lt;br /&gt;  3    from t1&lt;br /&gt;  4   where part_key = :part_key&lt;br /&gt;  5     and (:param = 'WAITING' and status = 'UNPROCESSED'&lt;br /&gt;  6          or&lt;br /&gt;  7          :param = 'ALL' and status &lt;&gt; 'PENDING');&lt;br /&gt;&lt;br /&gt;COUNT(PAD1)&lt;br /&gt;-----------&lt;br /&gt;       1000&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from dbms_xplan.display_cursor(format=&gt; 'allstats last outline');&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL_ID  fq8b3jumk131t, child number 0&lt;br /&gt;-------------------------------------&lt;br /&gt;select --+ gather_plan_statistics or_expand(@sel$1 (1) (2))&lt;br /&gt;count(pad1)   from t1  where part_key = :part_key    and (:param =&lt;br /&gt;'WAITING' and status = 'UNPROCESSED'         or         :param = 'ALL'&lt;br /&gt;and status &lt;&gt; 'PENDING')&lt;br /&gt;&lt;br /&gt;Plan hash value: 1293629841&lt;br /&gt;&lt;br /&gt;-----------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation              | Name | Starts | E-Rows | A-Rows |   A-Time   | Buffers |&lt;br /&gt;-----------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT       |      |      1 |        |      1 |00:00:00.03 |    7826 |&lt;br /&gt;|   1 |  SORT AGGREGATE        |      |      1 |      1 |      1 |00:00:00.03 |    7826 |&lt;br /&gt;|   2 |   PARTITION LIST SINGLE|      |      1 |    920 |   1000 |00:00:00.03 |    7826 |&lt;br /&gt;|*  3 |    TABLE ACCESS FULL   | T1   |      1 |    920 |   1000 |00:00:00.03 |    7826 |&lt;br /&gt;-----------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Outline Data&lt;br /&gt;-------------&lt;br /&gt;&lt;br /&gt;  /*+&lt;br /&gt;      BEGIN_OUTLINE_DATA&lt;br /&gt;      IGNORE_OPTIM_EMBEDDED_HINTS&lt;br /&gt;      OPTIMIZER_FEATURES_ENABLE('19.1.0')&lt;br /&gt;      DB_VERSION('19.1.0')&lt;br /&gt;      ALL_ROWS&lt;br /&gt;      OUTLINE_LEAF(@"SEL$1")&lt;br /&gt;      FULL(@"SEL$1" "T1"@"SEL$1")&lt;br /&gt;      END_OUTLINE_DATA&lt;br /&gt;  */&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   3 - filter((((:PARAM='ALL' AND "STATUS"&lt;&gt;'PENDING') OR&lt;br /&gt;              ("STATUS"='UNPROCESSED' AND :PARAM='WAITING')) AND "PART_KEY"=:PART_KEY))&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;38 rows selected.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set events 'trace[sql_optimizer.*] off';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col value for a80&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select value&lt;br /&gt;  2    from v$diag_info&lt;br /&gt;  3   where name='Default Trace File';&lt;br /&gt;&lt;br /&gt;VALUE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;/u01/app/oracle/diag/rdbms/orcl/orcl/trace/orcl_ora_7253_20200608_180223.trc&lt;br /&gt;&lt;/pre&gt;As the output above demonstrates, there is no OR Expansion anymore. The trace file &lt;a href="https://github.com/mvelikikh/oracle/blob/master/blog/202006_or_expansion_and_virtual_columns_19c/orcl_ora_7253_20200608_180223.trc"&gt;orcl_ora_7253_20200608_180223.trc&lt;/a&gt; shows the following: &lt;pre class="brush:sql;highlight:[26]"&gt;&lt;br /&gt;***********************************&lt;br /&gt;Cost-Based OR Expansion&lt;br /&gt;***********************************&lt;br /&gt;ORE: Trying CBQT OR expansion before unnesting&lt;br /&gt;ORE: Checking validity of OR Expansion for query block SEL$1 (#1)&lt;br /&gt;ORE: Predicate chain before QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;&lt;br /&gt;ORE: Predicate chain after QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;OR Expansion on query block SEL$1 (#1)&lt;br /&gt;ORE: Checking validity of OR Expansion for query block SEL$1 (#1)&lt;br /&gt;ORE: Predicate chain before QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;&lt;br /&gt;ORE: Predicate chain after QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;ORE: Using search type: linear&lt;br /&gt;ORE: Checking validity of OR Expansion for query block SEL$1 (#1)&lt;br /&gt;ORE: Predicate chain before QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;&lt;br /&gt;ORE: Predicate chain after QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;ORE: Checking validity of disjunct chain &lt;br /&gt;ORE: Bypassed for disjunct chain: No Index or Partition driver found.&lt;br /&gt;ORE: # conjunction chain - 1&lt;br /&gt;ORE: No state generated.&lt;br /&gt;&lt;/pre&gt;It is worth noting that even a full outline does not lead to the desired plan. That is how I discovered that issue initially. The query in question did have an SQL Plan Baseline which stopped being reproducible following a 19c upgrade.&lt;br/&gt;&lt;br/&gt; A straightforward way to get the desired execution plan is to rewrite the initial query as follows: &lt;pre class="brush:sql;highlight:[12,14]"&gt;&lt;br /&gt;SQL&gt; @or_expand_test_rewrite&lt;br /&gt;&lt;br /&gt;..skip..&lt;br /&gt;&lt;br /&gt;SQL&gt; var part_key varchar2(10)='P1'&lt;br /&gt;SQL&gt; var param    varchar2(12)='WAITING'&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select --+ gather_plan_statistics or_expand(@sel$1 (1) (2))&lt;br /&gt;  2         count(pad1)&lt;br /&gt;  3    from t1&lt;br /&gt;  4   where 1 = 1&lt;br /&gt;  5     and (part_key = :part_key and :param = 'WAITING' and status = 'UNPROCESSED'&lt;br /&gt;  6          or&lt;br /&gt;  7          part_key = :part_key||'' and :param = 'ALL' and status &lt;&gt; 'PENDING');&lt;br /&gt;&lt;br /&gt;COUNT(PAD1)&lt;br /&gt;-----------&lt;br /&gt;       1000&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from dbms_xplan.display_cursor(format=&gt; 'allstats last outline');&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL_ID  99zvump911bc7, child number 0&lt;br /&gt;-------------------------------------&lt;br /&gt;select --+ gather_plan_statistics or_expand(@sel$1 (1) (2))&lt;br /&gt;count(pad1)   from t1  where 1 = 1    and (part_key = :part_key and&lt;br /&gt;:param = 'WAITING' and status = 'UNPROCESSED'         or&lt;br /&gt;part_key = :part_key||'' and :param = 'ALL' and status &lt;&gt; 'PENDING')&lt;br /&gt;&lt;br /&gt;Plan hash value: 3973059565&lt;br /&gt;&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                                      | Name            | Starts | E-Rows | A-Rows |   A-Time   | Buffers |&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT                               |                 |      1 |        |      1 |00:00:00.01 |      83 |&lt;br /&gt;|   1 |  SORT AGGREGATE                                |                 |      1 |      1 |      1 |00:00:00.01 |      83 |&lt;br /&gt;|   2 |   VIEW                                         | VW_ORE_BA8ECEFB |      1 |  91982 |   1000 |00:00:00.01 |      83 |&lt;br /&gt;|   3 |    UNION-ALL                                   |                 |      1 |        |   1000 |00:00:00.01 |      83 |&lt;br /&gt;|*  4 |     FILTER                                     |                 |      1 |        |   1000 |00:00:00.01 |      83 |&lt;br /&gt;|   5 |      PARTITION LIST SINGLE                     |                 |      1 |    999 |   1000 |00:00:00.01 |      83 |&lt;br /&gt;|*  6 |       TABLE ACCESS BY LOCAL INDEX ROWID BATCHED| T1              |      1 |    999 |   1000 |00:00:00.01 |      83 |&lt;br /&gt;|*  7 |        INDEX RANGE SCAN                        | T1_STATUS_I     |      1 |   1000 |   1000 |00:00:00.01 |       6 |&lt;br /&gt;|*  8 |     FILTER                                     |                 |      1 |        |      0 |00:00:00.01 |       0 |&lt;br /&gt;|   9 |      PARTITION LIST SINGLE                     |                 |      0 |  90983 |      0 |00:00:00.01 |       0 |&lt;br /&gt;|* 10 |       TABLE ACCESS FULL                        | T1              |      0 |  90983 |      0 |00:00:00.01 |       0 |&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Outline Data&lt;br /&gt;-------------&lt;br /&gt;&lt;br /&gt;  /*+&lt;br /&gt;      BEGIN_OUTLINE_DATA&lt;br /&gt;      IGNORE_OPTIM_EMBEDDED_HINTS&lt;br /&gt;      OPTIMIZER_FEATURES_ENABLE('19.1.0')&lt;br /&gt;      DB_VERSION('19.1.0')&lt;br /&gt;      ALL_ROWS&lt;br /&gt;      OUTLINE_LEAF(@"SET$2A13AF86_2")&lt;br /&gt;      OUTLINE_LEAF(@"SET$2A13AF86_1")&lt;br /&gt;      OUTLINE_LEAF(@"SET$2A13AF86")&lt;br /&gt;      OUTLINE_LEAF(@"SEL$9162BF3C")&lt;br /&gt;      OR_EXPAND(@"SEL$1" (1) (2))&lt;br /&gt;      OUTLINE(@"SEL$1")&lt;br /&gt;      NO_ACCESS(@"SEL$9162BF3C" "VW_ORE_BA8ECEFB"@"SEL$BA8ECEFB")&lt;br /&gt;      INDEX_RS_ASC(@"SET$2A13AF86_1" "T1"@"SET$2A13AF86_1" ("T1"."STATUS"))&lt;br /&gt;      BATCH_TABLE_ACCESS_BY_ROWID(@"SET$2A13AF86_1" "T1"@"SET$2A13AF86_1")&lt;br /&gt;      FULL(@"SET$2A13AF86_2" "T1"@"SET$2A13AF86_2")&lt;br /&gt;      END_OUTLINE_DATA&lt;br /&gt;  */&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   4 - filter(:PARAM='WAITING')&lt;br /&gt;   6 - filter("PART_KEY"=:PART_KEY)&lt;br /&gt;   7 - access("STATUS"='UNPROCESSED')&lt;br /&gt;   8 - filter(:PARAM='ALL')&lt;br /&gt;  10 - filter(("STATUS"&lt;&gt;'PENDING' AND "PART_KEY"=:PART_KEY||'' AND (LNNVL("PART_KEY"=:PART_KEY) OR&lt;br /&gt;              LNNVL(:PARAM='WAITING') OR LNNVL("STATUS"='UNPROCESSED'))))&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;57 rows selected.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set events 'trace[sql_optimizer.*] off';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col value for a80&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select value&lt;br /&gt;  2    from v$diag_info&lt;br /&gt;  3   where name='Default Trace File';&lt;br /&gt;&lt;br /&gt;VALUE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;/u01/app/oracle/diag/rdbms/orcl/orcl/trace/orcl_ora_7253_20200608_180825.trc&lt;br /&gt;&lt;/pre&gt;That is what is done in &lt;a href="https://github.com/mvelikikh/oracle/blob/master/blog/202006_or_expansion_and_virtual_columns_19c/or_expand_test_rewrite.sql"&gt;or_expand_test_rewrite.sql&lt;/a&gt;; the corresponding trace file is: &lt;a href="https://github.com/mvelikikh/oracle/blob/master/blog/202006_or_expansion_and_virtual_columns_19c/orcl_ora_7253_20200608_180825.trc"&gt;orcl_ora_7253_20200608_180825.trc&lt;/a&gt;.&lt;br/&gt;Evidently, this rewrite can be applied in a limited number of cases. &lt;br/&gt;Thankfully, the old OR Expansion transformation, aka CONCATENATION, works just fine for this example which is demonstrated in the listing below: &lt;a href="https://github.com/mvelikikh/oracle/blob/master/blog/202006_or_expansion_and_virtual_columns_19c/or_expand_test_use_concat.sql"&gt;or_expand_test_use_concat.sql&lt;/a&gt;&lt;pre class="brush:sql;highlight:[40]"&gt;&lt;br /&gt;SQL&gt; @or_expand_test_use_concat&lt;br /&gt;&lt;br /&gt;..skip..&lt;br /&gt;&lt;br /&gt;SQL&gt; var part_key varchar2(10)='P1'&lt;br /&gt;SQL&gt; var param    varchar2(12)='WAITING'&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select --+ gather_plan_statistics use_concat(or_predicates(2))&lt;br /&gt;  2         count(pad1)&lt;br /&gt;  3    from t1&lt;br /&gt;  4   where part_key = :part_key&lt;br /&gt;  5     and (:param = 'WAITING' and status = 'UNPROCESSED'&lt;br /&gt;  6          or&lt;br /&gt;  7          :param = 'ALL' and status &lt;&gt; 'PENDING');&lt;br /&gt;&lt;br /&gt;COUNT(PAD1)&lt;br /&gt;-----------&lt;br /&gt;       1000&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from dbms_xplan.display_cursor(format=&gt; 'allstats last outline');&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL_ID  cygpq5hyy2uu2, child number 0&lt;br /&gt;-------------------------------------&lt;br /&gt;select --+ gather_plan_statistics use_concat(or_predicates(2))&lt;br /&gt;count(pad1)   from t1  where part_key = :part_key    and (:param =&lt;br /&gt;'WAITING' and status = 'UNPROCESSED'         or         :param = 'ALL'&lt;br /&gt;and status &lt;&gt; 'PENDING')&lt;br /&gt;&lt;br /&gt;Plan hash value: 496678280&lt;br /&gt;&lt;br /&gt;-----------------------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                                     | Name        | Starts | E-Rows | A-Rows |   A-Time   | Buffers |&lt;br /&gt;-----------------------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT                              |             |      1 |        |      1 |00:00:00.01 |      83 |&lt;br /&gt;|   1 |  SORT AGGREGATE                               |             |      1 |      1 |      1 |00:00:00.01 |      83 |&lt;br /&gt;|   2 |   CONCATENATION                               |             |      1 |        |   1000 |00:00:00.01 |      83 |&lt;br /&gt;|*  3 |    FILTER                                     |             |      1 |        |      0 |00:00:00.01 |       0 |&lt;br /&gt;|   4 |     PARTITION LIST SINGLE                     |             |      0 |  90992 |      0 |00:00:00.01 |       0 |&lt;br /&gt;|*  5 |      TABLE ACCESS FULL                        | T1          |      0 |  90992 |      0 |00:00:00.01 |       0 |&lt;br /&gt;|*  6 |    FILTER                                     |             |      1 |        |   1000 |00:00:00.01 |      83 |&lt;br /&gt;|   7 |     PARTITION LIST SINGLE                     |             |      1 |    990 |   1000 |00:00:00.01 |      83 |&lt;br /&gt;|*  8 |      TABLE ACCESS BY LOCAL INDEX ROWID BATCHED| T1          |      1 |    990 |   1000 |00:00:00.01 |      83 |&lt;br /&gt;|*  9 |       INDEX RANGE SCAN                        | T1_STATUS_I |      1 |    990 |   1000 |00:00:00.01 |       6 |&lt;br /&gt;-----------------------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Outline Data&lt;br /&gt;-------------&lt;br /&gt;&lt;br /&gt;  /*+&lt;br /&gt;      BEGIN_OUTLINE_DATA&lt;br /&gt;      IGNORE_OPTIM_EMBEDDED_HINTS&lt;br /&gt;      OPTIMIZER_FEATURES_ENABLE('19.1.0')&lt;br /&gt;      DB_VERSION('19.1.0')&lt;br /&gt;      ALL_ROWS&lt;br /&gt;      OUTLINE_LEAF(@"SEL$1")&lt;br /&gt;      OUTLINE_LEAF(@"SEL$1_1")&lt;br /&gt;      USE_CONCAT(@"SEL$1" OR_PREDICATES(2))&lt;br /&gt;      OUTLINE_LEAF(@"SEL$1_2")&lt;br /&gt;      FULL(@"SEL$1_1" "T1"@"SEL$1")&lt;br /&gt;      INDEX_RS_ASC(@"SEL$1_2" "T1"@"SEL$1_2" ("T1"."STATUS"))&lt;br /&gt;      BATCH_TABLE_ACCESS_BY_ROWID(@"SEL$1_2" "T1"@"SEL$1_2")&lt;br /&gt;      END_OUTLINE_DATA&lt;br /&gt;  */&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   3 - filter(:PARAM='ALL')&lt;br /&gt;   5 - filter(("STATUS"&lt;&gt;'PENDING' AND "PART_KEY"=:PART_KEY))&lt;br /&gt;   6 - filter(:PARAM='WAITING')&lt;br /&gt;   8 - filter("PART_KEY"=:PART_KEY)&lt;br /&gt;   9 - access("STATUS"='UNPROCESSED')&lt;br /&gt;       filter((LNNVL(:PARAM='ALL') OR LNNVL("STATUS"&lt;&gt;'PENDING')))&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;53 rows selected.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set events 'trace[sql_optimizer.*] off';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col value for a80&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select value&lt;br /&gt;  2    from v$diag_info&lt;br /&gt;  3   where name='Default Trace File';&lt;br /&gt;&lt;br /&gt;VALUE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;/u01/app/oracle/diag/rdbms/orcl/orcl/trace/orcl_ora_7253_20200608_181301.trc&lt;br /&gt;&lt;/pre&gt;The corresponding trace file is: &lt;a href="https://github.com/mvelikikh/oracle/blob/master/blog/202006_or_expansion_and_virtual_columns_19c/orcl_ora_7253_20200608_181301.trc"&gt;orcl_ora_7253_20200608_181301.trc&lt;/a&gt;. &lt;br/&gt;This blog post demonstrates a specific example in which OR Expansion fails to produce the desired execution plan, leading to a suboptimal execution.&lt;br/&gt;By way of contrast, CONCATENATION results in the execution plan I was seeking, performing as effectively as OR Expansion did before 19c.&lt;br/&gt;It is my hope that Oracle will fix this issue eventually, which I am trying to get done in &lt;a href="https://support.oracle.com/rs?type=sr&amp;id=3-22449907431"&gt;SR 3-22449907431 : OR-Expansion does not work following 19.5 upgrade&lt;/a&gt;.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/4032554088504224018/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2020/06/or-expansion-and-virtual-columns.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4032554088504224018'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4032554088504224018'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2020/06/or-expansion-and-virtual-columns.html' title='OR Expansion and Virtual Columns: Changes in 19c'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8308421128869960976</id><published>2020-05-25T23:44:00.000+06:00</published><updated>2020-05-25T23:44:18.119+06:00</updated><app:control xmlns:app='http://purl.org/atom/app#'><app:draft>yes</app:draft></app:control><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='afd'/><category scheme='http://www.blogger.com/atom/ns#' term='aws'/><title type='text'>Using Udev Rules with AFD on AWS Nitro Instances</title><content type='html'>When I configured a new server, I decided to start using ASM Filter Driver for device persistence. It was working quite fine till the day when I restarted the server.&lt;br /&gt;All of a sudden some of my ASM disks were not seen in the 'asmcmd afd_lsdsk' output:&lt;br /&gt;&lt;pre class='brush:sql'&gt;[root@sandbox ~]# asmcmd afd_lsdsk&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Label                     Filtering   Path&lt;br /&gt;================================================================================&lt;br /&gt;TEST02                      ENABLED   /dev/nvme7n1p1&lt;br /&gt;TEST03                      ENABLED   /dev/nvme1n1p1&lt;br /&gt;TEST04                      ENABLED   /dev/nvme3n1p1&lt;br /&gt;TEST05                      ENABLED   /dev/nvme8n1p1&lt;br /&gt;TEST06                      ENABLED   /dev/nvme2n1p1&lt;br /&gt;TEST07                      ENABLED   /dev/nvme5n1p1&lt;br /&gt;TEST08                      ENABLED   /dev/nvme9n1p1&lt;br /&gt;TEST09                      ENABLED   /dev/nvme6n1p1&lt;br /&gt;TEST10                      ENABLED   /dev/nvme0n1p1&lt;br /&gt;&lt;/pre&gt;It is Linux 7.6 with the 4.1.12-124.28.3.el7uek.x86_64 kernel and Oracle GI 19.5. The diskgroup TEST has 10 disks labeled from TEST01 to TEST10.&lt;br /&gt;There is no TEST01 disk in the example above. The OS and kernel are supported as it is stated in &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=1369107.1"&gt;ACFS Support On OS Platforms (Certification Matrix). (Doc ID 1369107.1)&lt;/a&gt;.&lt;br /&gt;I was able to bring the disk back by doing 'asmcmd afd_scan /dev/nvme12n1p1' manually:&lt;br /&gt;&lt;pre class='brush:sql;highlight:[5]'&gt;[root@sandbox ~]# asmcmd afd_lsdsk&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Label                     Filtering   Path&lt;br /&gt;================================================================================&lt;br /&gt;TEST01                      ENABLED   /dev/nvme12n1p1&lt;br /&gt;TEST02                      ENABLED   /dev/nvme7n1p1&lt;br /&gt;TEST03                      ENABLED   /dev/nvme1n1p1&lt;br /&gt;TEST04                      ENABLED   /dev/nvme3n1p1&lt;br /&gt;TEST05                      ENABLED   /dev/nvme8n1p1&lt;br /&gt;TEST06                      ENABLED   /dev/nvme2n1p1&lt;br /&gt;TEST07                      ENABLED   /dev/nvme5n1p1&lt;br /&gt;TEST08                      ENABLED   /dev/nvme9n1p1&lt;br /&gt;TEST09                      ENABLED   /dev/nvme6n1p1&lt;br /&gt;TEST10                      ENABLED   /dev/nvme0n1p1&lt;br /&gt;&lt;/pre&gt;It is worth noting that I started experiencing this issue only with AFD. Oracle ASMLib was working without any issues on the same instance type, OS, and GI combination.&lt;br /&gt;I was not able to reproduce this issue with AFD disks created on top of LVM</content><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2020/05/using-udev-rules-with-afd-on-aws-nitro.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8308421128869960976'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8308421128869960976'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8370226090326391986</id><published>2020-05-21T00:39:00.002+06:00</published><updated>2020-05-21T00:39:40.161+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='12.2'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='CBO'/><category scheme='http://www.blogger.com/atom/ns#' term='18c'/><title type='text'>OR Expansion and Virtual Columns</title><content type='html'>The following test case can be used to demonstrate a little peculiarity of the OR Expansion transformation, that was introduced in 12.2.&lt;br /&gt;It is important to note that the issue is not present in 19c - I have reproduced it only on 12.2.0.1.190416 and 18c.&lt;br /&gt;The listings that I am using in this article are taken from 18c.&lt;br /&gt;&lt;br /&gt;&lt;pre class='brush:sql'&gt;SQL&gt; @or_expand_setup&lt;br /&gt;SQL&gt; drop table t1;&lt;br /&gt;&lt;br /&gt;Table dropped.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create table t1 (&lt;br /&gt;  2    part_key varchar2(8),&lt;br /&gt;  3    status   varchar2(12),&lt;br /&gt;  4    pad1     char(500)&lt;br /&gt;  5  )&lt;br /&gt;  6  partition by list(part_key) (&lt;br /&gt;  7    partition values ('P1'),&lt;br /&gt;  8    partition values (default)&lt;br /&gt;  9  )&lt;br /&gt; 10  ;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert into t1&lt;br /&gt;  2  select 'P1', status, 'X'&lt;br /&gt;  3    from (select 90 pct, 'PROCESSED' status from dual union all&lt;br /&gt;  4          select 1, 'UNPROCESSED' from dual union all&lt;br /&gt;  5          select 9, 'PENDING' from dual) params,&lt;br /&gt;  6         lateral(&lt;br /&gt;  7           select level&lt;br /&gt;  8             from dual&lt;br /&gt;  9             connect by level &lt;= params.pct * 1000&lt;br /&gt; 10         ) duplicator;&lt;br /&gt;&lt;br /&gt;100000 rows created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create index t1_status_i on t1(status) local;&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select status,&lt;br /&gt;  2         count(*),&lt;br /&gt;  3         round(ratio_to_report(count(*)) over () * 100, 2) pct&lt;br /&gt;  4    from t1&lt;br /&gt;  5   group by status&lt;br /&gt;  6   order by 1;&lt;br /&gt;&lt;br /&gt;STATUS         COUNT(*)        PCT&lt;br /&gt;------------ ---------- ----------&lt;br /&gt;PENDING            9000          9&lt;br /&gt;PROCESSED         90000         90&lt;br /&gt;UNPROCESSED        1000          1&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;In a nutshell, it is a list-partitioned table with a local index. &lt;b&gt;90%&lt;/b&gt; of the rows are in the &lt;code&gt;PROCESSED&lt;/code&gt; status, whereas &lt;code&gt;PENDING&lt;/code&gt; and &lt;code&gt;UNPROCESSED&lt;/code&gt; statuses account only for &lt;b&gt;9%&lt;/b&gt; and &lt;b&gt;1%&lt;/b&gt; correspondingly.&lt;br /&gt;The script itself: &lt;a href="https://github.com/mvelikikh/oracle/blob/master/blog/202005_or_expansion_and_virtual_columns/or_expand_setup.sql"&gt;or_expand.sql&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;Next, I am going to run a simple query and check its plan with and without a virtual column on the &lt;code&gt;STATUS&lt;/code&gt; column:&lt;br /&gt;&lt;pre class='brush:sql'&gt; select --+ gather_plan_statistics or_expand(@sel$1 (1) (2))&lt;br /&gt;        count(pad1)&lt;br /&gt;   from t1&lt;br /&gt;  where part_key = :part_key&lt;br /&gt;    and (:param = 'WAITING' and status = 'UNPROCESSED'&lt;br /&gt;         or&lt;br /&gt;         :param = 'ALL' and status &lt;&gt; 'PENDING');&lt;br /&gt;&lt;/pre&gt;The variables &lt;b&gt;&lt;i&gt;PARAM&lt;/i&gt;&lt;/b&gt; and &lt;b&gt;&lt;i&gt;PART_KEY&lt;/i&gt;&lt;/b&gt; are set as follows:&lt;br /&gt;&lt;pre class="brush:sql"&gt;var part_key varchar2(10)='P1'&lt;br /&gt;var param    varchar2(12)='WAITING'&lt;br /&gt;&lt;/pre&gt;Thus, I am going to query a single partition to get the rows in the &lt;code&gt;UNPROCESSED&lt;/code&gt; status from it.&lt;br /&gt;&lt;br /&gt;Here is the result of &lt;a href="https://github.com/mvelikikh/oracle/blob/master/blog/202005_or_expansion_and_virtual_columns/or_expand_test_no_vcol.sql"&gt;the script&lt;/a&gt; without the virtual column first:&lt;br /&gt;&lt;pre class='brush:sql;highlight:[4]'&gt;SQL&gt; @or_expand_test_no_vcol&lt;br /&gt;SQL&gt; set def on lin 124 pages 100&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; -- alter table t1 add lower_status varchar2(128) generated always as (lower(status)) virtual;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec dbms_stats.gather_table_stats( '', 't1', method_opt =&gt; 'for all columns size 254')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col tfi old_v tfi nopri&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select to_char(sysdate, 'yyyymmdd_hh24miss') tfi from dual;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set tracefile_identifier='&amp;tfi.';&lt;br /&gt;old   1: alter session set tracefile_identifier='&amp;tfi.'&lt;br /&gt;new   1: alter session set tracefile_identifier='20200520_181304'&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set events 'trace[sql_optimizer.*]';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; var part_key varchar2(10)='P1'&lt;br /&gt;SQL&gt; var param    varchar2(12)='WAITING'&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select --+ gather_plan_statistics or_expand(@sel$1 (1) (2))&lt;br /&gt;  2         count(pad1)&lt;br /&gt;  3    from t1&lt;br /&gt;  4   where part_key = :part_key&lt;br /&gt;  5     and (:param = 'WAITING' and status = 'UNPROCESSED'&lt;br /&gt;  6          or&lt;br /&gt;  7          :param = 'ALL' and status &lt;&gt; 'PENDING');&lt;br /&gt;&lt;br /&gt;COUNT(PAD1)&lt;br /&gt;-----------&lt;br /&gt;       1000&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from dbms_xplan.display_cursor(format=&gt; 'allstats last outline');&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL_ID  fq8b3jumk131t, child number 0&lt;br /&gt;-------------------------------------&lt;br /&gt;An uncaught error happened in prepare_sql_statement : ORA-01403: no data found&lt;br /&gt;&lt;br /&gt;Plan hash value: 1293629841&lt;br /&gt;&lt;br /&gt;-----------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation              | Name | Starts | E-Rows | A-Rows |   A-Time   | Buffers |&lt;br /&gt;-----------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT       |      |      1 |        |      1 |00:00:00.02 |    7831 |&lt;br /&gt;|   1 |  SORT AGGREGATE        |      |      1 |      1 |      1 |00:00:00.02 |    7831 |&lt;br /&gt;|   2 |   PARTITION LIST SINGLE|      |      1 |    920 |   1000 |00:00:00.01 |    7831 |&lt;br /&gt;|*  3 |    TABLE ACCESS FULL   | T1   |      1 |    920 |   1000 |00:00:00.01 |    7831 |&lt;br /&gt;-----------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Outline Data&lt;br /&gt;-------------&lt;br /&gt;&lt;br /&gt;  /*+&lt;br /&gt;      BEGIN_OUTLINE_DATA&lt;br /&gt;      IGNORE_OPTIM_EMBEDDED_HINTS&lt;br /&gt;      OPTIMIZER_FEATURES_ENABLE('18.1.0')&lt;br /&gt;      DB_VERSION('18.1.0')&lt;br /&gt;      ALL_ROWS&lt;br /&gt;      OUTLINE_LEAF(@"SEL$1")&lt;br /&gt;      FULL(@"SEL$1" "T1"@"SEL$1")&lt;br /&gt;      END_OUTLINE_DATA&lt;br /&gt;  */&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   3 - filter((((:PARAM='ALL' AND "STATUS"&lt;&gt;'PENDING') OR&lt;br /&gt;              ("STATUS"='UNPROCESSED' AND :PARAM='WAITING')) AND "PART_KEY"=:PART_KEY))&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;35 rows selected.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set events 'trace[sql_optimizer.*] off';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col value for a80&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select value&lt;br /&gt;  2    from v$diag_info&lt;br /&gt;  3   where name='Default Trace File';&lt;br /&gt;&lt;br /&gt;VALUE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;/u01/app/oracle/diag/rdbms/orcl/orcl/trace/orcl_ora_2137_20200520_181304.trc&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;I highlighted the commented &lt;b&gt;ALTER TABLE ADD COLUMN&lt;/b&gt; command. I am going to refer to it below.&lt;br /&gt;&lt;br /&gt;It is worth noting that the OR Expansion transformation has not been performed and &lt;a href="https://github.com/mvelikikh/oracle/blob/master/blog/202005_or_expansion_and_virtual_columns/orcl_ora_2137_20200520_181304_NO_VCOL.trc#L877"&gt;the relevant trace file&lt;/a&gt; contains a clue:&lt;br /&gt;&lt;pre class='brush:sql;highlight:[25,26,27]'&gt;***********************************&lt;br /&gt;Cost-Based OR Expansion&lt;br /&gt;***********************************&lt;br /&gt;ORE: Trying CBQT OR expansion before unnesting&lt;br /&gt;ORE: Checking validity of OR Expansion for query block SEL$1 (#1)&lt;br /&gt;ORE: Predicate chain before QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;&lt;br /&gt;ORE: Predicate chain after QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;OR Expansion on query block SEL$1 (#1)&lt;br /&gt;ORE: Checking validity of OR Expansion for query block SEL$1 (#1)&lt;br /&gt;ORE: Predicate chain before QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;&lt;br /&gt;ORE: Predicate chain after QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;ORE: Using search type: linear&lt;br /&gt;ORE: Checking validity of OR Expansion for query block SEL$1 (#1)&lt;br /&gt;ORE: Predicate chain before QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;&lt;br /&gt;ORE: Predicate chain after QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;ORE: Checking validity of disjunct chain &lt;br /&gt;ORE: Bypassed for disjunct chain: No Index or Partition driver found.&lt;br /&gt;ORE: # conjunction chain - 1&lt;br /&gt;ORE: No state generated.&lt;br /&gt;&lt;/pre&gt;&lt;b&gt;&lt;i&gt;OFF&lt;/i&gt;&lt;/b&gt;: I came across that &lt;code&gt;ORE: Bypassed for disjunct chain: No Index or Partition driver found.&lt;/code&gt; message in one of my previous posts: &lt;a href="http://mvelikikh.blogspot.com/2019/05/concatenation-and-filter-subqueries.html"&gt;Concatenation and filter subqueries oddity&lt;/a&gt;.&lt;br /&gt;&lt;br /&gt;What can go wrong if we now uncomment the aforementioned &lt;b&gt;ALTER TABLE ADD COLUMN&lt;/b&gt; command?&lt;br /&gt;The script &lt;a href="https://github.com/mvelikikh/oracle/blob/master/blog/202005_or_expansion_and_virtual_columns/or_expand_test_vcol.sql"&gt;or_expand_test_vcol.sql&lt;/a&gt;:&lt;br /&gt;&lt;pre class='brush:sql'&gt;SQL&gt; @or_expand_test_vcol&lt;br /&gt;SQL&gt; set def on lin 124 pages 100&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter table t1 add lower_status varchar2(128) generated always as (lower(status)) virtual;&lt;br /&gt;&lt;br /&gt;Table altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec dbms_stats.gather_table_stats( '', 't1', method_opt =&gt; 'for all columns size 254')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col tfi old_v tfi nopri&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select to_char(sysdate, 'yyyymmdd_hh24miss') tfi from dual;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set tracefile_identifier='&amp;tfi.';&lt;br /&gt;old   1: alter session set tracefile_identifier='&amp;tfi.'&lt;br /&gt;new   1: alter session set tracefile_identifier='20200520_181319'&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set events 'trace[sql_optimizer.*]';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; var part_key varchar2(10)='P1'&lt;br /&gt;SQL&gt; var param    varchar2(12)='WAITING'&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select --+ gather_plan_statistics or_expand(@sel$1 (1) (2))&lt;br /&gt;  2         count(pad1)&lt;br /&gt;  3    from t1&lt;br /&gt;  4   where part_key = :part_key&lt;br /&gt;  5     and (:param = 'WAITING' and status = 'UNPROCESSED'&lt;br /&gt;  6          or&lt;br /&gt;  7          :param = 'ALL' and status &lt;&gt; 'PENDING');&lt;br /&gt;&lt;br /&gt;COUNT(PAD1)&lt;br /&gt;-----------&lt;br /&gt;       1000&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from dbms_xplan.display_cursor(format=&gt; 'allstats last outline');&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL_ID  fq8b3jumk131t, child number 0&lt;br /&gt;-------------------------------------&lt;br /&gt;An uncaught error happened in prepare_sql_statement : ORA-01403: no data found&lt;br /&gt;&lt;br /&gt;Plan hash value: 3973059565&lt;br /&gt;&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                                      | Name            | Starts | E-Rows | A-Rows |   A-Time   | Buffers |&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT                               |                 |      1 |        |      1 |00:00:00.01 |      83 |&lt;br /&gt;|   1 |  SORT AGGREGATE                                |                 |      1 |      1 |      1 |00:00:00.01 |      83 |&lt;br /&gt;|   2 |   VIEW                                         | VW_ORE_BA8ECEFB |      1 |  91982 |   1000 |00:00:00.01 |      83 |&lt;br /&gt;|   3 |    UNION-ALL                                   |                 |      1 |        |   1000 |00:00:00.01 |      83 |&lt;br /&gt;|*  4 |     FILTER                                     |                 |      1 |        |   1000 |00:00:00.01 |      83 |&lt;br /&gt;|   5 |      PARTITION LIST SINGLE                     |                 |      1 |    999 |   1000 |00:00:00.01 |      83 |&lt;br /&gt;|*  6 |       TABLE ACCESS BY LOCAL INDEX ROWID BATCHED| T1              |      1 |    999 |   1000 |00:00:00.01 |      83 |&lt;br /&gt;|*  7 |        INDEX RANGE SCAN                        | T1_STATUS_I     |      1 |   1000 |   1000 |00:00:00.01 |       6 |&lt;br /&gt;|*  8 |     FILTER                                     |                 |      1 |        |      0 |00:00:00.01 |       0 |&lt;br /&gt;|   9 |      PARTITION LIST SINGLE                     |                 |      0 |  90983 |      0 |00:00:00.01 |       0 |&lt;br /&gt;|* 10 |       TABLE ACCESS FULL                        | T1              |      0 |  90983 |      0 |00:00:00.01 |       0 |&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Outline Data&lt;br /&gt;-------------&lt;br /&gt;&lt;br /&gt;  /*+&lt;br /&gt;      BEGIN_OUTLINE_DATA&lt;br /&gt;      IGNORE_OPTIM_EMBEDDED_HINTS&lt;br /&gt;      OPTIMIZER_FEATURES_ENABLE('18.1.0')&lt;br /&gt;      DB_VERSION('18.1.0')&lt;br /&gt;      ALL_ROWS&lt;br /&gt;      OUTLINE_LEAF(@"SET$9162BF3C_2")&lt;br /&gt;      OUTLINE_LEAF(@"SET$9162BF3C_1")&lt;br /&gt;      OUTLINE_LEAF(@"SET$9162BF3C")&lt;br /&gt;      OR_EXPAND(@"SEL$1" (1) (2))&lt;br /&gt;      OUTLINE_LEAF(@"SEL$BA8ECEFB")&lt;br /&gt;      OUTLINE(@"SEL$1")&lt;br /&gt;      NO_ACCESS(@"SEL$BA8ECEFB" "VW_ORE_BA8ECEFB"@"SEL$BA8ECEFB")&lt;br /&gt;      INDEX_RS_ASC(@"SET$9162BF3C_1" "T1"@"SET$9162BF3C_1" ("T1"."STATUS"))&lt;br /&gt;      BATCH_TABLE_ACCESS_BY_ROWID(@"SET$9162BF3C_1" "T1"@"SET$9162BF3C_1")&lt;br /&gt;      FULL(@"SET$9162BF3C_2" "T1"@"SET$9162BF3C_2")&lt;br /&gt;      END_OUTLINE_DATA&lt;br /&gt;  */&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   4 - filter(:PARAM='WAITING')&lt;br /&gt;   6 - filter("PART_KEY"=:PART_KEY)&lt;br /&gt;   7 - access("STATUS"='UNPROCESSED')&lt;br /&gt;   8 - filter(:PARAM='ALL')&lt;br /&gt;  10 - filter(("STATUS"&lt;&gt;'PENDING' AND "PART_KEY"=:PART_KEY AND (LNNVL(:PARAM='WAITING') OR&lt;br /&gt;              LNNVL("STATUS"='UNPROCESSED'))))&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;54 rows selected.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set events 'trace[sql_optimizer.*] off';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col value for a80&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select value&lt;br /&gt;  2    from v$diag_info&lt;br /&gt;  3   where name='Default Trace File';&lt;br /&gt;&lt;br /&gt;VALUE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;/u01/app/oracle/diag/rdbms/orcl/orcl/trace/orcl_ora_2137_20200520_181319.trc&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;The relevant section of &lt;a href="https://github.com/mvelikikh/oracle/blob/master/blog/202005_or_expansion_and_virtual_columns/orcl_ora_2137_20200520_181319_VCOL.trc#L853"&gt;the trace file&lt;/a&gt; is as follows:&lt;br /&gt;&lt;pre class='brush:sql;highlight:[25,27,28]'&gt;***********************************&lt;br /&gt;Cost-Based OR Expansion&lt;br /&gt;***********************************&lt;br /&gt;ORE: Trying CBQT OR expansion before unnesting&lt;br /&gt;ORE: Checking validity of OR Expansion for query block SEL$1 (#1)&lt;br /&gt;ORE: Predicate chain before QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;&lt;br /&gt;ORE: Predicate chain after QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;OR Expansion on query block SEL$1 (#1)&lt;br /&gt;ORE: Checking validity of OR Expansion for query block SEL$1 (#1)&lt;br /&gt;ORE: Predicate chain before QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;&lt;br /&gt;ORE: Predicate chain after QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;ORE: Using search type: linear&lt;br /&gt;ORE: Checking validity of OR Expansion for query block SEL$1 (#1)&lt;br /&gt;ORE: Predicate chain before QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;&lt;br /&gt;ORE: Predicate chain after QB validity check - SEL$1&lt;br /&gt;"T1"."PART_KEY"=:B1 AND (:B2='WAITING' AND "T1"."STATUS"='UNPROCESSED' OR :B3='ALL' AND "T1"."STATUS"&lt;&gt;'PENDING')&lt;br /&gt;ORE: Checking validity of disjunct chain &lt;br /&gt;&lt;br /&gt;ORE: # conjunction chain - 2&lt;br /&gt;ORE: Checking validity of disjunct chain &lt;br /&gt;&lt;br /&gt;ORE:  Predicate list&lt;br /&gt;P1 : "T1"."PART_KEY"=:B1&lt;br /&gt;P2 : :B1='WAITING'&lt;br /&gt;P3 : "T1"."STATUS"='UNPROCESSED'&lt;br /&gt;P4 : :B1='ALL'&lt;br /&gt;P5 : "T1"."STATUS"&lt;&gt;'PENDING'&lt;br /&gt;&lt;br /&gt; DNF Matrix (Before sorting OR branches)&lt;br /&gt;            P1  P2  P3  P4  P5 &lt;br /&gt;CNJ (#1) :   1   1   1   0   0 &lt;br /&gt;&lt;br /&gt;CNJ (#2) :   1   0   0   1   1 &lt;br /&gt;&lt;/pre&gt;I have made the following observations regarding this issue:&lt;br /&gt;&lt;ul&gt;&lt;li&gt;The virtual column should be on the STATUS column. Neither PART_KEY, nor PAD1 works - they both result in the absence of OR Expansion.&lt;/li&gt;&lt;li&gt;The OR Expansion transformation kicks in if there are extended statistics on the STATUS column, such as: SYS_OP_COMBINED_HASH(STATUS, PART_KEY).&lt;/li&gt;&lt;li&gt;Unsurprisingly, there is OR Expansion when there is an FBI, such as: &lt;pre class="brush:sql"&gt;create index t1_lower_status_i on t1(lower(status)) local;&lt;/pre&gt;&lt;/li&gt;&lt;li&gt;The full outline of the query with OR Expansion does not lead to the OR Expansion transformation in the examples from this article where there was no OR Expansion.&lt;/li&gt;&lt;li&gt;Once again, &lt;b&gt;&lt;u&gt;19c behaves differently&lt;/u&gt;&lt;/b&gt; - there is no OR Expansion in the given examples when 12.2 and 18c performs it. I am going to talk about in the next blog post.&lt;/li&gt;&lt;/ul&gt;&lt;br /&gt;Although I do expect OR Expansion in the queries from this article, I am not able to make a connection between OR Expansion and virtual columns/extended statistics/FBIs in the provided examples.&lt;br /&gt;Hence, this issue is a bit mixed bag for me: I would love to have OR Expansion - the examples were designed after real application queries after all (they benefit from OR Expansion) - it might as well be a bug that was fixed in 19c.&lt;br /&gt;Time will tell. I have raised an SR to follow up on this issue: &lt;a href="https://support.oracle.com/rs?type=sr&amp;id=3-22449907431"&gt;SR 3-22449907431 : OR-Expansion does not work following 19.5 upgrade&lt;/a&gt;. Hopefully, Oracle Support will explain it one day - we have not made any progress during last 2 months which has become customary while working with Oracle Support.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/8370226090326391986/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2020/05/or-expansion-and-virtual-columns.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8370226090326391986'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8370226090326391986'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2020/05/or-expansion-and-virtual-columns.html' title='OR Expansion and Virtual Columns'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-637681655147207295</id><published>2020-04-30T23:00:00.000+06:00</published><updated>2020-04-30T23:00:05.504+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='OJVM'/><title type='text'>Secure Use of Runtime.exec Functionality in Oracle Database</title><content type='html'>Developers wanted to call external programs from the database using a Java class. By default, those commands are run under the database user account which is anything but secure.&lt;br /&gt;Following &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/20/jjdev/Runtime-exe-secure-use.html#GUID-63109A8A-028C-4DFC-B24B-A2A6DB7FAE19"&gt;Oracle security guidelines&lt;/a&gt;, I created a separate low-privileged OS account and configured the database user access to it.&lt;br /&gt;It turns out that this functionality has some limitations and does not work especially well with Grid Infrastructure.&lt;br /&gt;&lt;br /&gt;Here are the details of my setup:&lt;br /&gt;Oracle Grid Infrastructure 19.7 standalone that uses separate OS groups: $ORACLE_HOME/rdbms/lib/config.c:&lt;br /&gt;&lt;pre&gt;#define SS_DBA_GRP "asmdba"&lt;br /&gt;#define SS_OPER_GRP "asmoper"&lt;br /&gt;#define SS_ASM_GRP "asmadmin"&lt;br /&gt;#define SS_BKP_GRP "asmadmin"&lt;br /&gt;#define SS_DGD_GRP "asmadmin"&lt;br /&gt;#define SS_KMT_GRP "asmadmin"&lt;br /&gt;#define SS_RAC_GRP "asmadmin"&lt;br /&gt;&lt;/pre&gt;Oracle Database 19.7 uses the following groups:&lt;br /&gt;&lt;pre&gt;#define SS_DBA_GRP "dba"&lt;br /&gt;#define SS_OPER_GRP "oper"&lt;br /&gt;#define SS_ASM_GRP ""&lt;br /&gt;#define SS_BKP_GRP "backupdba"&lt;br /&gt;#define SS_DGD_GRP "dgdba"&lt;br /&gt;#define SS_KMT_GRP "kmdba"&lt;br /&gt;#define SS_RAC_GRP "racdba"&lt;br /&gt;&lt;/pre&gt;The &lt;b&gt;&lt;i&gt;oracle&lt;/i&gt;&lt;/b&gt; user is the software owner; its group is &lt;b&gt;&lt;i&gt;oinstall&lt;/i&gt;&lt;/b&gt;. The database listener runs from the GI ORACLE_HOME (it does not matter for the purpose of the test case, though, as the issue can be reproduced even with bequeath connections).&lt;br /&gt;&lt;br /&gt;Here is an SQL script that I use to demonstrate the issue:&lt;br /&gt;&lt;pre class='brush:sql'&gt;def user_connect_string=tc/tc@//localhost/pdb&lt;br /&gt;def sys_connect_string="sys/oracle@//localhost/pdb as sysdba"&lt;br /&gt;&lt;br /&gt;set echo on&lt;br /&gt;&lt;br /&gt;spool ojvm_test_case&lt;br /&gt;&lt;br /&gt;connect &amp;sys_connect_string&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  CREATING THE TEST CASE USER&lt;br /&gt;#&lt;br /&gt;&lt;br /&gt;drop user tc cascade;&lt;br /&gt;grant create procedure, create session to tc identified by tc;&lt;br /&gt;&lt;br /&gt;exec dbms_java.grant_permission('TC', 'SYS:java.io.FilePermission', '/usr/bin/who', 'read,execute')&lt;br /&gt;&lt;br /&gt;connect &amp;user_connect_string&lt;br /&gt;&lt;br /&gt;CREATE OR REPLACE AND COMPILE JAVA SOURCE NAMED "OSCommand" AS &lt;br /&gt;import java.io.*; &lt;br /&gt;public class OSCommand {&lt;br /&gt;    public static String Run(String command) {&lt;br /&gt;        final String crlf = "" + (char) 10 + (char) 13;&lt;br /&gt;        final int max_length = 4000;&lt;br /&gt;        String str_out = "";&lt;br /&gt;&lt;br /&gt;        try {&lt;br /&gt;            final Process pr = Runtime.getRuntime().exec(command);&lt;br /&gt;            pr.waitFor();&lt;br /&gt;&lt;br /&gt;            BufferedReader br_in = null;&lt;br /&gt;            try {&lt;br /&gt;                br_in = new BufferedReader(new InputStreamReader(pr.getInputStream()));&lt;br /&gt;                String buff = null;&lt;br /&gt;                while (((buff = br_in.readLine()) != null) &amp; (str_out.length() &lt; max_length)) {&lt;br /&gt;                    System.out.println("Process out :" + buff);&lt;br /&gt;                    str_out += buff + crlf;&lt;br /&gt;                }&lt;br /&gt;                br_in.close();&lt;br /&gt;            } catch (IOException ioe) {&lt;br /&gt;                System.out.println("Exception caught printing process output.");&lt;br /&gt;                ioe.printStackTrace();&lt;br /&gt;            } finally {&lt;br /&gt;                try {&lt;br /&gt;                    br_in.close();&lt;br /&gt;                } catch (Exception ex) {}&lt;br /&gt;            }&lt;br /&gt;&lt;br /&gt;            BufferedReader br_err = null;&lt;br /&gt;            try {&lt;br /&gt;                br_err = new BufferedReader(new InputStreamReader(pr.getErrorStream()));&lt;br /&gt;                String buff = null;&lt;br /&gt;                while (((buff = br_err.readLine()) != null) &amp; (str_out.length() &lt; max_length)) {&lt;br /&gt;                    str_out += buff + crlf;&lt;br /&gt;                }&lt;br /&gt;                br_err.close();&lt;br /&gt;            } catch (IOException ioe) {&lt;br /&gt;                System.out.println("Exception caught printing process error.");&lt;br /&gt;                ioe.printStackTrace();&lt;br /&gt;            } finally {&lt;br /&gt;                try {&lt;br /&gt;                    br_err.close();&lt;br /&gt;                } catch (Exception ex) {}&lt;br /&gt;            }&lt;br /&gt;&lt;br /&gt;        } catch (Exception e) {&lt;br /&gt;            e.printStackTrace();&lt;br /&gt;            return (e.getMessage());&lt;br /&gt;        }&lt;br /&gt;        if (str_out.length() &gt; 4000) str_out = str_out.substring(0, max_length); //limit output&lt;br /&gt;        return str_out;&lt;br /&gt;    }&lt;br /&gt;}&lt;br /&gt;/&lt;br /&gt;&lt;br /&gt;CREATE OR REPLACE FUNCTION OSCommand_Run(Command IN STRING) &lt;br /&gt;RETURN VARCHAR2 IS &lt;br /&gt;LANGUAGE JAVA &lt;br /&gt;NAME 'OSCommand.Run(java.lang.String) return int';&lt;br /&gt;/&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  Test #1: call OS command&lt;br /&gt;#&lt;br /&gt;&lt;br /&gt;select oscommand_run('/usr/bin/who') from dual; &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  ENABLING OJVM SECURITY&lt;br /&gt;#&lt;br /&gt;&lt;br /&gt;conn &amp;sys_connect_string&lt;br /&gt;&lt;br /&gt;exec dbms_java.set_runtime_exec_credentials('TC', 'oraexec', 'test');&lt;br /&gt;commit;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;connect &amp;user_connect_string&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  Test #2: call OS command after Java credentials were set&lt;br /&gt;#&lt;br /&gt;&lt;br /&gt;select oscommand_run('/usr/bin/who') from dual; &lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  Test #3: getting additional output&lt;br /&gt;#&lt;br /&gt;set serverout on&lt;br /&gt;exec dbms_java.set_output(100000)&lt;br /&gt;select oscommand_run('/usr/bin/who') from dual; &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;spo off&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;In a nutshell, the script creates a separate user and grants it necessary privileges to run the external command &lt;b&gt;&lt;i&gt;/usr/bin/who&lt;/i&gt;&lt;/b&gt; using a Java class (that might be copied from somewhere over the Internet judging by how it handles exceptions).&lt;br /&gt;When I call that command for the first time, I get the following output:&lt;br /&gt;&lt;pre class='brush:sql'&gt;SQL&gt; select oscommand_run('/usr/bin/who') from dual;&lt;br /&gt;&lt;br /&gt;OSCOMMAND_RUN('/USR/BIN/WHO')                                                   &lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;oracle   pts/0        2020-04-29 09:06 (:pts/2:S.0)&lt;br /&gt;ec2-user pts/2        2020-04-29 09:06 (172.17.1.27)&lt;br /&gt;ec2-user pts/3        2020-04-29 09:06 (172.17.1.27)&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;There is an OS account &lt;b&gt;&lt;i&gt;oraexec&lt;/i&gt;&lt;/b&gt; with a password test that is created on the database server host, and I associate that account to run any external commands initiated by the &lt;b&gt;&lt;i&gt;TC&lt;/i&gt;&lt;/b&gt; database user (&lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/20/jjdev/DBMS-JAVA-package.html#GUID-7DB95C10-0386-4E88-991A-2496B325082F"&gt;Java Developer's Guide&lt;/a&gt;):&lt;br /&gt;&lt;pre class='brush:sql'&gt;exec dbms_java.set_runtime_exec_credentials('TC', 'oraexec', 'test');&lt;br /&gt;&lt;/pre&gt;The subsequent calls of the previously working function, now starts failing:&lt;br /&gt;&lt;pre class='brush:sql'&gt;SQL&gt; select oscommand_run('/usr/bin/who') from dual;&lt;br /&gt;&lt;br /&gt;OSCOMMAND_RUN('/USR/BIN/WHO')                                                   &lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Cannot run program "/usr/bin/who": cannot execute /u01/app/oracle/product/db_19.&lt;br /&gt;7.0/bin/jssu                                                                    &lt;br /&gt;&lt;/pre&gt;OJVM can produce additional output, which in this case is not particularly helpful:&lt;br /&gt;&lt;pre class='brush:sql'&gt;SQL&gt; set serverout on&lt;br /&gt;SQL&gt; exec dbms_java.set_output(100000)&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt; select oscommand_run('/usr/bin/who') from dual;&lt;br /&gt;&lt;br /&gt;OSCOMMAND_RUN('/USR/BIN/WHO')                                                   &lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Cannot run program "/usr/bin/who": cannot execute /u01/app/oracle/product/db_19.&lt;br /&gt;7.0/bin/jssu                                                                    &lt;br /&gt;                                                                                &lt;br /&gt;&lt;br /&gt;java.io.IOException: Cannot run program "/usr/bin/who": cannot execute          &lt;br /&gt;/u01/app/oracle/product/db_19.7.0/bin/jssu                                      &lt;br /&gt; at java.lang.ProcessBuilder.start(ProcessBuilder.java:1057)                    &lt;br /&gt; at java.lang.Runtime.exec(Runtime.java:620)                                    &lt;br /&gt; at java.lang.Runtime.exec(Runtime.java:450)                                    &lt;br /&gt; at java.lang.Runtime.exec(Runtime.java:347)                                    &lt;br /&gt; at OSCommand.Run(OSCommand:11)                                                 &lt;br /&gt;Caused by: java.io.IOException: cannot execute                                  &lt;br /&gt;/u01/app/oracle/product/db_19.7.0/bin/jssu                                      &lt;br /&gt; at java.lang.OracleProcess.create(Native Method)                               &lt;br /&gt; at java.lang.OracleProcess.construct(OracleProcess.java:112)                   &lt;br /&gt; at java.lang.OracleProcess.&lt;init&gt;(OracleProcess.java:42)                       &lt;br /&gt; at java.lang.OracleProcess.start(OracleProcess.java:383)                       &lt;br /&gt; at java.lang.ProcessBuilder.start(ProcessBuilder.java:1038)                    &lt;br /&gt; ... 4 more                                                                     &lt;br /&gt;&lt;/pre&gt;&lt;b&gt;&lt;i&gt;jssu&lt;/i&gt;&lt;/b&gt; is an Oracle's way to switch to another user per my knowledge. I know that the database uses it when it runs external jobs through DBMS_SCHEDULER. The &lt;b&gt;&lt;i&gt;jssu&lt;/i&gt;&lt;/b&gt; name itself was likely inspired by the Linux 'su' command (Switch User).&lt;br /&gt;The first thing that I do is to check its permissions since I am quite familiar with certain issues when those permissions can go sideways due to patching actions:&lt;br /&gt;&lt;pre class='brush:sql'&gt;[oracle@ip-172-17-31-160 lib]$ ls -la $ORACLE_HOME/bin/jssu&lt;br /&gt;-rwsr-x---. 1 root oinstall 2327920 Apr 28 15:14 /u01/app/oracle/product/db_19.7.0/bin/jssu&lt;br /&gt;&lt;/pre&gt;The permissions are fine - its owned by root and has the setuid bit set.&lt;br /&gt;In order to further diagnose this issue, I run strace against the server process and find this:&lt;br /&gt;&lt;pre&gt;stat("/u01/app/oracle/product/db_19.7.0/bin/jssu", {st_mode=S_IFREG|S_ISUID|0750, st_size=2327920, ...}) = 0&lt;br /&gt;geteuid()                         = 54321&lt;br /&gt;getegid()                         = 54331&lt;br /&gt;&lt;/pre&gt;The uid &lt;b&gt;&lt;i&gt;54321&lt;/i&gt;&lt;/b&gt; is the oracle user, however, the gid &lt;b&gt;&lt;i&gt;54331&lt;/i&gt;&lt;/b&gt; is asmadmin (the OSASM group):&lt;br /&gt;&lt;pre&gt;[oracle@ip-172-17-31-160 lib]$ grep 54321 /etc/passwd&lt;br /&gt;oracle:x:54321:54321::/home/oracle:/bin/bash&lt;br /&gt;[oracle@ip-172-17-31-160 lib]$ grep 54331 /etc/group&lt;br /&gt;asmadmin:x:54331:oracle&lt;br /&gt;&lt;/pre&gt;When there is a role-separation in place, the Oracle binary is owned by the OSASM group:&lt;br /&gt;&lt;pre class='brush:sql'&gt;[oracle@ip-172-17-31-160 lib]$ ls -ls /u01/app/oracle/product/db_19.7.0/bin/oracle&lt;br /&gt;432852 -rwsr-s--x. 1 oracle asmadmin 443232296 Apr 28 15:15 /u01/app/oracle/product/db_19.7.0/bin/oracle&lt;br /&gt;&lt;/pre&gt;Oracle processes have the following groups:&lt;br /&gt;&lt;pre&gt;# ps -o rgid,egid,cmd -p 27280&lt;br /&gt; RGID  EGID CMD&lt;br /&gt;54321 54331 oracleorcl (LOCAL=NO)&lt;br /&gt;&lt;/pre&gt;Where RGID=oinstall, EGID=asmadmin (OSASM):&lt;br /&gt;&lt;pre&gt;# grep 543[23]1 /etc/group&lt;br /&gt;oinstall:x:54321:oracle&lt;br /&gt;asmadmin:x:54331:oracle&lt;br /&gt;&lt;/pre&gt;The OJVM code expects that &lt;b&gt;&lt;i&gt;jssu&lt;/i&gt;&lt;/b&gt; is owned by the OSASM group in this case, so that a possible workaround for this issue is to amend the &lt;b&gt;&lt;i&gt;jssu&lt;/i&gt;&lt;/b&gt; permissions as follows:&lt;br /&gt;&lt;pre class='brush:sql'&gt;[oracle@ip-172-17-31-160 lib]$ ls -ls /u01/app/oracle/product/db_19.7.0/bin/jssu&lt;br /&gt;2276 -rwsr-x---. 1 root asmadmin 2327920 Apr 28 15:14 /u01/app/oracle/product/db_19.7.0/bin/jssu&lt;br /&gt;&lt;/pre&gt;Obviously it cannot be used as a long-term solution as I recall that &lt;b&gt;&lt;i&gt;jssu&lt;/i&gt;&lt;/b&gt; permissions might be changed when relink is run, or when some patches are applied.&lt;br /&gt;There permissions also work fine with external jobs that use credentials.&lt;br /&gt;I opened an SR with Oracle Support a few months ago and it has not gone anywhere yet.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/637681655147207295/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2020/04/secure-use-of-runtimeexec-functionality.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/637681655147207295'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/637681655147207295'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2020/04/secure-use-of-runtimeexec-functionality.html' title='Secure Use of Runtime.exec Functionality in Oracle Database'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-4332927447276207848</id><published>2020-03-03T23:30:00.000+06:00</published><updated>2020-03-03T23:30:09.561+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='DBMS_LOGMNR'/><title type='text'>Using LogMiner to Identify Redo Tag for Transactions</title><content type='html'>I was asked if there is a way to identify what redo tag was set for a specific transaction.&lt;br /&gt;&lt;br /&gt;There is a document that answers the question &lt;b&gt;&lt;i&gt;if&lt;/i&gt;&lt;/b&gt; any tag was set without clarifying &lt;b&gt;&lt;i&gt;what&lt;/i&gt;&lt;/b&gt; tag was set specifically:&lt;br /&gt;&lt;a href="https://support.oracle.com/rs?type=doc&amp;id=740574.1"&gt;Using Logminer to Identify if a Non-NULL Tag Has Been Set Using DBMS_STREAMS.SET_TAG (Doc ID 740574.1)&lt;/a&gt;&lt;br /&gt;Besides, LogDump can be used to display the tag information when GoldenGate is in use: &lt;a href="https://docs.oracle.com/en/middleware/goldengate/core/19.1/logdump-ref/logdump-commands.html#GUID-9C86F9BB-461D-4002-B517-CB48038A4F3A"&gt;GGSTOKEN&lt;/a&gt;.&lt;br /&gt;&lt;br /&gt;My experiments revealed that the required information can be obtained using &lt;b&gt;&lt;i&gt;X$LOGMNR_CONTENTS.DUMP_INFO&lt;/i&gt;&lt;/b&gt; as the example below demonstrates.&lt;br /&gt;&lt;pre class='brush:sql;highlight:[24,33,46,53,70,81]'&gt;SYS@PDB&gt; grant create session, create table, select_catalog_role to tc identified by tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SYS@PDB&gt;&lt;br /&gt;SYS@PDB&gt; grant execute on dbms_streams_adm to tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SYS@PDB&gt;&lt;br /&gt;SYS@PDB&gt; alter user tc quota 100m on users;&lt;br /&gt;&lt;br /&gt;User altered.&lt;br /&gt;&lt;br /&gt;SYS@PDB&gt;&lt;br /&gt;SYS@PDB&gt; conn tc/tc@pdb&lt;br /&gt;Connected.&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; select current_scn from v$database;&lt;br /&gt;&lt;br /&gt;CURRENT_SCN&lt;br /&gt;-----------&lt;br /&gt;    2221571&lt;br /&gt;&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; create table t(id int, s varchar2(30))&lt;br /&gt;  2    segment creation immediate;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; exec dbms_streams_adm.set_tag(hextoraw('112233'))&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; insert into t values (1, 'tag_1');&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;TC@PDB&gt; select dbms_transaction.local_transaction_id from dual;&lt;br /&gt;&lt;br /&gt;LOCAL_TRANSACTION_ID&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;3.29.732&lt;br /&gt;&lt;br /&gt;TC@PDB&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; exec dbms_streams_adm.set_tag(hextoraw('deadbeef'))&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; insert into t values (11, 'tag_1');&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;TC@PDB&gt; insert into t values (12, 'tag_1');&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;TC@PDB&gt; select dbms_transaction.local_transaction_id from dual;&lt;br /&gt;&lt;br /&gt;LOCAL_TRANSACTION_ID&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;8.26.689&lt;br /&gt;&lt;br /&gt;TC@PDB&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; select current_scn from v$database;&lt;br /&gt;&lt;br /&gt;CURRENT_SCN&lt;br /&gt;-----------&lt;br /&gt;    2221592&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Here is summary information for the transactions above:&lt;br /&gt;&lt;style type="text/css"&gt;th.awrbg {     font: bold 12pt Arial,Helvetica,Geneva,sans-serif;     color: White;     background: #0066CC;     padding-left: 4px;     padding-right: 4px;     padding-bottom: 2px; } td.awrc {     font: 12pt Arial,Helvetica,Geneva,sans-serif;     color: black;     background: #FFFFCC;     vertical-align: top; } td.awrnc {     font: 12pt Arial,Helvetica,Geneva,sans-serif;     color: black;     background: White;     vertical-align: top; }  td.error {     color: red; } &lt;/style&gt;&lt;br /&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th class="awrbg"&gt;TRANSACTION&lt;/th&gt;&lt;th class="awrbg"&gt;TAG&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc"&gt;3.29.732&lt;/td&gt;&lt;td class="awrc"&gt;112233&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc"&gt;8.26.689&lt;/td&gt;&lt;td class="awrc"&gt;DEADBEEF&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt; &lt;/table&gt;&lt;br/&gt;&lt;br /&gt;The following query shows only the redo opcode &lt;b&gt;&lt;i&gt;5.20&lt;/i&gt;&lt;/b&gt; (Transaction Audit) rows for these transactions:&lt;br /&gt;&lt;pre class='brush:sql;highlight:[42,56]'&gt;SQL&gt; col log_file old_v log_file&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select member log_file &lt;br /&gt;  2    from v$log l, &lt;br /&gt;  3         v$logfile f&lt;br /&gt;  4   where l.status = 'CURRENT' &lt;br /&gt;  5     and f.group# = l.group#;&lt;br /&gt;&lt;br /&gt;LOG_FILE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;/opt/oracle/oradata/ORCLCDB/redo02.log&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec dbms_logmnr.add_logfile('&amp;log_file.')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec dbms_logmnr.start_logmnr(options =&gt; dbms_logmnr.dict_from_online_catalog)&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt; select xidusn, xidslt, xidsqn, &lt;br /&gt;  2        dump_info &lt;br /&gt;  3   from x$logmnr_contents&lt;br /&gt;  4  where (xidusn, xidslt, xidsqn) in ((3,29,732),(8,26,689)) &lt;br /&gt;  5    and scn between 2221571 and 2221592 &lt;br /&gt;  6    and component_id = 5&lt;br /&gt;  7    and opcode = 20;&lt;br /&gt;&lt;br /&gt;    XIDUSN     XIDSLT     XIDSQN DUMP_INFO                                                                                           &lt;br /&gt;---------- ---------- ---------- ----------------------------------------------------------------------------------------------------&lt;br /&gt;         3         29        732 CHANGE #3 MEDIA RECOVERY MARKER CON_ID:3 SCN:0x0000000000000000 SEQ:0 OP:5.20 ENC:0 FLG:0x0000      &lt;br /&gt;                                 session number   = 264                                                                              &lt;br /&gt;                                 serial  number   = 29041                                                                            &lt;br /&gt;                                 transaction name =                                                                                  &lt;br /&gt;                                 version 318767104                                                                                   &lt;br /&gt;                                 audit sessionid 24                                                                                  &lt;br /&gt;                                 Client Id =                                                                                         &lt;br /&gt;                                 login   username = TC                                                                               &lt;br /&gt;                                 REPL MARKER:                                                                                        &lt;br /&gt;                                  06 00 09 00 00 00 01 00 03 11 22 33                                                                &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;    XIDUSN     XIDSLT     XIDSQN DUMP_INFO                                                                                           &lt;br /&gt;---------- ---------- ---------- ----------------------------------------------------------------------------------------------------&lt;br /&gt;         8         26        689 CHANGE #3 MEDIA RECOVERY MARKER CON_ID:3 SCN:0x0000000000000000 SEQ:0 OP:5.20 ENC:0 FLG:0x0000      &lt;br /&gt;                                 session number   = 264                                                                              &lt;br /&gt;                                 serial  number   = 29041                                                                            &lt;br /&gt;                                 transaction name =                                                                                  &lt;br /&gt;                                 version 318767104                                                                                   &lt;br /&gt;                                 audit sessionid 24                                                                                  &lt;br /&gt;                                 Client Id =                                                                                         &lt;br /&gt;                                 login   username = TC                                                                               &lt;br /&gt;                                 REPL MARKER:                                                                                        &lt;br /&gt;                                  06 00 0a 00 00 00 01 00 04 de ad be ef     &lt;br /&gt;&lt;/pre&gt;It appears that the 9th byte of a &lt;b&gt;&lt;i&gt;REPL MARKER&lt;/i&gt;&lt;/b&gt; value stores the length of the tag. Therefore, it is possible to extract a tag using the following query:&lt;br /&gt;&lt;pre class='brush:sql;highlight:[16,30]'&gt;SQL&gt; select xidusn, xidslt, xidsqn, repl_marker, &lt;br /&gt;  2         utl_raw.substr(repl_marker, 10, to_number(utl_raw.substr(repl_marker, 9, 1), 'xxxxxxxxxx')) tag,&lt;br /&gt;  3         dump_info&lt;br /&gt;  4    from (&lt;br /&gt;  5          select xidusn, xidslt, xidsqn, &lt;br /&gt;  6                 hextoraw(replace(regexp_substr(dump_info, 'REPL MARKER:.(.*).', 1, 1, 'n', 1), ' ')) repl_marker, &lt;br /&gt;  7                 dump_info &lt;br /&gt;  8            from x$logmnr_contents&lt;br /&gt;  9           where (xidusn, xidslt, xidsqn) in ((3,29,732),(8,26,689)) &lt;br /&gt; 10             and scn between 2221571 and 2221592 &lt;br /&gt; 11             and component_id = 5&lt;br /&gt; 12             and opcode = 20);&lt;br /&gt;&lt;br /&gt;    XIDUSN     XIDSLT     XIDSQN REPL_MARKER                TAG        DUMP_INFO                                                                                           &lt;br /&gt;---------- ---------- ---------- -------------------------- ---------- ----------------------------------------------------------------------------------------------------&lt;br /&gt;         3         29        732 060009000000010003112233   112233     CHANGE #3 MEDIA RECOVERY MARKER CON_ID:3 SCN:0x0000000000000000 SEQ:0 OP:5.20 ENC:0 FLG:0x0000      &lt;br /&gt;                                                                       session number   = 264                                                                              &lt;br /&gt;                                                                       serial  number   = 29041                                                                            &lt;br /&gt;                                                                       transaction name =                                                                                  &lt;br /&gt;                                                                       version 318767104                                                                                   &lt;br /&gt;                                                                       audit sessionid 24                                                                                  &lt;br /&gt;                                                                       Client Id =                                                                                         &lt;br /&gt;                                                                       login   username = TC                                                                               &lt;br /&gt;                                                                       REPL MARKER:                                                                                        &lt;br /&gt;                                                                        06 00 09 00 00 00 01 00 03 11 22 33                                                                &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;    XIDUSN     XIDSLT     XIDSQN REPL_MARKER                TAG        DUMP_INFO                                                                                           &lt;br /&gt;---------- ---------- ---------- -------------------------- ---------- ----------------------------------------------------------------------------------------------------&lt;br /&gt;         8         26        689 06000A000000010004DEADBEEF DEADBEEF   CHANGE #3 MEDIA RECOVERY MARKER CON_ID:3 SCN:0x0000000000000000 SEQ:0 OP:5.20 ENC:0 FLG:0x0000      &lt;br /&gt;                                                                       session number   = 264                                                                              &lt;br /&gt;                                                                       serial  number   = 29041                                                                            &lt;br /&gt;                                                                       transaction name =                                                                                  &lt;br /&gt;                                                                       version 318767104                                                                                   &lt;br /&gt;                                                                       audit sessionid 24                                                                                  &lt;br /&gt;                                                                       Client Id =                                                                                         &lt;br /&gt;                                                                       login   username = TC                                                                               &lt;br /&gt;                                                                       REPL MARKER:                                                                                        &lt;br /&gt;                                                                        06 00 0a 00 00 00 01 00 04 de ad be ef  &lt;br /&gt;&lt;/pre&gt;It is quite handy that &lt;b&gt;&lt;i&gt;X$LOGMNR_CONTENTS.DUMP_INFO&lt;/i&gt;&lt;/b&gt; contains the same or, at least, the subset of the information present in the redo log dump, that allows to use it for sophisticated analysis in SQL*Plus without resorting to low-level dumps or the LogDump utility of Oracle GoldenGate.&lt;br /&gt;I was using a vanilla 19.3 database on Linux for these experiments.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/4332927447276207848/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2020/03/using-logminer-to-identify-redo-tag-for.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4332927447276207848'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4332927447276207848'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2020/03/using-logminer-to-identify-redo-tag-for.html' title='Using LogMiner to Identify Redo Tag for Transactions'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-3205006207654820061</id><published>2020-02-01T23:00:00.000+06:00</published><updated>2020-02-25T00:40:37.404+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='sql_macro'/><title type='text'>Tracing SQL Macro Expansion</title><content type='html'>I decided to take a look at what events Oracle provides to diagnose or troubleshoot SQL Macro Expansions.&lt;br /&gt;For that, I took almost the same code that I used before: &lt;a href="https://gist.github.com/mvelikikh/01eb283d6c053d8631f16f21e1bc58e3"&gt;SQL Macro script&lt;/a&gt;&lt;br /&gt;&lt;pre class='brush:sql'&gt;drop table t;&lt;br /&gt;drop table t1;&lt;br /&gt;drop table t2;&lt;br /&gt;&lt;br /&gt;CREATE OR REPLACE FUNCTION sample(t DBMS_TF.Table_t, how_many number DEFAULT 5)&lt;br /&gt;RETURN VARCHAR2 SQL_MACRO&lt;br /&gt;AS &lt;br /&gt;BEGIN &lt;br /&gt;  RETURN q'[SELECT * &lt;br /&gt;              FROM t&lt;br /&gt;      WHERE rownum &lt;= how_many]';&lt;br /&gt;END sample;&lt;br /&gt;/&lt;br /&gt;&lt;br /&gt;create table t&lt;br /&gt;as&lt;br /&gt;select n&lt;br /&gt;  from xmltable('1 to 10'&lt;br /&gt;  columns&lt;br /&gt;    n int path '.');&lt;br /&gt;&lt;br /&gt;create table t1&lt;br /&gt;as&lt;br /&gt;select n,&lt;br /&gt;       'val_'||to_char(n, 'fm00') val&lt;br /&gt;  from xmltable('1 to 10'&lt;br /&gt;  columns&lt;br /&gt;    n int path '.');&lt;br /&gt;&lt;br /&gt;create table t2&lt;br /&gt;as&lt;br /&gt;select 'val_'||to_char(n, 'fm00') s&lt;br /&gt;  from xmltable('1 to 10'&lt;br /&gt;  columns&lt;br /&gt;    n int path '.');&lt;br /&gt;&lt;br /&gt;select * from t1;&lt;br /&gt;select * from t2;&lt;br /&gt;&lt;br /&gt;select *&lt;br /&gt;  from sample(t1, 3);&lt;br /&gt;&lt;br /&gt;select *&lt;br /&gt;  from sample(t1);&lt;br /&gt;&lt;br /&gt;select *&lt;br /&gt;  from sample(t2);&lt;br /&gt;&lt;/pre&gt;A query failed when I was trying to supply the table T - which is the same that is used in the SQL macro's definition: &lt;pre class='brush:sql'&gt;SQL&gt; select *&lt;br /&gt;  2    from sample(t);&lt;br /&gt;  from sample(t)&lt;br /&gt;               *&lt;br /&gt;ERROR at line 2:&lt;br /&gt;ORA-32039: recursive WITH clause must have column alias list&lt;br /&gt;&lt;/pre&gt;The errorstack dump for &lt;b&gt;&lt;i&gt;ORA-32039&lt;/i&gt;&lt;/b&gt; (level=3) did not provide much information about the underlying cause: &lt;pre class='brush:sql'&gt;----- Error Stack Dump -----&lt;br /&gt;&amp;lt;error barrier&amp;gt; at 0x7ffd69f7aaf0 placed dbkda.c@296&lt;br /&gt;ORA-32039: recursive WITH clause must have column alias list&lt;br /&gt;----- Current SQL Statement for this session (sql_id=d3ktrfsd4s0sr) -----&lt;br /&gt;select * from sample(t)&lt;br /&gt;&lt;/pre&gt;SQL Trace was referring to the same statement: &lt;pre class='brush:sql'&gt;PARSE ERROR #140320112869816:len=24 dep=0 uid=119 oct=3 lid=119 tim=1054524149653 err=32039&lt;br /&gt;select * from sample(t)&lt;br /&gt;&lt;/pre&gt;It showed the following statement, though: &lt;pre class='brush:sql'&gt;PARSING IN CURSOR #140320116348624 len=446 dep=1 uid=119 oct=47 lid=119 tim=1054472624364 hv=3547957408 ad='7cda6688' sqlid='9awjhv79rm250'&lt;br /&gt;&lt;br /&gt;declare&lt;br /&gt;t0 DBMS_TF.Table_t := DBMS_TF.Table_t(column =&gt; :0);&lt;br /&gt;&lt;br /&gt;begin&lt;br /&gt;:macro_text := "SAMPLE"(t0);&lt;br /&gt;end;&lt;br /&gt;&lt;/pre&gt;While studying those &lt;b&gt;&lt;i&gt;qksptfSQM&lt;/i&gt;&lt;/b&gt; functions, namely: &lt;b&gt;&lt;i&gt;qksptfSQM_GetTxt&lt;/i&gt;&lt;/b&gt; and &lt;b&gt;&lt;i&gt;qksptfSQM_Template&lt;/i&gt;&lt;/b&gt;, I found that they are calling to the &lt;b&gt;&lt;i&gt;PTF_Comp&lt;/i&gt;&lt;/b&gt; UTS component (Polymorphic Table Functions Compilation (qksptf)): &lt;pre class='brush:sql;highlight:[2]'&gt;   0x000000000f75c87a &amp;lt;+4202&gt;:  mov    $0x6000,%ecx&lt;br /&gt;   0x000000000f75c87f &amp;lt;+4207&gt;:  mov    $0x205018b,%esi&lt;br /&gt;   0x000000000f75c884 &amp;lt;+4212&gt;:  mov    $0x2,%edx&lt;br /&gt;   0x000000000f75c889 &amp;lt;+4217&gt;:  mov    -0x200(%rbp),%r8&lt;br /&gt;   0x000000000f75c890 &amp;lt;+4224&gt;:  mov    -0xcb58(%rbx),%rdi&lt;br /&gt;   0x000000000f75c897 &amp;lt;+4231&gt;:  callq  0x485cef0 &amp;lt;dbgtCtrl_intEvalCtrlEvent&gt;&lt;br /&gt;&lt;/pre&gt;Therefore, I enabled &lt;b&gt;&lt;i&gt;PTF_Comp&lt;/i&gt;&lt;/b&gt; tracing: &lt;pre class='brush:sql'&gt;alter session set events 'trace[ptf_comp]' tracefile_identifier=ptf_comp;&lt;br /&gt;&lt;/pre&gt;Here is what I got in the trace file: &lt;pre class='brush:sql;highlight:[19]'&gt;qksptfSQM_GetTxt(): Anonymous Block&lt;br /&gt;===================================&lt;br /&gt;&lt;br /&gt;declare&lt;br /&gt;t0 DBMS_TF.Table_t := DBMS_TF.Table_t(column =&gt; :0);&lt;br /&gt;&lt;br /&gt;begin&lt;br /&gt;:macro_text := "SAMPLE"(t0);&lt;br /&gt;end;&lt;br /&gt;qksptfSQM_GetTxt(): Macro Text&lt;br /&gt;==============================&lt;br /&gt;&lt;br /&gt;SELECT *&lt;br /&gt;              FROM t&lt;br /&gt;             WHERE rownum &lt;= how_many&lt;br /&gt;qksptfSQM_Template(): Template Text&lt;br /&gt;===================================&lt;br /&gt;&lt;br /&gt;with  T as (select  /*+ INLINE */ * from "MY_USER"."T")&lt;br /&gt;select "SYS__$".*&lt;br /&gt;from (select 5 "HOW_MANY" from SYS.DUAL) "SAMPLE",&lt;br /&gt;     lateral(SELECT *&lt;br /&gt;              FROM t&lt;br /&gt;             WHERE rownum &lt;= how_many) "SYS__$"&lt;br /&gt;&lt;/pre&gt;Obviously, the &lt;b&gt;&lt;i&gt;ORA-32039&lt;/i&gt;&lt;/b&gt; error is absolutely legit in this case and the &lt;b&gt;&lt;i&gt;PTF_Comp&lt;/i&gt;&lt;/b&gt; tracing clearly shows where the issue is.  It highlights one of the current limitations of that functionality in Oracle 19.6. Beside it demonstrates how literals (&lt;b&gt;&lt;i&gt;HOW_MANY&lt;/i&gt;&lt;/b&gt; in the example above) are passed through a subquery and joined to a lateral view - that approach has certain restrictions.  Apparently there seem to be more restrictions than that according to &lt;b&gt;&lt;i&gt;$ORACLE_HOME/plsql/mesg/pcmus.msg&lt;/i&gt;&lt;/b&gt;: &lt;pre class='brush:sql;highlight:[1,6,12,22,31,42,48]'&gt;776, 0, "SQL macro can only return character return types"&lt;br /&gt;// INDEX: "SQL macro"&lt;br /&gt;// RELEASE: 20.1&lt;br /&gt;// CAUSE: A SQL macro function returned a type that was not a character type like VARCHAR2.&lt;br /&gt;// ACTION:  Change the return type to one of the character types.&lt;br /&gt;777, 0, "scalar SQL macro cannot have argument of type DBMS_TF.TABLE_T"&lt;br /&gt;// INDEX: "SQL macro"&lt;br /&gt;// RELEASE: 20.1&lt;br /&gt;// CAUSE: DBMS_TF.TABLE_T argument was used for scalar macros.&lt;br /&gt;// ACTION:  Change the argument type to a type other than&lt;br /&gt;//          DBMS_TF.TABLE_T.&lt;br /&gt;778, 0, "PARTITION BY, ORDER BY, CLUSTER BY, or PARALLEL_ENABLE are not allowed for SQL macros"&lt;br /&gt;// MANUAL: partition by, order by, cluster by, deterministic, authid or parallel_enable&lt;br /&gt;//         not allowed for SQL macros&lt;br /&gt;// INDEX: "SQL macro"&lt;br /&gt;// RELEASE: 20.1&lt;br /&gt;// CAUSE: An attempt was made to use the PARTITION BY, ORDER BY, CLUSTER BY,&lt;br /&gt;//        DETERMINISTIC, AUTHID, or PARALLEL_ENABLE clause in a&lt;br /&gt;//        SQL macro.&lt;br /&gt;// ACTION:  Do not specify the PARTITION BY, CLUSTER BY, ORDER BY, DETERMINISTIC, AUTHID, or&lt;br /&gt;//          PARALLEL_ENABLE clause with a SQL macro.&lt;br /&gt;779, 0, "Formal parameters of type TABLE cannot have a default value."&lt;br /&gt;// MANUAL: A default value cannot be specified for parameter of type TABLE.&lt;br /&gt;// INDEX:  "SQL macros"&lt;br /&gt;// RELEASE: 20.1&lt;br /&gt;// CAUSE: A default value was specified for a formal parameter of type TABLE&lt;br /&gt;//        in a SQL macro declaration.&lt;br /&gt;// ACTION: Remove the default value from the parameter of type TABLE in&lt;br /&gt;//         the SQL macro declaration.&lt;br /&gt;//&lt;br /&gt;780, 0, "Formal parameters of type COLUMNS may only have a NULL default value."&lt;br /&gt;// MANUAL:  Parameters of type COLUMNS can only have a NULL default value.&lt;br /&gt;// INDEX:  "SQL macros"&lt;br /&gt;// RELEASE: 20.1&lt;br /&gt;// CAUSE:  A non-NULL default value was specified for a formal parameter of type COLUMNS&lt;br /&gt;//        in a polymorphic table function.&lt;br /&gt;// ACTION: Change the default value for the parameter of type COLUMNS to&lt;br /&gt;//         have a NULL default value in the polymorphic table function&lt;br /&gt;//         specification.&lt;br /&gt;//&lt;br /&gt;//&lt;br /&gt;781, 0, "SQL macro cannot be a type method"&lt;br /&gt;// INDEX:  "SQL macros"&lt;br /&gt;// RELEASE: 20.1&lt;br /&gt;// CAUSE: The SQL macro could not be declared as a method in a type specification.&lt;br /&gt;// ACTION: Use the SQL macro as a package function or a top level function.&lt;br /&gt;//&lt;br /&gt;782, 0, "A package containing SQL macro cannot be an invoker's rights package."&lt;br /&gt;// INDEX:  "SQL macros"&lt;br /&gt;// RELEASE: 20.1&lt;br /&gt;// CAUSE: A package could not be declared as AUTHID CURRENT_USER if it had a SQL&lt;br /&gt;//        macro function declared inside.&lt;br /&gt;// ACTION: Declare the package as AUTHID DEFINER if it contains one or more&lt;br /&gt;//         SQL macro functions.&lt;br /&gt;&lt;/pre&gt;Keep in mind that this functionality is not officially released and only a limited subset of it is available in 19.6: &lt;a href="https://mvelikikh.blogspot.com/2020/01/bug-30324180-sql-macro-should-be.html"&gt;Bug 30324180 SQL Macro should be backported to 19.5&lt;/a&gt;. Hence, the final version of SQL Macro in Oracle 20 might be different from what we have now in Oracle 19.6.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/3205006207654820061/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2020/02/tracing-sql-macro-expansion.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3205006207654820061'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3205006207654820061'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2020/02/tracing-sql-macro-expansion.html' title='Tracing SQL Macro Expansion'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-6363677790004157199</id><published>2020-01-20T23:00:00.000+06:00</published><updated>2020-01-21T15:07:09.309+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='sql_macro'/><title type='text'>Bug 30324180 SQL Macro should be backported to 19.5</title><content type='html'>When Oracle released 19.6 release update, I went to the usual My Oracle Support (MOS) note: &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=2523220.1"&gt;Database 19 Release Updates and Revisions Bugs Fixed Lists (Doc ID 2523220.1)&lt;/a&gt; to find out what exactly was included there that might be of interest for me. Surprisingly, the note was not updated in several days, so that I decided to download the release update and take a look at it myself.&lt;br /&gt;Oracle patches follow a well-defined structure that was described by Martin Berger: &lt;a href="http://berxblog.blogspot.com/2019/10/oracle-patches-patchfiles-anatomy.html"&gt; Oracle patches - a patchfiles anatomy&lt;/a&gt;.&lt;br /&gt;&lt;br /&gt;One bug drew my eye:&lt;br /&gt;&lt;pre&gt;&amp;lt;bug description="SQM MACRO SHOULD BE BACKPORTED TO 19.5" number="30324180"/&amp;gt;&lt;br /&gt;&lt;/pre&gt;The relevant note contains some important information, albeit without any examples:&lt;br /&gt;&lt;a href="https://support.oracle.com/rs?type=doc&amp;id=30324180.8"&gt;Bug 30324180 - SQL Macro should be backported to 19.5 (Doc ID 30324180.8)&lt;/a&gt;&lt;br /&gt;Thankfully, there is a clue that the table semantics macro should be supported, so that I decided to skim through an excellent Keith Laker's presentation on that subject: &lt;a href="https://static.rainfocus.com/oracle/oow19/sess/1553765929286001lSFW/PF/SQL-Macros-Overview_1569084990942001SWly.pdf"&gt;A New Approach to Simplifying Complex SQL-Using SQL Macros in Database 20c&lt;/a&gt;.&lt;br /&gt;&lt;br /&gt;After a bit of toing and froing, I constructed the following example that demonstrates this new functionality (as it seems).&lt;br /&gt;&lt;pre class='brush:sql'&gt;SQL&gt; create table t1&lt;br /&gt;  2  as&lt;br /&gt;  3  select n,&lt;br /&gt;  4         'val_'||to_char(n, 'fm00') val&lt;br /&gt;  5    from xmltable('1 to 10'&lt;br /&gt;  6           columns&lt;br /&gt;  7             n int path '.');&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create table t2&lt;br /&gt;  2  as&lt;br /&gt;  3  select 'val_'||to_char(n, 'fm00') s&lt;br /&gt;  4    from xmltable('1 to 10'&lt;br /&gt;  5           columns&lt;br /&gt;  6             n int path '.');&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from t1;&lt;br /&gt;&lt;br /&gt;         N VAL&lt;br /&gt;---------- -------&lt;br /&gt;         1 val_01&lt;br /&gt;         2 val_02&lt;br /&gt;         3 val_03&lt;br /&gt;         4 val_04&lt;br /&gt;         5 val_05&lt;br /&gt;         6 val_06&lt;br /&gt;         7 val_07&lt;br /&gt;         8 val_08&lt;br /&gt;         9 val_09&lt;br /&gt;        10 val_10&lt;br /&gt;&lt;br /&gt;SQL&gt; select * from t2;&lt;br /&gt;&lt;br /&gt;S&lt;br /&gt;-------&lt;br /&gt;val_01&lt;br /&gt;val_02&lt;br /&gt;val_03&lt;br /&gt;val_04&lt;br /&gt;val_05&lt;br /&gt;val_06&lt;br /&gt;val_07&lt;br /&gt;val_08&lt;br /&gt;val_09&lt;br /&gt;val_10&lt;br /&gt;&lt;/pre&gt;I created two tables with a different structure. The &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=30324180.8"&gt;MOS note&lt;/a&gt; says about the table semantics macro, which is supposedly demonstrated on 22nd slide of &lt;a href="https://static.rainfocus.com/oracle/oow19/sess/1553765929286001lSFW/PF/SQL-Macros-Overview_1569084990942001SWly.pdf"&gt;Keith's presentation&lt;/a&gt;.&lt;br /&gt;I was not able to get &lt;b&gt;&lt;i&gt;SQL_MACRO(TABLE)&lt;/i&gt;&lt;/b&gt; work, so that I ended up with the following example:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; CREATE OR REPLACE FUNCTION sample(t DBMS_TF.Table_t, how_many number DEFAULT 5)&lt;br /&gt;  2  RETURN VARCHAR2 SQL_MACRO&lt;br /&gt;  3  AS&lt;br /&gt;  4  BEGIN&lt;br /&gt;  5    RETURN q'[SELECT *&lt;br /&gt;  6                FROM t&lt;br /&gt;  7               WHERE rownum &lt;= how_many]';&lt;br /&gt;  8  END sample;&lt;br /&gt;  9  /&lt;br /&gt;&lt;br /&gt;Function created.&lt;br /&gt;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from sample(t1, 3);&lt;br /&gt;&lt;br /&gt;         N VAL&lt;br /&gt;---------- -------&lt;br /&gt;         1 val_01&lt;br /&gt;         2 val_02&lt;br /&gt;         3 val_03&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from sample(t1);&lt;br /&gt;&lt;br /&gt;         N VAL&lt;br /&gt;---------- -------&lt;br /&gt;         1 val_01&lt;br /&gt;         2 val_02&lt;br /&gt;         3 val_03&lt;br /&gt;         4 val_04&lt;br /&gt;         5 val_05&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from sample(t2);&lt;br /&gt;&lt;br /&gt;S&lt;br /&gt;-------&lt;br /&gt;val_01&lt;br /&gt;val_02&lt;br /&gt;val_03&lt;br /&gt;val_04&lt;br /&gt;val_05&lt;br /&gt;&lt;/pre&gt;I traced the last two statements through Intel Pin debugtrace and grepped the resulted file for the SQM string (which are presumably Oracle functions corresponding to the SQL Macro functionality):&lt;br /&gt;&lt;pre&gt;&lt;&gt; qksptfSQM_Describe(0x7ff400bc6050, 0x6b76cbd8, ...)&lt;br /&gt;| &gt; qksptfSQM_Init(0x7ff400bc6050, 0x6b76cbd8, ...)&lt;br /&gt;| | &gt; qksptfSQM_Check_Errors(0x6b76cdf8, 0x7ff400b2c7a8, ...)&lt;br /&gt;| | &lt; qksptfSQM_Check_Errors+0x000000000090 returns: 0x7ff400b2c770&lt;br /&gt;| &lt; qksptfSQM_Init+0x0000000005d5 returns: 0x7ff400b2c7a8&lt;br /&gt;| &gt; qksptfSQM_GetTxt(0x7ff400b2c7a8, 0x1, ...)&lt;br /&gt;| | | | | | | | | | | &lt; qksptfSQM_GetTxt+0x000000001d51 returns: 0x6b76cdf8&lt;br /&gt;| | | | | | | | | | | &gt; qksptfSQM_Template(0x7ff400b2c7a8, 0, ...)&lt;br /&gt;| | | | | | | | | | | &lt; qksptfSQM_Template+0x0000000009ca returns: 0x6b76cdf8&lt;br /&gt;| | | | | | | | | | | &gt; qksptfSQM_Parse(0x7ff400b2c7a8, 0, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | &gt; qksptfSQM_Parse_errors(0x7ff400b2c448, 0xc0, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_Parse_errors+0x00000000069a returns: 0&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_Model_Check(0x7ff400bba928, 0, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_Model_Check+0x000000000040 returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_Model_Check(0x7ff405adf108, 0, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_Model_Check+0x000000000040 returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_Model_Check(0x7ff405adde48, 0, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_Model_Check+0x000000000040 returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_Model_Check(0x7ff405ade8a8, 0, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_Model_Check+0x000000000040 returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_Model_Check(0x7ff400bc4260, 0, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_Model_Check+0x000000000040 returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_rm_vqb(0x7ff400bc4260, 0x7ff400bba928, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_rm_vqb+0x00000000003d returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_SetSQM_(0x7ff405adf108, 0x7ff400b2c7a8, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_SetSQM_(0x7ff400b2c110, 0x7ff400b2c7a8, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_SetSQM_+0x00000000007e returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_SetSQM_+0x00000000007e returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_SetSQM_(0x7ff405adde48, 0x7ff400b2c7a8, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_SetSQM_+0x00000000007e returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_SetSQM_(0x7ff405ade8a8, 0x7ff400b2c7a8, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_SetSQM_+0x00000000007e returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_Parse+0x000000000851 returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_CleanupTDOs(0x3, 0x872027e0, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_CleanupTDOs+0x0000000001cd returns: 0x7ff400a5d73c&lt;br /&gt;| | | | | | | | | | | | &gt; qksptfSQM_PstPrc(0x7ff400bba928, 0x98b7af08, ...)&lt;br /&gt;| | | | | | | | | | | | | &gt; qksptfSQM_PstPrc1_(0x7ff400bba928, 0x7ff400bba928, ...)&lt;br /&gt;| | | | | | | | | | | | | &lt; qksptfSQM_PstPrc1_+0x000000000032 returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | &gt; qksptfSQM_PstPrc1_(0x7ff405adf108, 0x7ff400bba928, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | &gt; qksptfSQM_QbcRelExp_(0x7ff405adde48, 0x7ff405aded30, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_ExpRepl_(0x7ffef8fc52e0, 0x7ff405ad8818, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_ExpRepl_+0x00000000005a returns: 0&lt;br /&gt;| | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_ExpRepl_(0x7ffef8fc52e0, 0x7ff405addf10, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_ExpRepl_+0x00000000005a returns: 0&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_ExpRepl_(0x7ffef8fc52e0, 0x7ff405add890, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_ExpRepl_+0x00000000005a returns: 0&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_ExpRepl_(0x7ffef8fc52e0, 0x7ff405add850, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_ExpRepl_+0x00000000005a returns: 0&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_ExpRepl_(0x7ffef8fc52e0, 0x7ff405adda28, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_ExpRepl_+0x00000000005a returns: 0&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_ExpRepl_(0x7ffef8fc52e0, 0x7ff405add858, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_ExpRepl_+0x00000000005a returns: 0&lt;br /&gt;| | | | | | | | | | | | | | | | &lt; qksptfSQM_QbcRelExp_+0x000000000079 returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | | | | &gt; qksptfSQM_QbcRelExp_(0x7ff400b2c110, 0x7ff405aded30, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | &gt; qksptfSQM_ExpRepl_(0x7ffef8fc5270, 0x7ff405add1c8, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | | | | | &lt; qksptfSQM_ExpRepl_+0x00000000005a returns: 0&lt;br /&gt;| | | | | | | | | | | | | | | | | &lt; qksptfSQM_QbcRelExp_+0x000000000079 returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | &lt; qksptfSQM_PstPrc1_+0x000000000181 returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | | &gt; qksptfSQM_PstPrc1_(0x7ff405adde48, 0x7ff400bba928, ...)&lt;br /&gt;| | | | | | | | | | | | | | | &lt; qksptfSQM_PstPrc1_+0x000000000032 returns: 0x1&lt;br /&gt;| | | | | | | | | | | | | | | | &gt; qksptfSQM_PstPrc1_(0x7ff400b2c110, 0x7ff400bba928, ...)&lt;br /&gt;| | | | | | | | | | | | | | | | &lt; qksptfSQM_PstPrc1_+0x000000000032 returns: 0x1&lt;br /&gt;&lt;/pre&gt;As Fritz Hoogland identified them, those are new functions introduced in Oracle 19.6: &lt;a href="https://fritshoogland.wordpress.com/2020/01/16/whats-new-with-oracle-database-19-6-versus-19-5/"&gt;What’s new with Oracle database 19.6 versus 19.5&lt;/a&gt;.   I will wait till Oracle officially announces SQL Macros. For those who cannot wait, they can play around with them even in 19.6. Judging by &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=30324180.8"&gt;the bug description&lt;/a&gt;, the relevant functionality should be available for 19.5 (introduced without much fuss), but I have not found a one-off patch. It might have been set unpublished.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/6363677790004157199/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2020/01/bug-30324180-sql-macro-should-be.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6363677790004157199'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6363677790004157199'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2020/01/bug-30324180-sql-macro-should-be.html' title='Bug 30324180 SQL Macro should be backported to 19.5'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8278854078341281297</id><published>2019-12-18T23:00:00.000+06:00</published><updated>2019-12-18T20:21:42.991+06:00</updated><app:control xmlns:app='http://purl.org/atom/app#'><app:draft>yes</app:draft></app:control><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-07445'/><category scheme='http://www.blogger.com/atom/ns#' term='autoupgrade'/><title type='text'>Troubleshooting Failed AutoUpgrade</title><content type='html'>I have recently upgraded one of my 12.2.0.1.190716 database to 19.5.0.0.191015 using &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=2485457.1"&gt;the AutoUpgrade tool&lt;/a&gt; when I ran into an issue that this blog post is about.&lt;br /&gt;The AutoUpgrade console showed this:&lt;br /&gt;&lt;pre class="brush:bash;highlight:[9,11]"&gt;upg&gt;&lt;br /&gt;-------------------------------------------------&lt;br /&gt;Errors in database [emcdb]&lt;br /&gt;Stage     [DBUPGRADE]&lt;br /&gt;Operation [STOPPED]&lt;br /&gt;Status    [ERROR]&lt;br /&gt;Info    [&lt;br /&gt;Error: UPG-1400&lt;br /&gt;UPGRADE FAILED [emcdb]&lt;br /&gt;Cause: This indicates that the database upgrade failed with errors.&lt;br /&gt;For further details, see the log file located at /home/oracle/emcdb_upgrade/upg_logs/emcdb/emcdb/102/autoupgrade_20191218_user.log]&lt;br /&gt;&lt;br /&gt;-------------------------------------------------&lt;br /&gt;Logs: [/home/oracle/emcdb_upgrade/upg_logs/emcdb/emcdb/102/autoupgrade_20191218_user.log]&lt;br /&gt;-------------------------------------------------&lt;br /&gt;&lt;br /&gt;upg&gt; lsj&lt;br /&gt;+----+-------+---------+---------+------+--------------+--------+--------+--------+&lt;br /&gt;|Job#|DB_NAME|    STAGE|OPERATION|STATUS|    START_TIME|END_TIME| UPDATED| MESSAGE|&lt;br /&gt;+----+-------+---------+---------+------+--------------+--------+--------+--------+&lt;br /&gt;| 102|  emcdb|DBUPGRADE|  STOPPED| ERROR|19/12/18 09:56|     N/A|11:47:40|UPG-1400|&lt;br /&gt;+----+-------+---------+---------+------+--------------+--------+--------+--------+&lt;br /&gt;Total jobs 1&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Following the aforementioned logfile &lt;tt&gt;/home/oracle/emcdb_upgrade/upg_logs/emcdb/emcdb/102/autoupgrade_20191218_user.log&lt;/tt&gt; I found this:&lt;br /&gt;&lt;pre class="brush:bash;highlight:[3,4]"&gt;2019-12-18 11:46:14.543 ERROR&lt;br /&gt;DATABASE NAME: emcdb-PDB$SEED&lt;br /&gt;         CAUSE: ERROR at Line 175066 in [/home/oracle/emcdb_upgrade/upg_logs/emcdb/emcdb/102/dbupgrade/catupgrd20191218095654pdb_seed1.log]&lt;br /&gt;        REASON: ORA-03113: end-of-file on communication channel&lt;br /&gt;        ACTION: [MANUAL]&lt;br /&gt;        DETAILS: 03113, 00000, "end-of-file on communication channel"&lt;br /&gt;// *Cause: The connection between Client and Server process was broken.&lt;br /&gt;// *Action: There was a communication error that requires further investigation.&lt;br /&gt;//          First, check for network problems and review the SQL*Net setup.&lt;br /&gt;//          Also, look in the alert.log file for any errors. Finally, test to&lt;br /&gt;//          see whether the server process is dead and whether a trace file&lt;br /&gt;//          was generated at failure time.&lt;br /&gt;&lt;br /&gt;2019-12-18 11:46:14.549 ERROR UPGRADE FAILED [emcdb-pdb$seed]&lt;br /&gt;2019-12-18 11:46:14.550 ERROR Exception Error in Database Upgrade [UPG-1400#UPGRADE FAILED [emcdb-pdb$seed]]&lt;br /&gt;2019-12-18 11:46:14.550 INFO End Upgrade on Database [emcdb-pdb$seed]&lt;br /&gt;2019-12-18 11:47:36.118 INFO End Compiling Invalid Objects on Database [emcdb-empdbrepos]&lt;br /&gt;2019-12-18 11:47:36.120 INFO SUCCESSFULLY COMPILED [emcdb-empdbrepos]&lt;br /&gt;2019-12-18 11:47:36.519 INFO [Upgrading] is [100%] completed for [emcdb-empdbrepos]&lt;br /&gt;+----------+----------------------------------------+&lt;br /&gt;| CONTAINER|                              PERCENTAGE|&lt;br /&gt;+----------+----------------------------------------+&lt;br /&gt;|  CDB$ROOT|  SUCCESSFULLY UPGRADED [emcdb-cdb$root]|&lt;br /&gt;|  PDB$SEED|         UPGRADE FAILED [emcdb-pdb$seed]|&lt;br /&gt;|EMPDBREPOS|SUCCESSFULLY UPGRADED [emcdb-empdbrepos]|&lt;br /&gt;+----------+----------------------------------------+&lt;br /&gt;2019-12-18 11:47:40.686 ERROR UPGRADE FAILED [emcdb]&lt;br /&gt;2019-12-18 11:47:40.702 ERROR Exception Error in Database Upgrade [emcdb]&lt;br /&gt;2019-12-18 11:47:40.740 ERROR emcdb Return status is ERROR&lt;br /&gt;2019-12-18 11:47:40.748 INFO Starting error management routine&lt;br /&gt;2019-12-18 11:47:40.750 INFO Ended error management routine&lt;br /&gt;2019-12-18 11:47:40.752 ERROR Error occurred while running the dispatcher for job 102&lt;br /&gt;Cause: This indicates that the database upgrade failed with errors.&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;There is another log file &lt;tt&gt;/home/oracle/emcdb_upgrade/upg_logs/emcdb/emcdb/102/dbupgrade/catupgrd20191218095654pdb_seed1.log&lt;/tt&gt; that has the following lines:&lt;br /&gt;&lt;pre class="brush:bash;highlight:[18,21,26]"&gt;11:01:15 SQL&gt;&lt;br /&gt;11:01:15 SQL&gt; Rem For backwark compatibility with ORACLE7's catalog&lt;br /&gt;11:01:15 SQL&gt; create or replace public synonym ALL_HISTOGRAMS for ALL_TAB_HISTOGRAMS&lt;br /&gt;11:01:15   2  /&lt;br /&gt;&lt;br /&gt;Synonym created.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:00.02&lt;br /&gt;11:01:15 SQL&gt;&lt;br /&gt;11:01:15 SQL&gt; create or replace view DBA_TAB_HISTOGRAMS&lt;br /&gt;11:01:15   2      (OWNER, TABLE_NAME, COLUMN_NAME, ENDPOINT_NUMBER, ENDPOINT_VALUE,&lt;br /&gt;11:01:15   3       ENDPOINT_ACTUAL_VALUE, ENDPOINT_ACTUAL_VALUE_RAW, ENDPOINT_REPEAT_COUNT,&lt;br /&gt;11:01:15   4       SCOPE)&lt;br /&gt;11:01:15   5  as&lt;br /&gt;..skipping a long view definition..&lt;br /&gt;11:01:15 160    and c.intcol# = a.intcol#(+)&lt;br /&gt;11:01:15 161  /&lt;br /&gt;create or replace view DBA_TAB_HISTOGRAMS&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-03113: end-of-file on communication channel&lt;br /&gt;ERROR:&lt;br /&gt;ORA-03114: not connected to ORACLE&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SP2-1519: Unable to write to the error log table sys.registry$error&lt;br /&gt;Process ID: 420&lt;br /&gt;Session ID: 55 Serial number: 27219&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Elapsed: 00:04:08.19&lt;br /&gt;11:05:23 SQL&gt; comment on table DBA_TAB_HISTOGRAMS is&lt;br /&gt;11:05:23   2  'Histograms on columns of all tables'&lt;br /&gt;11:05:23   3  /&lt;br /&gt;ERROR:&lt;br /&gt;ORA-03114: not connected to ORACLE&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Thus, I got the infamous &lt;b&gt;&lt;i&gt;ORA-03113&lt;/i&gt;&lt;/b&gt; error around 11:01:15 (it can be also seen from the AutoUpgrade log), so that I looked at the alert log:&lt;br /&gt;&lt;b&gt;&lt;i&gt;Note&lt;/i&gt;&lt;/b&gt;: &lt;i&gt;SP2-1519: Unable to write to the error log table sys.registry$error&lt;/i&gt; says that the Oracle Upgrade scripts utilize &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/sqpug/SET-system-variable-summary.html#GUID-C7521DA1-03D1-4C02-8458-449479724F3E"&gt;SQL*Plus error logging&lt;/a&gt;.&lt;br /&gt;&lt;pre class="brush:bash;highlight:[5]"&gt;Wed Dec 18 11:01:16 2019&lt;br /&gt;PDB$SEED(2):Exception [type: SIGSEGV, Address not mapped to object] [ADDR:0x1] [PC:0xA8DF96B, kzaf_baiSetup()+1451] [&lt;br /&gt;flags: 0x0, count: 1]&lt;br /&gt;Errors in file /u01/app/oracle/diag/rdbms/emcdb/emcdb/trace/emcdb_ora_420.trc  (incident=91701) (PDBNAME=PDB$SEED):&lt;br /&gt;ORA-07445: exception encountered: core dump [kzaf_baiSetup()+1451] [SIGSEGV] [ADDR:0x1] [PC:0xA8DF96B] [Address not m&lt;br /&gt;apped to object] []&lt;br /&gt;PDB$SEED(2):Incident details in: /u01/app/oracle/diag/rdbms/emcdb/emcdb/incident/incdir_91701/emcdb_ora_420_i91701.tr&lt;br /&gt;c&lt;br /&gt;PDB$SEED(2):Use ADRCI or Support Workbench to package the incident.&lt;br /&gt;See Note 411.1 at My Oracle Support for error and packaging details.&lt;br /&gt;Wed Dec 18 11:01:38 2019&lt;br /&gt;PDB$SEED(2):*****************************************************************&lt;br /&gt;PDB$SEED(2):An internal routine has requested a dump of selected redo.&lt;br /&gt;PDB$SEED(2):This usually happens following a specific internal error, when&lt;br /&gt;PDB$SEED(2):analysis of the redo logs will help Oracle Support with the&lt;br /&gt;PDB$SEED(2):diagnosis.&lt;br /&gt;PDB$SEED(2):It is recommended that you retain all the redo logs generated (by&lt;br /&gt;PDB$SEED(2):all the instances) during the past 12 hours, in case additional&lt;br /&gt;PDB$SEED(2):redo dumps are required to help with the diagnosis.&lt;br /&gt;PDB$SEED(2):*****************************************************************&lt;br /&gt;&lt;/pre&gt;The incident trace file looks as follows:&lt;br /&gt;&lt;pre class="brush:bash"&gt;*** 2019-12-18 11:01:16.521&lt;br /&gt;*** SESSION ID:(55.27219) 2019-12-18 11:01:16.521&lt;br /&gt;*** CLIENT ID:() 2019-12-18 11:01:16.521&lt;br /&gt;*** SERVICE NAME:(SYS$USERS) 2019-12-18 11:01:16.521&lt;br /&gt;*** MODULE NAME:(catcon(pid=25405)) 2019-12-18 11:01:16.522&lt;br /&gt;*** ACTION NAME:(PDB$SEED::catost.sql) 2019-12-18 11:01:16.522&lt;br /&gt;*** CLIENT DRIVER:(SQL*PLUS) 2019-12-18 11:01:16.522&lt;br /&gt;*** CONTAINER ID:(2) 2019-12-18 11:01:16.522&lt;br /&gt;&lt;br /&gt;[TOC00000]&lt;br /&gt;Jump to table of contents&lt;br /&gt;Dump continued from file: /u01/app/oracle/diag/rdbms/emcdb/emcdb/trace/emcdb_ora_420.trc&lt;br /&gt;[TOC00001]&lt;br /&gt;ORA-07445: exception encountered: core dump [kzaf_baiSetup()+1451] [SIGSEGV] [ADDR:0x1] [PC:0xA8DF96B] [Address not mapped to object] []&lt;br /&gt;&lt;br /&gt;[TOC00001-END]&lt;br /&gt;[TOC00002]&lt;br /&gt;========= Dump for incident 91701 (ORA 7445 [kzaf_baiSetup]) ========&lt;br /&gt;[TOC00003]&lt;br /&gt;----- Beginning of Customized Incident Dump(s) -----&lt;br /&gt;Dumping swap information&lt;br /&gt;Memory (Avail / Total) = 88.35M / 7864.02M&lt;br /&gt;Swap (Avail / Total) = 6971.75M /  8000.00M&lt;br /&gt;Exception [type: SIGSEGV, Address not mapped to object] [ADDR:0x1] [PC:0xA8DF96B, kzaf_baiSetup()+1451] [flags: 0x0, count: 1]&lt;br /&gt;Registers:&lt;br /&gt;%rax: 0x0000000000000001 %rbx: 0x00007f77320fb080 %rcx: 0x00000000ae84e9b0&lt;br /&gt;%rdx: 0x0000000000000000 %rdi: 0x00007f77371d39a0 %rsi: 0x00007f77320fb080&lt;br /&gt;%rsp: 0x00007ffdbfbd26c0 %rbp: 0x00007ffdbfbd2820  %r8: 0x0000000000000000&lt;br /&gt; %r9: 0x00007f77320fbd88 %r10: 0x00007ffdbfbd26d8 %r11: 0x00007ffdbfbd2688&lt;br /&gt;%r12: 0x0000000000000000 %r13: 0x00007f77371f2660 %r14: 0x00007f77372243c0&lt;br /&gt;%r15: 0x00007f7732067228 %rip: 0x000000000a8df96b %efl: 0x0000000000010202&lt;br /&gt;  kzaf_baiSetup()+1440 (0xa8df960) je 0xa8df996&lt;br /&gt;  kzaf_baiSetup()+1442 (0xa8df962) mov 0x10(%rcx),%rax&lt;br /&gt;  kzaf_baiSetup()+1446 (0xa8df966) test %rax,%rax&lt;br /&gt;  kzaf_baiSetup()+1449 (0xa8df969) je 0xa8df996&lt;br /&gt;&gt; kzaf_baiSetup()+1451 (0xa8df96b) mov (%rax),%rax&lt;br /&gt;  kzaf_baiSetup()+1454 (0xa8df96e) testl $0x2000,0x24(%rax)&lt;br /&gt;  kzaf_baiSetup()+1461 (0xa8df975) je 0xa8df996&lt;br /&gt;  kzaf_baiSetup()+1463 (0xa8df977) cmpb $0xa,0x41(%rax)&lt;br /&gt;  kzaf_baiSetup()+1467 (0xa8df97b) je 0xa8df996&lt;br /&gt;&lt;br /&gt;*** 2019-12-18 11:01:16.531&lt;br /&gt;dbkedDefDump(): Starting a non-incident diagnostic dump (flags=0x3, level=3, mask=0x0)&lt;br /&gt;[TOC00004]&lt;br /&gt;----- Current SQL Statement for this session (sql_id=9nn0dfsn80mh4) -----&lt;br /&gt;create or replace view DBA_TAB_HISTOGRAMS&lt;br /&gt;    (OWNER, TABLE_NAME, COLUMN_NAME, ENDPOINT_NUMBER, ENDPOINT_VALUE,&lt;br /&gt;     ENDPOINT_ACTUAL_VALUE, ENDPOINT_ACTUAL_VALUE_RAW, ENDPOINT_REPEAT_COUNT,&lt;br /&gt;     SCOPE)&lt;br /&gt;as&lt;br /&gt;select /*+ ordered */ u.name,&lt;br /&gt;..skipping a long view definition..&lt;br /&gt;&lt;br /&gt;[TOC00005]&lt;br /&gt;----- Call Stack Trace -----&lt;br /&gt;calling              call     entry                argument values in hex&lt;br /&gt;location             type     point                (? means dubious value)&lt;br /&gt;-------------------- -------- -------------------- ----------------------------&lt;br /&gt;ksedst1()+95         call     kgdsdst()            7F773252ECF0 000000003&lt;br /&gt;                                                   7F7732529020 ? 7F7732529138 ?&lt;br /&gt;                                                   000000000 000000083 ?&lt;br /&gt;ksedst()+58          call     ksedst1()            000000001 000000001&lt;br /&gt;                                                   7F7732529020 ? 7F7732529138 ?&lt;br /&gt;                                                   000000000 ? 000000083 ?&lt;br /&gt;dbkedDefDump()+2308  call     ksedst()             000000001 000000001 ?&lt;br /&gt;0                                                  7F7732529020 ? 7F7732529138 ?&lt;br /&gt;                                                   000000000 ? 000000083 ?&lt;br /&gt;ksedmp()+577         call     dbkedDefDump()       000000003 000000003&lt;br /&gt;                                                   7F7732529020 ? 7F7732529138 ?&lt;br /&gt;                                                   000000000 ? 000000083 ?&lt;br /&gt;ssexhd()+2859        call     ksedmp()             00000044F 000000003 ?&lt;br /&gt;                                                   7F7732529020 ? 7F7732529138 ?&lt;br /&gt;                                                   000000000 ? 000000083 ?&lt;br /&gt;sslssSynchHdlr()+40  call     ssexhd()             00000000B 000000000&lt;br /&gt;1                                                  7F77325304B0 7F7732530380&lt;br /&gt;                                                   7F77325302E8 000000083 ?&lt;br /&gt;sslsshandler()+94    call     sslssSynchHdlr()     000002000 000000000 000000000&lt;br /&gt;                                                   7F7732530380 ? 7F77325302E8 ?&lt;br /&gt;                                                   000000083 ?&lt;br /&gt;__sighandler()       call     sslsshandler()       000000019 7F77325304B0&lt;br /&gt;                                                   7F7732530380 7F7732530380 ?&lt;br /&gt;                                                   7F77325302E8 ? 000000083 ?&lt;br /&gt;kzaf_baiSetup()+145  signal   __sighandler()       7F77371D39A0 7F77320FB080&lt;br /&gt;1                                                  000000000 0AE84E9B0 ?&lt;br /&gt;                                                   000000000 ? 7F77320FBD88 ?&lt;br /&gt;kzaf_write_audit()+  call     kzaf_baiSetup()      7F7700000000 7F77320FB080 ?&lt;br /&gt;608                                                000000000 ? 0AE84E9B0 ?&lt;br /&gt;                                                   000000000 ? 7F77320FBD88 ?&lt;br /&gt;kzanWriteStandardAu  call     kzaf_write_audit()   000000004 7FFDBFBD3D30&lt;br /&gt;dit()+542                                          000000000 ? 0AE84E9B0 ?&lt;br /&gt;                                                   000000000 ? 7F77320FBD88 ?&lt;br /&gt;audins()+1754        call     kzanWriteStandardAu  7F77370EF030 7FFDBFBD3D30 ?&lt;br /&gt;                              dit()                000000000 ? 0AE84E9B0 ?&lt;br /&gt;                                                   000000000 ? 7F77320FBD88 ?&lt;br /&gt;audfro()+2278        call     audins()             7F77370EF030 000000003 ?&lt;br /&gt;                                                   000000000 ? 000800300&lt;br /&gt;                                                   7FFDBFBDD2D0 ? 7F77320FBD88 ?&lt;br /&gt;audcvw()+690         call     audfro()             7F7731CEC2A0 ? 000030000&lt;br /&gt;                                                   000000000 000000000&lt;br /&gt;                                                   7FFD00000000 7F77370EF610&lt;br /&gt;auddft_internal()+2  call     audcvw()             7F77370EF030 ? 000000015&lt;br /&gt;887                                                000000000 ? 000000000&lt;br /&gt;                                                   7FFD00000000 ? 7F77370EF610 ?&lt;br /&gt;audStatement()+1168  call     auddft_internal()    7F77370EF030 000000015&lt;br /&gt;                                                   000000000 000000000 ?&lt;br /&gt;                                                   00A8451D0 7F77370EF610 ?&lt;br /&gt;opiexe()+10063       call     audStatement()       000000015 ? 000000000&lt;br /&gt;                                                   000000000 ? 000000000 ?&lt;br /&gt;                                                   00A8451D0 ? 7F77370EF610 ?&lt;br /&gt;opiosq0()+4494       call     opiexe()             000000004 000000000 ?&lt;br /&gt;&lt;/pre&gt;Obviously there is an invalid address in the rax register: &lt;b&gt;&lt;i&gt;0x0000000000000001&lt;/i&gt;&lt;/b&gt;, that must have come from the rcx register&lt;br /&gt;  &lt;b&gt;&lt;i&gt;kzaf_baiSetup()+1442 (0xa8df962) mov 0x10(%rcx),%rax&lt;/i&gt;&lt;/b&gt;&lt;br /&gt;unless there are some other jumps in that code, so that &lt;b&gt;&lt;i&gt;kzaf_baiSetup()+1442&lt;/i&gt;&lt;/b&gt; line got bypassed.&lt;br /&gt;Judging by these function names: &lt;b&gt;&lt;i&gt;audStatement, audcvw, audins, kzanWriteStandardAudit, kzaf_baiSetup&lt;/i&gt;&lt;/b&gt; - I can conclude that it is related to the database auditing. Otherwise, &lt;a href="http://orafun.info/stack/"&gt;http://orafun.info/stack/&lt;/a&gt; can be utilized. It is also helpful to lookup the incident context dump section in the trace file that may include the corresponding Oracle code layers for some functions on the stack:&lt;br /&gt;&lt;pre class="brush:bash"&gt;----- Incident Context Dump -----&lt;br /&gt;Address: 0x7f77370809d0&lt;br /&gt;Incident ID: 91701&lt;br /&gt;Problem Key: ORA 7445 [kzaf_baiSetup]&lt;br /&gt;Error: ORA-7445 [kzaf_baiSetup] [SIGSEGV] [ADDR:0x1] [PC:0xA8DF96B] [Address not mapped to object] [] [] [] [] [] [] []&lt;br /&gt;[00]: dbgexExplicitEndInc [diag_dde]&lt;br /&gt;[01]: dbgeEndDDEInvocationImpl [diag_dde]&lt;br /&gt;[02]: ssexhd []&lt;br /&gt;[03]: sslssSynchHdlr []&lt;br /&gt;[04]: sslsshandler []&lt;br /&gt;[05]: __sighandler []&lt;br /&gt;[06]: kzaf_baiSetup [AUDITNG]&lt;-- Signaling&lt;br /&gt;[07]: kzaf_write_audit [AUDITNG]&lt;br /&gt;[08]: kzanWriteStandardAudit [AUDITNG]&lt;br /&gt;[09]: audins [AUDITNG]&lt;br /&gt;[10]: audfro [AUDITNG]&lt;br /&gt;[11]: audcvw [AUDITNG]&lt;br /&gt;[12]: auddft_internal [AUDITNG]&lt;br /&gt;[13]: audStatement [AUDITNG]&lt;br /&gt;[14]: opiexe [Time_Limit]&lt;br /&gt;[15]: opiosq0 [OPI]&lt;br /&gt;[16]: kpooprx [PROGINT_MISC]&lt;br /&gt;[17]: kpoal8 [PROGINT_MISC]&lt;br /&gt;[18]: opiodr [OPI]&lt;br /&gt;[19]: ttcpip []&lt;br /&gt;[20]: opitsk [OPI]&lt;br /&gt;[21]: opiino [OPI]&lt;br /&gt;[22]: opiodr [OPI]&lt;br /&gt;[23]: opidrv [OPI]&lt;br /&gt;[24]: sou2o []&lt;br /&gt;[25]: opimai_real [OPI]&lt;br /&gt;[26]: ssthrdmain []&lt;br /&gt;[27]: main []&lt;br /&gt;[28]: __libc_start_main []&lt;br /&gt;MD [00]: 'SID'='55.27219' (0x2)&lt;br /&gt;MD [01]: 'ProcId'='62.103' (0x2)&lt;br /&gt;MD [02]: 'Service'='SYS$USERS' (0x200)&lt;br /&gt;MD [03]: 'Module'='catcon(pid=25405)' (0x200)&lt;br /&gt;MD [04]: 'Action'='PDB$SEED::catost.sql' (0x200)&lt;br /&gt;MD [05]: 'PdbName'='PDB$SEED' (0x0)&lt;br /&gt;MD [06]: 'Client ProcId'='oracle@emrep (TNS V1-V3).420_140150002828224' (0x0)&lt;br /&gt;&lt;/pre&gt;That is yet another proof of the observation made earlier that this error has something to do with Database Auditing (which is mistyped in the stack as &lt;b&gt;&lt;i&gt;AUDITNG&lt;/i&gt;&lt;/b&gt;). Having searched this &lt;b&gt;&lt;i&gt;kzaf_baiSetup&lt;/i&gt;&lt;/b&gt; function through My Oracle Support (MOS), I found only one bug filled for 18.5.0.0.0: &lt;a href="https://support.oracle.com/rs?type=bug&amp;id=29627066"&gt;Bug 29627066 : ORA-7445:[KZAF_BAISETUP] AFTER DATABASE UPGRADE TO 18.5&lt;/a&gt;&lt;br/&gt;Its status is &lt;i&gt;36 - Duplicate Bug. To Filer&lt;/i&gt; and its base bug is unpublished: 29970081. Hence, that was a dead-end for me. &lt;br/&gt;&lt;br/&gt;In fact, I was hitting the same error in PDB$SEED the other day while I was upgrading another database, however, it was for another view: &lt;pre class="brush:sql"&gt;create or replace view ALL_TAB_HISTGRM_PENDING_STATS&lt;br /&gt;                  *&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-03113: end-of-file on communication channel&lt;br /&gt;ERROR:&lt;br /&gt;ORA-03114: not connected to ORACLE&lt;br /&gt;&lt;/pre&gt;When I initially encountered that error, I just restored my database from a backup, which I made beforehand, to make sure that my fallback plan would work. I did not want to do the same the second time as I wanted to make a successful database upgrade. &lt;br/&gt;&lt;br/&gt;Although it is usually advised to contact Oracle Support in such a case, I tried to fix the error by myself. It is a database with a mixed-mode auditing, so that I checked the filesystem first - it had a plenty of space. I waded through the incident trace file but alas I did not find any clues that could help to resolve that issue. Was this a time to raise a new Service Request (SR)? It might have been but I decided to check any available AutoUpgrade commands to find out if I could restart the upgrade somehow. As I found that the same error was being hit against a different view, that made me think that it is a transient error that might get resolved when the problem command ran a second time. &lt;br/&gt;Sure enough, AutoUpgrade has the resume command which I ran: &lt;pre class="brush:bash"&gt;upg&gt; lsj&lt;br /&gt;+----+-------+---------+---------+------+--------------+--------+--------+--------+&lt;br /&gt;|Job#|DB_NAME|    STAGE|OPERATION|STATUS|    START_TIME|END_TIME| UPDATED| MESSAGE|&lt;br /&gt;+----+-------+---------+---------+------+--------------+--------+--------+--------+&lt;br /&gt;| 102|  emcdb|DBUPGRADE|  STOPPED| ERROR|19/12/18 09:56|     N/A|11:47:40|UPG-1400|&lt;br /&gt;+----+-------+---------+---------+------+--------------+--------+--------+--------+&lt;br /&gt;Total jobs 1&lt;br /&gt;upg&gt; resume -job 102&lt;br /&gt;Resuming job: [102][emcdb]&lt;br /&gt;&lt;/pre&gt;After a while the upgrade completed successfully: &lt;pre class="brush:bash"&gt;upg&gt; resume -job 102&lt;br /&gt;Resuming job: [102][emcdb]&lt;br /&gt;upg&gt; lsj&lt;br /&gt;+----+-------+----------+---------+-------+--------------+--------+--------+--------------+&lt;br /&gt;|Job#|DB_NAME|     STAGE|OPERATION| STATUS|    START_TIME|END_TIME| UPDATED|       MESSAGE|&lt;br /&gt;+----+-------+----------+---------+-------+--------------+--------+--------+--------------+&lt;br /&gt;| 102|  emcdb|POSTFIXUPS|EXECUTING|RUNNING|19/12/18 09:56|     N/A|12:18:18|Remaining 4/10|&lt;br /&gt;+----+-------+----------+---------+-------+--------------+--------+--------+--------------+&lt;br /&gt;Total jobs 1&lt;br /&gt;upg&gt; /&lt;br /&gt;+----+-------+-----------+---------+-------+--------------+--------+--------+--------------------+&lt;br /&gt;|Job#|DB_NAME|      STAGE|OPERATION| STATUS|    START_TIME|END_TIME| UPDATED|             MESSAGE|&lt;br /&gt;+----+-------+-----------+---------+-------+--------------+--------+--------+--------------------+&lt;br /&gt;| 102|  emcdb|POSTUPGRADE|EXECUTING|RUNNING|19/12/18 09:56|     N/A|12:27:29|Creating final SPFIL|&lt;br /&gt;+----+-------+-----------+---------+-------+--------------+--------+--------+--------------------+&lt;br /&gt;Total jobs 1&lt;br /&gt;upg&gt; Job 102 completed&lt;br /&gt;------------------- Final Summary --------------------&lt;br /&gt;Number of databases            [ 1 ]&lt;br /&gt;&lt;br /&gt;Jobs finished successfully     [1]&lt;br /&gt;Jobs failed                    [0]&lt;br /&gt;Jobs pending                   [0]&lt;br /&gt;------------- JOBS FINISHED SUCCESSFULLY -------------&lt;br /&gt;Job 102 FOR emcdb&lt;br /&gt;&lt;br /&gt;---- Drop GRP at your convenience once you consider it is no longer needed ----&lt;br /&gt;Drop GRP from emcdb: drop restore point AUTOUPGRADE_221145114461854_EMCDB&lt;br /&gt;&lt;/pre&gt;That was an Oracle Restart configuration where &lt;a href="https://mikedietrichde.com/2019/07/19/autoupgrade-and-data-guard-rac-restart-and-non-cdb-to-pdb/"&gt;some manual post-upgrade actions&lt;/a&gt; are required that AutoUpgrade does not perform yet. Therefore, I ran the srvctl upgrade command manually to modify the Oracle Restart configuration: &lt;pre class="brush:bash"&gt;[oracle@emrep ~]$ export ORACLE_HOME=/u01/app/oracle/product/db_19.5.0.0_ru191015&lt;br /&gt;[oracle@emrep ~]$ export PATH=$ORACLE_HOME/bin:$PATH&lt;br /&gt;[oracle@emrep ~]$ srvctl upgrade database -db emcdb -o $ORACLE_HOME&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/12/troubleshooting-failed-autoupgrade.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8278854078341281297'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8278854078341281297'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-6405394098893224448</id><published>2019-12-12T20:00:00.000+06:00</published><updated>2019-12-12T20:23:38.622+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='opatchauto'/><title type='text'>Patching Oracle Grid Infrastructure Standalone Environment Using opatchauto Out of Place (OOP) Patching</title><content type='html'>The MOS article &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=2419319.1"&gt;Grid Infrastructure Out of Place ( OOP ) Patching using opatchauto (Doc ID 2419319.1)&lt;/a&gt; describes how to perform opatchauto Out of Place Patching of a Grid Infrastructure environment. The article assumes that commands are to be entered interactively. Although it is possible to automate the patching process using the Linux &lt;a href="https://linux.die.net/man/1/expect"&gt;expect&lt;/a&gt; command, an alternative approach utilizing property files can be adapted to perform unattended patching.&lt;br /&gt;&lt;br /&gt;&lt;h2&gt;Initial setup&lt;/h2&gt;I have a Grid Infrastructure Oracle Home &lt;code&gt;/u01/app/oracle/product/19.4.0/grid&lt;/code&gt; on a Linux server. That is Grid Infrastructure Release Update 19.4.0.0.190716.&lt;br /&gt;I would like to install &lt;a href="https://support.oracle.com/epmos/faces/ui/patch/PatchDetail.jspx?parent=DOCUMENT&amp;sourceId=756671.1&amp;patchId=30116789"&gt;Grid Infrastructure Release Update 19.5.0.0.191015&lt;/a&gt; to a new location &lt;code&gt;/u01/app/oracle/product/19.5.0/grid&lt;/code&gt;.&lt;br /&gt;There are also a few 12.2 databases running on the same server.&lt;br /&gt;I will not be using the 2 Step Method from the aforementioned MOS article, so that I will not be running the prepare-clone and switch-clone commands.&lt;br /&gt;The patching will be performed by running a single command that can be easily scripted and used from any IT automation tool, such as &lt;a href="https://www.ansible.com/"&gt;Ansible&lt;/a&gt;.&lt;br /&gt;&lt;br /&gt;&lt;h2&gt;Configuring Oracle Home mapping file&lt;/h2&gt;Here is an excerpt from &lt;a href="https://docs.oracle.com/cd/E91266_01/OPTCH/GUID-10EF5AF2-BB81-488B-8F5A-362C04E4E6BE.htm#OPTCH-GUID-73389F3A-BFDF-48EC-9642-322C16730EDC"&gt;the OPatch User's Guide&lt;/a&gt; describing how to provide original and cloned home details:&lt;br /&gt;&lt;br /&gt;&lt;div style="font-style: italic"&gt;To create a property file, add all the required original and cloned home details and save the file with the &lt;i&gt;.properties&lt;/i&gt; extension.&lt;br /&gt;For example: clone.properties.&lt;br /&gt;&lt;br /&gt;Following is an example of the property file:&lt;br /&gt;&lt;pre style="background-color: #F9F9FB"&gt;/scratch/product/12.2/&lt;i&gt;&amp;lt;original_home&amp;gt;&lt;/i&gt;=/scratch/product/12.2/&lt;i&gt;&amp;lt;cloned_home&amp;gt;&lt;/i&gt;&lt;br /&gt;/scratch/product/db/12.2/&lt;i&gt;&amp;lt;original_home&amp;gt;&lt;/i&gt;=/scratch/product/db/12.2/&lt;i&gt;&amp;lt;cloned_home&amp;gt;&lt;/i&gt;&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;Where,&lt;br /&gt;&lt;br /&gt;&lt;i&gt;&amp;lt;original_home&amp;gt;&lt;/i&gt; is the folder name of the original home.&lt;br /&gt;&lt;br /&gt;&lt;i&gt;&amp;lt;cloned_home&amp;gt;&lt;/i&gt; is the folder name of the clone home to which the original home would be cloned to.&lt;br /&gt;&lt;/div&gt;&lt;br /&gt;Hence, I create a property file with the following contents:&lt;br /&gt;&lt;br /&gt;&lt;pre class="brush:sql"&gt;# cat clone.properties&lt;br /&gt;/u01/app/oracle/product/19.4.0/grid=/u01/app/oracle/product/19.5.0/grid&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h2&gt;Analyzing the patch applicability&lt;/h2&gt;&lt;br /&gt;&lt;pre class="brush:sql;highlight:[18,40]"&gt;[root@emrep 30116789]# opatchauto apply -outofplace -phBaseDir /u01/app/oracle/stage/p30116789_190000_Linux-x86-64_gi_ru_19.5.0.0.191015 \&lt;br /&gt;&amp;gt; -oh /u01/app/oracle/product/19.4.0/grid \&lt;br /&gt;&amp;gt; -silent /u01/app/oracle/stage/p30116789_190000_Linux-x86-64_gi_ru_19.5.0.0.191015/30116789/clone.properties \&lt;br /&gt;&amp;gt; -analyze&lt;br /&gt;&lt;br /&gt;OPatchauto session is initiated at Thu Dec 12 12:09:32 2019&lt;br /&gt;&lt;br /&gt;System initialization log file is /u01/app/oracle/product/19.4.0/grid/cfgtoollogs/opatchautodb/systemconfig2019-12-12_12-09-36PM.log.&lt;br /&gt;&lt;br /&gt;Session log file is /u01/app/oracle/product/19.4.0/grid/cfgtoollogs/opatchauto/opatchauto2019-12-12_12-09-41PM.log&lt;br /&gt;The id for this session is ATZ9&lt;br /&gt;&lt;br /&gt;Executing OPatch prereq operations to verify patch applicability on home /u01/app/oracle/product/19.4.0/grid&lt;br /&gt;Patch applicability verified successfully on home /u01/app/oracle/product/19.4.0/grid&lt;br /&gt;&lt;br /&gt;OPatchAuto successful.&lt;br /&gt;&lt;br /&gt;--------------------------------Summary--------------------------------&lt;br /&gt;Out of place patching clone home(s) summary&lt;br /&gt;____________________________________________&lt;br /&gt;Host : emrep&lt;br /&gt;Actual Home : /u01/app/oracle/product/19.4.0/grid&lt;br /&gt;Version:19.0.0.0.0&lt;br /&gt;Clone Home Path : /u01/app/oracle/product/19.5.0/grid&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Analysis for applying patches has completed successfully:&lt;br /&gt;&lt;br /&gt;Host:emrep&lt;br /&gt;SIHA Home:/u01/app/oracle/product/19.4.0/grid&lt;br /&gt;Version:19.0.0.0.0&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;==Following patches were SKIPPED:&lt;br /&gt;&lt;br /&gt;Patch: /u01/app/oracle/stage/p30116789_190000_Linux-x86-64_gi_ru_19.5.0.0.191015/30116789/29401763&lt;br /&gt;Reason: This patch is already been applied, so not going to apply again.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;==Following patches were SUCCESSFULLY analyzed to be applied:&lt;br /&gt;&lt;br /&gt;Patch: /u01/app/oracle/stage/p30116789_190000_Linux-x86-64_gi_ru_19.5.0.0.191015/30116789/30122149&lt;br /&gt;Log: /u01/app/oracle/product/19.4.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2019-12-12_12-10-00PM_1.log&lt;br /&gt;&lt;br /&gt;Patch: /u01/app/oracle/stage/p30116789_190000_Linux-x86-64_gi_ru_19.5.0.0.191015/30116789/30122167&lt;br /&gt;Log: /u01/app/oracle/product/19.4.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2019-12-12_12-10-00PM_1.log&lt;br /&gt;&lt;br /&gt;Patch: /u01/app/oracle/stage/p30116789_190000_Linux-x86-64_gi_ru_19.5.0.0.191015/30116789/30125133&lt;br /&gt;Log: /u01/app/oracle/product/19.4.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2019-12-12_12-10-00PM_1.log&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;OPatchauto session completed at Thu Dec 12 12:10:14 2019&lt;br /&gt;Time taken to complete the session 0 minute, 42 seconds&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h2&gt;Stopping Oracle Databases that use Oracle ASM&lt;/h2&gt;Since I would like to patch only the Grid Infrastructure Oracle Home, which implies its unavailability in my setup, I can stop all Oracle databases beforehand. Otherwise, they will be shutting down with the abort option. The following lines from the alert log confirm that the database was brought down using the abort option on one server where I was testing the Out of Place patching:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[2]"&gt;Thu Dec 12 12:26:00 2019&lt;br /&gt;Shutting down instance (abort) (OS id: 13679)&lt;br /&gt;License high water mark = 97&lt;br /&gt;Thu Dec 12 12:26:00 2019&lt;br /&gt;USER (ospid: 13679): terminating the instance&lt;br /&gt;Thu Dec 12 12:26:01 2019&lt;br /&gt;Instance terminated by USER, pid = 13679&lt;br /&gt;&lt;/pre&gt;&lt;br /&gt;&lt;h2&gt;Applying the Release Update&lt;/h2&gt;&lt;br /&gt;&lt;pre class="brush:sql;highlight:[54,69,97]"&gt;[root@emrep 30116789]# opatchauto apply -outofplace -phBaseDir /u01/app/oracle/stage/p30116789_190000_Linux-x86-64_gi_ru_19.5.0.0.191015 \&lt;br /&gt;&amp;gt; -oh /u01/app/oracle/product/19.4.0/grid \&lt;br /&gt;&amp;gt; -silent /u01/app/oracle/stage/p30116789_190000_Linux-x86-64_gi_ru_19.5.0.0.191015/30116789/clone.properties&lt;br /&gt;&lt;br /&gt;OPatchauto session is initiated at Thu Dec 12 12:12:57 2019&lt;br /&gt;&lt;br /&gt;System initialization log file is /u01/app/oracle/product/19.4.0/grid/cfgtoollogs/opatchautodb/systemconfig2019-12-12_12-13-01PM.log.&lt;br /&gt;&lt;br /&gt;Session log file is /u01/app/oracle/product/19.4.0/grid/cfgtoollogs/opatchauto/opatchauto2019-12-12_12-13-06PM.log&lt;br /&gt;The id for this session is IMWY&lt;br /&gt;&lt;br /&gt;Executing OPatch prereq operations to verify patch applicability on home /u01/app/oracle/product/19.4.0/grid&lt;br /&gt;Patch applicability verified successfully on home /u01/app/oracle/product/19.4.0/grid&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Copying the files from the existing oracle home /u01/app/oracle/product/19.4.0/grid to a new location. Please wait...&lt;br /&gt;Clone of oracle home /u01/app/oracle/product/19.4.0/grid is /u01/app/oracle/product/19.5.0/grid on host emrep&lt;br /&gt;Copying the files from the existing oracle home /u01/app/oracle/product/19.4.0/grid to a new location is successful.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Unlocking CRS clone home for home /u01/app/oracle/product/19.4.0/grid.&lt;br /&gt;Prepatch operation log file location: /u01/app/oracle/crsdata/emrep/crsconfig/hapatch_2019-12-12_12-16-50AM.log&lt;br /&gt;Unlocked CRS clone home successfully for home /u01/app/oracle/product/19.4.0/grid.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Creating clone for oracle home /u01/app/oracle/product/19.4.0/grid.&lt;br /&gt;Clone operation successful for oracle home /u01/app/oracle/product/19.4.0/grid.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Performing post clone operation for oracle home /u01/app/oracle/product/19.4.0/grid.&lt;br /&gt;Performing post clone operation was successful for oracle home /u01/app/oracle/product/19.5.0/grid.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Start applying binary patch on home /u01/app/oracle/product/19.5.0/grid&lt;br /&gt;Binary patch applied successfully on home /u01/app/oracle/product/19.5.0/grid&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Update nodelist in the inventory for oracle home /u01/app/oracle/product/19.5.0/grid.&lt;br /&gt;Update nodelist in the inventory is completed for oracle home /u01/app/oracle/product/19.5.0/grid.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Starting CRS service on home /u01/app/oracle/product/19.5.0/grid&lt;br /&gt;Postpatch operation log file location: /u01/app/oracle/crsdata/emrep/crsconfig/hapatch_2019-12-12_12-25-58AM.log&lt;br /&gt;CRS service started successfully on home /u01/app/oracle/product/19.5.0/grid&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Confirm that all resources have been started from home /u01/app/oracle/product/19.5.0/grid.&lt;br /&gt;All resources have been started successfully from home /u01/app/oracle/product/19.5.0/grid.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;OPatchAuto successful.&lt;br /&gt;&lt;br /&gt;--------------------------------Summary--------------------------------&lt;br /&gt;&lt;br /&gt;Patching is completed successfully. Please find the summary as follows:&lt;br /&gt;&lt;br /&gt;Host:emrep&lt;br /&gt;SIHA Home:/u01/app/oracle/product/19.4.0/grid&lt;br /&gt;Version:19.0.0.0.0&lt;br /&gt;Summary:&lt;br /&gt;&lt;br /&gt;==Following patches were SKIPPED:&lt;br /&gt;&lt;br /&gt;Patch: /u01/app/oracle/stage/p30116789_190000_Linux-x86-64_gi_ru_19.5.0.0.191015/30116789/29401763&lt;br /&gt;Reason: This patch is already been applied, so not going to apply again.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;==Following patches were SUCCESSFULLY applied:&lt;br /&gt;&lt;br /&gt;Patch: /u01/app/oracle/stage/p30116789_190000_Linux-x86-64_gi_ru_19.5.0.0.191015/30116789/30122149&lt;br /&gt;Log: /u01/app/oracle/product/19.5.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2019-12-12_12-18-01PM_1.log&lt;br /&gt;&lt;br /&gt;Patch: /u01/app/oracle/stage/p30116789_190000_Linux-x86-64_gi_ru_19.5.0.0.191015/30116789/30122167&lt;br /&gt;Log: /u01/app/oracle/product/19.5.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2019-12-12_12-18-01PM_1.log&lt;br /&gt;&lt;br /&gt;Patch: /u01/app/oracle/stage/p30116789_190000_Linux-x86-64_gi_ru_19.5.0.0.191015/30116789/30125133&lt;br /&gt;Log: /u01/app/oracle/product/19.5.0/grid/cfgtoollogs/opatchauto/core/opatch/opatch2019-12-12_12-18-01PM_1.log&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Patching session reported following warning(s):&lt;br /&gt;_________________________________________________&lt;br /&gt;&lt;br /&gt;[Note]: Please verify the database is running from the desired Oracle home, if not then manually execute&lt;br /&gt; $ORACLE_HOME/bin/srvctl modify database command to fix the problem&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Out of place patching clone home(s) summary&lt;br /&gt;____________________________________________&lt;br /&gt;Host : emrep&lt;br /&gt;Actual Home : /u01/app/oracle/product/19.4.0/grid&lt;br /&gt;Version:19.0.0.0.0&lt;br /&gt;Clone Home Path : /u01/app/oracle/product/19.5.0/grid&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;OPatchauto session completed at Thu Dec 12 12:37:27 2019&lt;br /&gt;Time taken to complete the session 24 minutes, 30 seconds&lt;br /&gt;[root@emrep 30116789]#&lt;br /&gt;&lt;/pre&gt;Thus, it took just 24 minutes to perform the patching on that server; it is an AWS t3.large instance.&lt;br /&gt;The time can be even shortened more by preparing the cloned Oracle Home in advance.&lt;br /&gt;A rough estimate on the log above can be made that the patching time may be shortened twice using &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=2419319.1"&gt;the 2 Step Method&lt;/a&gt;.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/6405394098893224448/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/12/patching-oracle-grid-infrastructure.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6405394098893224448'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6405394098893224448'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/12/patching-oracle-grid-infrastructure.html' title='Patching Oracle Grid Infrastructure Standalone Environment Using opatchauto Out of Place (OOP) Patching'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-3899856027799831476</id><published>2019-11-13T21:26:00.000+06:00</published><updated>2019-11-13T21:26:50.456+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='12.2'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-01031'/><category scheme='http://www.blogger.com/atom/ns#' term='sql92_security'/><title type='text'>SQL92_SECURITY and ORA-01031</title><content type='html'>&lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/12.2/refrn/SQL92_SECURITY.html#GUID-E41087C2-250E-4201-908B-79E659B22A4B"&gt;SQL92_SECURITY &lt;/a&gt;has changed its default value to &lt;b&gt;&lt;i&gt;TRUE&lt;/i&gt;&lt;/b&gt; starting from 12.2.0.1: &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/12.2/upgrd/changes-in-12c-release-2-upgrade.html#GUID-30855EA7-7194-4E09-A676-37CB74BD4C12"&gt;Upgrade Guide&lt;/a&gt;.&lt;br /&gt;That might lead to &lt;b&gt;&lt;i&gt;ORA-01031: insufficient privileges&lt;/i&gt;&lt;/b&gt; errors being thrown in runtime as the following script demonstrates.&lt;br /&gt;&lt;br /&gt;&lt;pre class="brush:sql;highlight:[32,40]"&gt;SQL&gt; grant create session, create table, unlimited tablespace to tc_data identified by tc_data;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create table tc_data.t&lt;br /&gt;  2  as&lt;br /&gt;  3  select *&lt;br /&gt;  4    from dual;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; grant create session, create procedure to tc_app identified by tc_app;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; grant delete on tc_data.t to tc_app;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create or replace procedure tc_app.p&lt;br /&gt;  2  is&lt;br /&gt;  3  begin&lt;br /&gt;  4    delete tc_data.t&lt;br /&gt;  5     where dummy = 'X';&lt;br /&gt;  6  end;&lt;br /&gt;  7  /&lt;br /&gt;&lt;br /&gt;Procedure created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec tc_app.p&lt;br /&gt;BEGIN tc_app.p; END;&lt;br /&gt;&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-01031: insufficient privileges&lt;br /&gt;ORA-06512: at "TC_APP.P", line 4&lt;br /&gt;ORA-06512: at line 1&lt;br /&gt;&lt;/pre&gt;Although the procedure is valid, it throws an &lt;b&gt;&lt;i&gt;ORA-01031&lt;/i&gt;&lt;/b&gt; error as soon as the statement refers to any table columns including pseudo-columns, such as ROWID (I have tested it only for ROWID).&lt;br /&gt;&lt;br /&gt;I have even seen a case similar to the one below, when the code throws an error depending on its input parameters:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[15,22]"&gt;SQL&gt; create or replace procedure tc_app.p_collection(p_tbl sys.odcivarchar2list)&lt;br /&gt;  2  is&lt;br /&gt;  3  begin&lt;br /&gt;  4    forall i in 1..p_tbl.count&lt;br /&gt;  5      delete tc_data.t&lt;br /&gt;  6       where dummy = p_tbl(i);&lt;br /&gt;  7  end;&lt;br /&gt;  8  /&lt;br /&gt;&lt;br /&gt;Procedure created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec tc_app.p_collection(sys.odcivarchar2list())&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt; exec tc_app.p_collection(sys.odcivarchar2list('y'))&lt;br /&gt;BEGIN tc_app.p_collection(sys.odcivarchar2list('y')); END;&lt;br /&gt;&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-01031: insufficient privileges&lt;br /&gt;ORA-06512: at "TC_APP.P_COLLECTION", line 4&lt;br /&gt;ORA-06512: at line 1&lt;br /&gt;&lt;/pre&gt;I can imagine that Oracle has not implemented the behavior when the code does not compile if it is known that there is a missing privilege due to &lt;b&gt;&lt;i&gt;SQL92_SECURITY=TRUE&lt;/i&gt;&lt;/b&gt; - it is just an instance parameter and it can be changed back and forth. Thus, it would make the status of the objects misleading. For instance, a valid PL/SQL unit with &lt;b&gt;&lt;i&gt;SQL92_SECURITY=FALSE&lt;/i&gt;&lt;/b&gt;, should either become invalid or throw a runtime &lt;b&gt;&lt;i&gt;ORA-01031&lt;/i&gt;&lt;/b&gt; error when &lt;b&gt;&lt;i&gt;SQL92_SECURITY=TRUE&lt;/i&gt;&lt;/b&gt;.&lt;br /&gt;However, it might come in handy to have a PL/SQL warning at least to identify possible missing privileges.&lt;br /&gt;It can also be a good idea to change the scope of the &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/12.2/refrn/SQL92_SECURITY.html#GUID-E41087C2-250E-4201-908B-79E659B22A4B"&gt;SQL92_SECURITY&lt;/a&gt; parameter and make it one of the PL/SQL compiler settings of the stored objects shown in &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/12.2/refrn/ALL_PLSQL_OBJECT_SETTINGS.html#GUID-7EF7B6E3-50B1-43C3-A56E-40955B47C65D"&gt;DBA_PLSQL_OBJECT_SETTINGS&lt;/a&gt;.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/3899856027799831476/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/11/sql92security-and-ora-01031.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3899856027799831476'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3899856027799831476'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/11/sql92security-and-ora-01031.html' title='SQL92_SECURITY and ORA-01031'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-5503436853271688515</id><published>2019-10-23T20:00:00.000+06:00</published><updated>2019-10-23T21:01:50.562+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><category scheme='http://www.blogger.com/atom/ns#' term='DBMS_LOB'/><title type='text'>Temporary LOBs</title><content type='html'>I have recently optimized one of processes working with LOBs and decided to write a blog post about it.&lt;br /&gt;&lt;br /&gt;There was an anonymous block like the following:&lt;br /&gt;&lt;pre class="brush:sql"&gt;declare&lt;br /&gt;  v_result clob;&lt;br /&gt;begin&lt;br /&gt;  for test_rec in (&lt;br /&gt;    select substr(clob_col, 1, 32000) clob_part1,&lt;br /&gt;           substr(clob_col, 32001, 32000) clob_part2&lt;br /&gt;      from driving_table&lt;br /&gt;     where some_conditions&lt;br /&gt;     order by sort_column)&lt;br /&gt;  loop&lt;br /&gt;    v_result := v_result || test_rec.clob_part1 || ';' || test_rec.clob_part2;&lt;br /&gt;  end loop;&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;&lt;/pre&gt;In a nutshell, that block unloaded some LOB data to a CLOB. Developers identified that this block was working quite fine being run for a relatively small number of rows, but the performance was deteriorating drastically when the same block was running against a large number of rows.&lt;br /&gt;&lt;br /&gt;To set the scene for further analysis, let's create a table with 100K rows that has a 100 byte CLOB column:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; create table t100(&lt;br /&gt;  2    n int generated as identity,&lt;br /&gt;  3    c clob);&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert /*+ append*/into t100(c)&lt;br /&gt;  2  select lpad('x', 100, 'x')&lt;br /&gt;  3    from xmltable('1 to 100000');&lt;br /&gt;&lt;br /&gt;100000 rows created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; commit;&lt;br /&gt;&lt;/pre&gt;Firstly, I show what happens when I try to emulate the original cursor:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[72]"&gt;-- I am gathering some memory statistics to be used in further research&lt;br /&gt;SQL&gt; select pga_used_mem, pga_alloc_mem&lt;br /&gt;  2    from v$session s,&lt;br /&gt;  3         v$process p&lt;br /&gt;  4   where s.sid = sys_context('userenv', 'sid')&lt;br /&gt;  5     and p.addr = s.paddr;&lt;br /&gt;&lt;br /&gt;PGA_USED_MEM PGA_ALLOC_MEM&lt;br /&gt;------------ -------------&lt;br /&gt;     2544108       4114740&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select pm.*&lt;br /&gt;  2    from v$session s,&lt;br /&gt;  3         v$process p,&lt;br /&gt;  4         v$process_memory pm&lt;br /&gt;  5   where s.sid = sys_context('userenv', 'sid')&lt;br /&gt;  6     and p.addr = s.paddr&lt;br /&gt;  7     and pm.pid = p.pid&lt;br /&gt;  8   order by pm.category;&lt;br /&gt;&lt;br /&gt;       PID    SERIAL# CATEGORY         ALLOCATED       USED MAX_ALLOCATED     CON_ID&lt;br /&gt;---------- ---------- --------------- ---------- ---------- ------------- ----------&lt;br /&gt;        77        157 Other              5667940                  5667940          3&lt;br /&gt;        77        157 PL/SQL               30744      23680         31920          3&lt;br /&gt;        77        157 SQL                  54456      43688        319280          3&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; var rc refcursor&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; begin&lt;br /&gt;  2    open :rc for&lt;br /&gt;  3      select n,&lt;br /&gt;  4             substr(c, 1, 40) c_part1,&lt;br /&gt;  5             substr(c, 41, 40) c_part2,&lt;br /&gt;  6             substr(c, 81, 40) c_part3&lt;br /&gt;  7        from t100&lt;br /&gt;  8       where n &lt;= 50000&lt;br /&gt;  9       order by n;&lt;br /&gt; 10  end;&lt;br /&gt; 11  /&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt; declare&lt;br /&gt;  2    n int;&lt;br /&gt;  3    c1 clob;&lt;br /&gt;  4    c2 c1%type;&lt;br /&gt;  5    c3 c1%type;&lt;br /&gt;  6  begin&lt;br /&gt;  7    fetch :rc&lt;br /&gt;  8      into n, c1, c2, c3;&lt;br /&gt;  9  end;&lt;br /&gt; 10  /&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select pm.*&lt;br /&gt;  2    from v$session s,&lt;br /&gt;  3         v$process p,&lt;br /&gt;  4         v$process_memory pm&lt;br /&gt;  5   where s.sid = sys_context('userenv', 'sid')&lt;br /&gt;  6     and p.addr = s.paddr&lt;br /&gt;  7     and pm.pid = p.pid&lt;br /&gt;  8   order by pm.category;&lt;br /&gt;&lt;br /&gt;       PID    SERIAL# CATEGORY         ALLOCATED       USED MAX_ALLOCATED     CON_ID&lt;br /&gt;---------- ---------- --------------- ---------- ---------- ------------- ----------&lt;br /&gt;        77        157 Freeable           1048576          0                        3&lt;br /&gt;        77        157 Other           1375048620               1375048620          3&lt;br /&gt;        77        157 PL/SQL               32856      23104         60960          3&lt;br /&gt;        77        157 SQL               14988592   11145152      17361192          3&lt;br /&gt;&lt;/pre&gt;Oops! The code allocated 1.3G PGA in the Other category. There are also 150K abstract LOBs created:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[7]"&gt;SQL&gt; select *&lt;br /&gt;  2    from v$temporary_lobs&lt;br /&gt;  3   where sid = sys_context('userenv', 'sid');&lt;br /&gt;&lt;br /&gt;       SID CACHE_LOBS NOCACHE_LOBS ABSTRACT_LOBS     CON_ID&lt;br /&gt;---------- ---------- ------------ ------------- ----------&lt;br /&gt;       435          0            0        150000          3&lt;br /&gt;&lt;/pre&gt;Let us find out what we have in &lt;b&gt;&lt;i&gt;V$PROCESS_MEMORY_DETAIL&lt;/i&gt;&lt;/b&gt;:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; alter session set events 'immediate trace name pga_detail_get level 77';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; select name, heap_name, bytes, allocation_count, bytes/150000&lt;br /&gt;  2    from v$process_memory_detail&lt;br /&gt;  3   where pid = 77&lt;br /&gt;  4     and category = 'Other'&lt;br /&gt;  5     and allocation_count &gt;= 140000&lt;br /&gt;  6   order by allocation_count&lt;br /&gt;  7  /&lt;br /&gt;&lt;br /&gt;NAME                       HEAP_NAME            BYTES ALLOCATION_COUNT BYTES/150000&lt;br /&gt;-------------------------- --------------- ---------- ---------------- ------------&lt;br /&gt;kghdsx                     kokltcr: creat    16800000           150000          112&lt;br /&gt;free permanent memory      kokltcr: creat    15600216           150000    104.00144&lt;br /&gt;kolrarfc:lobloc_kolrhte    kolr heap ds i     9610304           150000   64.0686933&lt;br /&gt;kolraloc-1                 kolr heap ds i    12289592           150002   81.9306133&lt;br /&gt;kokltcr: create clob       koh dur heap d    53599912           300000   357.332747&lt;br /&gt;kghsseg: kolaslCreateCtx   kokltcr: creat  1212000000           300000         8080&lt;br /&gt;&lt;/pre&gt;That is more than 8,192 bytes per abstract LOB even for these 40 byte LOBs!&lt;br /&gt;&lt;br /&gt;These are in-memory LOBs, however, memory is a limited resource obviously and Oracle can create non-in-memory LOBs starting with a certain number of abstract LOBs (it is around 215K LOBs in my test database). Notice that I limited the number of rows to 100K to create 300K abstract LOBs:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[8,36]"&gt;SQL&gt; begin&lt;br /&gt;  2    open :rc for&lt;br /&gt;  3      select n,&lt;br /&gt;  4             substr(c, 1, 40) c_part1,&lt;br /&gt;  5             substr(c, 41, 40) c_part2,&lt;br /&gt;  6             substr(c, 81, 40) c_part3&lt;br /&gt;  7        from t100&lt;br /&gt;  8       where n &lt;= 100000&lt;br /&gt;  9       order by n;&lt;br /&gt; 10  end;&lt;br /&gt; 11  /&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:00.20&lt;br /&gt;SQL&gt; declare&lt;br /&gt;  2    n int;&lt;br /&gt;  3    c1 clob;&lt;br /&gt;  4    c2 c1%type;&lt;br /&gt;  5    c3 c1%type;&lt;br /&gt;  6  begin&lt;br /&gt;  7    fetch :rc&lt;br /&gt;  8      into n, c1, c2, c3;&lt;br /&gt;  9  end;&lt;br /&gt; 10  /&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:01:08.04&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from v$temporary_lobs&lt;br /&gt;  3   where sid = sys_context('userenv', 'sid');&lt;br /&gt;&lt;br /&gt;       SID CACHE_LOBS NOCACHE_LOBS ABSTRACT_LOBS     CON_ID&lt;br /&gt;---------- ---------- ------------ ------------- ----------&lt;br /&gt;       435      84626            0        300000          3&lt;br /&gt;&lt;/pre&gt;Here is the output from &lt;b&gt;&lt;i&gt;V$TEMPSEG_USAGE&lt;/i&gt;&lt;/b&gt;:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[8]"&gt;SQL&gt; select contents, segtype, blocks &lt;br /&gt;  2    from v$tempseg_usage&lt;br /&gt;  3   where session_num = 61759;&lt;br /&gt;&lt;br /&gt;CONTENTS  SEGTYPE       BLOCKS&lt;br /&gt;--------- --------- ----------&lt;br /&gt;TEMPORARY SORT            1792&lt;br /&gt;TEMPORARY LOB_DATA       84736&lt;br /&gt;&lt;/pre&gt;After enabling an event &lt;b&gt;&lt;i&gt;trace[LOB_REFCOUNT]&lt;/i&gt;&lt;/b&gt;, the following can be seen in the tracefile:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[1,11,20,25]"&gt;PGA usage percent: 74 percent, isMaxHeap reached?: 0, Mem check freq: 50&lt;br /&gt;kolrarfc:  0x55 0xbc 0x0d 0x00 0x00 0x03 0x40 0x9e  : 1&lt;br /&gt;kolrarfc: kolaCreateClob()+123&lt;-kolaslCreateClob()+144&lt;-kole_templob_init()+431&lt;-kole_substr()+728&lt;-kokle_substr()+340&lt;-evaopn2()+612&lt;-qersoRowP()+2657&lt;-qerstRowP()+802&lt;-kdstf010000100000000kmP()+1377&lt;-kdsttgr()+2149&lt;-qertbFetch()+1409&lt;-qerstFetch()+477&lt;-qersoProcessULS()+300&lt;-qersoFetchSimple()+1433&lt;-qersoFetch()+210&lt;br /&gt;kolradls:  0x55 0xbc 0x0d 0x00 0x00 0x03 0x40 0x9e  : 1 (32)&lt;br /&gt;kolrarfc:  0x55 0xbc 0x0d 0x00 0x00 0x03 0x40 0x9e  : 2&lt;br /&gt;kolrarfc: kokegOpnGarbagePromote()+103&lt;-qersoRowP()+2069&lt;-qerstRowP()+802&lt;-kdstf010000100000000kmP()+1377&lt;-kdsttgr()+2149&lt;-qertbFetch()+1409&lt;-qerstFetch()+477&lt;-qersoProcessULS()+300&lt;-qersoFetchSimple()+1433&lt;-qersoFetch()+210&lt;-qerstFetch()+477&lt;-opifch2()+3267&lt;-opifch()+62&lt;-opipls()+7312&lt;-opiodr()+1229&lt;br /&gt;kolradc :  0x55 0xbc 0x0d 0x00 0x00 0x03 0x40 0x9e  : 2 (32)&lt;br /&gt;&lt;br /&gt;...skip...&lt;br /&gt;&lt;br /&gt;PGA usage percent: 75 percent, isMaxHeap reached?: 1, Mem check freq: 25&lt;br /&gt;kolrarfc:  0x55 0xbc 0x0d 0x00 0x00 0x03 0x42 0x2e  : 1&lt;br /&gt;kolrarfc: kolaCreateClob()+123&lt;-kolaslCreateClob()+144&lt;-kole_templob_init()+431&lt;-kole_substr()+728&lt;-kokle_substr()+340&lt;-evaopn2()+612&lt;-qersoRowP()+2657&lt;-qerstRowP()+802&lt;-kdstf010000100000000kmP()+1377&lt;-kdsttgr()+2149&lt;-qertbFetch()+1409&lt;-qer&lt;br /&gt;stFetch()+477&lt;-qersoProcessULS()+300&lt;-qersoFetchSimple()+1433&lt;-qersoFetch()+210&lt;br /&gt;kolradls:  0x55 0xbc 0x0d 0x00 0x00 0x03 0x42 0x2e  : 1 (32)&lt;br /&gt;kolrarfc:  0x55 0xbc 0x0d 0x00 0x00 0x03 0x42 0x2e  : 2&lt;br /&gt;kolrarfc: kokegOpnGarbagePromote()+103&lt;-qersoRowP()+2069&lt;-qerstRowP()+802&lt;-kdstf010000100000000kmP()+1377&lt;-kdsttgr()+2149&lt;-qertbFetch()+1409&lt;-qerstFetch()+477&lt;-qersoProcessULS()+300&lt;-qersoFetchSimple()+1433&lt;-qersoFetch()+210&lt;-qerstFetch()+4&lt;br /&gt;77&lt;-opifch2()+3267&lt;-opifch()+62&lt;-opipls()+7312&lt;-opiodr()+1229&lt;br /&gt;kolradc :  0x55 0xbc 0x0d 0x00 0x00 0x03 0x42 0x2e  : 2 (32)&lt;br /&gt;Max limit reached for in-mem heap allocation&lt;br /&gt;kolrarfc:  0x55 0xbc 0x0d 0x00 0x00 0x03 0x42 0x2f  : 1&lt;br /&gt;kolrarfc: kolaCreateClob()+123&lt;-kolaslCreateClob()+144&lt;-kole_templob_init()+431&lt;-kole_substr()+728&lt;-kokle_substr()+340&lt;-evaopn2()+612&lt;-qersoRowP()+2657&lt;-qerstRowP()+802&lt;-kdstf010000100000000kmP()+1377&lt;-kdsttgr()+2149&lt;-qertbFetch()+1409&lt;-qerstFetch()+477&lt;-qersoProcessULS()+300&lt;-qersoFetchSimple()+1433&lt;-qersoFetch()+210&lt;br /&gt;kolradls:  0x55 0xbc 0x0d 0x00 0x00 0x03 0x42 0x2f  : 1 (32)&lt;br /&gt;kolrarfc:  0x55 0xbc 0x0d 0x00 0x00 0x03 0x42 0x30  : 1&lt;br /&gt;kolrarfc: kokltcc()+131&lt;-koltitcr()+364&lt;-kolttcr()+72&lt;-kolaslWriteCreateTempLob()+607&lt;-kolaslWrite()+656&lt;-kolaWrite()+289&lt;-kolaCopy()+726&lt;-koklAbsCopy()+69&lt;-kokasuc()+247&lt;-koklcopy2()+4270&lt;-koklc_copy()+78&lt;-kole_append()+211&lt;-kole_templob_init()+354&lt;-kole_substr()+728&lt;-kokle_substr()+340&lt;br /&gt;&lt;/pre&gt;Once the session reached the max heap, which seems to be &lt;b&gt;&lt;i&gt;75%&lt;/i&gt;&lt;/b&gt; in my environment, it starts allocating non-in-memory temporary LOBs and there are functions such as &lt;b&gt;&lt;i&gt;kolaslWrite&lt;/i&gt;&lt;/b&gt; and &lt;b&gt;&lt;i&gt;kolaslWriteCreateTempLob&lt;/i&gt;&lt;/b&gt; on the callstack that implies that they might be writing something to the temporary tablespace.   Let us take a look now at the following PL/SQL block that emulates what the application code does: &lt;pre class="brush:sql; highlight:[32,33,37]"&gt;SQL&gt; declare&lt;br /&gt;  2    v_reporting_freq constant pls_integer := 20000;&lt;br /&gt;  3    procedure log_info(i_msg varchar2)&lt;br /&gt;  4    is&lt;br /&gt;  5    begin&lt;br /&gt;  6      dbms_output.put_line(to_char(sysdate, 'hh24:mi:ss')||' '||i_msg);&lt;br /&gt;  7    end log_info;&lt;br /&gt;  8  begin&lt;br /&gt;  9    log_info('Starting execution');&lt;br /&gt; 10    for test_rec in (&lt;br /&gt; 11      select n,&lt;br /&gt; 12             substr(c, 1, 40) c_part1,&lt;br /&gt; 13             substr(c, 41, 40) c_part2,&lt;br /&gt; 14             substr(c, 81, 40) c_part3&lt;br /&gt; 15        from t100&lt;br /&gt; 16       where n &lt;= 100000&lt;br /&gt; 17       order by n)&lt;br /&gt; 18    loop&lt;br /&gt; 19      if mod(test_rec.n, v_reporting_freq) = 0&lt;br /&gt; 20      then&lt;br /&gt; 21        log_info('Processed '||v_reporting_freq||' rows');&lt;br /&gt; 22      end if;&lt;br /&gt; 23    end loop;&lt;br /&gt; 24    log_info('Finishing execution');&lt;br /&gt; 25  end;&lt;br /&gt; 26  /&lt;br /&gt;06:35:34 Starting execution&lt;br /&gt;06:36:58 Processed 20000 rows&lt;br /&gt;06:37:10 Processed 20000 rows&lt;br /&gt;06:37:18 Processed 20000 rows&lt;br /&gt;06:37:21 Processed 20000 rows&lt;br /&gt;06:37:22 Processed 20000 rows&lt;br /&gt;06:44:52 Finishing execution&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:09:18.82&lt;br /&gt;&lt;/pre&gt;There are a few observations about this output: &lt;ol&gt;&lt;li&gt;The SELECT was running from &lt;b&gt;&lt;i&gt;35:34&lt;/i&gt;&lt;/b&gt; to &lt;b&gt;&lt;i&gt;37:22&lt;/i&gt;&lt;/b&gt;, it is &lt;b&gt;&lt;i&gt;108&lt;/i&gt;&lt;/b&gt; seconds.&lt;/li&gt;&lt;li&gt;The block itself was running in 9 minutes 18 seconds or in &lt;b&gt;&lt;i&gt;558&lt;/i&gt;&lt;/b&gt; seconds, which is &lt;b&gt;&lt;i&gt;108(SELECT)+450(other)&lt;/i&gt;&lt;/b&gt;&lt;/li&gt;&lt;li&gt;What exactly happened between &lt;b&gt;&lt;i&gt;06:37:22&lt;/i&gt;&lt;/b&gt;, when was the last fetch, and &lt;b&gt;&lt;i&gt;06:44:52&lt;/i&gt;&lt;/b&gt; - that is exactly &lt;b&gt;&lt;i&gt;450&lt;/i&gt;&lt;/b&gt; seconds, when the block finished?&lt;/li&gt;&lt;/ol&gt;Here is a tkprof processed tracefile: &lt;pre class="brush:sql"&gt;SQL ID: btysk50atwccn Plan Hash: 1939537825&lt;br /&gt;&lt;br /&gt;SELECT N, SUBSTR(C, 1, 40) C_PART1, SUBSTR(C, 41, 40) C_PART2, SUBSTR(C, 81,&lt;br /&gt;  40) C_PART3&lt;br /&gt;FROM&lt;br /&gt; T100 WHERE N &lt;= 100000 ORDER BY N&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;call     count       cpu    elapsed       disk      query    current        rows&lt;br /&gt;------- ------  -------- ---------- ---------- ---------- ----------  ----------&lt;br /&gt;Parse        1      0.00       0.00          0          0          0           0&lt;br /&gt;Execute      1      0.00       0.00          0          0          0           0&lt;br /&gt;Fetch     1001    106.43     107.82       5029       3341     649751      100000&lt;br /&gt;------- ------  -------- ---------- ---------- ---------- ----------  ----------&lt;br /&gt;total     1003    106.43     107.82       5029       3341     649751      100000&lt;br /&gt;&lt;br /&gt;Misses in library cache during parse: 0&lt;br /&gt;Optimizer mode: ALL_ROWS&lt;br /&gt;Parsing user id: 107     (recursive depth: 1)&lt;br /&gt;Number of plan statistics captured: 1&lt;br /&gt;&lt;br /&gt;Rows (1st) Rows (avg) Rows (max)  Row Source Operation&lt;br /&gt;---------- ---------- ----------  ---------------------------------------------------&lt;br /&gt;    100000     100000     100000  SORT ORDER BY (cr=3341 pr=5029 pw=1695 time=108105549 us starts=1 cost=2080 size=4600000 card=100000)&lt;br /&gt;    100000     100000     100000   TABLE ACCESS FULL T100 (cr=3341 pr=3334 pw=0 time=474939 us starts=1 cost=923 size=4600000 card=100000)&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Elapsed times include waiting on following events:&lt;br /&gt;  Event waited on                             Times   Max. Wait  Total Waited&lt;br /&gt;  ----------------------------------------   Waited  ----------  ------------&lt;br /&gt;  PGA memory operation                        37387        0.00          0.29&lt;br /&gt;  Disk file operations I/O                        2        0.00          0.00&lt;br /&gt;  db file scattered read                         67        0.00          0.09&lt;br /&gt;  CSS initialization                              1        0.00          0.00&lt;br /&gt;  CSS operation: query                            6        0.00          0.00&lt;br /&gt;  CSS operation: action                           1        0.00          0.00&lt;br /&gt;  direct path write temp                         26        0.00          0.02&lt;br /&gt;  direct path read temp                          66        0.00          0.07&lt;br /&gt;&lt;br /&gt;********************************************************************************&lt;br /&gt;&lt;br /&gt;declare&lt;br /&gt;  v_reporting_freq constant pls_integer := 20000;&lt;br /&gt;  procedure log_info(i_msg varchar2)&lt;br /&gt;  is&lt;br /&gt;  begin&lt;br /&gt;    dbms_output.put_line(to_char(sysdate, 'hh24:mi:ss')||' '||i_msg);&lt;br /&gt;  end log_info;&lt;br /&gt;begin&lt;br /&gt;  log_info('Starting execution');&lt;br /&gt;  for test_rec in (&lt;br /&gt;    select n,&lt;br /&gt;           substr(c, 1, 40) c_part1,&lt;br /&gt;           substr(c, 41, 40) c_part2,&lt;br /&gt;           substr(c, 81, 40) c_part3&lt;br /&gt;      from t100&lt;br /&gt;     where n &lt;= 100000&lt;br /&gt;     order by n)&lt;br /&gt;  loop&lt;br /&gt;    if mod(test_rec.n, v_reporting_freq) = 0&lt;br /&gt;    then&lt;br /&gt;      log_info('Processed '||v_reporting_freq||' rows');&lt;br /&gt;    end if;&lt;br /&gt;  end loop;&lt;br /&gt;  log_info('Finishing execution');&lt;br /&gt;end;&lt;br /&gt;&lt;br /&gt;call     count       cpu    elapsed       disk      query    current        rows&lt;br /&gt;------- ------  -------- ---------- ---------- ---------- ----------  ----------&lt;br /&gt;Parse        1      0.00       0.00          0          0          0           0&lt;br /&gt;Execute      1    446.41     450.44          0          0     468361           1&lt;br /&gt;Fetch        0      0.00       0.00          0          0          0           0&lt;br /&gt;------- ------  -------- ---------- ---------- ---------- ----------  ----------&lt;br /&gt;total        2    446.41     450.44          0          0     468361           1&lt;br /&gt;&lt;br /&gt;Misses in library cache during parse: 0&lt;br /&gt;Optimizer mode: ALL_ROWS&lt;br /&gt;Parsing user id: 107&lt;br /&gt;&lt;br /&gt;Elapsed times include waiting on following events:&lt;br /&gt;  Event waited on                             Times   Max. Wait  Total Waited&lt;br /&gt;  ----------------------------------------   Waited  ----------  ------------&lt;br /&gt;  PGA memory operation                          419        0.11          0.13&lt;br /&gt;  SQL*Net message to client                       1        0.00          0.00&lt;br /&gt;  SQL*Net message from client                     1        0.10          0.10&lt;br /&gt;&lt;/pre&gt;There are no waits that can explain why the block took 450 seconds to execute. Let us get to the raw tracefile then: &lt;pre class="brush:sql; highlight:[38,42]"&gt;PARSING IN CURSOR #140371888210368 len=617 dep=0 uid=107 oct=47 lid=107 tim=9831631653615 hv=2253167668 ad='c9f31410' sqlid='3sfmy3y34t71n'&lt;br /&gt;declare&lt;br /&gt;  v_reporting_freq constant pls_integer := 20000;&lt;br /&gt;  procedure log_info(i_msg varchar2)&lt;br /&gt;  is&lt;br /&gt;  begin&lt;br /&gt;    dbms_output.put_line(to_char(sysdate, 'hh24:mi:ss')||' '||i_msg);&lt;br /&gt;  end log_info;&lt;br /&gt;begin&lt;br /&gt;  log_info('Starting execution');&lt;br /&gt;  for test_rec in (&lt;br /&gt;    select n,&lt;br /&gt;           substr(c, 1, 40) c_part1,&lt;br /&gt;           substr(c, 41, 40) c_part2,&lt;br /&gt;           substr(c, 81, 40) c_part3&lt;br /&gt;      from t100&lt;br /&gt;     where n &lt;= 100000&lt;br /&gt;     order by n)&lt;br /&gt;  loop&lt;br /&gt;    if mod(test_rec.n, v_reporting_freq) = 0&lt;br /&gt;    then&lt;br /&gt;      log_info('Processed '||v_reporting_freq||' rows');&lt;br /&gt;    end if;&lt;br /&gt;  end loop;&lt;br /&gt;  log_info('Finishing execution');&lt;br /&gt;end;&lt;br /&gt;END OF STMT&lt;br /&gt;PARSE #140371888210368:c=96,e=95,p=0,cr=0,cu=0,mis=0,r=0,dep=0,og=1,plh=0,tim=9831631653614&lt;br /&gt;=====================&lt;br /&gt;PARSING IN CURSOR #140371888222536 len=127 dep=1 uid=107 oct=3 lid=107 tim=9831631654062 hv=362688916 ad='c91e39a0' sqlid='btysk50atwccn'&lt;br /&gt;SELECT N, SUBSTR(C, 1, 40) C_PART1, SUBSTR(C, 41, 40) C_PART2, SUBSTR(C, 81, 40) C_PART3 FROM T100 WHERE N &lt;= 100000 ORDER BY N&lt;br /&gt;END OF STMT&lt;br /&gt;PARSE #140371888222536:c=95,e=95,p=0,cr=0,cu=0,mis=0,r=0,dep=1,og=1,plh=1939537825,tim=9831631654062&lt;br /&gt;EXEC #140371888222536:c=41,e=41,p=0,cr=0,cu=0,mis=0,r=0,dep=1,og=1,plh=1939537825,tim=9831631654152&lt;br /&gt;&lt;br /&gt;..skip..&lt;br /&gt;FETCH #140371888222536:c=946,e=539,p=0,cr=0,cu=0,mis=0,r=100,dep=1,og=1,plh=1939537825,tim=9831739623035&lt;br /&gt;FETCH #140371888222536:c=59,e=59,p=0,cr=0,cu=0,mis=0,r=0,dep=1,og=1,plh=1939537825,tim=9831739623185&lt;br /&gt;STAT #140371888222536 id=1 cnt=100000 pid=0 pos=1 obj=0 op='SORT ORDER BY (cr=3341 pr=5029 pw=1695 str=1 time=108105549 us cost=2080 size=4600000 card=100000)'&lt;br /&gt;STAT #140371888222536 id=2 cnt=100000 pid=1 pos=1 obj=158217 op='TABLE ACCESS FULL T100 (cr=3341 pr=3334 pw=0 str=1 time=474939 us cost=923 size=4600000 card=100000)'&lt;br /&gt;&lt;br /&gt;*** 2019-10-23 06:44:52.738 (PDB(3))&lt;br /&gt;CLOSE #140371888222536:c=1,e=1,dep=1,type=3,tim=9832189916721&lt;br /&gt;EXEC #140371888210368:c=552847911,e=558267064,p=5029,cr=3341,cu=1118112,mis=0,r=1,dep=0,og=1,plh=0,tim=9832189920765&lt;br /&gt;&lt;br /&gt;*** 2019-10-23 06:44:52.934 (PDB(3))&lt;br /&gt;WAIT #140371888210368: nam='PGA memory operation' ela= 89 p1=0 p2=0 p3=0 obj#=158217 tim=9832190113279&lt;br /&gt;WAIT #140371888210368: nam='PGA memory operation' ela= 61 p1=0 p2=0 p3=0 obj#=158217 tim=9832190113427&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;The tracefile does not show what was going on between the last fetch(tim=&lt;b&gt;&lt;i&gt;9831739623185&lt;/i&gt;&lt;/b&gt;) and the time the cursor was closed(tim=&lt;b&gt;&lt;i&gt;9832189916721&lt;/i&gt;&lt;/b&gt;).   Here is the &lt;b&gt;&lt;i&gt;V$ACTIVE_SESSION_HISTORY&lt;/i&gt;&lt;/b&gt; (ASH) output for the problem block: &lt;pre class="brush:sql;highlight:[28,52,61]"&gt;SQL&gt; select to_char(sample_time, 'hh24:mi:ss') sample_time, sql_id, sql_opname, top_level_sql_id, session_state, event,&lt;br /&gt;  2         trim(case when IN_CONNECTION_MGMT='Y' then ' IN_CONNECTION_MGMT' end||&lt;br /&gt;  3              case when IN_PARSE='Y' then ' IN_PARSE' end||&lt;br /&gt;  4              case when IN_HARD_PARSE='Y' then ' IN_HARD_PARSE' end||&lt;br /&gt;  5              case when IN_SQL_EXECUTION='Y' then ' IN_SQL_EXECUTION' end||&lt;br /&gt;  6              case when IN_PLSQL_EXECUTION='Y' then ' IN_PLSQL_EXECUTION' end||&lt;br /&gt;  7              case when IN_PLSQL_RPC='Y' then ' IN_PLSQL_RPC' end||&lt;br /&gt;  8              case when IN_PLSQL_COMPILATION='Y' then ' IN_PLSQL_COMPILATION' end||&lt;br /&gt;  9              case when IN_JAVA_EXECUTION='Y' then ' IN_JAVA_EXECUTION' end||&lt;br /&gt; 10              case when IN_BIND='Y' then ' IN_BIND' end||&lt;br /&gt; 11              case when IN_CURSOR_CLOSE='Y' then ' IN_CURSOR_CLOSE' end||&lt;br /&gt; 12              case when IN_SEQUENCE_LOAD='Y' then ' IN_SEQUENCE_LOAD' end||&lt;br /&gt; 13              case when IN_INMEMORY_QUERY='Y' then ' IN_INMEMORY_QUERY' end||&lt;br /&gt; 14              case when IN_INMEMORY_POPULATE='Y' then ' IN_INMEMORY_POPULATE' end||&lt;br /&gt; 15              case when IN_INMEMORY_PREPOPULATE='Y' then ' IN_INMEMORY_PREPOPULATE' end||&lt;br /&gt; 16              case when IN_INMEMORY_REPOPULATE='Y' then ' IN_INMEMORY_REPOPULATE' end||&lt;br /&gt; 17              case when IN_INMEMORY_TREPOPULATE='Y' then ' IN_INMEMORY_TREPOPULATE' end||&lt;br /&gt; 18              case when IN_TABLESPACE_ENCRYPTION='Y' then ' IN_TABLESPACE_ENCRYPTION' end) activity,&lt;br /&gt; 19         pga_allocated,&lt;br /&gt; 20         temp_space_allocated&lt;br /&gt; 21    from v$active_session_history&lt;br /&gt; 22   where session_id = 52&lt;br /&gt; 23     and sample_time &gt;= timestamp'2019-10-23 06:35:33'&lt;br /&gt; 24   order by sample_time;&lt;br /&gt;&lt;br /&gt;SAMPLE_T SQL_ID        SQL_OPNAME    TOP_LEVEL_SQL SESSION_STATE EVENT      ACTIVITY         PGA_ALLOCATED TEMP_SPACE_ALLOCATED&lt;br /&gt;-------- ------------- ------------- ------------- ------------- ---------- ---------------- ------------- --------------------&lt;br /&gt;-- the execution starts and the session steadily allocates PGA and TEMP&lt;br /&gt;06:35:35 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION     316826624                    0&lt;br /&gt;06:35:36 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION     526869504                    0&lt;br /&gt;06:35:37 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION     667640832                    0&lt;br /&gt;06:35:38 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION     775185408                    0&lt;br /&gt;06:35:39 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION     870933504              5242880&lt;br /&gt;06:35:40 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION     946693120              5242880&lt;br /&gt;06:35:41 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    1025664000              5242880&lt;br /&gt;06:35:42 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    1087202304              5242880&lt;br /&gt;06:35:43 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    1153000448              6291456&lt;br /&gt;06:35:44 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    1216242688              6291456&lt;br /&gt;06:35:45 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    1276404736              6291456&lt;br /&gt;06:35:46 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    1321624576              6291456&lt;br /&gt;06:35:47 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    1372152832              7340032&lt;br /&gt;06:35:48 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    1424450560              7340032&lt;br /&gt;06:35:49 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    1474192384              7340032&lt;br /&gt;06:35:50 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    1520133120              7340032&lt;br /&gt;06:35:51 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    1563255808              7340032&lt;br /&gt;06:35:52 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    1593336832              8388608&lt;br /&gt;&lt;br /&gt;..skip..&lt;br /&gt;&lt;br /&gt;SAMPLE_T SQL_ID        SQL_OPNAME    TOP_LEVEL_SQL SESSION_STATE EVENT      ACTIVITY         PGA_ALLOCATED TEMP_SPACE_ALLOCATED&lt;br /&gt;-------- ------------- ------------- ------------- ------------- ---------- ---------------- ------------- --------------------&lt;br /&gt;-- the SELECT completes&lt;br /&gt;06:37:19 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    2461950976            715128832&lt;br /&gt;06:37:20 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    2461950976            715128832&lt;br /&gt;06:37:21 btysk50atwccn SELECT        3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    2461950976            715128832&lt;br /&gt;06:37:23                             3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    2460902400            700448768&lt;br /&gt;06:37:24                             3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    2460902400            700448768&lt;br /&gt;06:37:25                             3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    2460902400            700448768&lt;br /&gt;06:37:26                             3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    2460902400            700448768&lt;br /&gt;&lt;br /&gt;-- the session is burning up CPUs&lt;br /&gt;06:44:50                             3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    2460902400            700448768&lt;br /&gt;06:44:51                             3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    2460902400            700448768&lt;br /&gt;06:44:52                             3sfmy3y34t71n ON CPU                   IN_SQL_EXECUTION    2460902400            700448768&lt;br /&gt;&lt;/pre&gt;I would rather expect to see some PGA and TEMP deallocations between &lt;b&gt;&lt;i&gt;06:37:22&lt;/i&gt;&lt;/b&gt; (the time when the SELECT completes) and &lt;b&gt;&lt;i&gt;06:44:52&lt;/i&gt;&lt;/b&gt; (the time when the block completes) but there are none. While I was looking at &lt;b&gt;&lt;i&gt;V$TEMPORARY_LOBS&lt;/i&gt;&lt;/b&gt;, I was observing that the session was constantly releasing LOBs during the period in question. Remember there are &lt;b&gt;&lt;i&gt;300K&lt;/i&gt;&lt;/b&gt; abstract LOBs created - they are being released in those &lt;b&gt;&lt;i&gt;450&lt;/i&gt;&lt;/b&gt; seconds. However, it is not reflected in ASH as far as I am aware. All PGA and TEMP deallocations happen at once and there is really no hint in ASH to figure out what is going on.   Let us take a look at the Flamegraph to see what Oracle functions contributed to most load: &lt;?xml version="1.0" standalone="no"?&gt;&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;&lt;svg version="1.1" width="1200" height="1574" onload="init(evt)" viewBox="0 0 1200 1574" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"&gt;&lt;!-- Flame graph stack visualization. See https://github.com/brendangregg/FlameGraph for latest version, and http://www.brendangregg.com/flamegraphs.html for examples. --&gt;&lt;!-- NOTES:  --&gt;&lt;defs&gt; &lt;linearGradient id="background" y1="0" y2="1" x1="0" x2="0" &gt;  &lt;stop stop-color="#eeeeee" offset="5%" /&gt;  &lt;stop stop-color="#eeeeb0" offset="95%" /&gt; &lt;/linearGradient&gt;&lt;/defs&gt;&lt;style type="text/css"&gt; text { font-family:Verdana; font-size:12px; fill:rgb(0,0,0); }  #search { opacity:0.1; cursor:pointer; }  #search:hover, #search.show { opacity:1; }  #subtitle { text-anchor:middle; font-color:rgb(160,160,160); }  #title { text-anchor:middle; font-size:17px}  #unzoom { cursor:pointer; }  #frames &gt; *:hover { stroke:black; stroke-width:0.5; cursor:pointer; }  .hide { display:none; }  .parent { opacity:0.5; } &lt;/style&gt;&lt;script type="text/ecmascript"&gt;&lt;![CDATA[  "use strict";  var details, searchbtn, unzoombtn, matchedtxt, svg, searching;  function init(evt) {   details = document.getElementById("details").firstChild;   searchbtn = document.getElementById("search");   unzoombtn = document.getElementById("unzoom");   matchedtxt = document.getElementById("matched");   svg = document.getElementsByTagName("svg")[0];   searching = 0;  }   window.addEventListener("click", function(e) {   var target = find_group(e.target);   if (target) {    if (target.nodeName == "a") {     if (e.ctrlKey === false) return;     e.preventDefault();    }    if (target.classList.contains("parent")) unzoom();    zoom(target);   }   else if (e.target.id == "unzoom") unzoom();   else if (e.target.id == "search") search_prompt();  }, false)   // mouse-over for info  // show  window.addEventListener("mouseover", function(e) {   var target = find_group(e.target);   if (target) details.nodeValue = "Function: " + g_to_text(target);  }, false)   // clear  window.addEventListener("mouseout", function(e) {   var target = find_group(e.target);   if (target) details.nodeValue = ' ';  }, false)   // ctrl-F for search  window.addEventListener("keydown",function (e) {   if (e.keyCode === 114 || (e.ctrlKey &amp;&amp; e.keyCode === 70)) {    e.preventDefault();    search_prompt();   }  }, false)   // functions  function find_child(node, selector) {   var children = node.querySelectorAll(selector);   if (children.length) return children[0];   return;  }  function find_group(node) {   var parent = node.parentElement;   if (!parent) return;   if (parent.id == "frames") return node;   return find_group(parent);  }  function orig_save(e, attr, val) {   if (e.attributes["_orig_" + attr] != undefined) return;   if (e.attributes[attr] == undefined) return;   if (val == undefined) val = e.attributes[attr].value;   e.setAttribute("_orig_" + attr, val);  }  function orig_load(e, attr) {   if (e.attributes["_orig_"+attr] == undefined) return;   e.attributes[attr].value = e.attributes["_orig_" + attr].value;   e.removeAttribute("_orig_"+attr);  }  function g_to_text(e) {   var text = find_child(e, "title").firstChild.nodeValue;   return (text)  }  function g_to_func(e) {   var func = g_to_text(e);   // if there's any manipulation we want to do to the function   // name before it's searched, do it here before returning.   return (func);  }  function update_text(e) {   var r = find_child(e, "rect");   var t = find_child(e, "text");   var w = parseFloat(r.attributes.width.value) -3;   var txt = find_child(e, "title").textContent.replace(/\([^(]*\)$/,"");   t.attributes.x.value = parseFloat(r.attributes.x.value) + 3;    // Smaller than this size won't fit anything   if (w &lt; 2 * 12 * 0.59) {    t.textContent = "";    return;   }    t.textContent = txt;   // Fit in full text width   if (/^ *$/.test(txt) || t.getSubStringLength(0, txt.length) &lt; w)    return;    for (var x = txt.length - 2; x &gt; 0; x--) {    if (t.getSubStringLength(0, x + 2) &lt;= w) {     t.textContent = txt.substring(0, x) + "..";     return;    }   }   t.textContent = "";  }   // zoom  function zoom_reset(e) {   if (e.attributes != undefined) {    orig_load(e, "x");    orig_load(e, "width");   }   if (e.childNodes == undefined) return;   for (var i = 0, c = e.childNodes; i &lt; c.length; i++) {    zoom_reset(c[i]);   }  }  function zoom_child(e, x, ratio) {   if (e.attributes != undefined) {    if (e.attributes.x != undefined) {     orig_save(e, "x");     e.attributes.x.value = (parseFloat(e.attributes.x.value) - x - 10) * ratio + 10;     if (e.tagName == "text")      e.attributes.x.value = find_child(e.parentNode, "rect[x]").attributes.x.value + 3;    }    if (e.attributes.width != undefined) {     orig_save(e, "width");     e.attributes.width.value = parseFloat(e.attributes.width.value) * ratio;    }   }    if (e.childNodes == undefined) return;   for (var i = 0, c = e.childNodes; i &lt; c.length; i++) {    zoom_child(c[i], x - 10, ratio);   }  }  function zoom_parent(e) {   if (e.attributes) {    if (e.attributes.x != undefined) {     orig_save(e, "x");     e.attributes.x.value = 10;    }    if (e.attributes.width != undefined) {     orig_save(e, "width");     e.attributes.width.value = parseInt(svg.width.baseVal.value) - (10 * 2);    }   }   if (e.childNodes == undefined) return;   for (var i = 0, c = e.childNodes; i &lt; c.length; i++) {    zoom_parent(c[i]);   }  }  function zoom(node) {   var attr = find_child(node, "rect").attributes;   var width = parseFloat(attr.width.value);   var xmin = parseFloat(attr.x.value);   var xmax = parseFloat(xmin + width);   var ymin = parseFloat(attr.y.value);   var ratio = (svg.width.baseVal.value - 2 * 10) / width;    // XXX: Workaround for JavaScript float issues (fix me)   var fudge = 0.0001;    unzoombtn.classList.remove("hide");    var el = document.getElementById("frames").children;   for (var i = 0; i &lt; el.length; i++) {    var e = el[i];    var a = find_child(e, "rect").attributes;    var ex = parseFloat(a.x.value);    var ew = parseFloat(a.width.value);    var upstack;    // Is it an ancestor    if (0 == 0) {     upstack = parseFloat(a.y.value) &gt; ymin;    } else {     upstack = parseFloat(a.y.value) &lt; ymin;    }    if (upstack) {     // Direct ancestor     if (ex &lt;= xmin &amp;&amp; (ex+ew+fudge) &gt;= xmax) {      e.classList.add("parent");      zoom_parent(e);      update_text(e);     }     // not in current path     else      e.classList.add("hide");    }    // Children maybe    else {     // no common path     if (ex &lt; xmin || ex + fudge &gt;= xmax) {      e.classList.add("hide");     }     else {      zoom_child(e, xmin, ratio);      update_text(e);     }    }   }  }  function unzoom() {   unzoombtn.classList.add("hide");   var el = document.getElementById("frames").children;   for(var i = 0; i &lt; el.length; i++) {    el[i].classList.remove("parent");    el[i].classList.remove("hide");    zoom_reset(el[i]);    update_text(el[i]);   }  }   // search  function reset_search() {   var el = document.querySelectorAll("#frames rect");   for (var i = 0; i &lt; el.length; i++) {    orig_load(el[i], "fill")   }  }  function search_prompt() {   if (!searching) {    var term = prompt("Enter a search term (regexp " +        "allowed, eg: ^ext4_)", "");    if (term != null) {     search(term)    }   } else {    reset_search();    searching = 0;    searchbtn.classList.remove("show");    searchbtn.firstChild.nodeValue = "Search"    matchedtxt.classList.add("hide");    matchedtxt.firstChild.nodeValue = ""   }  }  function search(term) {   var re = new RegExp(term);   var el = document.getElementById("frames").children;   var matches = new Object();   var maxwidth = 0;   for (var i = 0; i &lt; el.length; i++) {    var e = el[i];    var func = g_to_func(e);    var rect = find_child(e, "rect");    if (func == null || rect == null)     continue;     // Save max width. Only works as we have a root frame    var w = parseFloat(rect.attributes.width.value);    if (w &gt; maxwidth)     maxwidth = w;     if (func.match(re)) {     // highlight     var x = parseFloat(rect.attributes.x.value);     orig_save(rect, "fill");     rect.attributes.fill.value = "rgb(230,0,230)";      // remember matches     if (matches[x] == undefined) {      matches[x] = w;     } else {      if (w &gt; matches[x]) {       // overwrite with parent       matches[x] = w;      }     }     searching = 1;    }   }   if (!searching)    return;    searchbtn.classList.add("show");   searchbtn.firstChild.nodeValue = "Reset Search";    // calculate percent matched, excluding vertical overlap   var count = 0;   var lastx = -1;   var lastw = 0;   var keys = Array();   for (k in matches) {    if (matches.hasOwnProperty(k))     keys.push(k);   }   // sort the matched frames by their x location   // ascending, then width descending   keys.sort(function(a, b){    return a - b;   });   // Step through frames saving only the biggest bottom-up frames   // thanks to the sort order. This relies on the tree property   // where children are always smaller than their parents.   var fudge = 0.0001; // JavaScript floating point   for (var k in keys) {    var x = parseFloat(keys[k]);    var w = matches[keys[k]];    if (x &gt;= lastx + lastw - fudge) {     count += w;     lastx = x;     lastw = w;    }   }   // display matched percent   matchedtxt.classList.remove("hide");   var pct = 100 * count / maxwidth;   if (pct != 100) pct = pct.toFixed(1)   matchedtxt.firstChild.nodeValue = "Matched: " + pct + "%";  } ]]&gt;&lt;/script&gt;&lt;rect x="0.0" y="0" width="1200.0" height="1574.0" fill="url(#background)"  /&gt;&lt;text id="title" x="600.00" y="24" &gt;Flame Graph&lt;/text&gt;&lt;text id="details" x="10.00" y="1557" &gt; &lt;/text&gt;&lt;text id="unzoom" x="10.00" y="24" class="hide"&gt;Reset Zoom&lt;/text&gt;&lt;text id="search" x="1090.00" y="24" &gt;Search&lt;/text&gt;&lt;text id="matched" x="1090.00" y="1557" &gt; &lt;/text&gt;&lt;g id="frames"&gt;&lt;g &gt;&lt;title&gt;kola_set_locator (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1081.9" y="725" width="0.1" height="15.0" fill="rgb(210,203,20)" rx="2" ry="2" /&gt;&lt;text  x="1084.91" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalc (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="962.3" y="693" width="0.3" height="15.0" fill="rgb(242,130,28)" rx="2" ry="2" /&gt;&lt;text  x="965.33" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__dta_xfs_vn_update_time_3412 (10 samples, 0.02%)&lt;/title&gt;&lt;rect x="1089.0" y="165" width="0.2" height="15.0" fill="rgb(223,133,1)" rx="2" ry="2" /&gt;&lt;text  x="1092.03" y="175.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;schedule (22 samples, 0.04%)&lt;/title&gt;&lt;rect x="722.6" y="597" width="0.5" height="15.0" fill="rgb(229,224,14)" rx="2" ry="2" /&gt;&lt;text  x="725.61" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__vfs_write (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.6" y="85" width="0.1" height="15.0" fill="rgb(231,192,33)" rx="2" ry="2" /&gt;&lt;text  x="1103.62" y="95.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="12.8" y="741" width="0.1" height="15.0" fill="rgb(238,209,52)" rx="2" ry="2" /&gt;&lt;text  x="15.75" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;tlb_flush_mmu (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1189.4" y="1301" width="0.2" height="15.0" fill="rgb(237,211,41)" rx="2" ry="2" /&gt;&lt;text  x="1192.41" y="1311.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokliihdl (12 samples, 0.02%)&lt;/title&gt;&lt;rect x="1091.1" y="629" width="0.3" height="15.0" fill="rgb(254,58,45)" rx="2" ry="2" /&gt;&lt;text  x="1094.11" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbzgb (19 samples, 0.03%)&lt;/title&gt;&lt;rect x="1095.2" y="517" width="0.4" height="15.0" fill="rgb(246,104,8)" rx="2" ry="2" /&gt;&lt;text  x="1098.22" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;free_pages_and_swap_cache (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1189.4" y="1269" width="0.2" height="15.0" fill="rgb(229,148,42)" rx="2" ry="2" /&gt;&lt;text  x="1192.41" y="1279.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="963.2" y="773" width="0.2" height="15.0" fill="rgb(238,53,11)" rx="2" ry="2" /&gt;&lt;text  x="966.24" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstine_wfp (51 samples, 0.09%)&lt;/title&gt;&lt;rect x="1082.0" y="709" width="1.1" height="15.0" fill="rgb(247,229,36)" rx="2" ry="2" /&gt;&lt;text  x="1085.01" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalc (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="1083.1" y="677" width="0.2" height="15.0" fill="rgb(252,144,6)" rx="2" ry="2" /&gt;&lt;text  x="1086.14" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__handle_mm_fault (25 samples, 0.04%)&lt;/title&gt;&lt;rect x="1099.6" y="357" width="0.5" height="15.0" fill="rgb(254,201,28)" rx="2" ry="2" /&gt;&lt;text  x="1102.60" y="367.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktbchgro (33 samples, 0.06%)&lt;/title&gt;&lt;rect x="735.7" y="645" width="0.7" height="15.0" fill="rgb(250,1,2)" rx="2" ry="2" /&gt;&lt;text  x="738.70" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaslWriteCreateTempLob (89 samples, 0.16%)&lt;/title&gt;&lt;rect x="1101.0" y="645" width="1.9" height="15.0" fill="rgb(246,63,6)" rx="2" ry="2" /&gt;&lt;text  x="1104.02" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalf (10 samples, 0.02%)&lt;/title&gt;&lt;rect x="1086.1" y="741" width="0.2" height="15.0" fill="rgb(225,15,54)" rx="2" ry="2" /&gt;&lt;text  x="1089.08" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sou2o (55,631 samples, 99.90%)&lt;/title&gt;&lt;rect x="10.3" y="1429" width="1178.9" height="15.0" fill="rgb(251,228,3)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1439.5" &gt;sou2o&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrem (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="962.1" y="677" width="0.2" height="15.0" fill="rgb(250,210,51)" rx="2" ry="2" /&gt;&lt;text  x="965.10" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolredur (44,967 samples, 80.75%)&lt;/title&gt;&lt;rect x="11.0" y="885" width="952.9" height="15.0" fill="rgb(224,109,29)" rx="2" ry="2" /&gt;&lt;text  x="14.00" y="895.5" &gt;kolredur&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_syscall_64 (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.6" y="133" width="0.1" height="15.0" fill="rgb(246,96,27)" rx="2" ry="2" /&gt;&lt;text  x="1103.62" y="143.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opifch2 (55,602 samples, 99.85%)&lt;/title&gt;&lt;rect x="10.9" y="1013" width="1178.2" height="15.0" fill="rgb(215,166,36)" rx="2" ry="2" /&gt;&lt;text  x="13.91" y="1023.5" &gt;opifch2&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtRecVAWriteDisk (37 samples, 0.07%)&lt;/title&gt;&lt;rect x="1088.8" y="405" width="0.8" height="15.0" fill="rgb(246,181,50)" rx="2" ry="2" /&gt;&lt;text  x="1091.77" y="415.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;finish_task_switch (30 samples, 0.05%)&lt;/title&gt;&lt;rect x="479.9" y="565" width="0.6" height="15.0" fill="rgb(225,97,8)" rx="2" ry="2" /&gt;&lt;text  x="482.85" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgh_invoke_alloc_cb (66 samples, 0.12%)&lt;/title&gt;&lt;rect x="1088.3" y="533" width="1.4" height="15.0" fill="rgb(250,135,3)" rx="2" ry="2" /&gt;&lt;text  x="1091.27" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlrdo (130 samples, 0.23%)&lt;/title&gt;&lt;rect x="1095.8" y="453" width="2.8" height="15.0" fill="rgb(244,94,35)" rx="2" ry="2" /&gt;&lt;text  x="1098.83" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgsc (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1094.6" y="469" width="0.2" height="15.0" fill="rgb(251,105,38)" rx="2" ry="2" /&gt;&lt;text  x="1097.60" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;async_page_fault (61 samples, 0.11%)&lt;/title&gt;&lt;rect x="1087.0" y="597" width="1.2" height="15.0" fill="rgb(205,164,33)" rx="2" ry="2" /&gt;&lt;text  x="1089.95" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;entry_SYSCALL_64_after_hwframe (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.7" y="133" width="0.2" height="15.0" fill="rgb(253,136,46)" rx="2" ry="2" /&gt;&lt;text  x="1103.75" y="143.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_async_page_fault (41 samples, 0.07%)&lt;/title&gt;&lt;rect x="1099.3" y="421" width="0.9" height="15.0" fill="rgb(206,61,35)" rx="2" ry="2" /&gt;&lt;text  x="1102.31" y="431.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;run_timer_softirq (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="479.4" y="581" width="0.2" height="15.0" fill="rgb(230,83,0)" rx="2" ry="2" /&gt;&lt;text  x="482.36" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_syscall_64 (31 samples, 0.06%)&lt;/title&gt;&lt;rect x="1189.2" y="1461" width="0.7" height="15.0" fill="rgb(237,180,15)" rx="2" ry="2" /&gt;&lt;text  x="1192.19" y="1471.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__handle_mm_fault (35 samples, 0.06%)&lt;/title&gt;&lt;rect x="1087.5" y="517" width="0.7" height="15.0" fill="rgb(206,143,29)" rx="2" ry="2" /&gt;&lt;text  x="1090.50" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;tlb_finish_mmu (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="1189.4" y="1333" width="0.2" height="15.0" fill="rgb(238,82,40)" rx="2" ry="2" /&gt;&lt;text  x="1192.39" y="1343.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;apic_timer_interrupt (28 samples, 0.05%)&lt;/title&gt;&lt;rect x="721.6" y="645" width="0.6" height="15.0" fill="rgb(240,52,53)" rx="2" ry="2" /&gt;&lt;text  x="724.59" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpidrv (55,607 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1141" width="1178.4" height="15.0" fill="rgb(206,86,41)" rx="2" ry="2" /&gt;&lt;text  x="13.83" y="1151.5" &gt;rpidrv&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklSurrCheck (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1098.7" y="597" width="0.1" height="15.0" fill="rgb(215,147,15)" rx="2" ry="2" /&gt;&lt;text  x="1101.67" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;plsql_run (55,610 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1253" width="1178.4" height="15.0" fill="rgb(216,55,23)" rx="2" ry="2" /&gt;&lt;text  x="13.78" y="1263.5" &gt;plsql_run&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklreadSurrChk (44 samples, 0.08%)&lt;/title&gt;&lt;rect x="1091.9" y="597" width="0.9" height="15.0" fill="rgb(210,99,13)" rx="2" ry="2" /&gt;&lt;text  x="1094.91" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_async_page_fault (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1088.3" y="485" width="0.2" height="15.0" fill="rgb(247,32,20)" rx="2" ry="2" /&gt;&lt;text  x="1091.31" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtTrcVaList_int (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="1100.5" y="261" width="0.4" height="15.0" fill="rgb(206,212,18)" rx="2" ry="2" /&gt;&lt;text  x="1103.47" y="271.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kpoal8 (55,610 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1317" width="1178.4" height="15.0" fill="rgb(250,51,23)" rx="2" ry="2" /&gt;&lt;text  x="13.78" y="1327.5" &gt;kpoal8&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollfre (14 samples, 0.03%)&lt;/title&gt;&lt;rect x="962.0" y="741" width="0.3" height="15.0" fill="rgb(254,171,6)" rx="2" ry="2" /&gt;&lt;text  x="964.99" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalp (160 samples, 0.29%)&lt;/title&gt;&lt;rect x="1086.4" y="725" width="3.4" height="15.0" fill="rgb(238,200,1)" rx="2" ry="2" /&gt;&lt;text  x="1089.38" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (10 samples, 0.02%)&lt;/title&gt;&lt;rect x="1105.0" y="837" width="0.2" height="15.0" fill="rgb(237,123,35)" rx="2" ry="2" /&gt;&lt;text  x="1108.03" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlfill (20 samples, 0.04%)&lt;/title&gt;&lt;rect x="1098.2" y="437" width="0.4" height="15.0" fill="rgb(218,131,45)" rx="2" ry="2" /&gt;&lt;text  x="1101.16" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksmrf_init_alloc (51 samples, 0.09%)&lt;/title&gt;&lt;rect x="1088.6" y="501" width="1.1" height="15.0" fill="rgb(215,216,12)" rx="2" ry="2" /&gt;&lt;text  x="1091.58" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qerstRowP (6,579 samples, 11.81%)&lt;/title&gt;&lt;rect x="964.7" y="869" width="139.4" height="15.0" fill="rgb(205,1,48)" rx="2" ry="2" /&gt;&lt;text  x="967.68" y="879.5" &gt;qerstRowP&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlw_locator_op (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="1091.4" y="597" width="0.3" height="15.0" fill="rgb(242,53,11)" rx="2" ry="2" /&gt;&lt;text  x="1094.44" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaFree_rfc (44,931 samples, 80.69%)&lt;/title&gt;&lt;rect x="11.8" y="805" width="952.1" height="15.0" fill="rgb(213,183,40)" rx="2" ry="2" /&gt;&lt;text  x="14.76" y="815.5" &gt;kolaFree_rfc&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;schedule (35 samples, 0.06%)&lt;/title&gt;&lt;rect x="479.7" y="597" width="0.8" height="15.0" fill="rgb(212,190,30)" rx="2" ry="2" /&gt;&lt;text  x="482.75" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;psddr0 (55,607 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1157" width="1178.4" height="15.0" fill="rgb(217,128,25)" rx="2" ry="2" /&gt;&lt;text  x="13.83" y="1167.5" &gt;psddr0&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (2,594 samples, 4.66%)&lt;/title&gt;&lt;rect x="1107.1" y="869" width="55.0" height="15.0" fill="rgb(242,36,30)" rx="2" ry="2" /&gt;&lt;text  x="1110.10" y="879.5" &gt;_inte..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrarfc (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1103.4" y="805" width="0.2" height="15.0" fill="rgb(243,217,49)" rx="2" ry="2" /&gt;&lt;text  x="1106.44" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ssthrdmain (55,631 samples, 99.90%)&lt;/title&gt;&lt;rect x="10.3" y="1461" width="1178.9" height="15.0" fill="rgb(215,21,7)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1471.5" &gt;ssthrdmain&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaCreate_rfc (178 samples, 0.32%)&lt;/title&gt;&lt;rect x="1081.9" y="741" width="3.7" height="15.0" fill="rgb(239,77,52)" rx="2" ry="2" /&gt;&lt;text  x="1084.87" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksni_handle_net_intr_int (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="10.3" y="1317" width="0.5" height="15.0" fill="rgb(239,50,28)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1327.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgicls (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1090.4" y="597" width="0.2" height="15.0" fill="rgb(214,181,8)" rx="2" ry="2" /&gt;&lt;text  x="1093.45" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokltcc (77 samples, 0.14%)&lt;/title&gt;&lt;rect x="1101.2" y="597" width="1.6" height="15.0" fill="rgb(219,95,42)" rx="2" ry="2" /&gt;&lt;text  x="1104.19" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opiodr (55,631 samples, 99.90%)&lt;/title&gt;&lt;rect x="10.3" y="1397" width="1178.9" height="15.0" fill="rgb(209,47,52)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1407.5" &gt;opiodr&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalp (87 samples, 0.16%)&lt;/title&gt;&lt;rect x="1099.1" y="581" width="1.9" height="15.0" fill="rgb(249,78,35)" rx="2" ry="2" /&gt;&lt;text  x="1102.14" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;release_pages (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1189.4" y="1253" width="0.2" height="15.0" fill="rgb(242,82,44)" rx="2" ry="2" /&gt;&lt;text  x="1192.43" y="1263.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklcprv (10 samples, 0.02%)&lt;/title&gt;&lt;rect x="1092.6" y="533" width="0.2" height="15.0" fill="rgb(206,106,54)" rx="2" ry="2" /&gt;&lt;text  x="1095.57" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfinddur (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="734.9" y="661" width="0.1" height="15.0" fill="rgb(228,178,53)" rx="2" ry="2" /&gt;&lt;text  x="737.90" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_syscall_64 (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.7" y="117" width="0.2" height="15.0" fill="rgb(232,205,17)" rx="2" ry="2" /&gt;&lt;text  x="1103.75" y="127.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opidrv (55,631 samples, 99.90%)&lt;/title&gt;&lt;rect x="10.3" y="1413" width="1178.9" height="15.0" fill="rgb(209,45,37)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1423.5" &gt;opidrv&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokegOpnGC_Lob (5,458 samples, 9.80%)&lt;/title&gt;&lt;rect x="965.0" y="805" width="115.6" height="15.0" fill="rgb(222,177,48)" rx="2" ry="2" /&gt;&lt;text  x="967.98" y="815.5" &gt;kokegOpnGC_Lob&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksmarfg (34 samples, 0.06%)&lt;/title&gt;&lt;rect x="1100.2" y="357" width="0.7" height="15.0" fill="rgb(249,99,45)" rx="2" ry="2" /&gt;&lt;text  x="1103.20" y="367.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlw_locator_op (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1081.2" y="725" width="0.4" height="15.0" fill="rgb(243,71,52)" rx="2" ry="2" /&gt;&lt;text  x="1084.21" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;entry_SYSCALL_64_after_hwframe (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1089.0" y="309" width="0.4" height="15.0" fill="rgb(215,228,19)" rx="2" ry="2" /&gt;&lt;text  x="1092.01" y="319.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpiswu2 (55,607 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1125" width="1178.4" height="15.0" fill="rgb(210,188,54)" rx="2" ry="2" /&gt;&lt;text  x="13.83" y="1135.5" &gt;rpiswu2&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklCurrentDataInline (20 samples, 0.04%)&lt;/title&gt;&lt;rect x="1081.2" y="741" width="0.4" height="15.0" fill="rgb(238,19,20)" rx="2" ry="2" /&gt;&lt;text  x="1084.21" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;handle_mm_fault (25 samples, 0.04%)&lt;/title&gt;&lt;rect x="1099.6" y="373" width="0.5" height="15.0" fill="rgb(210,226,9)" rx="2" ry="2" /&gt;&lt;text  x="1102.60" y="383.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;unmap_region (11 samples, 0.02%)&lt;/title&gt;&lt;rect x="1189.4" y="1349" width="0.2" height="15.0" fill="rgb(241,223,27)" rx="2" ry="2" /&gt;&lt;text  x="1192.36" y="1359.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;prepare_exit_to_usermode (15 samples, 0.03%)&lt;/title&gt;&lt;rect x="1028.4" y="725" width="0.4" height="15.0" fill="rgb(247,109,39)" rx="2" ry="2" /&gt;&lt;text  x="1031.45" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="1102.4" y="549" width="0.3" height="15.0" fill="rgb(232,159,23)" rx="2" ry="2" /&gt;&lt;text  x="1105.40" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qersoProcessULS (6,607 samples, 11.86%)&lt;/title&gt;&lt;rect x="964.1" y="949" width="140.0" height="15.0" fill="rgb(216,123,23)" rx="2" ry="2" /&gt;&lt;text  x="967.11" y="959.5" &gt;qersoProcessULS&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaGetHeap (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="1085.6" y="757" width="0.5" height="15.0" fill="rgb(238,187,41)" rx="2" ry="2" /&gt;&lt;text  x="1088.64" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;all (55,686 samples, 100%)&lt;/title&gt;&lt;rect x="10.0" y="1525" width="1180.0" height="15.0" fill="rgb(211,88,50)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1535.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgh_invoke_alloc_cb (35 samples, 0.06%)&lt;/title&gt;&lt;rect x="1100.2" y="373" width="0.7" height="15.0" fill="rgb(237,214,20)" rx="2" ry="2" /&gt;&lt;text  x="1103.17" y="383.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokegPinLob (3,828 samples, 6.87%)&lt;/title&gt;&lt;rect x="1107.1" y="901" width="81.1" height="15.0" fill="rgb(237,2,0)" rx="2" ry="2" /&gt;&lt;text  x="1110.08" y="911.5" &gt;kokegPinLob&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbchg1_main (138 samples, 0.25%)&lt;/title&gt;&lt;rect x="1095.7" y="501" width="2.9" height="15.0" fill="rgb(250,222,4)" rx="2" ry="2" /&gt;&lt;text  x="1098.66" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qmuhshget_internal (1,408 samples, 2.53%)&lt;/title&gt;&lt;rect x="1028.8" y="757" width="29.8" height="15.0" fill="rgb(207,18,2)" rx="2" ry="2" /&gt;&lt;text  x="1031.76" y="767.5" &gt;qm..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokegPromoteLob (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="1103.4" y="821" width="0.4" height="15.0" fill="rgb(213,98,15)" rx="2" ry="2" /&gt;&lt;text  x="1106.35" y="831.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtTrcVaList_int (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="963.9" y="965" width="0.1" height="15.0" fill="rgb(254,96,10)" rx="2" ry="2" /&gt;&lt;text  x="966.88" y="975.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrdrfc (20 samples, 0.04%)&lt;/title&gt;&lt;rect x="963.4" y="789" width="0.4" height="15.0" fill="rgb(220,21,41)" rx="2" ry="2" /&gt;&lt;text  x="966.39" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdl_write1 (254 samples, 0.46%)&lt;/title&gt;&lt;rect x="1093.2" y="581" width="5.4" height="15.0" fill="rgb(254,4,24)" rx="2" ry="2" /&gt;&lt;text  x="1096.20" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ttcpip (55,631 samples, 99.90%)&lt;/title&gt;&lt;rect x="10.3" y="1349" width="1178.9" height="15.0" fill="rgb(254,129,39)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1359.5" &gt;ttcpip&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_anonymous_page (25 samples, 0.04%)&lt;/title&gt;&lt;rect x="1099.6" y="341" width="0.5" height="15.0" fill="rgb(240,29,48)" rx="2" ry="2" /&gt;&lt;text  x="1102.60" y="351.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaAssign_rfc (20 samples, 0.04%)&lt;/title&gt;&lt;rect x="1104.6" y="837" width="0.4" height="15.0" fill="rgb(242,185,8)" rx="2" ry="2" /&gt;&lt;text  x="1107.56" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koltitfr (44,820 samples, 80.49%)&lt;/title&gt;&lt;rect x="13.0" y="757" width="949.8" height="15.0" fill="rgb(243,208,7)" rx="2" ry="2" /&gt;&lt;text  x="16.01" y="767.5" &gt;koltitfr&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokltslfn (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1098.8" y="581" width="0.1" height="15.0" fill="rgb(242,120,36)" rx="2" ry="2" /&gt;&lt;text  x="1101.84" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrem (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="12.6" y="709" width="0.2" height="15.0" fill="rgb(229,222,42)" rx="2" ry="2" /&gt;&lt;text  x="15.65" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghash (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="11.6" y="789" width="0.1" height="15.0" fill="rgb(251,59,1)" rx="2" ry="2" /&gt;&lt;text  x="14.59" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sys_write (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.7" y="101" width="0.2" height="15.0" fill="rgb(214,200,47)" rx="2" ry="2" /&gt;&lt;text  x="1103.75" y="111.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;schedule (23 samples, 0.04%)&lt;/title&gt;&lt;rect x="248.8" y="629" width="0.5" height="15.0" fill="rgb(231,63,34)" rx="2" ry="2" /&gt;&lt;text  x="251.79" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlw_xid_eq (14 samples, 0.03%)&lt;/title&gt;&lt;rect x="1081.3" y="693" width="0.3" height="15.0" fill="rgb(231,151,30)" rx="2" ry="2" /&gt;&lt;text  x="1084.27" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksm_pga_limit_interrupt (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="10.3" y="1269" width="0.5" height="15.0" fill="rgb(236,219,13)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1279.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;apic_timer_interrupt (43 samples, 0.08%)&lt;/title&gt;&lt;rect x="247.5" y="677" width="1.0" height="15.0" fill="rgb(231,223,54)" rx="2" ry="2" /&gt;&lt;text  x="250.54" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfnd (69 samples, 0.12%)&lt;/title&gt;&lt;rect x="1088.2" y="613" width="1.5" height="15.0" fill="rgb(214,205,25)" rx="2" ry="2" /&gt;&lt;text  x="1091.24" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;run_timer_softirq (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="950.2" y="597" width="0.1" height="15.0" fill="rgb(232,131,14)" rx="2" ry="2" /&gt;&lt;text  x="953.17" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolttfr (44,827 samples, 80.50%)&lt;/title&gt;&lt;rect x="12.9" y="773" width="949.9" height="15.0" fill="rgb(251,131,34)" rx="2" ry="2" /&gt;&lt;text  x="15.86" y="783.5" &gt;kolttfr&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;swapgs_restore_regs_and_return_to_usermode (12 samples, 0.02%)&lt;/title&gt;&lt;rect x="1161.8" y="853" width="0.3" height="15.0" fill="rgb(248,193,8)" rx="2" ry="2" /&gt;&lt;text  x="1164.82" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;vm_mmap_pgoff (26 samples, 0.05%)&lt;/title&gt;&lt;rect x="1189.2" y="1413" width="0.6" height="15.0" fill="rgb(238,125,37)" rx="2" ry="2" /&gt;&lt;text  x="1192.24" y="1423.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rworupo (3,862 samples, 6.94%)&lt;/title&gt;&lt;rect x="1107.0" y="949" width="81.9" height="15.0" fill="rgb(215,226,53)" rx="2" ry="2" /&gt;&lt;text  x="1110.04" y="959.5" &gt;rworupo&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklRead (71 samples, 0.13%)&lt;/title&gt;&lt;rect x="1091.4" y="645" width="1.5" height="15.0" fill="rgb(211,70,19)" rx="2" ry="2" /&gt;&lt;text  x="1094.40" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlrsp (136 samples, 0.24%)&lt;/title&gt;&lt;rect x="735.0" y="677" width="2.9" height="15.0" fill="rgb(232,129,8)" rx="2" ry="2" /&gt;&lt;text  x="738.00" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;async_page_fault (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1088.3" y="501" width="0.2" height="15.0" fill="rgb(220,81,41)" rx="2" ry="2" /&gt;&lt;text  x="1091.31" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgetsh (11 samples, 0.02%)&lt;/title&gt;&lt;rect x="1094.6" y="485" width="0.2" height="15.0" fill="rgb(235,3,34)" rx="2" ry="2" /&gt;&lt;text  x="1097.58" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1103.7" y="789" width="0.1" height="15.0" fill="rgb(205,96,44)" rx="2" ry="2" /&gt;&lt;text  x="1106.69" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklglfn (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1098.8" y="597" width="0.2" height="15.0" fill="rgb(230,223,52)" rx="2" ry="2" /&gt;&lt;text  x="1101.82" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_anonymous_page (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1088.4" y="405" width="0.1" height="15.0" fill="rgb(210,167,42)" rx="2" ry="2" /&gt;&lt;text  x="1091.39" y="415.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollfrfn (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="12.6" y="757" width="0.2" height="15.0" fill="rgb(246,155,43)" rx="2" ry="2" /&gt;&lt;text  x="15.65" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;main (55,631 samples, 99.90%)&lt;/title&gt;&lt;rect x="10.3" y="1477" width="1178.9" height="15.0" fill="rgb(232,68,10)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1487.5" &gt;main&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrddc (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1106.0" y="805" width="0.2" height="15.0" fill="rgb(219,49,54)" rx="2" ry="2" /&gt;&lt;text  x="1109.04" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;irq_exit (10 samples, 0.02%)&lt;/title&gt;&lt;rect x="1028.2" y="709" width="0.2" height="15.0" fill="rgb(219,43,5)" rx="2" ry="2" /&gt;&lt;text  x="1031.23" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;finish_task_switch (18 samples, 0.03%)&lt;/title&gt;&lt;rect x="722.7" y="565" width="0.4" height="15.0" fill="rgb(221,76,48)" rx="2" ry="2" /&gt;&lt;text  x="725.69" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;handle_mm_fault (35 samples, 0.06%)&lt;/title&gt;&lt;rect x="1087.5" y="533" width="0.7" height="15.0" fill="rgb(206,79,16)" rx="2" ry="2" /&gt;&lt;text  x="1090.50" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokegOpnGarbagePromote (25 samples, 0.04%)&lt;/title&gt;&lt;rect x="1103.3" y="837" width="0.5" height="15.0" fill="rgb(237,211,9)" rx="2" ry="2" /&gt;&lt;text  x="1106.31" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrarfc (106 samples, 0.19%)&lt;/title&gt;&lt;rect x="1083.3" y="725" width="2.3" height="15.0" fill="rgb(221,211,50)" rx="2" ry="2" /&gt;&lt;text  x="1086.35" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalf (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="1071.2" y="757" width="0.1" height="15.0" fill="rgb(239,229,37)" rx="2" ry="2" /&gt;&lt;text  x="1074.17" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstdle_wfp (20 samples, 0.04%)&lt;/title&gt;&lt;rect x="962.8" y="773" width="0.4" height="15.0" fill="rgb(233,193,34)" rx="2" ry="2" /&gt;&lt;text  x="965.82" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (11,139 samples, 20.00%)&lt;/title&gt;&lt;rect x="13.2" y="693" width="236.1" height="15.0" fill="rgb(215,147,38)" rx="2" ry="2" /&gt;&lt;text  x="16.24" y="703.5" &gt;_intel_fast_memcmp&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokltfc (44,780 samples, 80.42%)&lt;/title&gt;&lt;rect x="13.1" y="741" width="948.9" height="15.0" fill="rgb(249,191,25)" rx="2" ry="2" /&gt;&lt;text  x="16.09" y="751.5" &gt;kokltfc&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdl_destroy (22,554 samples, 40.50%)&lt;/title&gt;&lt;rect x="260.3" y="693" width="477.9" height="15.0" fill="rgb(223,122,18)" rx="2" ry="2" /&gt;&lt;text  x="263.26" y="703.5" &gt;kdl_destroy&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kpdbHashTable_Find (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1090.9" y="549" width="0.1" height="15.0" fill="rgb(239,89,41)" rx="2" ry="2" /&gt;&lt;text  x="1093.91" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;peicnt (55,610 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1269" width="1178.4" height="15.0" fill="rgb(220,23,44)" rx="2" ry="2" /&gt;&lt;text  x="13.78" y="1279.5" &gt;peicnt&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;irq_exit (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1080.4" y="709" width="0.1" height="15.0" fill="rgb(221,79,52)" rx="2" ry="2" /&gt;&lt;text  x="1083.43" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (591 samples, 1.06%)&lt;/title&gt;&lt;rect x="1058.6" y="757" width="12.5" height="15.0" fill="rgb(225,129,7)" rx="2" ry="2" /&gt;&lt;text  x="1061.62" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrde_alloc (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="1083.1" y="693" width="0.2" height="15.0" fill="rgb(236,37,18)" rx="2" ry="2" /&gt;&lt;text  x="1086.14" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rcu_process_callbacks (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="950.0" y="597" width="0.1" height="15.0" fill="rgb(209,27,21)" rx="2" ry="2" /&gt;&lt;text  x="953.02" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklInlineRead (50 samples, 0.09%)&lt;/title&gt;&lt;rect x="1091.8" y="613" width="1.0" height="15.0" fill="rgb(217,44,47)" rx="2" ry="2" /&gt;&lt;text  x="1094.78" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;irq_exit (43 samples, 0.08%)&lt;/title&gt;&lt;rect x="247.5" y="645" width="1.0" height="15.0" fill="rgb(230,48,18)" rx="2" ry="2" /&gt;&lt;text  x="250.54" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;apic_timer_interrupt (40 samples, 0.07%)&lt;/title&gt;&lt;rect x="949.5" y="661" width="0.8" height="15.0" fill="rgb(250,206,47)" rx="2" ry="2" /&gt;&lt;text  x="952.49" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokacau (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="1092.6" y="485" width="0.2" height="15.0" fill="rgb(248,53,8)" rx="2" ry="2" /&gt;&lt;text  x="1095.61" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrw (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="12.6" y="741" width="0.2" height="15.0" fill="rgb(250,205,9)" rx="2" ry="2" /&gt;&lt;text  x="15.65" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlopen (11,508 samples, 20.67%)&lt;/title&gt;&lt;rect x="491.1" y="677" width="243.9" height="15.0" fill="rgb(228,137,24)" rx="2" ry="2" /&gt;&lt;text  x="494.15" y="687.5" &gt;kdlopen&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstdle_wfp (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="963.4" y="773" width="0.1" height="15.0" fill="rgb(210,62,18)" rx="2" ry="2" /&gt;&lt;text  x="966.39" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pmuocpy (61 samples, 0.11%)&lt;/title&gt;&lt;rect x="1105.7" y="901" width="1.3" height="15.0" fill="rgb(245,144,11)" rx="2" ry="2" /&gt;&lt;text  x="1108.71" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklWrite (277 samples, 0.50%)&lt;/title&gt;&lt;rect x="1093.2" y="613" width="5.8" height="15.0" fill="rgb(212,148,37)" rx="2" ry="2" /&gt;&lt;text  x="1096.16" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaCreateClob (178 samples, 0.32%)&lt;/title&gt;&lt;rect x="1081.9" y="757" width="3.7" height="15.0" fill="rgb(248,187,30)" rx="2" ry="2" /&gt;&lt;text  x="1084.87" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrr (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="12.6" y="725" width="0.2" height="15.0" fill="rgb(253,104,38)" rx="2" ry="2" /&gt;&lt;text  x="15.65" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlw_xid_eq (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1091.5" y="565" width="0.2" height="15.0" fill="rgb(241,70,7)" rx="2" ry="2" /&gt;&lt;text  x="1094.53" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__dta_xfs_file_buffered_aio_write_3297 (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.6" y="53" width="0.1" height="15.0" fill="rgb(253,225,17)" rx="2" ry="2" /&gt;&lt;text  x="1103.62" y="63.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlt_filltid (11,654 samples, 20.93%)&lt;/title&gt;&lt;rect x="13.2" y="709" width="247.0" height="15.0" fill="rgb(223,74,30)" rx="2" ry="2" /&gt;&lt;text  x="16.24" y="719.5" &gt;kdlt_filltid&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_page_fault (41 samples, 0.07%)&lt;/title&gt;&lt;rect x="1099.3" y="405" width="0.9" height="15.0" fill="rgb(219,137,24)" rx="2" ry="2" /&gt;&lt;text  x="1102.31" y="415.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbhfho (10 samples, 0.02%)&lt;/title&gt;&lt;rect x="1094.9" y="517" width="0.2" height="15.0" fill="rgb(230,204,17)" rx="2" ry="2" /&gt;&lt;text  x="1097.92" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghualloc (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1083.2" y="645" width="0.1" height="15.0" fill="rgb(208,129,11)" rx="2" ry="2" /&gt;&lt;text  x="1086.18" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbzgs (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="737.4" y="565" width="0.2" height="15.0" fill="rgb(226,187,26)" rx="2" ry="2" /&gt;&lt;text  x="740.36" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smp_apic_timer_interrupt (43 samples, 0.08%)&lt;/title&gt;&lt;rect x="247.5" y="661" width="1.0" height="15.0" fill="rgb(254,127,11)" rx="2" ry="2" /&gt;&lt;text  x="250.54" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;exit_to_usermode_loop (14 samples, 0.03%)&lt;/title&gt;&lt;rect x="1058.3" y="709" width="0.3" height="15.0" fill="rgb(217,30,44)" rx="2" ry="2" /&gt;&lt;text  x="1061.30" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;swapgs_restore_regs_and_return_to_usermode (39 samples, 0.07%)&lt;/title&gt;&lt;rect x="248.5" y="677" width="0.8" height="15.0" fill="rgb(253,195,18)" rx="2" ry="2" /&gt;&lt;text  x="251.45" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__schedule (35 samples, 0.06%)&lt;/title&gt;&lt;rect x="479.7" y="581" width="0.8" height="15.0" fill="rgb(230,33,41)" rx="2" ry="2" /&gt;&lt;text  x="482.75" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklAbsCopy (618 samples, 1.11%)&lt;/title&gt;&lt;rect x="1089.9" y="709" width="13.1" height="15.0" fill="rgb(227,42,48)" rx="2" ry="2" /&gt;&lt;text  x="1092.88" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_munmap (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="1189.3" y="1365" width="0.3" height="15.0" fill="rgb(252,61,12)" rx="2" ry="2" /&gt;&lt;text  x="1192.34" y="1375.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgmd (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1103.6" y="805" width="0.1" height="15.0" fill="rgb(230,144,0)" rx="2" ry="2" /&gt;&lt;text  x="1106.56" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opifcr (136 samples, 0.24%)&lt;/title&gt;&lt;rect x="1104.1" y="933" width="2.9" height="15.0" fill="rgb(219,57,38)" rx="2" ry="2" /&gt;&lt;text  x="1107.12" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolttcr (82 samples, 0.15%)&lt;/title&gt;&lt;rect x="1101.2" y="629" width="1.7" height="15.0" fill="rgb(232,40,19)" rx="2" ry="2" /&gt;&lt;text  x="1104.17" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbhfix_tail (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1095.0" y="501" width="0.1" height="15.0" fill="rgb(248,198,34)" rx="2" ry="2" /&gt;&lt;text  x="1098.00" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtfdFileWrite (24 samples, 0.04%)&lt;/title&gt;&lt;rect x="1088.9" y="357" width="0.5" height="15.0" fill="rgb(217,142,24)" rx="2" ry="2" /&gt;&lt;text  x="1091.86" y="367.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlclose (10,877 samples, 19.53%)&lt;/title&gt;&lt;rect x="260.7" y="677" width="230.4" height="15.0" fill="rgb(210,174,26)" rx="2" ry="2" /&gt;&lt;text  x="263.66" y="687.5" &gt;kdlclose&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smp_apic_timer_interrupt (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1071.0" y="725" width="0.1" height="15.0" fill="rgb(225,0,37)" rx="2" ry="2" /&gt;&lt;text  x="1073.97" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sdbgrfwf_write_file (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1089.0" y="341" width="0.4" height="15.0" fill="rgb(226,61,39)" rx="2" ry="2" /&gt;&lt;text  x="1092.01" y="351.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;arch_local_irq_enable (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1161.9" y="805" width="0.1" height="15.0" fill="rgb(205,85,37)" rx="2" ry="2" /&gt;&lt;text  x="1164.86" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__dta_xfs_file_buffered_aio_write_3297 (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.7" y="37" width="0.2" height="15.0" fill="rgb(210,219,38)" rx="2" ry="2" /&gt;&lt;text  x="1103.75" y="47.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;swapgs_restore_regs_and_return_to_usermode (45 samples, 0.08%)&lt;/title&gt;&lt;rect x="479.6" y="645" width="0.9" height="15.0" fill="rgb(239,129,53)" rx="2" ry="2" /&gt;&lt;text  x="482.55" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstmap (44,967 samples, 80.75%)&lt;/title&gt;&lt;rect x="11.0" y="869" width="952.9" height="15.0" fill="rgb(206,182,22)" rx="2" ry="2" /&gt;&lt;text  x="14.00" y="879.5" &gt;kgghstmap&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;skgmstack (55,607 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1093" width="1178.4" height="15.0" fill="rgb(223,9,18)" rx="2" ry="2" /&gt;&lt;text  x="13.83" y="1103.5" &gt;skgmstack&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbbsrch (31 samples, 0.06%)&lt;/title&gt;&lt;rect x="1093.8" y="517" width="0.7" height="15.0" fill="rgb(229,218,34)" rx="2" ry="2" /&gt;&lt;text  x="1096.80" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;free_hot_cold_page_list (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1189.4" y="1237" width="0.2" height="15.0" fill="rgb(234,171,14)" rx="2" ry="2" /&gt;&lt;text  x="1192.43" y="1247.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollasg (51 samples, 0.09%)&lt;/title&gt;&lt;rect x="1104.5" y="869" width="1.1" height="15.0" fill="rgb(213,223,7)" rx="2" ry="2" /&gt;&lt;text  x="1107.52" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smp_apic_timer_interrupt (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1058.2" y="725" width="0.1" height="15.0" fill="rgb(228,161,46)" rx="2" ry="2" /&gt;&lt;text  x="1061.15" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opimai_real (55,631 samples, 99.90%)&lt;/title&gt;&lt;rect x="10.3" y="1445" width="1178.9" height="15.0" fill="rgb(251,119,51)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1455.5" &gt;opimai_real&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlwfb (237 samples, 0.43%)&lt;/title&gt;&lt;rect x="1093.6" y="565" width="5.0" height="15.0" fill="rgb(225,96,28)" rx="2" ry="2" /&gt;&lt;text  x="1096.56" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;irq_exit (40 samples, 0.07%)&lt;/title&gt;&lt;rect x="949.5" y="629" width="0.8" height="15.0" fill="rgb(250,49,38)" rx="2" ry="2" /&gt;&lt;text  x="952.49" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opipls (55,605 samples, 99.85%)&lt;/title&gt;&lt;rect x="10.9" y="1045" width="1178.3" height="15.0" fill="rgb(214,185,42)" rx="2" ry="2" /&gt;&lt;text  x="13.87" y="1055.5" &gt;opipls&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaFree (44 samples, 0.08%)&lt;/title&gt;&lt;rect x="1106.0" y="837" width="1.0" height="15.0" fill="rgb(238,175,21)" rx="2" ry="2" /&gt;&lt;text  x="1109.02" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kxsFreeWorkArea (44,968 samples, 80.75%)&lt;/title&gt;&lt;rect x="11.0" y="965" width="952.9" height="15.0" fill="rgb(243,214,47)" rx="2" ry="2" /&gt;&lt;text  x="13.97" y="975.5" &gt;kxsFreeWorkArea&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklReadCbk (70 samples, 0.13%)&lt;/title&gt;&lt;rect x="1091.4" y="629" width="1.5" height="15.0" fill="rgb(237,164,51)" rx="2" ry="2" /&gt;&lt;text  x="1094.42" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrdladd (12 samples, 0.02%)&lt;/title&gt;&lt;rect x="1083.1" y="709" width="0.2" height="15.0" fill="rgb(229,11,14)" rx="2" ry="2" /&gt;&lt;text  x="1086.10" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;irq_exit (38 samples, 0.07%)&lt;/title&gt;&lt;rect x="478.7" y="613" width="0.9" height="15.0" fill="rgb(209,51,38)" rx="2" ry="2" /&gt;&lt;text  x="481.75" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_page_fault (40 samples, 0.07%)&lt;/title&gt;&lt;rect x="1099.3" y="389" width="0.9" height="15.0" fill="rgb(209,183,1)" rx="2" ry="2" /&gt;&lt;text  x="1102.31" y="399.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;xfs_file_write_iter (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1089.0" y="229" width="0.4" height="15.0" fill="rgb(235,146,10)" rx="2" ry="2" /&gt;&lt;text  x="1092.01" y="239.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qersoFetch (10,625 samples, 19.08%)&lt;/title&gt;&lt;rect x="964.0" y="981" width="225.1" height="15.0" fill="rgb(239,139,48)" rx="2" ry="2" /&gt;&lt;text  x="966.98" y="991.5" &gt;qersoFetch&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrh_internal (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="12.5" y="773" width="0.1" height="15.0" fill="rgb(210,151,30)" rx="2" ry="2" /&gt;&lt;text  x="15.48" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlrci_get_inline_data (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1081.0" y="741" width="0.2" height="15.0" fill="rgb(238,44,33)" rx="2" ry="2" /&gt;&lt;text  x="1084.02" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalc (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1104.3" y="853" width="0.2" height="15.0" fill="rgb(231,140,37)" rx="2" ry="2" /&gt;&lt;text  x="1107.35" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;schedule (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1028.6" y="693" width="0.2" height="15.0" fill="rgb(253,136,6)" rx="2" ry="2" /&gt;&lt;text  x="1031.64" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcoapl (134 samples, 0.24%)&lt;/title&gt;&lt;rect x="1095.7" y="485" width="2.9" height="15.0" fill="rgb(242,108,26)" rx="2" ry="2" /&gt;&lt;text  x="1098.75" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kole_getFillChar (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="961.4" y="709" width="0.2" height="15.0" fill="rgb(223,60,50)" rx="2" ry="2" /&gt;&lt;text  x="964.40" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrw (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="962.0" y="709" width="0.3" height="15.0" fill="rgb(241,75,17)" rx="2" ry="2" /&gt;&lt;text  x="965.01" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smp_apic_timer_interrupt (38 samples, 0.07%)&lt;/title&gt;&lt;rect x="478.7" y="629" width="0.9" height="15.0" fill="rgb(209,153,17)" rx="2" ry="2" /&gt;&lt;text  x="481.75" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pmuocpy2_copy_recur (61 samples, 0.11%)&lt;/title&gt;&lt;rect x="1105.7" y="885" width="1.3" height="15.0" fill="rgb(245,171,34)" rx="2" ry="2" /&gt;&lt;text  x="1108.71" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_softirq (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1161.6" y="805" width="0.2" height="15.0" fill="rgb(236,44,26)" rx="2" ry="2" /&gt;&lt;text  x="1164.63" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollasg (56 samples, 0.10%)&lt;/title&gt;&lt;rect x="1105.8" y="869" width="1.2" height="15.0" fill="rgb(205,133,44)" rx="2" ry="2" /&gt;&lt;text  x="1108.77" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklCurrentDataInline (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1091.4" y="613" width="0.4" height="15.0" fill="rgb(219,177,43)" rx="2" ry="2" /&gt;&lt;text  x="1094.42" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;irq_exit (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1058.2" y="709" width="0.1" height="15.0" fill="rgb(208,173,40)" rx="2" ry="2" /&gt;&lt;text  x="1061.15" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdstf010000100000000kmP (6,606 samples, 11.86%)&lt;/title&gt;&lt;rect x="964.1" y="885" width="140.0" height="15.0" fill="rgb(230,28,5)" rx="2" ry="2" /&gt;&lt;text  x="967.11" y="895.5" &gt;kdstf010000100000..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghufree (12 samples, 0.02%)&lt;/title&gt;&lt;rect x="962.9" y="709" width="0.2" height="15.0" fill="rgb(248,110,10)" rx="2" ry="2" /&gt;&lt;text  x="965.88" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlt_freetemp (33,088 samples, 59.42%)&lt;/title&gt;&lt;rect x="260.2" y="709" width="701.1" height="15.0" fill="rgb(232,129,5)" rx="2" ry="2" /&gt;&lt;text  x="263.19" y="719.5" &gt;kdlt_freetemp&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaslFree (44,871 samples, 80.58%)&lt;/title&gt;&lt;rect x="11.9" y="789" width="950.9" height="15.0" fill="rgb(214,147,46)" rx="2" ry="2" /&gt;&lt;text  x="14.93" y="799.5" &gt;kolaslFree&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1106.6" y="773" width="0.4" height="15.0" fill="rgb(209,203,44)" rx="2" ry="2" /&gt;&lt;text  x="1109.60" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghash (22 samples, 0.04%)&lt;/title&gt;&lt;rect x="1082.6" y="693" width="0.4" height="15.0" fill="rgb(243,171,50)" rx="2" ry="2" /&gt;&lt;text  x="1085.57" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalf (15 samples, 0.03%)&lt;/title&gt;&lt;rect x="1085.7" y="741" width="0.3" height="15.0" fill="rgb(205,161,3)" rx="2" ry="2" /&gt;&lt;text  x="1088.72" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__mmap64 (32 samples, 0.06%)&lt;/title&gt;&lt;rect x="1189.2" y="1493" width="0.7" height="15.0" fill="rgb(251,5,15)" rx="2" ry="2" /&gt;&lt;text  x="1192.17" y="1503.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghash (15 samples, 0.03%)&lt;/title&gt;&lt;rect x="1083.7" y="693" width="0.3" height="15.0" fill="rgb(208,204,10)" rx="2" ry="2" /&gt;&lt;text  x="1086.67" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklc_copy (633 samples, 1.14%)&lt;/title&gt;&lt;rect x="1089.8" y="757" width="13.4" height="15.0" fill="rgb(210,206,18)" rx="2" ry="2" /&gt;&lt;text  x="1092.79" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgrfc (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="12.8" y="773" width="0.1" height="15.0" fill="rgb(235,80,47)" rx="2" ry="2" /&gt;&lt;text  x="15.75" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (36 samples, 0.06%)&lt;/title&gt;&lt;rect x="1100.2" y="437" width="0.7" height="15.0" fill="rgb(248,36,33)" rx="2" ry="2" /&gt;&lt;text  x="1103.17" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (15 samples, 0.03%)&lt;/title&gt;&lt;rect x="1085.3" y="677" width="0.3" height="15.0" fill="rgb(237,121,45)" rx="2" ry="2" /&gt;&lt;text  x="1088.26" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklClosePCursor (10 samples, 0.02%)&lt;/title&gt;&lt;rect x="1090.4" y="629" width="0.2" height="15.0" fill="rgb(229,222,44)" rx="2" ry="2" /&gt;&lt;text  x="1093.38" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;oracle_16067_sf (55,686 samples, 100.00%)&lt;/title&gt;&lt;rect x="10.0" y="1509" width="1180.0" height="15.0" fill="rgb(250,141,23)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1519.5" &gt;oracle_16067_sf&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpidrus (55,607 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1077" width="1178.4" height="15.0" fill="rgb(211,41,38)" rx="2" ry="2" /&gt;&lt;text  x="13.83" y="1087.5" &gt;rpidrus&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktcsna (10 samples, 0.02%)&lt;/title&gt;&lt;rect x="1081.3" y="677" width="0.2" height="15.0" fill="rgb(253,164,29)" rx="2" ry="2" /&gt;&lt;text  x="1084.32" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaFree_rfc (43 samples, 0.08%)&lt;/title&gt;&lt;rect x="1106.0" y="821" width="1.0" height="15.0" fill="rgb(223,106,24)" rx="2" ry="2" /&gt;&lt;text  x="1109.04" y="831.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__handle_mm_fault (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1088.4" y="421" width="0.1" height="15.0" fill="rgb(248,170,32)" rx="2" ry="2" /&gt;&lt;text  x="1091.37" y="431.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pevm_BFTCHC (55,607 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1189" width="1178.4" height="15.0" fill="rgb(225,28,13)" rx="2" ry="2" /&gt;&lt;text  x="13.83" y="1199.5" &gt;pevm_BFTCHC&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklpgsz (58 samples, 0.10%)&lt;/title&gt;&lt;rect x="1090.2" y="661" width="1.2" height="15.0" fill="rgb(211,99,16)" rx="2" ry="2" /&gt;&lt;text  x="1093.15" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_raw_spin_lock (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1087.6" y="485" width="0.2" height="15.0" fill="rgb(234,141,42)" rx="2" ry="2" /&gt;&lt;text  x="1090.61" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokle_substr (1,066 samples, 1.91%)&lt;/title&gt;&lt;rect x="1080.7" y="821" width="22.6" height="15.0" fill="rgb(228,111,3)" rx="2" ry="2" /&gt;&lt;text  x="1083.68" y="831.5" &gt;k..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smp_apic_timer_interrupt (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1161.6" y="837" width="0.2" height="15.0" fill="rgb(205,169,12)" rx="2" ry="2" /&gt;&lt;text  x="1164.63" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklSurrCheck (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1103.0" y="725" width="0.2" height="15.0" fill="rgb(212,220,4)" rx="2" ry="2" /&gt;&lt;text  x="1106.04" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalmc (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1104.4" y="837" width="0.1" height="15.0" fill="rgb(253,12,44)" rx="2" ry="2" /&gt;&lt;text  x="1107.39" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlt_add_tlob_ctl_link (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1101.3" y="549" width="0.1" height="15.0" fill="rgb(210,6,24)" rx="2" ry="2" /&gt;&lt;text  x="1104.28" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghsupmm (88 samples, 0.16%)&lt;/title&gt;&lt;rect x="1099.1" y="597" width="1.9" height="15.0" fill="rgb(252,163,32)" rx="2" ry="2" /&gt;&lt;text  x="1102.12" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sys_write (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.6" y="117" width="0.1" height="15.0" fill="rgb(236,61,19)" rx="2" ry="2" /&gt;&lt;text  x="1103.62" y="127.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opikndf2 (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="10.3" y="1333" width="0.5" height="15.0" fill="rgb(205,62,43)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1343.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;arch_local_irq_enable (15 samples, 0.03%)&lt;/title&gt;&lt;rect x="722.3" y="597" width="0.3" height="15.0" fill="rgb(234,40,42)" rx="2" ry="2" /&gt;&lt;text  x="725.29" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1105.1" y="805" width="0.1" height="15.0" fill="rgb(208,5,48)" rx="2" ry="2" /&gt;&lt;text  x="1108.11" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1086.2" y="725" width="0.1" height="15.0" fill="rgb(231,203,14)" rx="2" ry="2" /&gt;&lt;text  x="1089.17" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qerstFetch (10,625 samples, 19.08%)&lt;/title&gt;&lt;rect x="964.0" y="997" width="225.1" height="15.0" fill="rgb(215,3,4)" rx="2" ry="2" /&gt;&lt;text  x="966.98" y="1007.5" &gt;qerstFetch&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;mmap_region (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="1189.3" y="1381" width="0.4" height="15.0" fill="rgb(230,203,38)" rx="2" ry="2" /&gt;&lt;text  x="1192.28" y="1391.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrarfc (57 samples, 0.10%)&lt;/title&gt;&lt;rect x="1101.5" y="565" width="1.2" height="15.0" fill="rgb(253,25,24)" rx="2" ry="2" /&gt;&lt;text  x="1104.47" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kslwtectx (47 samples, 0.08%)&lt;/title&gt;&lt;rect x="1088.6" y="469" width="1.0" height="15.0" fill="rgb(242,85,46)" rx="2" ry="2" /&gt;&lt;text  x="1091.65" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smp_apic_timer_interrupt (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1080.4" y="725" width="0.1" height="15.0" fill="rgb(216,124,21)" rx="2" ry="2" /&gt;&lt;text  x="1083.43" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokegGarbageCollectRworo (3,861 samples, 6.93%)&lt;/title&gt;&lt;rect x="1107.1" y="933" width="81.8" height="15.0" fill="rgb(251,63,24)" rx="2" ry="2" /&gt;&lt;text  x="1110.06" y="943.5" &gt;kokegGarb..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghssagptr (90 samples, 0.16%)&lt;/title&gt;&lt;rect x="1099.1" y="629" width="1.9" height="15.0" fill="rgb(243,210,13)" rx="2" ry="2" /&gt;&lt;text  x="1102.07" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgrfc (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1106.6" y="805" width="0.4" height="15.0" fill="rgb(208,18,23)" rx="2" ry="2" /&gt;&lt;text  x="1109.60" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolttfr_ed (44,932 samples, 80.69%)&lt;/title&gt;&lt;rect x="11.7" y="837" width="952.2" height="15.0" fill="rgb(239,109,9)" rx="2" ry="2" /&gt;&lt;text  x="14.74" y="847.5" &gt;kolttfr_ed&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (145 samples, 0.26%)&lt;/title&gt;&lt;rect x="1086.7" y="645" width="3.0" height="15.0" fill="rgb(239,160,32)" rx="2" ry="2" /&gt;&lt;text  x="1089.68" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__handle_mm_fault (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.2" y="261" width="0.1" height="15.0" fill="rgb(221,209,34)" rx="2" ry="2" /&gt;&lt;text  x="1103.24" y="271.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaAssign (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1105.8" y="853" width="0.2" height="15.0" fill="rgb(247,181,6)" rx="2" ry="2" /&gt;&lt;text  x="1108.83" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollalop (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1101.0" y="629" width="0.1" height="15.0" fill="rgb(216,140,21)" rx="2" ry="2" /&gt;&lt;text  x="1104.04" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrdrfc (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="961.6" y="709" width="0.2" height="15.0" fill="rgb(218,124,8)" rx="2" ry="2" /&gt;&lt;text  x="964.61" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kole_append (633 samples, 1.14%)&lt;/title&gt;&lt;rect x="1089.8" y="773" width="13.4" height="15.0" fill="rgb(211,11,28)" rx="2" ry="2" /&gt;&lt;text  x="1092.79" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__write_nocancel (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1089.0" y="325" width="0.4" height="15.0" fill="rgb(245,41,32)" rx="2" ry="2" /&gt;&lt;text  x="1092.01" y="335.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_anonymous_page (30 samples, 0.05%)&lt;/title&gt;&lt;rect x="1087.6" y="501" width="0.6" height="15.0" fill="rgb(219,88,18)" rx="2" ry="2" /&gt;&lt;text  x="1090.59" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaAssign (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="1104.5" y="853" width="0.5" height="15.0" fill="rgb(205,75,52)" rx="2" ry="2" /&gt;&lt;text  x="1107.54" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklpgszCbk (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1092.5" y="549" width="0.3" height="15.0" fill="rgb(227,116,10)" rx="2" ry="2" /&gt;&lt;text  x="1095.46" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="1102.4" y="533" width="0.3" height="15.0" fill="rgb(226,80,29)" rx="2" ry="2" /&gt;&lt;text  x="1105.40" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__schedule (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1028.6" y="677" width="0.2" height="15.0" fill="rgb(225,115,52)" rx="2" ry="2" /&gt;&lt;text  x="1031.64" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtRecVAWriteDisk (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="963.9" y="949" width="0.1" height="15.0" fill="rgb(206,100,22)" rx="2" ry="2" /&gt;&lt;text  x="966.88" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgshx (38 samples, 0.07%)&lt;/title&gt;&lt;rect x="737.0" y="629" width="0.8" height="15.0" fill="rgb(248,83,8)" rx="2" ry="2" /&gt;&lt;text  x="739.99" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaslWrite (467 samples, 0.84%)&lt;/title&gt;&lt;rect x="1093.0" y="661" width="9.9" height="15.0" fill="rgb(234,72,3)" rx="2" ry="2" /&gt;&lt;text  x="1096.01" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolttfr (44 samples, 0.08%)&lt;/title&gt;&lt;rect x="1106.0" y="853" width="1.0" height="15.0" fill="rgb(253,8,30)" rx="2" ry="2" /&gt;&lt;text  x="1109.02" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcpy (40 samples, 0.07%)&lt;/title&gt;&lt;rect x="1097.3" y="437" width="0.9" height="15.0" fill="rgb(241,91,49)" rx="2" ry="2" /&gt;&lt;text  x="1100.31" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklc_write (279 samples, 0.50%)&lt;/title&gt;&lt;rect x="1093.1" y="645" width="5.9" height="15.0" fill="rgb(254,187,18)" rx="2" ry="2" /&gt;&lt;text  x="1096.12" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;entry_SYSCALL_64_after_hwframe (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.6" y="149" width="0.1" height="15.0" fill="rgb(246,158,5)" rx="2" ry="2" /&gt;&lt;text  x="1103.62" y="159.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sdbgrfwf_write_file (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.7" y="165" width="0.2" height="15.0" fill="rgb(226,135,6)" rx="2" ry="2" /&gt;&lt;text  x="1103.75" y="175.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklCurrentDataInline (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="1092.0" y="581" width="0.1" height="15.0" fill="rgb(253,161,52)" rx="2" ry="2" /&gt;&lt;text  x="1094.97" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_mmap (23 samples, 0.04%)&lt;/title&gt;&lt;rect x="1189.2" y="1397" width="0.5" height="15.0" fill="rgb(227,62,22)" rx="2" ry="2" /&gt;&lt;text  x="1192.24" y="1407.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;exit_to_usermode_loop (33 samples, 0.06%)&lt;/title&gt;&lt;rect x="950.4" y="629" width="0.7" height="15.0" fill="rgb(252,190,12)" rx="2" ry="2" /&gt;&lt;text  x="953.40" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrddc (30 samples, 0.05%)&lt;/title&gt;&lt;rect x="962.8" y="789" width="0.6" height="15.0" fill="rgb(205,122,34)" rx="2" ry="2" /&gt;&lt;text  x="965.76" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstine_wfp (23 samples, 0.04%)&lt;/title&gt;&lt;rect x="1101.5" y="549" width="0.5" height="15.0" fill="rgb(219,226,38)" rx="2" ry="2" /&gt;&lt;text  x="1104.47" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_page_fault (61 samples, 0.11%)&lt;/title&gt;&lt;rect x="1087.0" y="549" width="1.2" height="15.0" fill="rgb(231,196,25)" rx="2" ry="2" /&gt;&lt;text  x="1089.95" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;finish_task_switch (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1058.5" y="661" width="0.1" height="15.0" fill="rgb(247,198,34)" rx="2" ry="2" /&gt;&lt;text  x="1061.49" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_softirq (39 samples, 0.07%)&lt;/title&gt;&lt;rect x="949.5" y="613" width="0.8" height="15.0" fill="rgb(250,0,30)" rx="2" ry="2" /&gt;&lt;text  x="952.49" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_softirq (41 samples, 0.07%)&lt;/title&gt;&lt;rect x="247.5" y="629" width="0.9" height="15.0" fill="rgb(219,31,46)" rx="2" ry="2" /&gt;&lt;text  x="250.54" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghbshrt (45 samples, 0.08%)&lt;/title&gt;&lt;rect x="1099.2" y="453" width="1.0" height="15.0" fill="rgb(205,36,54)" rx="2" ry="2" /&gt;&lt;text  x="1102.22" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollulin (15 samples, 0.03%)&lt;/title&gt;&lt;rect x="962.3" y="741" width="0.3" height="15.0" fill="rgb(248,200,46)" rx="2" ry="2" /&gt;&lt;text  x="965.29" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__schedule (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="950.7" y="597" width="0.4" height="15.0" fill="rgb(254,99,13)" rx="2" ry="2" /&gt;&lt;text  x="953.74" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__alloc_pages_nodemask (11 samples, 0.02%)&lt;/title&gt;&lt;rect x="1099.7" y="309" width="0.2" height="15.0" fill="rgb(244,161,38)" rx="2" ry="2" /&gt;&lt;text  x="1102.67" y="319.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;xfs_file_write_iter (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.6" y="69" width="0.1" height="15.0" fill="rgb(233,63,31)" rx="2" ry="2" /&gt;&lt;text  x="1103.62" y="79.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__schedule (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1058.5" y="677" width="0.1" height="15.0" fill="rgb(242,213,18)" rx="2" ry="2" /&gt;&lt;text  x="1061.45" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (35 samples, 0.06%)&lt;/title&gt;&lt;rect x="1084.9" y="709" width="0.7" height="15.0" fill="rgb(216,33,37)" rx="2" ry="2" /&gt;&lt;text  x="1087.85" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kole_t2u_int (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="961.4" y="677" width="0.2" height="15.0" fill="rgb(249,194,14)" rx="2" ry="2" /&gt;&lt;text  x="964.42" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrempty_subheaps_all (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="10.3" y="1237" width="0.5" height="15.0" fill="rgb(238,149,20)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1247.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;alloc_pages_vma (11 samples, 0.02%)&lt;/title&gt;&lt;rect x="1099.7" y="325" width="0.2" height="15.0" fill="rgb(214,182,47)" rx="2" ry="2" /&gt;&lt;text  x="1102.67" y="335.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolradlst (63 samples, 0.11%)&lt;/title&gt;&lt;rect x="1082.0" y="725" width="1.3" height="15.0" fill="rgb(219,87,25)" rx="2" ry="2" /&gt;&lt;text  x="1085.01" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalo (149 samples, 0.27%)&lt;/title&gt;&lt;rect x="1086.6" y="677" width="3.2" height="15.0" fill="rgb(222,123,34)" rx="2" ry="2" /&gt;&lt;text  x="1089.61" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sys_mmap_pgoff (26 samples, 0.05%)&lt;/title&gt;&lt;rect x="1189.2" y="1429" width="0.6" height="15.0" fill="rgb(241,143,20)" rx="2" ry="2" /&gt;&lt;text  x="1192.24" y="1439.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbvini (12 samples, 0.02%)&lt;/title&gt;&lt;rect x="1094.6" y="517" width="0.2" height="15.0" fill="rgb(218,210,44)" rx="2" ry="2" /&gt;&lt;text  x="1097.56" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokegGarbageCollectOpn (5,463 samples, 9.81%)&lt;/title&gt;&lt;rect x="964.9" y="821" width="115.8" height="15.0" fill="rgb(247,146,26)" rx="2" ry="2" /&gt;&lt;text  x="967.90" y="831.5" &gt;kokegGarbageCo..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sorgetqbf (11 samples, 0.02%)&lt;/title&gt;&lt;rect x="1188.9" y="949" width="0.2" height="15.0" fill="rgb(245,68,39)" rx="2" ry="2" /&gt;&lt;text  x="1191.90" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgetsh (37 samples, 0.07%)&lt;/title&gt;&lt;rect x="737.0" y="613" width="0.8" height="15.0" fill="rgb(246,18,19)" rx="2" ry="2" /&gt;&lt;text  x="740.02" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sdbgrfwf_write_file (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.6" y="181" width="0.1" height="15.0" fill="rgb(244,100,36)" rx="2" ry="2" /&gt;&lt;text  x="1103.60" y="191.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;schedule (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1058.5" y="693" width="0.1" height="15.0" fill="rgb(211,89,18)" rx="2" ry="2" /&gt;&lt;text  x="1061.45" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalmc (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1101.0" y="581" width="0.1" height="15.0" fill="rgb(238,106,9)" rx="2" ry="2" /&gt;&lt;text  x="1104.04" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfnd (86 samples, 0.15%)&lt;/title&gt;&lt;rect x="1099.2" y="549" width="1.8" height="15.0" fill="rgb(227,1,10)" rx="2" ry="2" /&gt;&lt;text  x="1102.16" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;irq_exit (28 samples, 0.05%)&lt;/title&gt;&lt;rect x="721.6" y="613" width="0.6" height="15.0" fill="rgb(209,93,38)" rx="2" ry="2" /&gt;&lt;text  x="724.59" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koltitcr (81 samples, 0.15%)&lt;/title&gt;&lt;rect x="1101.2" y="613" width="1.7" height="15.0" fill="rgb(235,94,2)" rx="2" ry="2" /&gt;&lt;text  x="1104.19" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sys_mmap (26 samples, 0.05%)&lt;/title&gt;&lt;rect x="1189.2" y="1445" width="0.6" height="15.0" fill="rgb(223,27,11)" rx="2" ry="2" /&gt;&lt;text  x="1192.24" y="1455.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;arch_local_irq_enable (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="479.6" y="597" width="0.1" height="15.0" fill="rgb(248,161,51)" rx="2" ry="2" /&gt;&lt;text  x="482.55" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklcprv (24 samples, 0.04%)&lt;/title&gt;&lt;rect x="1090.6" y="629" width="0.5" height="15.0" fill="rgb(237,7,3)" rx="2" ry="2" /&gt;&lt;text  x="1093.60" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtfWriteRec (18 samples, 0.03%)&lt;/title&gt;&lt;rect x="1100.5" y="229" width="0.4" height="15.0" fill="rgb(234,168,24)" rx="2" ry="2" /&gt;&lt;text  x="1103.53" y="239.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdsttgr (6,606 samples, 11.86%)&lt;/title&gt;&lt;rect x="964.1" y="901" width="140.0" height="15.0" fill="rgb(247,30,46)" rx="2" ry="2" /&gt;&lt;text  x="967.11" y="911.5" &gt;kdsttgr&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlgsp (59 samples, 0.11%)&lt;/title&gt;&lt;rect x="1093.6" y="549" width="1.2" height="15.0" fill="rgb(242,7,49)" rx="2" ry="2" /&gt;&lt;text  x="1096.56" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrmrg (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="10.6" y="1173" width="0.2" height="15.0" fill="rgb(230,52,2)" rx="2" ry="2" /&gt;&lt;text  x="13.64" y="1183.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;exit_to_usermode_loop (38 samples, 0.07%)&lt;/title&gt;&lt;rect x="248.5" y="645" width="0.8" height="15.0" fill="rgb(215,187,44)" rx="2" ry="2" /&gt;&lt;text  x="251.48" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;arch_tlb_finish_mmu (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1189.4" y="1317" width="0.2" height="15.0" fill="rgb(217,98,49)" rx="2" ry="2" /&gt;&lt;text  x="1192.41" y="1327.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;xfs_trans_alloc (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1089.0" y="149" width="0.2" height="15.0" fill="rgb(210,127,40)" rx="2" ry="2" /&gt;&lt;text  x="1092.03" y="159.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;exit_to_usermode_loop (44 samples, 0.08%)&lt;/title&gt;&lt;rect x="479.6" y="613" width="0.9" height="15.0" fill="rgb(252,175,37)" rx="2" ry="2" /&gt;&lt;text  x="482.55" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokltfr_pdbcbk (44,771 samples, 80.40%)&lt;/title&gt;&lt;rect x="13.2" y="725" width="948.8" height="15.0" fill="rgb(205,97,1)" rx="2" ry="2" /&gt;&lt;text  x="16.24" y="735.5" &gt;kokltfr_pdbcbk&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgrfc (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="961.8" y="709" width="0.2" height="15.0" fill="rgb(225,54,43)" rx="2" ry="2" /&gt;&lt;text  x="964.78" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrf (15 samples, 0.03%)&lt;/title&gt;&lt;rect x="12.2" y="773" width="0.3" height="15.0" fill="rgb(221,53,35)" rx="2" ry="2" /&gt;&lt;text  x="15.16" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalo (85 samples, 0.15%)&lt;/title&gt;&lt;rect x="1099.2" y="517" width="1.8" height="15.0" fill="rgb(252,172,19)" rx="2" ry="2" /&gt;&lt;text  x="1102.18" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;prepare_exit_to_usermode (14 samples, 0.03%)&lt;/title&gt;&lt;rect x="1058.3" y="725" width="0.3" height="15.0" fill="rgb(247,188,25)" rx="2" ry="2" /&gt;&lt;text  x="1061.30" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaFree (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1105.2" y="837" width="0.4" height="15.0" fill="rgb(237,182,28)" rx="2" ry="2" /&gt;&lt;text  x="1108.24" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;finish_task_switch (20 samples, 0.04%)&lt;/title&gt;&lt;rect x="248.9" y="597" width="0.4" height="15.0" fill="rgb(229,131,48)" rx="2" ry="2" /&gt;&lt;text  x="251.86" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qerstRowP (138 samples, 0.25%)&lt;/title&gt;&lt;rect x="1104.1" y="949" width="2.9" height="15.0" fill="rgb(252,155,11)" rx="2" ry="2" /&gt;&lt;text  x="1107.12" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opiodr (55,610 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1333" width="1178.4" height="15.0" fill="rgb(253,83,50)" rx="2" ry="2" /&gt;&lt;text  x="13.78" y="1343.5" &gt;opiodr&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklNeedSurrChk (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1103.1" y="709" width="0.1" height="15.0" fill="rgb(235,211,23)" rx="2" ry="2" /&gt;&lt;text  x="1106.06" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtTrc_int (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="963.9" y="981" width="0.1" height="15.0" fill="rgb(232,168,54)" rx="2" ry="2" /&gt;&lt;text  x="966.88" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfnd (66 samples, 0.12%)&lt;/title&gt;&lt;rect x="1088.3" y="565" width="1.4" height="15.0" fill="rgb(250,184,9)" rx="2" ry="2" /&gt;&lt;text  x="1091.27" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_anonymous_page (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.2" y="245" width="0.1" height="15.0" fill="rgb(253,139,9)" rx="2" ry="2" /&gt;&lt;text  x="1103.24" y="255.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;vfs_write (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.6" y="101" width="0.1" height="15.0" fill="rgb(244,88,0)" rx="2" ry="2" /&gt;&lt;text  x="1103.62" y="111.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghprmalo (158 samples, 0.28%)&lt;/title&gt;&lt;rect x="1086.4" y="709" width="3.4" height="15.0" fill="rgb(254,52,4)" rx="2" ry="2" /&gt;&lt;text  x="1089.42" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalp (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="965.0" y="773" width="0.2" height="15.0" fill="rgb(222,109,34)" rx="2" ry="2" /&gt;&lt;text  x="968.04" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (10,047 samples, 18.04%)&lt;/title&gt;&lt;rect x="738.2" y="677" width="212.9" height="15.0" fill="rgb(245,47,47)" rx="2" ry="2" /&gt;&lt;text  x="741.22" y="687.5" &gt;_intel_fast_memcmp&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbgcur (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="735.4" y="645" width="0.2" height="15.0" fill="rgb(248,207,7)" rx="2" ry="2" /&gt;&lt;text  x="738.36" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfindctl (477 samples, 0.86%)&lt;/title&gt;&lt;rect x="951.1" y="677" width="10.1" height="15.0" fill="rgb(245,186,41)" rx="2" ry="2" /&gt;&lt;text  x="954.12" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgrfc (10 samples, 0.02%)&lt;/title&gt;&lt;rect x="1105.0" y="853" width="0.2" height="15.0" fill="rgb(219,52,13)" rx="2" ry="2" /&gt;&lt;text  x="1108.03" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opiino (55,631 samples, 99.90%)&lt;/title&gt;&lt;rect x="10.3" y="1381" width="1178.9" height="15.0" fill="rgb(207,212,4)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1391.5" &gt;opiino&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;free_hot_cold_page (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1189.4" y="1221" width="0.2" height="15.0" fill="rgb(249,216,18)" rx="2" ry="2" /&gt;&lt;text  x="1192.45" y="1231.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kprccu (66 samples, 0.12%)&lt;/title&gt;&lt;rect x="1104.2" y="917" width="1.4" height="15.0" fill="rgb(250,45,26)" rx="2" ry="2" /&gt;&lt;text  x="1107.20" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlf_write (259 samples, 0.47%)&lt;/title&gt;&lt;rect x="1093.2" y="597" width="5.5" height="15.0" fill="rgb(245,53,2)" rx="2" ry="2" /&gt;&lt;text  x="1096.18" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghprmalo (87 samples, 0.16%)&lt;/title&gt;&lt;rect x="1099.1" y="565" width="1.9" height="15.0" fill="rgb(210,14,41)" rx="2" ry="2" /&gt;&lt;text  x="1102.14" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtfmWriteMetadata (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1100.7" y="213" width="0.2" height="15.0" fill="rgb(226,43,26)" rx="2" ry="2" /&gt;&lt;text  x="1103.73" y="223.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kksumc (44,968 samples, 80.75%)&lt;/title&gt;&lt;rect x="11.0" y="997" width="952.9" height="15.0" fill="rgb(213,212,12)" rx="2" ry="2" /&gt;&lt;text  x="13.97" y="1007.5" &gt;kksumc&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbgsp1 (58 samples, 0.10%)&lt;/title&gt;&lt;rect x="1093.6" y="533" width="1.2" height="15.0" fill="rgb(210,5,34)" rx="2" ry="2" /&gt;&lt;text  x="1096.58" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrr (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="962.9" y="741" width="0.3" height="15.0" fill="rgb(222,164,23)" rx="2" ry="2" /&gt;&lt;text  x="965.88" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaAssign_rfc (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1105.8" y="837" width="0.2" height="15.0" fill="rgb(250,70,27)" rx="2" ry="2" /&gt;&lt;text  x="1108.83" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalc (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1101.0" y="597" width="0.1" height="15.0" fill="rgb(207,126,2)" rx="2" ry="2" /&gt;&lt;text  x="1104.04" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_softirq (10 samples, 0.02%)&lt;/title&gt;&lt;rect x="1028.2" y="693" width="0.2" height="15.0" fill="rgb(248,59,33)" rx="2" ry="2" /&gt;&lt;text  x="1031.23" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalw (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="962.3" y="709" width="0.3" height="15.0" fill="rgb(221,9,21)" rx="2" ry="2" /&gt;&lt;text  x="965.33" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="1105.4" y="773" width="0.2" height="15.0" fill="rgb(209,73,40)" rx="2" ry="2" /&gt;&lt;text  x="1108.43" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtfdFileWrite (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.6" y="197" width="0.1" height="15.0" fill="rgb(253,11,6)" rx="2" ry="2" /&gt;&lt;text  x="1103.58" y="207.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaCopy (613 samples, 1.10%)&lt;/title&gt;&lt;rect x="1090.0" y="693" width="13.0" height="15.0" fill="rgb(208,15,25)" rx="2" ry="2" /&gt;&lt;text  x="1092.96" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokavpr (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="1092.6" y="517" width="0.2" height="15.0" fill="rgb(226,145,16)" rx="2" ry="2" /&gt;&lt;text  x="1095.61" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_page_fault (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1088.3" y="469" width="0.2" height="15.0" fill="rgb(250,2,22)" rx="2" ry="2" /&gt;&lt;text  x="1091.31" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlw_locator_op_read (10 samples, 0.02%)&lt;/title&gt;&lt;rect x="1091.5" y="581" width="0.2" height="15.0" fill="rgb(212,166,17)" rx="2" ry="2" /&gt;&lt;text  x="1094.49" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (22 samples, 0.04%)&lt;/title&gt;&lt;rect x="11.3" y="821" width="0.4" height="15.0" fill="rgb(246,21,48)" rx="2" ry="2" /&gt;&lt;text  x="14.27" y="831.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghbshrt (72 samples, 0.13%)&lt;/title&gt;&lt;rect x="1086.7" y="613" width="1.5" height="15.0" fill="rgb(244,155,41)" rx="2" ry="2" /&gt;&lt;text  x="1089.72" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghash (11 samples, 0.02%)&lt;/title&gt;&lt;rect x="1101.7" y="533" width="0.3" height="15.0" fill="rgb(208,14,37)" rx="2" ry="2" /&gt;&lt;text  x="1104.72" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlwdb (178 samples, 0.32%)&lt;/title&gt;&lt;rect x="1094.8" y="549" width="3.8" height="15.0" fill="rgb(237,163,53)" rx="2" ry="2" /&gt;&lt;text  x="1097.81" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbgcur (26 samples, 0.05%)&lt;/title&gt;&lt;rect x="737.1" y="581" width="0.5" height="15.0" fill="rgb(248,127,20)" rx="2" ry="2" /&gt;&lt;text  x="740.08" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;apic_timer_interrupt (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1071.0" y="741" width="0.1" height="15.0" fill="rgb(242,225,3)" rx="2" ry="2" /&gt;&lt;text  x="1073.97" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalf (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="1102.0" y="549" width="0.4" height="15.0" fill="rgb(243,56,2)" rx="2" ry="2" /&gt;&lt;text  x="1104.95" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kspgip (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1103.6" y="773" width="0.1" height="15.0" fill="rgb(229,228,27)" rx="2" ry="2" /&gt;&lt;text  x="1106.56" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="12.8" y="757" width="0.1" height="15.0" fill="rgb(244,184,45)" rx="2" ry="2" /&gt;&lt;text  x="15.75" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokavpr (23 samples, 0.04%)&lt;/title&gt;&lt;rect x="1090.6" y="613" width="0.5" height="15.0" fill="rgb(250,8,28)" rx="2" ry="2" /&gt;&lt;text  x="1093.62" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kxstTraceWait (22 samples, 0.04%)&lt;/title&gt;&lt;rect x="1100.5" y="293" width="0.4" height="15.0" fill="rgb(236,18,44)" rx="2" ry="2" /&gt;&lt;text  x="1103.45" y="303.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kole_t2u (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="961.4" y="693" width="0.2" height="15.0" fill="rgb(230,137,7)" rx="2" ry="2" /&gt;&lt;text  x="964.42" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;arch_local_irq_enable (14 samples, 0.03%)&lt;/title&gt;&lt;rect x="950.4" y="613" width="0.3" height="15.0" fill="rgb(242,143,54)" rx="2" ry="2" /&gt;&lt;text  x="953.44" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kxsdmc (44,967 samples, 80.75%)&lt;/title&gt;&lt;rect x="11.0" y="949" width="952.9" height="15.0" fill="rgb(232,195,42)" rx="2" ry="2" /&gt;&lt;text  x="14.00" y="959.5" &gt;kxsdmc&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalf (41 samples, 0.07%)&lt;/title&gt;&lt;rect x="1084.0" y="709" width="0.9" height="15.0" fill="rgb(239,217,4)" rx="2" ry="2" /&gt;&lt;text  x="1086.99" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalo (35 samples, 0.06%)&lt;/title&gt;&lt;rect x="1100.2" y="421" width="0.7" height="15.0" fill="rgb(233,56,20)" rx="2" ry="2" /&gt;&lt;text  x="1103.17" y="431.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktbchgro (138 samples, 0.25%)&lt;/title&gt;&lt;rect x="1095.7" y="533" width="2.9" height="15.0" fill="rgb(252,200,15)" rx="2" ry="2" /&gt;&lt;text  x="1098.66" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;schedule (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="950.7" y="613" width="0.4" height="15.0" fill="rgb(226,90,12)" rx="2" ry="2" /&gt;&lt;text  x="953.74" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;prepare_exit_to_usermode (12 samples, 0.02%)&lt;/title&gt;&lt;rect x="1161.8" y="837" width="0.3" height="15.0" fill="rgb(218,207,22)" rx="2" ry="2" /&gt;&lt;text  x="1164.82" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstine_wfp (30 samples, 0.05%)&lt;/title&gt;&lt;rect x="1083.3" y="709" width="0.7" height="15.0" fill="rgb(246,169,19)" rx="2" ry="2" /&gt;&lt;text  x="1086.35" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktbchgro (12 samples, 0.02%)&lt;/title&gt;&lt;rect x="1094.0" y="453" width="0.2" height="15.0" fill="rgb(247,169,33)" rx="2" ry="2" /&gt;&lt;text  x="1096.99" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrrun (55,610 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1237" width="1178.4" height="15.0" fill="rgb(215,214,52)" rx="2" ry="2" /&gt;&lt;text  x="13.78" y="1247.5" &gt;pfrrun&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_page_fault (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.2" y="309" width="0.1" height="15.0" fill="rgb(243,56,52)" rx="2" ry="2" /&gt;&lt;text  x="1103.22" y="319.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;prepare_exit_to_usermode (39 samples, 0.07%)&lt;/title&gt;&lt;rect x="248.5" y="661" width="0.8" height="15.0" fill="rgb(210,180,28)" rx="2" ry="2" /&gt;&lt;text  x="251.45" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokasuc (619 samples, 1.11%)&lt;/title&gt;&lt;rect x="1089.9" y="725" width="13.1" height="15.0" fill="rgb(217,53,10)" rx="2" ry="2" /&gt;&lt;text  x="1092.88" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;irq_exit (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1071.0" y="709" width="0.1" height="15.0" fill="rgb(222,208,37)" rx="2" ry="2" /&gt;&lt;text  x="1073.97" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;tlb_flush_mmu_free (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1189.4" y="1285" width="0.2" height="15.0" fill="rgb(224,160,41)" rx="2" ry="2" /&gt;&lt;text  x="1192.41" y="1295.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;get_page_from_freelist (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1087.9" y="453" width="0.1" height="15.0" fill="rgb(213,34,10)" rx="2" ry="2" /&gt;&lt;text  x="1090.86" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgrfc2 (23 samples, 0.04%)&lt;/title&gt;&lt;rect x="11.3" y="837" width="0.4" height="15.0" fill="rgb(207,45,21)" rx="2" ry="2" /&gt;&lt;text  x="14.25" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_page_fault (61 samples, 0.11%)&lt;/title&gt;&lt;rect x="1087.0" y="565" width="1.2" height="15.0" fill="rgb(218,160,34)" rx="2" ry="2" /&gt;&lt;text  x="1089.95" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfnd (35 samples, 0.06%)&lt;/title&gt;&lt;rect x="1100.2" y="405" width="0.7" height="15.0" fill="rgb(236,165,31)" rx="2" ry="2" /&gt;&lt;text  x="1103.17" y="415.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbgcur (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="1094.6" y="453" width="0.2" height="15.0" fill="rgb(234,121,28)" rx="2" ry="2" /&gt;&lt;text  x="1097.60" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;prepare_exit_to_usermode (37 samples, 0.07%)&lt;/title&gt;&lt;rect x="950.3" y="645" width="0.8" height="15.0" fill="rgb(224,87,18)" rx="2" ry="2" /&gt;&lt;text  x="953.34" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__dta_xfs_file_buffered_aio_write_3297 (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1089.0" y="213" width="0.4" height="15.0" fill="rgb(230,195,46)" rx="2" ry="2" /&gt;&lt;text  x="1092.01" y="223.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_setjmp (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="11.1" y="853" width="0.1" height="15.0" fill="rgb(243,215,52)" rx="2" ry="2" /&gt;&lt;text  x="14.06" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;skgmrf_alloc (50 samples, 0.09%)&lt;/title&gt;&lt;rect x="1088.6" y="485" width="1.1" height="15.0" fill="rgb(247,94,51)" rx="2" ry="2" /&gt;&lt;text  x="1091.60" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtRecVAWriteDisk (19 samples, 0.03%)&lt;/title&gt;&lt;rect x="1100.5" y="245" width="0.4" height="15.0" fill="rgb(239,59,50)" rx="2" ry="2" /&gt;&lt;text  x="1103.51" y="255.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokegPinLob (5,451 samples, 9.79%)&lt;/title&gt;&lt;rect x="965.0" y="789" width="115.6" height="15.0" fill="rgb(247,72,40)" rx="2" ry="2" /&gt;&lt;text  x="968.04" y="799.5" &gt;kokegPinLob&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_page_fault (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1088.3" y="453" width="0.2" height="15.0" fill="rgb(254,203,11)" rx="2" ry="2" /&gt;&lt;text  x="1091.31" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlrsp (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1093.4" y="565" width="0.1" height="15.0" fill="rgb(228,50,33)" rx="2" ry="2" /&gt;&lt;text  x="1096.44" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__schedule (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="722.6" y="581" width="0.5" height="15.0" fill="rgb(222,205,43)" rx="2" ry="2" /&gt;&lt;text  x="725.63" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (10,942 samples, 19.65%)&lt;/title&gt;&lt;rect x="491.2" y="661" width="231.9" height="15.0" fill="rgb(233,120,51)" rx="2" ry="2" /&gt;&lt;text  x="494.21" y="671.5" &gt;_intel_fast_memcmp&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="1106.3" y="789" width="0.3" height="15.0" fill="rgb(244,191,27)" rx="2" ry="2" /&gt;&lt;text  x="1109.28" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalmc (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1083.2" y="661" width="0.1" height="15.0" fill="rgb(245,198,50)" rx="2" ry="2" /&gt;&lt;text  x="1086.18" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrr (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="962.0" y="693" width="0.3" height="15.0" fill="rgb(241,82,18)" rx="2" ry="2" /&gt;&lt;text  x="965.01" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfindctl (499 samples, 0.90%)&lt;/title&gt;&lt;rect x="480.5" y="661" width="10.6" height="15.0" fill="rgb(249,186,31)" rx="2" ry="2" /&gt;&lt;text  x="483.51" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollalop (14 samples, 0.03%)&lt;/title&gt;&lt;rect x="962.3" y="725" width="0.3" height="15.0" fill="rgb(247,106,42)" rx="2" ry="2" /&gt;&lt;text  x="965.31" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opiodr (55,607 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1061" width="1178.4" height="15.0" fill="rgb(245,71,34)" rx="2" ry="2" /&gt;&lt;text  x="13.83" y="1071.5" &gt;opiodr&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalf (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1101.3" y="533" width="0.1" height="15.0" fill="rgb(206,64,22)" rx="2" ry="2" /&gt;&lt;text  x="1104.28" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalw (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="1104.3" y="869" width="0.2" height="15.0" fill="rgb(210,174,7)" rx="2" ry="2" /&gt;&lt;text  x="1107.33" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbinvbrhb (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="735.1" y="629" width="0.1" height="15.0" fill="rgb(251,173,28)" rx="2" ry="2" /&gt;&lt;text  x="738.09" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__dta_xfs_file_aio_write_checks_3294 (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="1089.0" y="197" width="0.3" height="15.0" fill="rgb(231,71,40)" rx="2" ry="2" /&gt;&lt;text  x="1092.01" y="207.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalo (83 samples, 0.15%)&lt;/title&gt;&lt;rect x="1099.2" y="469" width="1.8" height="15.0" fill="rgb(252,60,48)" rx="2" ry="2" /&gt;&lt;text  x="1102.20" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qmuhshput (1,036 samples, 1.86%)&lt;/title&gt;&lt;rect x="1058.6" y="773" width="22.0" height="15.0" fill="rgb(228,135,42)" rx="2" ry="2" /&gt;&lt;text  x="1061.60" y="783.5" &gt;q..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;swapgs_restore_regs_and_return_to_usermode (37 samples, 0.07%)&lt;/title&gt;&lt;rect x="950.3" y="661" width="0.8" height="15.0" fill="rgb(240,126,21)" rx="2" ry="2" /&gt;&lt;text  x="953.34" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfnd_get_extent (156 samples, 0.28%)&lt;/title&gt;&lt;rect x="1086.5" y="693" width="3.3" height="15.0" fill="rgb(220,1,11)" rx="2" ry="2" /&gt;&lt;text  x="1089.46" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="961.8" y="677" width="0.2" height="15.0" fill="rgb(206,158,25)" rx="2" ry="2" /&gt;&lt;text  x="964.84" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfindctl (512 samples, 0.92%)&lt;/title&gt;&lt;rect x="249.3" y="693" width="10.8" height="15.0" fill="rgb(223,159,7)" rx="2" ry="2" /&gt;&lt;text  x="252.28" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbbset (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="1094.0" y="469" width="0.2" height="15.0" fill="rgb(222,67,40)" rx="2" ry="2" /&gt;&lt;text  x="1096.97" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;finish_task_switch (15 samples, 0.03%)&lt;/title&gt;&lt;rect x="950.8" y="581" width="0.3" height="15.0" fill="rgb(245,153,18)" rx="2" ry="2" /&gt;&lt;text  x="953.78" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklc_length (37 samples, 0.07%)&lt;/title&gt;&lt;rect x="1080.9" y="789" width="0.8" height="15.0" fill="rgb(233,36,3)" rx="2" ry="2" /&gt;&lt;text  x="1083.91" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__vfs_write (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.7" y="69" width="0.2" height="15.0" fill="rgb(252,99,35)" rx="2" ry="2" /&gt;&lt;text  x="1103.75" y="79.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbchg1 (138 samples, 0.25%)&lt;/title&gt;&lt;rect x="1095.7" y="517" width="2.9" height="15.0" fill="rgb(220,119,19)" rx="2" ry="2" /&gt;&lt;text  x="1098.66" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfnd (83 samples, 0.15%)&lt;/title&gt;&lt;rect x="1099.2" y="501" width="1.8" height="15.0" fill="rgb(216,71,2)" rx="2" ry="2" /&gt;&lt;text  x="1102.20" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokltcr (75 samples, 0.13%)&lt;/title&gt;&lt;rect x="1101.2" y="581" width="1.6" height="15.0" fill="rgb(233,163,54)" rx="2" ry="2" /&gt;&lt;text  x="1104.23" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrf (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="963.4" y="757" width="0.1" height="15.0" fill="rgb(236,38,35)" rx="2" ry="2" /&gt;&lt;text  x="966.39" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbdba_vbn (26 samples, 0.05%)&lt;/title&gt;&lt;rect x="736.4" y="645" width="0.6" height="15.0" fill="rgb(242,143,54)" rx="2" ry="2" /&gt;&lt;text  x="739.42" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;alloc_pages_vma (12 samples, 0.02%)&lt;/title&gt;&lt;rect x="1087.8" y="485" width="0.2" height="15.0" fill="rgb(254,125,46)" rx="2" ry="2" /&gt;&lt;text  x="1090.76" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="961.8" y="693" width="0.2" height="15.0" fill="rgb(253,50,29)" rx="2" ry="2" /&gt;&lt;text  x="964.82" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (66 samples, 0.12%)&lt;/title&gt;&lt;rect x="1088.3" y="549" width="1.4" height="15.0" fill="rgb(216,190,37)" rx="2" ry="2" /&gt;&lt;text  x="1091.27" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;evaopn2 (6,532 samples, 11.73%)&lt;/title&gt;&lt;rect x="964.9" y="837" width="138.4" height="15.0" fill="rgb(242,217,22)" rx="2" ry="2" /&gt;&lt;text  x="967.90" y="847.5" &gt;evaopn2&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kaf_typed_stuff (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="964.4" y="853" width="0.2" height="15.0" fill="rgb(237,51,29)" rx="2" ry="2" /&gt;&lt;text  x="967.39" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;irq_exit (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1161.6" y="821" width="0.2" height="15.0" fill="rgb(212,87,10)" rx="2" ry="2" /&gt;&lt;text  x="1164.63" y="831.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklSurrCheck (30 samples, 0.05%)&lt;/title&gt;&lt;rect x="1092.2" y="581" width="0.6" height="15.0" fill="rgb(240,157,50)" rx="2" ry="2" /&gt;&lt;text  x="1095.21" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolttfr (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1105.2" y="853" width="0.4" height="15.0" fill="rgb(251,227,10)" rx="2" ry="2" /&gt;&lt;text  x="1108.24" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_softirq (38 samples, 0.07%)&lt;/title&gt;&lt;rect x="478.7" y="597" width="0.9" height="15.0" fill="rgb(253,220,17)" rx="2" ry="2" /&gt;&lt;text  x="481.75" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbbscn (18 samples, 0.03%)&lt;/title&gt;&lt;rect x="1093.9" y="501" width="0.4" height="15.0" fill="rgb(209,128,8)" rx="2" ry="2" /&gt;&lt;text  x="1096.88" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrf (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="963.5" y="773" width="0.1" height="15.0" fill="rgb(235,51,3)" rx="2" ry="2" /&gt;&lt;text  x="966.52" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;apic_timer_interrupt (38 samples, 0.07%)&lt;/title&gt;&lt;rect x="478.7" y="645" width="0.9" height="15.0" fill="rgb(234,18,42)" rx="2" ry="2" /&gt;&lt;text  x="481.75" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kpmdurend (44,967 samples, 80.75%)&lt;/title&gt;&lt;rect x="11.0" y="933" width="952.9" height="15.0" fill="rgb(209,20,5)" rx="2" ry="2" /&gt;&lt;text  x="14.00" y="943.5" &gt;kpmdurend&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfnd (36 samples, 0.06%)&lt;/title&gt;&lt;rect x="1100.2" y="453" width="0.7" height="15.0" fill="rgb(250,92,16)" rx="2" ry="2" /&gt;&lt;text  x="1103.17" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_syscall_64 (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1089.0" y="293" width="0.4" height="15.0" fill="rgb(251,131,9)" rx="2" ry="2" /&gt;&lt;text  x="1092.01" y="303.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtTrc_int (40 samples, 0.07%)&lt;/title&gt;&lt;rect x="1088.7" y="437" width="0.9" height="15.0" fill="rgb(248,199,45)" rx="2" ry="2" /&gt;&lt;text  x="1091.71" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaFree_rfc (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1105.2" y="821" width="0.4" height="15.0" fill="rgb(220,33,5)" rx="2" ry="2" /&gt;&lt;text  x="1108.24" y="831.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1106.4" y="773" width="0.2" height="15.0" fill="rgb(208,35,48)" rx="2" ry="2" /&gt;&lt;text  x="1109.43" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbchg1_main (27 samples, 0.05%)&lt;/title&gt;&lt;rect x="735.8" y="613" width="0.5" height="15.0" fill="rgb(254,125,35)" rx="2" ry="2" /&gt;&lt;text  x="738.77" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (2,998 samples, 5.38%)&lt;/title&gt;&lt;rect x="965.2" y="757" width="63.6" height="15.0" fill="rgb(247,138,3)" rx="2" ry="2" /&gt;&lt;text  x="968.24" y="767.5" &gt;_intel..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgrfc (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1105.4" y="805" width="0.2" height="15.0" fill="rgb(240,167,16)" rx="2" ry="2" /&gt;&lt;text  x="1108.41" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (22 samples, 0.04%)&lt;/title&gt;&lt;rect x="11.3" y="805" width="0.4" height="15.0" fill="rgb(232,115,2)" rx="2" ry="2" /&gt;&lt;text  x="14.27" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalw (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1101.0" y="613" width="0.1" height="15.0" fill="rgb(220,126,24)" rx="2" ry="2" /&gt;&lt;text  x="1104.04" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokacau (20 samples, 0.04%)&lt;/title&gt;&lt;rect x="1090.7" y="581" width="0.4" height="15.0" fill="rgb(210,21,9)" rx="2" ry="2" /&gt;&lt;text  x="1093.66" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_softirq (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1058.2" y="693" width="0.1" height="15.0" fill="rgb(214,58,39)" rx="2" ry="2" /&gt;&lt;text  x="1061.15" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opitsk (55,631 samples, 99.90%)&lt;/title&gt;&lt;rect x="10.3" y="1365" width="1178.9" height="15.0" fill="rgb(247,216,13)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1375.5" &gt;opitsk&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_dl_addr (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1189.9" y="1493" width="0.1" height="15.0" fill="rgb(229,16,14)" rx="2" ry="2" /&gt;&lt;text  x="1192.85" y="1503.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollas2 (60 samples, 0.11%)&lt;/title&gt;&lt;rect x="1104.3" y="885" width="1.3" height="15.0" fill="rgb(210,74,53)" rx="2" ry="2" /&gt;&lt;text  x="1107.33" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrinstr_BFTCHC (55,607 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1205" width="1178.4" height="15.0" fill="rgb(252,76,47)" rx="2" ry="2" /&gt;&lt;text  x="13.83" y="1215.5" &gt;pfrinstr_BFTCHC&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaFree (44,931 samples, 80.69%)&lt;/title&gt;&lt;rect x="11.8" y="821" width="952.1" height="15.0" fill="rgb(231,33,25)" rx="2" ry="2" /&gt;&lt;text  x="14.76" y="831.5" &gt;kolaFree&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;vfs_write (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1089.0" y="261" width="0.4" height="15.0" fill="rgb(250,100,15)" rx="2" ry="2" /&gt;&lt;text  x="1092.01" y="271.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="1188.6" y="853" width="0.2" height="15.0" fill="rgb(250,169,7)" rx="2" ry="2" /&gt;&lt;text  x="1191.60" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;arch_local_irq_enable (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1058.3" y="693" width="0.2" height="15.0" fill="rgb(247,176,7)" rx="2" ry="2" /&gt;&lt;text  x="1061.32" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (86 samples, 0.15%)&lt;/title&gt;&lt;rect x="1099.2" y="533" width="1.8" height="15.0" fill="rgb(227,32,29)" rx="2" ry="2" /&gt;&lt;text  x="1102.16" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghssgmm (90 samples, 0.16%)&lt;/title&gt;&lt;rect x="1099.1" y="613" width="1.9" height="15.0" fill="rgb(250,70,13)" rx="2" ry="2" /&gt;&lt;text  x="1102.07" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__write_nocancel (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.6" y="165" width="0.1" height="15.0" fill="rgb(246,90,29)" rx="2" ry="2" /&gt;&lt;text  x="1103.62" y="175.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgrfc (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1103.7" y="805" width="0.1" height="15.0" fill="rgb(235,50,0)" rx="2" ry="2" /&gt;&lt;text  x="1106.69" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbchg1_main (12 samples, 0.02%)&lt;/title&gt;&lt;rect x="1094.0" y="421" width="0.2" height="15.0" fill="rgb(237,189,32)" rx="2" ry="2" /&gt;&lt;text  x="1096.99" y="431.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kssadf_numa_intl (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="737.5" y="549" width="0.1" height="15.0" fill="rgb(233,71,48)" rx="2" ry="2" /&gt;&lt;text  x="740.48" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qmuhsh_get (4,406 samples, 7.91%)&lt;/title&gt;&lt;rect x="965.2" y="773" width="93.4" height="15.0" fill="rgb(237,229,2)" rx="2" ry="2" /&gt;&lt;text  x="968.24" y="783.5" &gt;qmuhsh_get&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;run_timer_softirq (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="248.3" y="613" width="0.1" height="15.0" fill="rgb(212,196,5)" rx="2" ry="2" /&gt;&lt;text  x="251.26" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfindctl (556 samples, 1.00%)&lt;/title&gt;&lt;rect x="723.1" y="661" width="11.8" height="15.0" fill="rgb(247,137,36)" rx="2" ry="2" /&gt;&lt;text  x="726.12" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpidru (55,607 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1109" width="1178.4" height="15.0" fill="rgb(227,68,6)" rx="2" ry="2" /&gt;&lt;text  x="13.83" y="1119.5" &gt;rpidru&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbzfb (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1095.4" y="501" width="0.2" height="15.0" fill="rgb(242,32,13)" rx="2" ry="2" /&gt;&lt;text  x="1098.39" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklpgszCbk (52 samples, 0.09%)&lt;/title&gt;&lt;rect x="1090.3" y="645" width="1.1" height="15.0" fill="rgb(239,54,12)" rx="2" ry="2" /&gt;&lt;text  x="1093.28" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__schedule (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="248.8" y="613" width="0.5" height="15.0" fill="rgb(249,128,41)" rx="2" ry="2" /&gt;&lt;text  x="251.84" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;get_page_from_freelist (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1099.8" y="293" width="0.1" height="15.0" fill="rgb(229,204,11)" rx="2" ry="2" /&gt;&lt;text  x="1102.75" y="303.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalo (66 samples, 0.12%)&lt;/title&gt;&lt;rect x="1088.3" y="581" width="1.4" height="15.0" fill="rgb(235,94,10)" rx="2" ry="2" /&gt;&lt;text  x="1091.27" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;vfs_write (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.7" y="85" width="0.2" height="15.0" fill="rgb(239,74,13)" rx="2" ry="2" /&gt;&lt;text  x="1103.75" y="95.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;file_update_time (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="1089.0" y="181" width="0.3" height="15.0" fill="rgb(216,23,14)" rx="2" ry="2" /&gt;&lt;text  x="1092.01" y="191.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opifch (55,602 samples, 99.85%)&lt;/title&gt;&lt;rect x="10.9" y="1029" width="1178.2" height="15.0" fill="rgb(227,54,22)" rx="2" ry="2" /&gt;&lt;text  x="13.91" y="1039.5" &gt;opifch&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;entry_SYSCALL_64_after_hwframe (31 samples, 0.06%)&lt;/title&gt;&lt;rect x="1189.2" y="1477" width="0.7" height="15.0" fill="rgb(241,76,41)" rx="2" ry="2" /&gt;&lt;text  x="1192.19" y="1487.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smp_apic_timer_interrupt (28 samples, 0.05%)&lt;/title&gt;&lt;rect x="721.6" y="629" width="0.6" height="15.0" fill="rgb(235,51,34)" rx="2" ry="2" /&gt;&lt;text  x="724.59" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklpgsz (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="1092.4" y="565" width="0.4" height="15.0" fill="rgb(209,127,25)" rx="2" ry="2" /&gt;&lt;text  x="1095.38" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_IO_vsnprintf (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="10.1" y="1477" width="0.2" height="15.0" fill="rgb(207,91,45)" rx="2" ry="2" /&gt;&lt;text  x="13.08" y="1487.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (10 samples, 0.02%)&lt;/title&gt;&lt;rect x="1105.0" y="821" width="0.2" height="15.0" fill="rgb(205,213,21)" rx="2" ry="2" /&gt;&lt;text  x="1108.03" y="831.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;prepare_exit_to_usermode (45 samples, 0.08%)&lt;/title&gt;&lt;rect x="479.6" y="629" width="0.9" height="15.0" fill="rgb(229,144,51)" rx="2" ry="2" /&gt;&lt;text  x="482.55" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (35 samples, 0.06%)&lt;/title&gt;&lt;rect x="1100.2" y="389" width="0.7" height="15.0" fill="rgb(239,99,44)" rx="2" ry="2" /&gt;&lt;text  x="1103.17" y="399.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kpdbUidToId (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1090.9" y="565" width="0.1" height="15.0" fill="rgb(245,5,50)" rx="2" ry="2" /&gt;&lt;text  x="1093.89" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklc_pagesize (58 samples, 0.10%)&lt;/title&gt;&lt;rect x="1090.2" y="677" width="1.2" height="15.0" fill="rgb(245,198,52)" rx="2" ry="2" /&gt;&lt;text  x="1093.15" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdli_iread (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="1081.0" y="725" width="0.2" height="15.0" fill="rgb(234,10,17)" rx="2" ry="2" /&gt;&lt;text  x="1084.02" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;psdnal (55,607 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1173" width="1178.4" height="15.0" fill="rgb(212,120,43)" rx="2" ry="2" /&gt;&lt;text  x="13.83" y="1183.5" &gt;psdnal&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (83 samples, 0.15%)&lt;/title&gt;&lt;rect x="1099.2" y="485" width="1.8" height="15.0" fill="rgb(244,137,33)" rx="2" ry="2" /&gt;&lt;text  x="1102.20" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;arch_local_irq_enable (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="248.5" y="629" width="0.3" height="15.0" fill="rgb(227,46,49)" rx="2" ry="2" /&gt;&lt;text  x="251.52" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghuwrlength (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="963.1" y="709" width="0.1" height="15.0" fill="rgb(223,66,30)" rx="2" ry="2" /&gt;&lt;text  x="966.14" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (10,369 samples, 18.62%)&lt;/title&gt;&lt;rect x="260.8" y="661" width="219.7" height="15.0" fill="rgb(225,72,38)" rx="2" ry="2" /&gt;&lt;text  x="263.79" y="671.5" &gt;_intel_fast_memcmp&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;swapgs_restore_regs_and_return_to_usermode (15 samples, 0.03%)&lt;/title&gt;&lt;rect x="1028.4" y="741" width="0.4" height="15.0" fill="rgb(233,165,33)" rx="2" ry="2" /&gt;&lt;text  x="1031.45" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklglen (37 samples, 0.07%)&lt;/title&gt;&lt;rect x="1080.9" y="773" width="0.8" height="15.0" fill="rgb(248,34,44)" rx="2" ry="2" /&gt;&lt;text  x="1083.91" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qmuhshget_internal (1,233 samples, 2.21%)&lt;/title&gt;&lt;rect x="1162.1" y="869" width="26.1" height="15.0" fill="rgb(223,170,12)" rx="2" ry="2" /&gt;&lt;text  x="1165.07" y="879.5" &gt;q..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opiexe (55,610 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1301" width="1178.4" height="15.0" fill="rgb(228,146,6)" rx="2" ry="2" /&gt;&lt;text  x="13.78" y="1311.5" &gt;opiexe&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1104.6" y="805" width="0.2" height="15.0" fill="rgb(254,14,42)" rx="2" ry="2" /&gt;&lt;text  x="1107.60" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_async_page_fault (61 samples, 0.11%)&lt;/title&gt;&lt;rect x="1087.0" y="581" width="1.2" height="15.0" fill="rgb(206,53,4)" rx="2" ry="2" /&gt;&lt;text  x="1089.95" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kprcdt (63 samples, 0.11%)&lt;/title&gt;&lt;rect x="1104.3" y="901" width="1.3" height="15.0" fill="rgb(229,82,36)" rx="2" ry="2" /&gt;&lt;text  x="1107.26" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;apic_timer_interrupt (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1161.6" y="853" width="0.2" height="15.0" fill="rgb(241,96,54)" rx="2" ry="2" /&gt;&lt;text  x="1164.63" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;clear_page_erms (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1087.8" y="453" width="0.1" height="15.0" fill="rgb(246,144,32)" rx="2" ry="2" /&gt;&lt;text  x="1090.76" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;exit_to_usermode_loop (15 samples, 0.03%)&lt;/title&gt;&lt;rect x="1028.4" y="709" width="0.4" height="15.0" fill="rgb(236,144,54)" rx="2" ry="2" /&gt;&lt;text  x="1031.45" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_async_page_fault (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.2" y="325" width="0.1" height="15.0" fill="rgb(211,224,29)" rx="2" ry="2" /&gt;&lt;text  x="1103.22" y="335.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;apic_timer_interrupt (10 samples, 0.02%)&lt;/title&gt;&lt;rect x="1028.2" y="741" width="0.2" height="15.0" fill="rgb(237,188,4)" rx="2" ry="2" /&gt;&lt;text  x="1031.23" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smp_apic_timer_interrupt (10 samples, 0.02%)&lt;/title&gt;&lt;rect x="1028.2" y="725" width="0.2" height="15.0" fill="rgb(221,39,50)" rx="2" ry="2" /&gt;&lt;text  x="1031.23" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_softirq (28 samples, 0.05%)&lt;/title&gt;&lt;rect x="721.6" y="597" width="0.6" height="15.0" fill="rgb(221,10,37)" rx="2" ry="2" /&gt;&lt;text  x="724.59" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktcsna (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="737.9" y="677" width="0.2" height="15.0" fill="rgb(243,179,25)" rx="2" ry="2" /&gt;&lt;text  x="740.95" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_softirq (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1080.4" y="693" width="0.1" height="15.0" fill="rgb(211,47,46)" rx="2" ry="2" /&gt;&lt;text  x="1083.43" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklc_sysparam (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1103.6" y="789" width="0.1" height="15.0" fill="rgb(210,214,34)" rx="2" ry="2" /&gt;&lt;text  x="1106.56" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrempty_sh_all_depth (19 samples, 0.03%)&lt;/title&gt;&lt;rect x="10.4" y="1221" width="0.4" height="15.0" fill="rgb(227,95,4)" rx="2" ry="2" /&gt;&lt;text  x="13.38" y="1231.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohedu (44,967 samples, 80.75%)&lt;/title&gt;&lt;rect x="11.0" y="917" width="952.9" height="15.0" fill="rgb(228,70,22)" rx="2" ry="2" /&gt;&lt;text  x="14.00" y="927.5" &gt;kohedu&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;skgmrf_alloc (26 samples, 0.05%)&lt;/title&gt;&lt;rect x="1100.4" y="325" width="0.5" height="15.0" fill="rgb(210,200,3)" rx="2" ry="2" /&gt;&lt;text  x="1103.37" y="335.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;apic_timer_interrupt (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1080.4" y="741" width="0.1" height="15.0" fill="rgb(232,142,49)" rx="2" ry="2" /&gt;&lt;text  x="1083.43" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollfrfn (14 samples, 0.03%)&lt;/title&gt;&lt;rect x="962.0" y="725" width="0.3" height="15.0" fill="rgb(246,158,26)" rx="2" ry="2" /&gt;&lt;text  x="964.99" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrde_free (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="962.9" y="757" width="0.3" height="15.0" fill="rgb(231,84,50)" rx="2" ry="2" /&gt;&lt;text  x="965.88" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcoapl (14 samples, 0.03%)&lt;/title&gt;&lt;rect x="736.0" y="597" width="0.3" height="15.0" fill="rgb(248,106,4)" rx="2" ry="2" /&gt;&lt;text  x="739.02" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__intel_new_memset (14 samples, 0.03%)&lt;/title&gt;&lt;rect x="260.4" y="677" width="0.3" height="15.0" fill="rgb(219,125,21)" rx="2" ry="2" /&gt;&lt;text  x="263.36" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (35 samples, 0.06%)&lt;/title&gt;&lt;rect x="1084.9" y="693" width="0.7" height="15.0" fill="rgb(249,62,3)" rx="2" ry="2" /&gt;&lt;text  x="1087.85" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgshx (11 samples, 0.02%)&lt;/title&gt;&lt;rect x="1094.6" y="501" width="0.2" height="15.0" fill="rgb(221,225,40)" rx="2" ry="2" /&gt;&lt;text  x="1097.58" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohdee (44,967 samples, 80.75%)&lt;/title&gt;&lt;rect x="11.0" y="901" width="952.9" height="15.0" fill="rgb(248,155,7)" rx="2" ry="2" /&gt;&lt;text  x="14.00" y="911.5" &gt;kohdee&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokegCollectGarbageFromScalar (3,859 samples, 6.93%)&lt;/title&gt;&lt;rect x="1107.1" y="917" width="81.7" height="15.0" fill="rgb(214,124,27)" rx="2" ry="2" /&gt;&lt;text  x="1110.06" y="927.5" &gt;kokegColl..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbfsp (121 samples, 0.22%)&lt;/title&gt;&lt;rect x="735.3" y="661" width="2.6" height="15.0" fill="rgb(210,181,7)" rx="2" ry="2" /&gt;&lt;text  x="738.32" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtfmWriteMetadata (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1089.4" y="373" width="0.2" height="15.0" fill="rgb(246,156,29)" rx="2" ry="2" /&gt;&lt;text  x="1092.37" y="383.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;handle_mm_fault (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1088.4" y="437" width="0.1" height="15.0" fill="rgb(205,71,52)" rx="2" ry="2" /&gt;&lt;text  x="1091.37" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kco_issue_callback (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="736.1" y="581" width="0.1" height="15.0" fill="rgb(217,2,19)" rx="2" ry="2" /&gt;&lt;text  x="739.10" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;xfs_file_write_iter (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.7" y="53" width="0.2" height="15.0" fill="rgb(230,49,43)" rx="2" ry="2" /&gt;&lt;text  x="1103.75" y="63.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__alloc_pages_nodemask (12 samples, 0.02%)&lt;/title&gt;&lt;rect x="1087.8" y="469" width="0.2" height="15.0" fill="rgb(250,152,51)" rx="2" ry="2" /&gt;&lt;text  x="1090.76" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbvini (39 samples, 0.07%)&lt;/title&gt;&lt;rect x="737.0" y="645" width="0.8" height="15.0" fill="rgb(235,171,22)" rx="2" ry="2" /&gt;&lt;text  x="739.97" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kafger (12 samples, 0.02%)&lt;/title&gt;&lt;rect x="964.3" y="869" width="0.3" height="15.0" fill="rgb(253,151,36)" rx="2" ry="2" /&gt;&lt;text  x="967.32" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sys_write (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1089.0" y="277" width="0.4" height="15.0" fill="rgb(251,105,17)" rx="2" ry="2" /&gt;&lt;text  x="1092.01" y="287.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__vfs_write (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1089.0" y="245" width="0.4" height="15.0" fill="rgb(211,76,50)" rx="2" ry="2" /&gt;&lt;text  x="1092.01" y="255.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbbfill (18 samples, 0.03%)&lt;/title&gt;&lt;rect x="1093.9" y="485" width="0.4" height="15.0" fill="rgb(207,161,6)" rx="2" ry="2" /&gt;&lt;text  x="1096.88" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtTrc_int (22 samples, 0.04%)&lt;/title&gt;&lt;rect x="1100.5" y="277" width="0.4" height="15.0" fill="rgb(206,193,43)" rx="2" ry="2" /&gt;&lt;text  x="1103.45" y="287.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrrun_no_tool (55,610 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1221" width="1178.4" height="15.0" fill="rgb(241,199,25)" rx="2" ry="2" /&gt;&lt;text  x="13.78" y="1231.5" &gt;pfrrun_no_tool&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghaddex (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1086.5" y="677" width="0.1" height="15.0" fill="rgb(231,39,33)" rx="2" ry="2" /&gt;&lt;text  x="1089.51" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="1106.6" y="789" width="0.4" height="15.0" fill="rgb(214,98,51)" rx="2" ry="2" /&gt;&lt;text  x="1109.60" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kxstTraceWait (45 samples, 0.08%)&lt;/title&gt;&lt;rect x="1088.7" y="453" width="0.9" height="15.0" fill="rgb(209,23,17)" rx="2" ry="2" /&gt;&lt;text  x="1091.69" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfsadrc (66 samples, 0.12%)&lt;/title&gt;&lt;rect x="1105.6" y="917" width="1.4" height="15.0" fill="rgb(240,217,15)" rx="2" ry="2" /&gt;&lt;text  x="1108.60" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1104.7" y="789" width="0.1" height="15.0" fill="rgb(223,100,2)" rx="2" ry="2" /&gt;&lt;text  x="1107.67" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="1105.4" y="789" width="0.2" height="15.0" fill="rgb(249,107,54)" rx="2" ry="2" /&gt;&lt;text  x="1108.41" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbchg1 (12 samples, 0.02%)&lt;/title&gt;&lt;rect x="1094.0" y="437" width="0.2" height="15.0" fill="rgb(205,220,27)" rx="2" ry="2" /&gt;&lt;text  x="1096.99" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgrfc (30 samples, 0.05%)&lt;/title&gt;&lt;rect x="1188.2" y="901" width="0.6" height="15.0" fill="rgb(206,153,54)" rx="2" ry="2" /&gt;&lt;text  x="1191.20" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokasuc (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="1090.6" y="597" width="0.5" height="15.0" fill="rgb(242,95,47)" rx="2" ry="2" /&gt;&lt;text  x="1093.64" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;exit_to_usermode_loop (11 samples, 0.02%)&lt;/title&gt;&lt;rect x="1161.8" y="821" width="0.3" height="15.0" fill="rgb(206,35,53)" rx="2" ry="2" /&gt;&lt;text  x="1164.84" y="831.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbivbr (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="735.0" y="645" width="0.2" height="15.0" fill="rgb(234,156,20)" rx="2" ry="2" /&gt;&lt;text  x="738.05" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (68 samples, 0.12%)&lt;/title&gt;&lt;rect x="1088.3" y="597" width="1.4" height="15.0" fill="rgb(234,95,21)" rx="2" ry="2" /&gt;&lt;text  x="1091.27" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfnd (147 samples, 0.26%)&lt;/title&gt;&lt;rect x="1086.6" y="661" width="3.1" height="15.0" fill="rgb(245,101,0)" rx="2" ry="2" /&gt;&lt;text  x="1089.63" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtTrcVaList_int (40 samples, 0.07%)&lt;/title&gt;&lt;rect x="1088.7" y="421" width="0.9" height="15.0" fill="rgb(238,109,36)" rx="2" ry="2" /&gt;&lt;text  x="1091.71" y="431.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;prepare_exit_to_usermode (41 samples, 0.07%)&lt;/title&gt;&lt;rect x="722.2" y="629" width="0.9" height="15.0" fill="rgb(220,62,24)" rx="2" ry="2" /&gt;&lt;text  x="725.20" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_softirq (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1071.0" y="693" width="0.1" height="15.0" fill="rgb(234,72,25)" rx="2" ry="2" /&gt;&lt;text  x="1073.97" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_page_fault (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.2" y="293" width="0.1" height="15.0" fill="rgb(235,191,2)" rx="2" ry="2" /&gt;&lt;text  x="1103.22" y="303.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qmuhshget_internal (434 samples, 0.78%)&lt;/title&gt;&lt;rect x="1071.4" y="757" width="9.2" height="15.0" fill="rgb(211,95,33)" rx="2" ry="2" /&gt;&lt;text  x="1074.36" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklcopy2 (630 samples, 1.13%)&lt;/title&gt;&lt;rect x="1089.9" y="741" width="13.3" height="15.0" fill="rgb(251,170,13)" rx="2" ry="2" /&gt;&lt;text  x="1092.85" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklglenCbk (34 samples, 0.06%)&lt;/title&gt;&lt;rect x="1081.0" y="757" width="0.7" height="15.0" fill="rgb(211,209,10)" rx="2" ry="2" /&gt;&lt;text  x="1083.95" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrempty (18 samples, 0.03%)&lt;/title&gt;&lt;rect x="10.4" y="1205" width="0.4" height="15.0" fill="rgb(227,53,10)" rx="2" ry="2" /&gt;&lt;text  x="13.40" y="1215.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokacpc (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1090.4" y="613" width="0.2" height="15.0" fill="rgb(254,151,33)" rx="2" ry="2" /&gt;&lt;text  x="1093.45" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbchg1 (31 samples, 0.06%)&lt;/title&gt;&lt;rect x="735.7" y="629" width="0.7" height="15.0" fill="rgb(252,145,7)" rx="2" ry="2" /&gt;&lt;text  x="738.74" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklc_read (72 samples, 0.13%)&lt;/title&gt;&lt;rect x="1091.4" y="677" width="1.5" height="15.0" fill="rgb(235,169,19)" rx="2" ry="2" /&gt;&lt;text  x="1094.38" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollfre (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="12.6" y="773" width="0.2" height="15.0" fill="rgb(251,51,47)" rx="2" ry="2" /&gt;&lt;text  x="15.65" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgsc (30 samples, 0.05%)&lt;/title&gt;&lt;rect x="737.1" y="597" width="0.6" height="15.0" fill="rgb(250,94,35)" rx="2" ry="2" /&gt;&lt;text  x="740.06" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklread (71 samples, 0.13%)&lt;/title&gt;&lt;rect x="1091.4" y="661" width="1.5" height="15.0" fill="rgb(238,170,28)" rx="2" ry="2" /&gt;&lt;text  x="1094.40" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolredurHashMapCbk (44,957 samples, 80.73%)&lt;/title&gt;&lt;rect x="11.2" y="853" width="952.7" height="15.0" fill="rgb(236,225,38)" rx="2" ry="2" /&gt;&lt;text  x="14.21" y="863.5" &gt;kolredurHashMapCbk&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgdc (13 samples, 0.02%)&lt;/title&gt;&lt;rect x="1106.3" y="805" width="0.3" height="15.0" fill="rgb(224,93,16)" rx="2" ry="2" /&gt;&lt;text  x="1109.28" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kslwtectx (25 samples, 0.04%)&lt;/title&gt;&lt;rect x="1100.4" y="309" width="0.5" height="15.0" fill="rgb(214,92,29)" rx="2" ry="2" /&gt;&lt;text  x="1103.39" y="319.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qerstFetch (6,606 samples, 11.86%)&lt;/title&gt;&lt;rect x="964.1" y="933" width="140.0" height="15.0" fill="rgb(226,195,29)" rx="2" ry="2" /&gt;&lt;text  x="967.11" y="943.5" &gt;qerstFetch&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbnew (40 samples, 0.07%)&lt;/title&gt;&lt;rect x="1094.8" y="533" width="0.9" height="15.0" fill="rgb(219,140,49)" rx="2" ry="2" /&gt;&lt;text  x="1097.81" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qmuhsh_get (3,827 samples, 6.87%)&lt;/title&gt;&lt;rect x="1107.1" y="885" width="81.1" height="15.0" fill="rgb(251,70,1)" rx="2" ry="2" /&gt;&lt;text  x="1110.10" y="895.5" &gt;qmuhsh_get&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kole_templob_init (1,010 samples, 1.81%)&lt;/title&gt;&lt;rect x="1081.8" y="789" width="21.4" height="15.0" fill="rgb(218,178,39)" rx="2" ry="2" /&gt;&lt;text  x="1084.80" y="799.5" &gt;k..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolradc (12 samples, 0.02%)&lt;/title&gt;&lt;rect x="1104.6" y="821" width="0.3" height="15.0" fill="rgb(218,199,5)" rx="2" ry="2" /&gt;&lt;text  x="1107.60" y="831.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlw_locator_op_read (15 samples, 0.03%)&lt;/title&gt;&lt;rect x="1081.3" y="709" width="0.3" height="15.0" fill="rgb(234,180,26)" rx="2" ry="2" /&gt;&lt;text  x="1084.25" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcblibr_int (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="735.0" y="661" width="0.2" height="15.0" fill="rgb(250,162,17)" rx="2" ry="2" /&gt;&lt;text  x="738.05" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kxstcol (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="963.9" y="997" width="0.1" height="15.0" fill="rgb(214,10,25)" rx="2" ry="2" /&gt;&lt;text  x="966.88" y="1007.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__intel_new_memset (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1090.0" y="677" width="0.1" height="15.0" fill="rgb(217,92,30)" rx="2" ry="2" /&gt;&lt;text  x="1093.02" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kole_substr (1,056 samples, 1.90%)&lt;/title&gt;&lt;rect x="1080.8" y="805" width="22.4" height="15.0" fill="rgb(249,43,5)" rx="2" ry="2" /&gt;&lt;text  x="1083.83" y="815.5" &gt;k..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smp_apic_timer_interrupt (40 samples, 0.07%)&lt;/title&gt;&lt;rect x="949.5" y="645" width="0.8" height="15.0" fill="rgb(237,115,51)" rx="2" ry="2" /&gt;&lt;text  x="952.49" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;handle_mm_fault (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.2" y="277" width="0.1" height="15.0" fill="rgb(235,60,43)" rx="2" ry="2" /&gt;&lt;text  x="1103.24" y="287.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (28 samples, 0.05%)&lt;/title&gt;&lt;rect x="1188.2" y="869" width="0.6" height="15.0" fill="rgb(210,20,24)" rx="2" ry="2" /&gt;&lt;text  x="1191.24" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kco_issue_callback (132 samples, 0.24%)&lt;/title&gt;&lt;rect x="1095.8" y="469" width="2.8" height="15.0" fill="rgb(221,189,42)" rx="2" ry="2" /&gt;&lt;text  x="1098.79" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;async_page_fault (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.2" y="341" width="0.1" height="15.0" fill="rgb(235,217,22)" rx="2" ry="2" /&gt;&lt;text  x="1103.22" y="351.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (28 samples, 0.05%)&lt;/title&gt;&lt;rect x="1188.2" y="885" width="0.6" height="15.0" fill="rgb(249,78,22)" rx="2" ry="2" /&gt;&lt;text  x="1191.24" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfre (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="10.6" y="1189" width="0.2" height="15.0" fill="rgb(209,10,34)" rx="2" ry="2" /&gt;&lt;text  x="13.61" y="1199.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksmrf_init_alloc (27 samples, 0.05%)&lt;/title&gt;&lt;rect x="1100.3" y="341" width="0.6" height="15.0" fill="rgb(252,155,26)" rx="2" ry="2" /&gt;&lt;text  x="1103.34" y="351.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtfWriteRec (37 samples, 0.07%)&lt;/title&gt;&lt;rect x="1088.8" y="389" width="0.8" height="15.0" fill="rgb(250,53,19)" rx="2" ry="2" /&gt;&lt;text  x="1091.77" y="399.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__libc_start_main (55,631 samples, 99.90%)&lt;/title&gt;&lt;rect x="10.3" y="1493" width="1178.9" height="15.0" fill="rgb(206,204,14)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1503.5" &gt;__libc_start_main&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrem (17 samples, 0.03%)&lt;/title&gt;&lt;rect x="962.9" y="725" width="0.3" height="15.0" fill="rgb(236,30,2)" rx="2" ry="2" /&gt;&lt;text  x="965.88" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlt_createtemp (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1101.3" y="565" width="0.1" height="15.0" fill="rgb(241,60,42)" rx="2" ry="2" /&gt;&lt;text  x="1104.26" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qersoRowP (6,575 samples, 11.81%)&lt;/title&gt;&lt;rect x="964.7" y="853" width="139.4" height="15.0" fill="rgb(245,102,48)" rx="2" ry="2" /&gt;&lt;text  x="967.75" y="863.5" &gt;qersoRowP&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtfdFileAccessCbk (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.6" y="213" width="0.1" height="15.0" fill="rgb(224,15,21)" rx="2" ry="2" /&gt;&lt;text  x="1103.58" y="223.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rcu_report_qs_rnp (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="950.0" y="581" width="0.1" height="15.0" fill="rgb(221,65,43)" rx="2" ry="2" /&gt;&lt;text  x="953.04" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksmarfg (66 samples, 0.12%)&lt;/title&gt;&lt;rect x="1088.3" y="517" width="1.4" height="15.0" fill="rgb(206,136,8)" rx="2" ry="2" /&gt;&lt;text  x="1091.27" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghssgai (164 samples, 0.29%)&lt;/title&gt;&lt;rect x="1086.3" y="741" width="3.5" height="15.0" fill="rgb(227,147,15)" rx="2" ry="2" /&gt;&lt;text  x="1089.29" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkxexe (55,610 samples, 99.86%)&lt;/title&gt;&lt;rect x="10.8" y="1285" width="1178.4" height="15.0" fill="rgb(206,172,35)" rx="2" ry="2" /&gt;&lt;text  x="13.78" y="1295.5" &gt;kkxexe&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;exit_to_usermode_loop (39 samples, 0.07%)&lt;/title&gt;&lt;rect x="722.2" y="613" width="0.9" height="15.0" fill="rgb(246,197,46)" rx="2" ry="2" /&gt;&lt;text  x="725.25" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklwrite (279 samples, 0.50%)&lt;/title&gt;&lt;rect x="1093.1" y="629" width="5.9" height="15.0" fill="rgb(215,206,33)" rx="2" ry="2" /&gt;&lt;text  x="1096.12" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;swapgs_restore_regs_and_return_to_usermode (14 samples, 0.03%)&lt;/title&gt;&lt;rect x="1058.3" y="741" width="0.3" height="15.0" fill="rgb(241,154,32)" rx="2" ry="2" /&gt;&lt;text  x="1061.30" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtfdFileAccessCbk (24 samples, 0.04%)&lt;/title&gt;&lt;rect x="1088.9" y="373" width="0.5" height="15.0" fill="rgb(229,45,15)" rx="2" ry="2" /&gt;&lt;text  x="1091.86" y="383.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrempty_ex (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="10.3" y="1253" width="0.5" height="15.0" fill="rgb(225,39,6)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1263.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaslCreateCtx (174 samples, 0.31%)&lt;/title&gt;&lt;rect x="1086.1" y="757" width="3.7" height="15.0" fill="rgb(228,212,37)" rx="2" ry="2" /&gt;&lt;text  x="1089.08" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlt_remove_tlob_ctl_link (10,528 samples, 18.91%)&lt;/title&gt;&lt;rect x="738.2" y="693" width="223.1" height="15.0" fill="rgb(228,204,31)" rx="2" ry="2" /&gt;&lt;text  x="741.20" y="703.5" &gt;kdlt_remove_tlob_ctl_link&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokasuc (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="1092.6" y="501" width="0.2" height="15.0" fill="rgb(242,108,22)" rx="2" ry="2" /&gt;&lt;text  x="1095.61" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smbput (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1103.9" y="837" width="0.2" height="15.0" fill="rgb(253,116,51)" rx="2" ry="2" /&gt;&lt;text  x="1106.90" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;arch_local_irq_enable (8 samples, 0.01%)&lt;/title&gt;&lt;rect x="1028.5" y="693" width="0.1" height="15.0" fill="rgb(234,76,11)" rx="2" ry="2" /&gt;&lt;text  x="1031.47" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklNeedSurrChk (6 samples, 0.01%)&lt;/title&gt;&lt;rect x="1098.7" y="581" width="0.1" height="15.0" fill="rgb(217,196,52)" rx="2" ry="2" /&gt;&lt;text  x="1101.69" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__write_nocancel (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.7" y="149" width="0.2" height="15.0" fill="rgb(245,176,34)" rx="2" ry="2" /&gt;&lt;text  x="1103.75" y="159.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;[unknown] (15 samples, 0.03%)&lt;/title&gt;&lt;rect x="10.0" y="1493" width="0.3" height="15.0" fill="rgb(231,168,39)" rx="2" ry="2" /&gt;&lt;text  x="13.02" y="1503.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qersoFetchSimple (10,625 samples, 19.08%)&lt;/title&gt;&lt;rect x="964.0" y="965" width="225.1" height="15.0" fill="rgb(226,169,10)" rx="2" ry="2" /&gt;&lt;text  x="966.98" y="975.5" &gt;qersoFetchSimple&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksuintract_handle_network_interrupt (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="10.3" y="1301" width="0.5" height="15.0" fill="rgb(223,49,6)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1311.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__intel_ssse3_rep_memcpy (69 samples, 0.12%)&lt;/title&gt;&lt;rect x="1095.9" y="437" width="1.4" height="15.0" fill="rgb(249,36,12)" rx="2" ry="2" /&gt;&lt;text  x="1098.85" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalo (144 samples, 0.26%)&lt;/title&gt;&lt;rect x="1086.7" y="629" width="3.0" height="15.0" fill="rgb(224,69,51)" rx="2" ry="2" /&gt;&lt;text  x="1089.70" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalmc (9 samples, 0.02%)&lt;/title&gt;&lt;rect x="962.4" y="677" width="0.2" height="15.0" fill="rgb(233,170,53)" rx="2" ry="2" /&gt;&lt;text  x="965.42" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;apic_timer_interrupt (7 samples, 0.01%)&lt;/title&gt;&lt;rect x="1058.2" y="741" width="0.1" height="15.0" fill="rgb(246,145,39)" rx="2" ry="2" /&gt;&lt;text  x="1061.15" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtfdFileWrite (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.7" y="181" width="0.2" height="15.0" fill="rgb(252,182,43)" rx="2" ry="2" /&gt;&lt;text  x="1103.75" y="191.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksuintract_exec_pending (21 samples, 0.04%)&lt;/title&gt;&lt;rect x="10.3" y="1285" width="0.5" height="15.0" fill="rgb(230,139,41)" rx="2" ry="2" /&gt;&lt;text  x="13.34" y="1295.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;async_page_fault (41 samples, 0.07%)&lt;/title&gt;&lt;rect x="1099.3" y="437" width="0.9" height="15.0" fill="rgb(245,197,31)" rx="2" ry="2" /&gt;&lt;text  x="1102.31" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtfWriteRec (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="963.9" y="933" width="0.1" height="15.0" fill="rgb(211,150,19)" rx="2" ry="2" /&gt;&lt;text  x="966.88" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qertbFetch (6,606 samples, 11.86%)&lt;/title&gt;&lt;rect x="964.1" y="917" width="140.0" height="15.0" fill="rgb(249,165,28)" rx="2" ry="2" /&gt;&lt;text  x="967.11" y="927.5" &gt;qertbFetch&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;dbgtfdFileAccessCbk (5 samples, 0.01%)&lt;/title&gt;&lt;rect x="1100.7" y="197" width="0.2" height="15.0" fill="rgb(217,178,34)" rx="2" ry="2" /&gt;&lt;text  x="1103.75" y="207.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaWrite (471 samples, 0.85%)&lt;/title&gt;&lt;rect x="1093.0" y="677" width="10.0" height="15.0" fill="rgb(230,156,40)" rx="2" ry="2" /&gt;&lt;text  x="1095.97" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kxsFreeExecutionHeap (44,968 samples, 80.75%)&lt;/title&gt;&lt;rect x="11.0" y="981" width="952.9" height="15.0" fill="rgb(238,37,27)" rx="2" ry="2" /&gt;&lt;text  x="13.97" y="991.5" &gt;kxsFreeExecutionHeap&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;swapgs_restore_regs_and_return_to_usermode (41 samples, 0.07%)&lt;/title&gt;&lt;rect x="722.2" y="645" width="0.9" height="15.0" fill="rgb(235,137,1)" rx="2" ry="2" /&gt;&lt;text  x="725.20" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolasaWrite (94 samples, 0.17%)&lt;/title&gt;&lt;rect x="1099.0" y="645" width="2.0" height="15.0" fill="rgb(219,72,38)" rx="2" ry="2" /&gt;&lt;text  x="1102.03" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaslCreateClob (375 samples, 0.67%)&lt;/title&gt;&lt;rect x="1081.8" y="773" width="8.0" height="15.0" fill="rgb(241,207,8)" rx="2" ry="2" /&gt;&lt;text  x="1084.84" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;/g&gt;&lt;/svg&gt; It can be seen that there are functions such as &lt;b&gt;&lt;i&gt;kokegGarbageCollectOpn&lt;/i&gt;&lt;/b&gt; and &lt;b&gt;&lt;i&gt;kokegGarbageCollectRworo&lt;/i&gt;&lt;/b&gt; that were active when &lt;b&gt;&lt;i&gt;qersoFetch&lt;/i&gt;&lt;/b&gt; was active (19% of the time). Those seem to be related to garbage collection and the koke prefix is present in the oradebug doc component output: &lt;pre class="brush:sql;highlight:[4]"&gt;OBJECTS                      OBJECTS ((null))&lt;br /&gt;    OBJECTS_DDL                OBJECTS DDL (kokt)&lt;br /&gt;    OBJECTS_Types              OBJECTS Types (kot, ko, ort)&lt;br /&gt;    OBJECTS_Images             OBJECTS Images (koke, kot, kad)&lt;br /&gt;&lt;/pre&gt;Most of the time (80%), though, the functions such as: &lt;b&gt;&lt;i&gt;kksumc&lt;/i&gt;&lt;/b&gt;, &lt;b&gt;&lt;i&gt;kxsFreeExecutionHeap&lt;/i&gt;&lt;/b&gt; were active - they are supposedly related to releasing memory.&lt;br/&gt;Oracle code might not be updating PGA_ALLOCATED, TEMP_SPACE_ALLOCATED till the whole duration is freed as I do not see any changes in those columns of V$ACTIVE_SESSION_HISTORY.&lt;br/&gt; When I found that SUBSTR on LOBs produces new abstract LOBs, I implemented the following workaround: &lt;pre class="brush:sql;highlight:[14,15,16,45]"&gt;SQL&gt; declare&lt;br /&gt;  2    v_reporting_freq constant pls_integer := 20000;&lt;br /&gt;  3    v_result clob;&lt;br /&gt;  4    procedure log_info(i_msg varchar2)&lt;br /&gt;  5    is&lt;br /&gt;  6    begin&lt;br /&gt;  7      dbms_output.put_line(to_char(sysdate, 'hh24:mi:ss')||' '||i_msg);&lt;br /&gt;  8    end log_info;&lt;br /&gt;  9  begin&lt;br /&gt; 10    log_info('Starting execution');&lt;br /&gt; 11    dbms_lob.createtemporary(v_result, cache=&gt; true, dur=&gt; dbms_lob.call);&lt;br /&gt; 12    for test_rec in (&lt;br /&gt; 13      select n,&lt;br /&gt; 14             dbms_lob.substr(c, 40, 1) c_part1,&lt;br /&gt; 15             dbms_lob.substr(c, 40, 41) c_part2,&lt;br /&gt; 16             dbms_lob.substr(c, 40, 81) c_part3&lt;br /&gt; 17        from t100&lt;br /&gt; 18       where n &lt;= 100000&lt;br /&gt; 19       order by n)&lt;br /&gt; 20    loop&lt;br /&gt; 21      dbms_lob.append(v_result, test_rec.c_part1);&lt;br /&gt; 22      dbms_lob.append(v_result, test_rec.c_part2);&lt;br /&gt; 23      dbms_lob.append(v_result, test_rec.c_part3);&lt;br /&gt; 24      if mod(test_rec.n, v_reporting_freq) = 0&lt;br /&gt; 25      then&lt;br /&gt; 26        log_info('Processed '||v_reporting_freq||' rows');&lt;br /&gt; 27      end if;&lt;br /&gt; 28    end loop;&lt;br /&gt; 29    dbms_output.put_line('Lob size: '||dbms_lob.getlength(v_result));&lt;br /&gt; 30    dbms_lob.freetemporary(v_result);&lt;br /&gt; 31    log_info('Finishing execution');&lt;br /&gt; 32  end;&lt;br /&gt; 33  /&lt;br /&gt;08:15:04 Starting execution&lt;br /&gt;08:15:08 Processed 20000 rows&lt;br /&gt;08:15:09 Processed 20000 rows&lt;br /&gt;08:15:10 Processed 20000 rows&lt;br /&gt;08:15:12 Processed 20000 rows&lt;br /&gt;08:15:13 Processed 20000 rows&lt;br /&gt;Lob size: 10000000&lt;br /&gt;08:15:13 Finishing execution&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:08.95&lt;br /&gt;&lt;/pre&gt;In spite of the fact that this block even writes a whole new LOB (there are no such operations in the block that was working 9 minutes), it completes just in 9 seconds. It is quite a neat optimization, isn't it?   That behavior of producing abstract LOBs of SUBSTR is documented: &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/adlob/performance-guidelines.html#GUID-4E9360AA-C610-4341-AAD3-9DCDF82CF085"&gt;Database SecureFiles and Large Objects Developer's Guide: Temporary LOBs&lt;/a&gt;:  &lt;div style="font-style: italic"&gt;If you use the newly provided enhanced SQL semantics functionality in your applications, then &lt;b&gt;there are many more temporary LOBs created silently in SQL and PL/SQL than before&lt;/b&gt;. Ensure that temporary tablespace for storing these temporary LOBs is large enough for your applications. In particular, these temporary LOBs are silently created when you use the following: &lt;ul&gt;&lt;li&gt;&lt;b&gt;SQL functions on LOBs&lt;/b&gt;&lt;/li&gt;&lt;li&gt;PL/SQL built-in character functions on LOBs&lt;/li&gt;&lt;li&gt;Variable assignments from VARCHAR2/RAW to CLOBs/BLOBs, respectively.&lt;/li&gt;&lt;li&gt;Perform a LONG-to-LOB migration&lt;/li&gt;&lt;/ul&gt;If SQL operators are used on LOBs, the PGA memory and temporary tablespace must be large enough to accommodate the temporary LOBs generated by SQL operators. &lt;/div&gt; Apart from that workaround, I can come up with a few others that also provide significant performance boost: &lt;ol&gt;&lt;li&gt;This query is almost a corner-case due to that sorting. If the ORDER BY is really needed, then an indexed access on the N column can be considered.&lt;/li&gt;&lt;li&gt;These SUBSTR calls can be moved within the LOOP part, so that only the C column is selected in the query. Although it would not be the most efficient way to process the cursor (abstract LOBs will still be allocated), those abstract LOBs will be released after each iteration. Therefore, the time-consuming garbage collection at the end will be avoided.&lt;/li&gt;&lt;/ol&gt;All tests were performed on 12.2.0.1.190716. 19c has some nice optimizations, such as one mentioned in &lt;a href="https://mvelikikh.blogspot.com/2019/07/session-spending-its-time-incursorclose.html"&gt; Session spending its time IN_CURSOR_CLOSE&lt;/a&gt;I was trying to reproduce that issue on 19c but I was not able to get the same results after a few attempts. Though abstract LOBs were still allocated, they were being released rather quickly.   &lt;b&gt;tl;dr&lt;/b&gt;Oracle can create temporary LOBs when SQL functions are used on LOBs as this blog post demonstrates.&lt;br /&gt;For example, SUBSTR behaves like that. Those calls can be replaced with DBMS_LOB.SUBSTR that does not lead to the aforementioned deficiency.&lt;br /&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/5503436853271688515/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/10/temporary-lobs.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5503436853271688515'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5503436853271688515'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/10/temporary-lobs.html' title='Temporary LOBs'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-1062714371496363682</id><published>2019-09-09T23:00:00.000+06:00</published><updated>2019-09-09T23:00:01.714+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='APEX'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-10934'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><title type='text'>APEX WWV_FLOW_SECURITY.GET_OWNER_OF_CALLING_CODE and 12.2</title><content type='html'>Our developers were using &lt;b&gt;&lt;i&gt;WWV_FLOW_API.SET_SECURITY_GROUP_ID&lt;/i&gt;&lt;/b&gt; and were surprised to find that that procedure behaves differently in 12.2 than in 12.1.&lt;br /&gt;In a nutshell, the procedure could not determine the correct security group ID after we upgraded the database to 12.2.&lt;br /&gt;They asked me to help to figure out what was going on as they claimed that the code had not been changed.&lt;br /&gt;&lt;br /&gt;Here is some background on that issue. We are using the following version of APEX which is certified against 12.2:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; SELECT VERSION_NO FROM APEX_RELEASE;&lt;br /&gt;&lt;br /&gt;VERSION_NO&lt;br /&gt;------------&lt;br /&gt;5.1.2.00.09&lt;br /&gt;&lt;/pre&gt;The procedure in question calls &lt;b&gt;&lt;i&gt;WWV_FLOW_SECURITY.GET_OWNER_OF_CALLING_CODE&lt;/i&gt;&lt;/b&gt; which, according to its name, should be returning the owner of the calling code.&lt;br /&gt;However, it does not do it in our version of APEX and 12.2 anymore. I constructed a simple test case to demonstrate the changed behavior:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; grant connect, create procedure to tc_owner identified by tc_owner;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; grant execute on apex_050100.wwv_flow_security to tc_owner;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create or replace procedure tc_owner.p&lt;br /&gt;  2  is&lt;br /&gt;  3  begin&lt;br /&gt;  4    dbms_output.put_line(apex_050100.wwv_flow_security.get_owner_of_calling_code);&lt;br /&gt;  5  end;&lt;br /&gt;  6  /&lt;br /&gt;&lt;br /&gt;Procedure created.&lt;br /&gt;&lt;br /&gt;SQL&gt; create or replace package tc_owner.pkg&lt;br /&gt;  2  is&lt;br /&gt;  3    procedure p;&lt;br /&gt;  4  end;&lt;br /&gt;  5  /&lt;br /&gt;&lt;br /&gt;Package created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create or replace package body tc_owner.pkg&lt;br /&gt;  2  is&lt;br /&gt;  3    procedure p&lt;br /&gt;  4    is&lt;br /&gt;  5    begin&lt;br /&gt;  6      dbms_output.put_line(apex_050100.wwv_flow_security.get_owner_of_calling_code);&lt;br /&gt;  7    end p;&lt;br /&gt;  8  end;&lt;br /&gt;  9  /&lt;br /&gt;&lt;br /&gt;Package body created.&lt;br /&gt;&lt;br /&gt;SQL&gt; grant connect to tc_connect identified by tc_connect;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt; grant execute on tc_owner.p to tc_connect;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt; grant execute on tc_owner.pkg to tc_connect;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;/pre&gt;Let's now connect as that TC_CONNECT user and try to call that procedure:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[2]"&gt;TC_CONNECT@SQL&gt; exec tc_owner.p&lt;br /&gt;TC_OWNER&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;It returns TC_OWNER here as expected. The result is different, though, when the same user calls the package:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[2]"&gt;TC_CONNECT@SQL&gt; exec tc_owner.pkg.p&lt;br /&gt;TC_CONNECT&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;That seems to be an incorrect result and the developers claimed that the same code was working fine before I upgraded that database to 12.2.&lt;br /&gt;I quickly reviewed &lt;b&gt;&lt;i&gt;WWV_FLOW_SECURITY.GET_OWNER_OF_CALLING_CODE&lt;/i&gt;&lt;/b&gt; and identified that it is using the &lt;b&gt;&lt;i&gt;DBMS_UTILITY.FORMAT_CALL_STACK&lt;/i&gt;&lt;/b&gt; function which appears to have been changed in 12.2:&lt;br /&gt;&lt;a href="https://support.oracle.com/rs?type=doc&amp;id=2312198.1"&gt;DBMS_UTILITY.FORMAT_CALL_STACK Returns Subprogram Names After Upgrade to 12.2 (Doc ID 2312198.1)&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;Indeed, the same solution from the MOS note worked flawlessly for me, so that the problem code started to return the correct user after I applied it:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[6]"&gt;TC_CONNECT@SQL&gt; alter session set events '10934 level 64';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;TC_CONNECT@SQL&gt; exec tc_owner.pkg.p&lt;br /&gt;TC_OWNER&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/1062714371496363682/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/09/apex-wwvflowsecuritygetownerofcallingco.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/1062714371496363682'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/1062714371496363682'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/09/apex-wwvflowsecuritygetownerofcallingco.html' title='APEX WWV_FLOW_SECURITY.GET_OWNER_OF_CALLING_CODE and 12.2'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-3749704627249024485</id><published>2019-09-08T18:15:00.000+06:00</published><updated>2019-09-08T18:15:21.290+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='re'/><title type='text'>Unwrapping PL/SQL: Using Custom Wrap Tables</title><content type='html'>The previous article in this series:&lt;br /&gt;&lt;ol&gt;&lt;li&gt;&lt;a href="https://mvelikikh.blogspot.com/2019/09/unwrapping-plsql-systematic-approach.html"&gt;Unwrapping PL/SQL: a Systematic Approach&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;&lt;br /&gt;As a bonus, I decided to apply that discovered knowledge about Oracle Wrap tables.&lt;br /&gt;Thus, I created my own version of the &lt;b&gt;&lt;i&gt;oracle&lt;/i&gt;&lt;/b&gt; binary and put trivial wrap tables in it - the ones keeping all bytes the same:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[3,21,39,57]"&gt;$ diff &lt;(xxd oracle) &lt;(xxd /tmp/oracle_modified)&lt;br /&gt;19775119,19775150c19775119,19775150&lt;br /&gt;-- pkwrap_reverse_table&lt;br /&gt;&lt; 12dbe8e0:dd05 2553 b87b 8227 91f2 4b03 eb55 40ff  ..%S.{.'..K..U@.&lt;br /&gt;&lt; 12dbe8f0:1d08 1b3b c462 c807 2a7e 44c6 bea3 8bb7  ...;.b..*~D.....&lt;br /&gt;&lt; 12dbe900:0fd4 de1a df72 490a af89 d5f6 bf51 edb0  .....rI......Q..&lt;br /&gt;&lt; 12dbe910:1879 1596 5ce1 a421 01a6 994d 7675 c91e  .y..\..!...Mvu..&lt;br /&gt;&lt; 12dbe920:263e 1985 a55a 246c 0ec7 2e50 fd48 933f  &amp;&gt;...Z$l...P.H.?&lt;br /&gt;&lt; 12dbe930:7042 1158 f87d ccd8 39ec e8a7 f584 f32c  pB.X.}..9......,&lt;br /&gt;&lt; 12dbe940:e656 cd45 4fd2 c2e0 7cf0 6341 c52b 3cb6  .V.EO...|.cA.+&lt;.&lt;br /&gt;&lt; 12dbe950:00fc 6f9d ac38 bc74 d70d dcda d088 0cd1  ..o..8.t........&lt;br /&gt;&lt; 12dbe960:e795 d37a e368 83fe b934 8c86 4335 b480  ...z.h...4..C5..&lt;br /&gt;&lt; 12dbe970:3d04 9af9 b565 cf6a 5bab 7f92 375f aa16  =....e.j[...7_..&lt;br /&gt;&lt; 12dbe980:54e9 e4fa bd90 a036 c120 1fba 22d9 ef61  T......6. .."..a&lt;br /&gt;&lt; 12dbe990:4777 ad71 789f b333 108e fb8f 5ea9 5917  Gw.qx..3....^.Y.&lt;br /&gt;&lt; 12dbe9a0:1287 52f4 57ca 6713 3006 c0ae f18d 981c  ..R.W.g.0.......&lt;br /&gt;&lt; 12dbe9b0:2fce 94b2 66cb 236d 4c6b db64 ee60 09d6  /...f.#mLk.d.`..&lt;br /&gt;&lt; 12dbe9c0:02a2 4e28 9c4a e2a8 46e5 f773 3a5d 81c3  ..N(.J..F..s:]..&lt;br /&gt;&lt; 12dbe9d0:2d32 eab1 2914 0b31 9b9e 69a1 8abb 976e  -2..)..1..i....n&lt;br /&gt;---&lt;br /&gt;-- modified pkwrap_reverse_table&lt;br /&gt;&gt; 12dbe8e0:a0a1 a2a3 a4a5 a6a7 a8a9 aaab acad aeaf  ................&lt;br /&gt;&gt; 12dbe8f0:b0b1 b2b3 b4b5 b6b7 b8b9 babb bcbd bebf  ................&lt;br /&gt;&gt; 12dbe900:c0c1 c2c3 c4c5 c6c7 c8c9 cacb cccd cecf  ................&lt;br /&gt;&gt; 12dbe910:d0d1 d2d3 d4d5 d6d7 d8d9 dadb dcdd dedf  ................&lt;br /&gt;&gt; 12dbe920:e0e1 e2e3 e4e5 e6e7 e8e9 eaeb eced eeef  ................&lt;br /&gt;&gt; 12dbe930:f0f1 f2f3 f4f5 f6f7 f8f9 fafb fcfd feff  ................&lt;br /&gt;&gt; 12dbe940:0001 0203 0405 0607 0809 0a0b 0c0d 0e0f  ................&lt;br /&gt;&gt; 12dbe950:1011 1213 1415 1617 1819 1a1b 1c1d 1e1f  ................&lt;br /&gt;&gt; 12dbe960:2021 2223 2425 2627 2829 2a2b 2c2d 2e2f   !"#$%&amp;'()*+,-./&lt;br /&gt;&gt; 12dbe970:3031 3233 3435 3637 3839 3a3b 3c3d 3e3f  0123456789:;&lt;=&gt;?&lt;br /&gt;&gt; 12dbe980:4041 4243 4445 4647 4849 4a4b 4c4d 4e4f  @ABCDEFGHIJKLMNO&lt;br /&gt;&gt; 12dbe990:5051 5253 5455 5657 5859 5a5b 5c5d 5e5f  PQRSTUVWXYZ[\]^_&lt;br /&gt;&gt; 12dbe9a0:6061 6263 6465 6667 6869 6a6b 6c6d 6e6f  `abcdefghijklmno&lt;br /&gt;&gt; 12dbe9b0:7071 7273 7475 7677 7879 7a7b 7c7d 7e7f  pqrstuvwxyz{|}~.&lt;br /&gt;&gt; 12dbe9c0:8081 8283 8485 8687 8889 8a8b 8c8d 8e8f  ................&lt;br /&gt;&gt; 12dbe9d0:9091 9293 9495 9697 9899 9a9b 9c9d 9e9f  ................&lt;br /&gt;&lt;br /&gt;-- pkwrap_forward_table&lt;br /&gt;&lt; 12dbe9e0:7038 e00b 9101 c917 11de 27f6 7e79 4820  p8........'.~yH&lt;br /&gt;&lt; 12dbe9f0:b852 c0c7 f532 9fbf 3042 2312 cf10 3faa  .R...2..0B#...?.&lt;br /&gt;&lt; 12dbea00:a937 acd6 4602 4007 e3f4 186d 5ff0 4ad0  .7..F.@....m_.J.&lt;br /&gt;&lt; 12dbea10:c8f7 f1b7 898d a79c 7558 ec13 6e90 414f  ........uX..n.AO&lt;br /&gt;&lt; 12dbea20:0e6b 518c 1a63 e8b0 4d26 e50a d83b e264  .kQ..c..M&amp;...;.d&lt;br /&gt;&lt; 12dbea30:4b2d c203 a00d 61c4 53be 4598 34ed bc9d  K-....a.S.E.4...&lt;br /&gt;&lt; 12dbea40:ddaf 156a db95 d4c6 85fa 97d9 47d7 ff72  ...j........G..r&lt;br /&gt;&lt; 12dbea50:50b3 25eb 773d 3cb1 b431 8305 6855 199a  P.%.w=&lt;..1..hU..&lt;br /&gt;&lt; 12dbea60:8fee 0686 5d43 8bc1 7d29 fc1e 8acd b9bb  ....]C..})......&lt;br /&gt;&lt; 12dbea70:a508 9b4e d281 33fe ce3a 92f8 e473 f9b5  ...N..3..:...s..&lt;br /&gt;&lt; 12dbea80:a6fb e11d 3644 395b e7bd 9e99 74b2 cb28  ....6D9[....t..(&lt;br /&gt;&lt; 12dbea90:2ff3 d3b6 8e94 6f1f 0488 abfd 76a4 1c2c  /.....o.....v..,&lt;br /&gt;&lt; 12dbeaa0:caa8 66ef 146c 1b49 163e c5d5 5662 d196  ..f..l.I.&gt;..Vb..&lt;br /&gt;&lt; 12dbeab0:7c7f 6582 212a df78 57ad 7bda 7a00 2224  |.e.!*.xW.{.z."$&lt;br /&gt;&lt; 12dbeac0:6735 e684 a2e9 6080 5aa1 f20c 592e dcae  g5....`.Z...Y...&lt;br /&gt;&lt; 12dbead0:69cc 095e c35c 2bea 5493 a3ba 714c 870f  i..^.\+.T...qL..&lt;br /&gt;---&lt;br /&gt;-- modified pkwrap_forward_tble&lt;br /&gt;&gt; 12dbe9e0:6061 6263 6465 6667 6869 6a6b 6c6d 6e6f  `abcdefghijklmno&lt;br /&gt;&gt; 12dbe9f0:7071 7273 7475 7677 7879 7a7b 7c7d 7e7f  pqrstuvwxyz{|}~.&lt;br /&gt;&gt; 12dbea00:8081 8283 8485 8687 8889 8a8b 8c8d 8e8f  ................&lt;br /&gt;&gt; 12dbea10:9091 9293 9495 9697 9899 9a9b 9c9d 9e9f  ................&lt;br /&gt;&gt; 12dbea20:a0a1 a2a3 a4a5 a6a7 a8a9 aaab acad aeaf  ................&lt;br /&gt;&gt; 12dbea30:b0b1 b2b3 b4b5 b6b7 b8b9 babb bcbd bebf  ................&lt;br /&gt;&gt; 12dbea40:c0c1 c2c3 c4c5 c6c7 c8c9 cacb cccd cecf  ................&lt;br /&gt;&gt; 12dbea50:d0d1 d2d3 d4d5 d6d7 d8d9 dadb dcdd dedf  ................&lt;br /&gt;&gt; 12dbea60:e0e1 e2e3 e4e5 e6e7 e8e9 eaeb eced eeef  ................&lt;br /&gt;&gt; 12dbea70:f0f1 f2f3 f4f5 f6f7 f8f9 fafb fcfd feff  ................&lt;br /&gt;&gt; 12dbea80:0001 0203 0405 0607 0809 0a0b 0c0d 0e0f  ................&lt;br /&gt;&gt; 12dbea90:1011 1213 1415 1617 1819 1a1b 1c1d 1e1f  ................&lt;br /&gt;&gt; 12dbeaa0:2021 2223 2425 2627 2829 2a2b 2c2d 2e2f   !"#$%&amp;'()*+,-./&lt;br /&gt;&gt; 12dbeab0:3031 3233 3435 3637 3839 3a3b 3c3d 3e3f  0123456789:;&lt;=&gt;?&lt;br /&gt;&gt; 12dbeac0:4041 4243 4445 4647 4849 4a4b 4c4d 4e4f  @ABCDEFGHIJKLMNO&lt;br /&gt;&gt; 12dbead0:5051 5253 5455 5657 5859 5a5b 5c5d 5e5f  PQRSTUVWXYZ[\]^_&lt;br /&gt;&lt;/pre&gt;Remember, this wrap process, which uses modified substitution tables, should hold the following invariant to keep bytes the same:&lt;br /&gt;&lt;tt&gt;MOD(pkwrap_reverse_table[&lt;b&gt;BYTE&lt;/b&gt;] + 0x60, 0x100) = pkwrap_forward_table[MOD(&lt;b&gt;BYTE&lt;/b&gt; + 0xA0, 0x100)] = &lt;b&gt;BYTE&lt;/b&gt;&lt;/tt&gt; for all &lt;b&gt;&lt;i&gt;BYTE&lt;/i&gt;&lt;/b&gt;s from 0 to 255 (it was demonstrated in the first part of this series).&lt;br /&gt;Here is a sample package that I wrapped using that modified oracle binary:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[87]"&gt;SQL&gt; with src as (&lt;br /&gt;  2    select q'!package test_pkg&lt;br /&gt;  3  is&lt;br /&gt;  4  procedure p1;&lt;br /&gt;  5  function f1 return varchar2;&lt;br /&gt;  6  end;!' txt&lt;br /&gt;  7      from dual),&lt;br /&gt;  8    wrap as (&lt;br /&gt;  9      select dbms_ddl.wrap( 'create ' || src.txt ) wrap&lt;br /&gt; 10        from src)&lt;br /&gt; 11  select wrap wrapped_code&lt;br /&gt; 12    from wrap&lt;br /&gt; 13  /&lt;br /&gt;&lt;br /&gt;WRAPPED_CODE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;create package test_pkg wrapped&lt;br /&gt;a000000&lt;br /&gt;369&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;9&lt;br /&gt;44 81&lt;br /&gt;kuXPwLaDK0xzws78Nfs5dvIfvtl42gtwdPZ2dHdVKEktLokvyE7n8gzmCgjyd3Z1CQ1yVQgw&lt;br /&gt;tOZyC/VzDvH091NwM1QIcg0JDfJTCHMMcvZwDDKy5nL1c7FmAACeSxJa&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt; with src as (&lt;br /&gt;  2    select q'!package body test_pkg&lt;br /&gt;  3  is&lt;br /&gt;  4  procedure p1&lt;br /&gt;  5  is&lt;br /&gt;  6     v_local_var pls_integer := 10;&lt;br /&gt;  7  begin&lt;br /&gt;  8    dbms_output.put_line(123);&lt;br /&gt;  9  end;&lt;br /&gt; 10  function f1 return varchar2&lt;br /&gt; 11  is&lt;br /&gt; 12    /* code comment*/&lt;br /&gt; 13  begin&lt;br /&gt; 14    return 'string';&lt;br /&gt; 15  end;&lt;br /&gt; 16  end;!' txt&lt;br /&gt; 17      from dual),&lt;br /&gt; 18    wrap as (&lt;br /&gt; 19      select dbms_ddl.wrap( 'create ' || src.txt ) wrap&lt;br /&gt; 20        from src)&lt;br /&gt; 21  select wrap wrapped_code&lt;br /&gt; 22    from wrap&lt;br /&gt; 23  /&lt;br /&gt;&lt;br /&gt;WRAPPED_CODE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;create package body test_pkg wrapped&lt;br /&gt;a000000&lt;br /&gt;369&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;b&lt;br /&gt;b8 eb&lt;br /&gt;Fhyioql6UlwVZh69G4MDdFUfl9V42j1NPQvCMBR0zq94W3URUzeLQ5q81mB8Ca9JwSmTFBFE&lt;br /&gt;bP8/tigOd3DcV1D6rFqE2psrTLdxyq/HIGwnAnuNJjFCkIsGgD47r5XLvWIIrsuWIrbIcDiC&lt;br /&gt;3FWixtbSnDP1pcs+xZDidkZ2lnAty/2mEkimEk0iHa0naCQwxsQE86I+KS6/R/+ln1uM0/v+&lt;br /&gt;HIpff6HVB57RL3k=&lt;br /&gt;&lt;/pre&gt;As it is intended, there is no need to use the &lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt; to unwrap that code - it is enough to unzip it:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; select mycompress.inflate(substr(utl_encode.base64_decode(utl_raw.cast_to_raw('Fhyioql6UlwVZh69G4MDdFUfl9V42j1NPQvCMBR0zq94W3URUzeLQ5q81mB8Ca9JwSmTFBFEbP8/tigOd3DcV1D6rFqE2psrTLdxyq/HIGwnAnuNJjFCkIsGgD47r5XL&lt;br /&gt;vWIIrsuWIrbIcDiC3FWixtbSnDP1pcs+xZDidkZ2lnAty/2mEkimEk0iHa0naCQwxsQE86I+KS6/R/+ln1uM0/v+HIpff6HVB57RL3k=')), 41)) unwrapped_code from dual&lt;br /&gt;  2  /&lt;br /&gt;&lt;br /&gt;UNWRAPPED_CODE&lt;br /&gt;----------------------------------------------------&lt;br /&gt;PACKAGE BODY test_pkg&lt;br /&gt;IS&lt;br /&gt;PROCEDURE P1&lt;br /&gt;IS&lt;br /&gt;   V_LOCAL_VAR PLS_INTEGER := 10;&lt;br /&gt;BEGIN&lt;br /&gt;  DBMS_OUTPUT.PUT_LINE(123);&lt;br /&gt;END;&lt;br /&gt;FUNCTION F1 RETURN VARCHAR2&lt;br /&gt;IS&lt;br /&gt;&lt;br /&gt;BEGIN&lt;br /&gt;  RETURN 'string';&lt;br /&gt;END;&lt;br /&gt;END;&lt;br /&gt;&lt;/pre&gt;That wrapped code can be correctly compiled as well:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[60,61]"&gt;SQL&gt; drop package test_pkg&lt;br /&gt;  2  /&lt;br /&gt;&lt;br /&gt;Package dropped.&lt;br /&gt;&lt;br /&gt;SQL&gt; create package test_pkg wrapped&lt;br /&gt;  2  a000000&lt;br /&gt;  3  369&lt;br /&gt;  4  abcd&lt;br /&gt;  5  abcd&lt;br /&gt;  6  abcd&lt;br /&gt;  7  abcd&lt;br /&gt;  8  abcd&lt;br /&gt;  9  abcd&lt;br /&gt; 10  abcd&lt;br /&gt; 11  abcd&lt;br /&gt; 12  abcd&lt;br /&gt; 13  abcd&lt;br /&gt; 14  abcd&lt;br /&gt; 15  abcd&lt;br /&gt; 16  abcd&lt;br /&gt; 17  abcd&lt;br /&gt; 18  abcd&lt;br /&gt; 19  9&lt;br /&gt; 20  44 81&lt;br /&gt; 21  kuXPwLaDK0xzws78Nfs5dvIfvtl42gtwdPZ2dHdVKEktLokvyE7n8gzmCgjyd3Z1CQ1yVQgw&lt;br /&gt; 22  tOZyC/VzDvH091NwM1QIcg0JDfJTCHMMcvZwDDKy5nL1c7FmAACeSxJa&lt;br /&gt; 23  /&lt;br /&gt;&lt;br /&gt;Package created.&lt;br /&gt;&lt;br /&gt;SQL&gt; create package body test_pkg wrapped&lt;br /&gt;  2  a000000&lt;br /&gt;  3  369&lt;br /&gt;  4  abcd&lt;br /&gt;  5  abcd&lt;br /&gt;  6  abcd&lt;br /&gt;  7  abcd&lt;br /&gt;  8  abcd&lt;br /&gt;  9  abcd&lt;br /&gt; 10  abcd&lt;br /&gt; 11  abcd&lt;br /&gt; 12  abcd&lt;br /&gt; 13  abcd&lt;br /&gt; 14  abcd&lt;br /&gt; 15  abcd&lt;br /&gt; 16  abcd&lt;br /&gt; 17  abcd&lt;br /&gt; 18  abcd&lt;br /&gt; 19  b&lt;br /&gt; 20  b8 eb&lt;br /&gt; 21  Fhyioql6UlwVZh69G4MDdFUfl9V42j1NPQvCMBR0zq94W3URUzeLQ5q81mB8Ca9JwSmTFBFE&lt;br /&gt; 22  bP8/tigOd3DcV1D6rFqE2psrTLdxyq/HIGwnAnuNJjFCkIsGgD47r5XLvWIIrsuWIrbIcDiC&lt;br /&gt; 23  3FWixtbSnDP1pcs+xZDidkZ2lnAty/2mEkimEk0iHa0naCQwxsQE86I+KS6/R/+ln1uM0/v+&lt;br /&gt; 24  HIpff6HVB57RL3k=&lt;br /&gt; 25  /&lt;br /&gt;&lt;br /&gt;Package body created.&lt;br /&gt;&lt;br /&gt;SQL&gt; exec test_pkg.p1&lt;br /&gt;123&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;Thus, the unwrapping can be now done without using that substitution table - I made the &lt;a href="https://mvelikikh.blogspot.com/2019/09/unwrapping-plsql-systematic-approach.html#step3"&gt;step 3&lt;/a&gt; (obfuscation of zipped code) an effective noop operation keeping all bytes in place:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; with wrap as (&lt;br /&gt;  2      select 'create package body test_pkg wrapped&lt;br /&gt;  3  a000000&lt;br /&gt;  4  369&lt;br /&gt;  5  abcd&lt;br /&gt;  6  abcd&lt;br /&gt;  7  abcd&lt;br /&gt;  8  abcd&lt;br /&gt;  9  abcd&lt;br /&gt; 10  abcd&lt;br /&gt; 11  abcd&lt;br /&gt; 12  abcd&lt;br /&gt; 13  abcd&lt;br /&gt; 14  abcd&lt;br /&gt; 15  abcd&lt;br /&gt; 16  abcd&lt;br /&gt; 17  abcd&lt;br /&gt; 18  abcd&lt;br /&gt; 19  abcd&lt;br /&gt; 20  b&lt;br /&gt; 21  b8 eb&lt;br /&gt; 22  Fhyioql6UlwVZh69G4MDdFUfl9V42j1NPQvCMBR0zq94W3URUzeLQ5q81mB8Ca9JwSmTFBFE&lt;br /&gt; 23  bP8/tigOd3DcV1D6rFqE2psrTLdxyq/HIGwnAnuNJjFCkIsGgD47r5XLvWIIrsuWIrbIcDiC&lt;br /&gt; 24  3FWixtbSnDP1pcs+xZDidkZ2lnAty/2mEkimEk0iHa0naCQwxsQE86I+KS6/R/+ln1uM0/v+&lt;br /&gt; 25  HIpff6HVB57RL3k=' wrap&lt;br /&gt; 26        from dual),&lt;br /&gt; 27    base64_dcd as(&lt;br /&gt; 28      select substr( utl_encode.base64_decode( utl_raw.cast_to_raw(rtrim( substr( wrap.wrap, instr( wrap.wrap, chr( 10 ), 1, 20 ) + 1 ), chr(10) )  ) ), 41 ) x&lt;br /&gt; 29        from wrap),&lt;br /&gt; 30    subst as (&lt;br /&gt; 31      select x s&lt;br /&gt; 32      from base64_dcd)&lt;br /&gt; 33  select mycompress.inflate( s ) unwrapped_code&lt;br /&gt; 34    from subst&lt;br /&gt; 35  /&lt;br /&gt;&lt;br /&gt;UNWRAPPED_CODE&lt;br /&gt;----------------------------------------&lt;br /&gt;PACKAGE BODY test_pkg&lt;br /&gt;IS&lt;br /&gt;PROCEDURE P1&lt;br /&gt;IS&lt;br /&gt;   V_LOCAL_VAR PLS_INTEGER := 10;&lt;br /&gt;BEGIN&lt;br /&gt;  DBMS_OUTPUT.PUT_LINE(123);&lt;br /&gt;END;&lt;br /&gt;FUNCTION F1 RETURN VARCHAR2&lt;br /&gt;IS&lt;br /&gt;&lt;br /&gt;BEGIN&lt;br /&gt;  RETURN 'string';&lt;br /&gt;END;&lt;br /&gt;END;&lt;br /&gt;&lt;/pre&gt;The last demonstration is used only to show how &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt; and &lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt; are used during Oracle Wrap process.&lt;br /&gt;It has no practical meaning apart from verifying an assumption about how Oracle code uses these tables.&lt;br /&gt;It is also an example of how behavior of Oracle can be changed without having access to source code by way of patching binary files used by Oracle utilities.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/3749704627249024485/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/09/unwrapping-plsql-using-custom-wrap.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3749704627249024485'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3749704627249024485'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/09/unwrapping-plsql-using-custom-wrap.html' title='Unwrapping PL/SQL: Using Custom Wrap Tables'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-2683273528777757591</id><published>2019-09-06T22:00:00.000+06:00</published><updated>2019-09-06T22:00:03.029+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='re'/><title type='text'>Unwrapping PL/SQL: a Systematic Approach</title><content type='html'>The high-level steps of how PL/SQL code appears to be wrapped since 10g on are below:&lt;br /&gt;&lt;ol&gt;&lt;li&gt;The source code is &lt;b&gt;&lt;i&gt;normalized&lt;/i&gt;&lt;/b&gt; (converted to upper-case, comments are removed, etc.)&lt;/li&gt;&lt;li&gt;&lt;a name="step2"&gt;&lt;/a&gt;The normalized code is compressed using zip&lt;/li&gt;&lt;li&gt;&lt;a name="step3"&gt;&lt;/a&gt;The compressed byte stream is obfuscated using a substitution table&lt;/li&gt;&lt;li&gt;Finally, Base64 encoding is applied&lt;/li&gt;&lt;/ol&gt;&lt;br /&gt;If we want to rewind that process and get the unwrapped code, the best we can do is to get the &lt;b&gt;&lt;i&gt;normalized&lt;/i&gt;&lt;/b&gt; code.&lt;br /&gt;Steps 4 (Base64 Encoding) and 2 (ZIP Compression) are reversible, however, the obfuscation step 3 supposedly uses a substitution table which is the secret sauce of Oracle Wrap process.&lt;br /&gt;It is known how to obtain that substitution table using a kind of a brute-force approach, as it was demonstrated in the following links:&lt;br /&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://macrotoneconsulting.co.uk/images/Documents/unwrap.pdf"&gt;Unwrapping Oracle PLSQL&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://technology.amis.nl/2009/02/03/unwrapping-10g-wrapped-plsql/"&gt;Unwrapping 10G wrapped PL/SQL by Anton Scheffer&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;Once the substitution table is known, it becomes feasible to write a fully-fledged unwrapper. See for example&lt;br /&gt;&lt;a href="http://blog.teusink.net/2010/04/unwrapping-oracle-plsql-with-unwrappy.html"&gt;Unwrapping Oracle PL/SQL with unwrap.py by Niels Teusink&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;In this blog post, I will show how I discovered that Wrap substitution table by Reverse Engineering Oracle binaries.&lt;br /&gt;&lt;br /&gt;I will be using that code that Anton Scheffer referred to in his &lt;a href="https://technology.amis.nl/wp-content/uploads/file/generate2.txt"&gt;blog post&lt;/a&gt;, namely I need to be able to compress and decompress data in SQL:&lt;br /&gt;&lt;pre class="brush:sql"&gt;create or replace java source named MY_COMPRESS&lt;br /&gt;as&lt;br /&gt;import java.io.*;&lt;br /&gt;import java.util.zip.*;&lt;br /&gt;&lt;br /&gt;public class MY_COMPRESS&lt;br /&gt;{&lt;br /&gt;  public static String Inflate( byte[] src )&lt;br /&gt;  {&lt;br /&gt;    try&lt;br /&gt;    {&lt;br /&gt;      ByteArrayInputStream bis = new ByteArrayInputStream( src );&lt;br /&gt;      InflaterInputStream iis = new InflaterInputStream( bis );&lt;br /&gt;      StringBuffer sb = new StringBuffer();&lt;br /&gt;      for( int c = iis.read(); c != -1; c = iis.read() )&lt;br /&gt;      {&lt;br /&gt;        sb.append( (char) c );&lt;br /&gt;      }&lt;br /&gt;      return sb.toString();&lt;br /&gt;    } catch ( Exception e )&lt;br /&gt;    {&lt;br /&gt;    }&lt;br /&gt;    return null;&lt;br /&gt;  }&lt;br /&gt;  public static byte[] Deflate( String src, int quality )&lt;br /&gt;  {&lt;br /&gt;    try&lt;br /&gt;    {&lt;br /&gt;      byte[] tmp = new byte[ src.length() + 100 ];&lt;br /&gt;      Deflater defl = new Deflater( quality );&lt;br /&gt;      defl.setInput( src.getBytes( "UTF-8" ) );&lt;br /&gt;      defl.finish();&lt;br /&gt;      int cnt = defl.deflate( tmp );&lt;br /&gt;      byte[] res = new byte[ cnt ];&lt;br /&gt;      for( int i = 0; i &lt; cnt; i++ )&lt;br /&gt;        res[i] = tmp[i];&lt;br /&gt;      return res;&lt;br /&gt;    } catch ( Exception e )&lt;br /&gt;    {&lt;br /&gt;    }&lt;br /&gt;    return null;&lt;br /&gt;  }&lt;br /&gt;}&lt;br /&gt;/&lt;br /&gt;&lt;br /&gt;alter java source MY_COMPRESS compile&lt;br /&gt;/&lt;br /&gt;&lt;br /&gt;create or replace package mycompress&lt;br /&gt;is&lt;br /&gt;  function deflate( src in varchar2 )&lt;br /&gt;  return raw;&lt;br /&gt;--&lt;br /&gt;  function deflate( src in varchar2, quality in number )&lt;br /&gt;  return raw;&lt;br /&gt;--&lt;br /&gt;  function inflate( src in raw )&lt;br /&gt;  return varchar2;&lt;br /&gt;--&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;&lt;br /&gt;create or replace package body mycompress&lt;br /&gt;is&lt;br /&gt;  function deflate( src in varchar2 )&lt;br /&gt;  return raw&lt;br /&gt;  is&lt;br /&gt;  begin&lt;br /&gt;    return deflate( src, 6 );&lt;br /&gt;  end;&lt;br /&gt;--&lt;br /&gt;  function deflate( src in varchar2, quality in number )&lt;br /&gt;  return raw&lt;br /&gt;  as language java&lt;br /&gt;  name 'MY_COMPRESS.Deflate( java.lang.String, int ) return byte[]';&lt;br /&gt;--&lt;br /&gt;  function inflate( src in raw )&lt;br /&gt;  return varchar2&lt;br /&gt;  as language java&lt;br /&gt;  name 'MY_COMPRESS.Inflate( byte[] ) return java.lang.String';&lt;br /&gt;--&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;&lt;/pre&gt;Let's now obtain some data for analysis that will be used throughout this post: &lt;pre class="brush:sql"&gt;SQL&gt; with src as (&lt;br /&gt;  2    select 'FUNCTION F RETURN NUMBER IS BEGIN RETURN 1; END;' txt&lt;br /&gt;  3      from dual),&lt;br /&gt;  4  wrap as (&lt;br /&gt;  5    select src.txt,&lt;br /&gt;  6           dbms_ddl.wrap( 'CREATE OR REPLACE ' || src.txt) wrap&lt;br /&gt;  7      from src),&lt;br /&gt;  8  subst as (&lt;br /&gt;  9    select substr(utl_encode.base64_decode(utl_raw.cast_to_raw(rtrim(substr(wrap.wrap, instr(wrap.wrap,&lt;br /&gt; chr(10), 1, 20) + 1), chr(10)))), 41) x,&lt;br /&gt; 10           mycompress.deflate(wrap.txt||chr(0)) d&lt;br /&gt; 11      from wrap)&lt;br /&gt; 12  select to_number(substr(x, r*2 -1,2), 'xx') wrapped,&lt;br /&gt; 13         substr(x, r*2 -1, 2) wrapped_hex,&lt;br /&gt; 14         to_number(substr(d, r*2 -1,2), 'xx') zipped,&lt;br /&gt; 15         substr(d, r*2 -1, 2) zipped_hex&lt;br /&gt; 16    from subst,&lt;br /&gt; 17         (select rownum r from dual connect by rownum &lt;= 10);&lt;br /&gt;&lt;br /&gt;   WRAPPED WRAPPED_HEX     ZIPPED ZIPPED_HEX&lt;br /&gt;---------- ----------- ---------- -----------&lt;br /&gt;        48 30                 120 78&lt;br /&gt;       131 83                 156 9C&lt;br /&gt;       199 C7                 115 73&lt;br /&gt;       153 99                  11 0B&lt;br /&gt;       129 81                 245 F5&lt;br /&gt;       199 C7                 115 73&lt;br /&gt;       203 CB                  14 0E&lt;br /&gt;         8 08                 241 F1&lt;br /&gt;       210 D2                 244 F4&lt;br /&gt;       254 FE                 247 F7&lt;br /&gt;&lt;/pre&gt;The &lt;b&gt;&lt;i&gt;ZIPPED_HEX&lt;/i&gt;&lt;/b&gt; column shows compressed bytes whereas &lt;b&gt;&lt;i&gt;WRAPPED_HEX&lt;/i&gt;&lt;/b&gt; shows the corresponding wrapped byte. A simple brute-force approach can be used to obtain the reverse wrap substitution table to convert a wrapped byte to its corresponding zipped byte. Then, it is just enough to unzip the final byte stream to complete the unwrap exercise. &lt;br/&gt;&lt;br/&gt; I was curious how to do the same by using a more systematic approach. For that, I was recording the function calls using DebugTrace from &lt;a href="https://software.intel.com/en-us/articles/pin-a-dynamic-binary-instrumentation-tool"&gt;the Intel Pin Tools&lt;/a&gt; of a session wrapping PL/SQL code. I came across the &lt;b&gt;&lt;i&gt;pkwrap_obfuscate_source&lt;/i&gt;&lt;/b&gt; function: &lt;pre class="brush:sql"&gt;pkwrap_obfuscate_source(0x7feb38878af8, 0x9, ...)&lt;br /&gt;&gt; bam_init(0x7feb38878af8, 0x7ffd567e9d18, ...)&lt;br /&gt;| &gt; kghalp(0x7feb3e4a69a0, 0x7feb3e4abe00, ...)&lt;br /&gt;| | &gt; kghprmalo(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | &gt; kghtshrt(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | &lt; kghtshrt+0x000000000169 returns: 0x40b38f0000000139&lt;br /&gt;| | | &gt; kghfnd_in_free_lists(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | &lt; kghfnd_in_free_lists+0x0000000001d5 returns: 0&lt;br /&gt;| | | &gt; kghfnd(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | | &gt; kghgex(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | | | &gt; kghalo(0x7feb3e4a69a0, 0x7feb3e4ad700, ...)&lt;br /&gt;| | | | | | &gt; kghfnd_in_free_lists(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | | | | &lt; kghfnd_in_free_lists+0x0000000001d5 returns: 0x7feb3e37bc00&lt;br /&gt;| | | | | | &gt; kghbshrt(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | | | | &lt; kghbshrt+0x000000000130 returns: 0x7feb3e37dbc8&lt;br /&gt;| | | | | | &gt; ksmpga_allo_cb(0x7feb3e4a69a0, 0x7feb3e4ad700, ...)&lt;br /&gt;| | | | | | | &gt; ksm_near_pga_limit_pdb(0x1, 0x3, ...)&lt;br /&gt;| | | | | | | &lt; ksm_near_pga_limit_pdb+0x00000000017f returns: 0&lt;br /&gt;| | | | | | &lt; ksmpga_allo_cb+0x0000000006a4 returns: 0&lt;br /&gt;| | | | | &lt; kghalo+0x000000000722 returns: 0x7feb3e37dbe0&lt;br /&gt;| | | | | &gt; kghaddex(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | | | &lt; kghaddex+0x00000000026a returns: 0x7feb3e37dbf0&lt;br /&gt;| | | | &lt; kghgex+0x00000000034e returns: 0x7feb3e37dbf0&lt;br /&gt;| | | &lt; kghfnd+0x00000000018b returns: 0x7feb3e37dbf0&lt;br /&gt;| | &lt; kghprmalo+0x00000000045e returns: 0x7feb3e37dc18&lt;br /&gt;| | &gt; _intel_fast_memset(0x7feb3e37dc18, 0, ...)&lt;br /&gt;| | &lt;&gt; _intel_fast_memset.J(0x7feb3e37dc18, 0, ...)&lt;br /&gt;| | &lt;&gt; __intel_memset(0x7feb3e37dc18, 0, ...)&lt;br /&gt;| | &lt; __intel_memset+0x000000000818 returns: 0x7feb3e37dc18&lt;br /&gt;| &lt; kghalp+0x0000000002d9 returns: 0x7feb3e37dc18&lt;br /&gt;&lt; bam_init+0x000000000105 returns: 0x7ffd567e9d18&lt;br /&gt;&lt;/pre&gt;It is coming from the &lt;b&gt;&lt;i&gt;pkwrap.o&lt;/i&gt;&lt;/b&gt; library within the &lt;b&gt;&lt;i&gt;$ORACLE_HOME/lib/libpls12.a&lt;/i&gt;&lt;/b&gt; archive. There's one especially interesting line in that file: &lt;pre class="brush:sql;highlight:[17]"&gt;$ objdump -dzr pkwrap.o&lt;br /&gt;&lt;br /&gt;    4ecd:       ff c3                   inc    %ebx&lt;br /&gt;    4ecf:       89 d8                   mov    %ebx,%eax&lt;br /&gt;    4ed1:       83 fb 14                cmp    $0x14,%ebx&lt;br /&gt;    4ed4:       72 de                   jb     4eb4 &amp;lt;pkwrap_obfuscate_source+0x194&gt;&lt;br /&gt;    4ed6:       48 8b 55 c8             mov    -0x38(%rbp),%rdx&lt;br /&gt;    4eda:       33 c9                   xor    %ecx,%ecx&lt;br /&gt;    4edc:       48 8b 45 e0             mov    -0x20(%rbp),%rax&lt;br /&gt;    4ee0:       48 85 c0                test   %rax,%rax&lt;br /&gt;    4ee3:       48 89 55 d0             mov    %rdx,-0x30(%rbp)&lt;br /&gt;    4ee7:       76 27                   jbe    4f10 &amp;lt;pkwrap_obfuscate_source+0x1f0&gt;&lt;br /&gt;    4ee9:       0f b6 04 0a             movzbl (%rdx,%rcx,1),%eax&lt;br /&gt;    4eed:       48 83 c0 a0             add    $0xffffffffffffffa0,%rax&lt;br /&gt;    4ef1:       0f b6 d8                movzbl %al,%ebx&lt;br /&gt;    4ef4:       44 8a 83 00 00 00 00    mov    0x0(%rbx),%r8b&lt;br /&gt;                        4ef7: R_X86_64_32S      pkwrap_forward_table&lt;br /&gt;&lt;/pre&gt;&lt;b&gt;&lt;i&gt;R_X86_64_32S&lt;/i&gt;&lt;/b&gt; is one of relocation types as it is defined in &lt;a href="http://refspecs.linuxbase.org/elf/x86_64-abi-0.98.pdf"&gt;System V Application Binary Interface&lt;/a&gt;. Here's how to get that table: &lt;pre class="brush:sql;highlight:[26,30]"&gt;$ readelf --syms pkwrap.o&lt;br /&gt;&lt;br /&gt;Symbol table '.symtab' contains 94 entries:&lt;br /&gt;   Num:    Value          Size Type    Bind   Vis      Ndx Name&lt;br /&gt;     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND&lt;br /&gt;     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS pkwrap.c&lt;br /&gt;     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    2&lt;br /&gt;     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    3&lt;br /&gt;     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    4&lt;br /&gt;     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    5&lt;br /&gt;     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    6&lt;br /&gt;     7: 0000000000000010    80 FUNC    LOCAL  DEFAULT    6 pkwrap_skip_white_space&lt;br /&gt;     8: 0000000000000060   304 FUNC    LOCAL  DEFAULT    6 pkwrap_read_hex&lt;br /&gt;     9: 0000000000000000     0 SECTION LOCAL  DEFAULT    7&lt;br /&gt;    10: 0000000000000190   272 FUNC    LOCAL  DEFAULT    6 pkwrap_read_hex_multi&lt;br /&gt;    11: 00000000000002a0  3440 FUNC    LOCAL  DEFAULT    6 pkwrap_read_string&lt;br /&gt;    12: 0000000000001010   896 FUNC    LOCAL  DEFAULT    6 pkwrap_read_string_paro&lt;br /&gt;    13: 0000000000001390   192 FUNC    LOCAL  DEFAULT    6 pkwrap_read_number&lt;br /&gt;    14: 0000000000001450   416 FUNC    LOCAL  DEFAULT    6 pkwrap_read_number_paro&lt;br /&gt;    15: 00000000000015f0   400 FUNC    LOCAL  DEFAULT    6 pkwrap_2_to_4&lt;br /&gt;    16: 0000000000001780   384 FUNC    LOCAL  DEFAULT    6 pkwrap_4_to_8&lt;br /&gt;    17: 0000000000001900   976 FUNC    LOCAL  DEFAULT    6 pkwrap_read_ub_paro&lt;br /&gt;    18: 0000000000001cd0   736 FUNC    LOCAL  DEFAULT    6 pkwrap_read_symtab&lt;br /&gt;    19: 0000000000001fb0  1728 FUNC    LOCAL  DEFAULT    6 pkwrap_read_source&lt;br /&gt;    20: 0000000000000000     0 SECTION LOCAL  DEFAULT    8&lt;br /&gt;    21: 0000000000000080   256 OBJECT  LOCAL  DEFAULT    8 pkwrap_reverse_table&lt;br /&gt;    22: 0000000000003cc0  4192 FUNC    LOCAL  DEFAULT    6 pkwrap_is_plsql&lt;br /&gt;    23: 0000000000000000     0 SECTION LOCAL  DEFAULT    9&lt;br /&gt;    24: 0000000000004d20  1072 FUNC    LOCAL  DEFAULT    6 pkwrap_obfuscate_source&lt;br /&gt;    25: 0000000000000180   256 OBJECT  LOCAL  DEFAULT    8 pkwrap_forward_table&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Those tables are coming from section 8 and start at addresses &lt;tt&gt;0x00000080&lt;/tt&gt; (&lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt;) and &lt;tt&gt;0x00000180&lt;/tt&gt; (&lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt;). The aforementioned section can be seen as follows: &lt;pre class="brush:sql;highlight:[13,29]"&gt;$readelf --hex-dump=8 pkwrap.o&lt;br /&gt;&lt;br /&gt;Hex dump of section '.rodata':&lt;br /&gt; NOTE: This section has relocations against it, but these have NOT been applied to this dump.&lt;br /&gt;  0x00000000 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000010 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000020 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000030 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000040 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000050 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000060 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000070 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000080 dd052553 b87b8227 91f24b03 eb5540ff ..%S.{.'..K..U@.&lt;br /&gt;  0x00000090 1d081b3b c462c807 2a7e44c6 bea38bb7 ...;.b..*~D.....&lt;br /&gt;  0x000000a0 0fd4de1a df72490a af89d5f6 bf51edb0 .....rI......Q..&lt;br /&gt;  0x000000b0 18791596 5ce1a421 01a6994d 7675c91e .y..\..!...Mvu..&lt;br /&gt;  0x000000c0 263e1985 a55a246c 0ec72e50 fd48933f &amp;&gt;...Z$l...P.H.?&lt;br /&gt;  0x000000d0 70421158 f87dccd8 39ece8a7 f584f32c pB.X.}..9......,&lt;br /&gt;  0x000000e0 e656cd45 4fd2c2e0 7cf06341 c52b3cb6 .V.EO...|.cA.+&lt;.&lt;br /&gt;  0x000000f0 00fc6f9d ac38bc74 d70ddcda d0880cd1 ..o..8.t........&lt;br /&gt;  0x00000100 e795d37a e36883fe b9348c86 4335b480 ...z.h...4..C5..&lt;br /&gt;  0x00000110 3d049af9 b565cf6a 5bab7f92 375faa16 =....e.j[...7_..&lt;br /&gt;  0x00000120 54e9e4fa bd90a036 c1201fba 22d9ef61 T......6. .."..a&lt;br /&gt;  0x00000130 4777ad71 789fb333 108efb8f 5ea95917 Gw.qx..3....^.Y.&lt;br /&gt;  0x00000140 128752f4 57ca6713 3006c0ae f18d981c ..R.W.g.0.......&lt;br /&gt;  0x00000150 2fce94b2 66cb236d 4c6bdb64 ee6009d6 /...f.#mLk.d.`..&lt;br /&gt;  0x00000160 02a24e28 9c4ae2a8 46e5f773 3a5d81c3 ..N(.J..F..s:]..&lt;br /&gt;  0x00000170 2d32eab1 29140b31 9b9e69a1 8abb976e -2..)..1..i....n&lt;br /&gt;  0x00000180 7038e00b 9101c917 11de27f6 7e794820 p8........'.~yH&lt;br /&gt;  0x00000190 b852c0c7 f5329fbf 30422312 cf103faa .R...2..0B#...?.&lt;br /&gt;  0x000001a0 a937acd6 46024007 e3f4186d 5ff04ad0 .7..F.@....m_.J.&lt;br /&gt;  0x000001b0 c8f7f1b7 898da79c 7558ec13 6e90414f ........uX..n.AO&lt;br /&gt;  0x000001c0 0e6b518c 1a63e8b0 4d26e50a d83be264 .kQ..c..M&amp;...;.d&lt;br /&gt;  0x000001d0 4b2dc203 a00d61c4 53be4598 34edbc9d K-....a.S.E.4...&lt;br /&gt;  0x000001e0 ddaf156a db95d4c6 85fa97d9 47d7ff72 ...j........G..r&lt;br /&gt;  0x000001f0 50b325eb 773d3cb1 b4318305 6855199a P.%.w=&lt;..1..hU..&lt;br /&gt;  0x00000200 8fee0686 5d438bc1 7d29fc1e 8acdb9bb ....]C..})......&lt;br /&gt;  0x00000210 a5089b4e d28133fe ce3a92f8 e473f9b5 ...N..3..:...s..&lt;br /&gt;  0x00000220 a6fbe11d 3644395b e7bd9e99 74b2cb28 ....6D9[....t..(&lt;br /&gt;  0x00000230 2ff3d3b6 8e946f1f 0488abfd 76a41c2c /.....o.....v..,&lt;br /&gt;  0x00000240 caa866ef 146c1b49 163ec5d5 5662d196 ..f..l.I.&gt;..Vb..&lt;br /&gt;  0x00000250 7c7f6582 212adf78 57ad7bda 7a002224 |.e.!*.xW.{.z."$&lt;br /&gt;  0x00000260 6735e684 a2e96080 5aa1f20c 592edcae g5....`.Z...Y...&lt;br /&gt;  0x00000270 69cc095e c35c2bea 5493a3ba 714c870f i..^.\+.T...qL..&lt;br /&gt;  0x00000280 9a999999 9999f13f 00000000 00002840 .......?......(@&lt;br /&gt;  0x00000290 00000000 00003440 66666666 6666f63f ......4@ffffff.?&lt;br /&gt;  0x000002a0 00000000 0000e043 0000005f 00000000 .......C..._....&lt;br /&gt;  0x000002b0 00000000 00000000 00000000 00000000 ................&lt;br /&gt;&lt;/pre&gt;Judging by their names: &lt;ul&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt; should be applied at &lt;a href="#step3"&gt;step 3&lt;/a&gt; when the zipped byte stream is converted using the substitution table.&lt;/li&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt; can be used to reverse that step.&lt;/li&gt;&lt;/ul&gt;Initially, I could not find out how both of those tables are used.  Then, while I was studying the &lt;b&gt;&lt;i&gt;pkwrap_obfuscate_source&lt;/i&gt;&lt;/b&gt; procedure in &lt;a href="https://ghidra-sre.org/"&gt;Ghidra&lt;/a&gt;, I found a block of code that seemed quite promising: &lt;pre class="brush:sql;highlight:[4]"&gt;if (CONCAT44(uStack36,local_28) != 0) {&lt;br /&gt;    do {&lt;br /&gt;      *(undefined *)(local_40 + uVar7) =&lt;br /&gt;           pkwrap_forward_table[(ulong)(byte)(*(char *)(local_40 + uVar7) + 0xa0)];&lt;br /&gt;      uVar7 = (ulong)((int)uVar7 + 1);&lt;br /&gt;    } while (uVar7 &lt; CONCAT44(uStack36,local_28));&lt;br /&gt;  }&lt;br /&gt;&lt;/pre&gt;The important part here is how that table is accessed - there is &lt;b&gt;&lt;i&gt;0xA0&lt;/i&gt;&lt;/b&gt; which is 160 in decimal. Let's just try to lookup those zipped bytes against &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt; by adding that offset &lt;b&gt;&lt;i&gt;0xA0&lt;/i&gt;&lt;/b&gt; to them: &lt;pre class="brush:sql"&gt;SQL&gt; with src as (&lt;br /&gt;  2    select 'FUNCTION F RETURN NUMBER IS BEGIN RETURN 1; END;' txt&lt;br /&gt;  3      from dual),&lt;br /&gt;  4  wrap as (&lt;br /&gt;  5    select src.txt,&lt;br /&gt;  6           dbms_ddl.wrap( 'CREATE OR REPLACE ' || src.txt) wrap&lt;br /&gt;  7      from src),&lt;br /&gt;  8  subst as (&lt;br /&gt;  9    select substr(utl_encode.base64_decode(utl_raw.cast_to_raw(rtrim(substr(wrap.wrap, instr(wrap.wrap,&lt;br /&gt; chr(10), 1, 20) + 1), chr(10)))), 41) x,&lt;br /&gt; 10           mycompress.deflate(wrap.txt||chr(0)) d&lt;br /&gt; 11      from wrap)&lt;br /&gt; 12  select to_number(substr(x, r*2 -1,2), 'xx') wrapped,&lt;br /&gt; 13         substr(x, r*2 -1, 2) wrapped_hex,&lt;br /&gt; 14         to_number(substr(d, r*2 -1,2), 'xx') zipped,&lt;br /&gt; 15         substr(d, r*2 -1, 2) zipped_hex&lt;br /&gt; 16    from subst,&lt;br /&gt; 17         (select rownum r from dual connect by rownum &lt;= 10);&lt;br /&gt;&lt;br /&gt;   WRAPPED WRAPPED_HEX     ZIPPED ZIPPED_HEX&lt;br /&gt;---------- ----------- ---------- -----------&lt;br /&gt;        48 30                 120 78&lt;br /&gt;       131 83                 156 9C&lt;br /&gt;       199 C7                 115 73&lt;br /&gt;       153 99                  11 0B&lt;br /&gt;       129 81                 245 F5&lt;br /&gt;       199 C7                 115 73&lt;br /&gt;       203 CB                  14 0E&lt;br /&gt;         8 08                 241 F1&lt;br /&gt;       210 D2                 244 F4&lt;br /&gt;       254 FE                 247 F7&lt;br /&gt;&lt;/pre&gt;I got the following table: &lt;style type="text/css"&gt;th.awrbg {     font: bold 8pt Arial,Helvetica,Geneva,sans-serif;     color: White;     background: #0066CC;     padding-left: 4px;     padding-right: 4px;     padding-bottom: 2px; } td.awrc {     font: 8pt Arial,Helvetica,Geneva,sans-serif;     color: black;     background: #FFFFCC;     vertical-align: top; } td.awrnc {     font: 8pt Arial,Helvetica,Geneva,sans-serif;     color: black;     background: White;     vertical-align: top; }  td.error {     color: red; } &lt;/style&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th class="awrbg"&gt;WRAPPED_HEX&lt;/th&gt;&lt;th class="awrbg"&gt;ZIPPED_HEX&lt;/th&gt;&lt;th class="awrbg"&gt;MOD(ZIPPED_HEX+0xA0,0x100)&lt;/th&gt;&lt;th class="awrbg"&gt;PKWRAP_FORWARD_TABLE(MOD(ZIPPED_HEX+0xA0,0x100))&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc"&gt;0x30&lt;/td&gt;&lt;td class="awrc"&gt;0x78&lt;/td&gt;&lt;td class="awrc"&gt;0x18&lt;/td&gt;&lt;td class="awrc"&gt;0x30&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrnc"&gt;0x83&lt;/td&gt;&lt;td class="awrnc"&gt;0x9C&lt;/td&gt;&lt;td class="awrnc"&gt;0x3C&lt;/td&gt;&lt;td class="awrnc error"&gt;0x6E&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc"&gt;0xC7&lt;/td&gt;&lt;td class="awrc"&gt;0x78&lt;/td&gt;&lt;td class="awrc"&gt;0x73&lt;/td&gt;&lt;td class="awrc"&gt;0xC7&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrnc"&gt;0x99&lt;/td&gt;&lt;td class="awrnc"&gt;0x0B&lt;/td&gt;&lt;td class="awrnc"&gt;0xAB&lt;/td&gt;&lt;td class="awrnc"&gt;0x99&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc"&gt;0x81&lt;/td&gt;&lt;td class="awrc"&gt;0xF5&lt;/td&gt;&lt;td class="awrc"&gt;0x95&lt;/td&gt;&lt;td class="awrc"&gt;0x81&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrnc"&gt;0xC7&lt;/td&gt;&lt;td class="awrnc"&gt;0x78&lt;/td&gt;&lt;td class="awrnc"&gt;0x73&lt;/td&gt;&lt;td class="awrnc"&gt;0xC7&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc"&gt;0xCB&lt;/td&gt;&lt;td class="awrc"&gt;0x0E&lt;/td&gt;&lt;td class="awrc"&gt;0xAE&lt;/td&gt;&lt;td class="awrc"&gt;0xCB&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrnc"&gt;0x08&lt;/td&gt;&lt;td class="awrnc"&gt;0xF1&lt;/td&gt;&lt;td class="awrnc"&gt;0x91&lt;/td&gt;&lt;td class="awrnc"&gt;0x08&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc"&gt;0xD2&lt;/td&gt;&lt;td class="awrc"&gt;0xF4&lt;/td&gt;&lt;td class="awrc"&gt;0x94&lt;/td&gt;&lt;td class="awrc"&gt;0xD2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrnc"&gt;0xFE&lt;/td&gt;&lt;td class="awrnc"&gt;0xF7&lt;/td&gt;&lt;td class="awrnc"&gt;0x97&lt;/td&gt;&lt;td class="awrnc"&gt;0xFE&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt; &lt;/table&gt;Let me explain how the right most column is obtained. I will take the last row for this example. The wrapped byte is &lt;b&gt;&lt;i&gt;0xFE&lt;/i&gt;&lt;/b&gt;, its corresponding zipped byte is &lt;b&gt;&lt;i&gt;0xF7&lt;/i&gt;&lt;/b&gt;. &lt;tt&gt;MOD(0xF7 + 0xA0, 0x100)=0x97&lt;/tt&gt;. The relevant entry from &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt; at index &lt;b&gt;&lt;i&gt;0x97&lt;/i&gt;&lt;/b&gt; is &lt;b&gt;&lt;i&gt;0xFE&lt;/i&gt;&lt;/b&gt; (the same as the wrapped byte): &lt;pre class="brush:sql;highlight:[10]"&gt;  0x00000180 7038e00b 9101c917 11de27f6 7e794820 p8........'.~yH&lt;br /&gt;  0x00000190 b852c0c7 f5329fbf 30422312 cf103faa .R...2..0B#...?.&lt;br /&gt;  0x000001a0 a937acd6 46024007 e3f4186d 5ff04ad0 .7..F.@....m_.J.&lt;br /&gt;  0x000001b0 c8f7f1b7 898da79c 7558ec13 6e90414f ........uX..n.AO&lt;br /&gt;  0x000001c0 0e6b518c 1a63e8b0 4d26e50a d83be264 .kQ..c..M&amp;...;.d&lt;br /&gt;  0x000001d0 4b2dc203 a00d61c4 53be4598 34edbc9d K-....a.S.E.4...&lt;br /&gt;  0x000001e0 ddaf156a db95d4c6 85fa97d9 47d7ff72 ...j........G..r&lt;br /&gt;  0x000001f0 50b325eb 773d3cb1 b4318305 6855199a P.%.w=&lt;..1..hU..&lt;br /&gt;  0x00000200 8fee0686 5d438bc1 7d29fc1e 8acdb9bb ....]C..})......&lt;br /&gt;  0x00000210 a5089b4e d28133fe ce3a92f8 e473f9b5 ...N..3..:...s..&lt;br /&gt;  0x00000220 a6fbe11d 3644395b e7bd9e99 74b2cb28 ....6D9[....t..(&lt;br /&gt;  0x00000230 2ff3d3b6 8e946f1f 0488abfd 76a41c2c /.....o.....v..,&lt;br /&gt;  0x00000240 caa866ef 146c1b49 163ec5d5 5662d196 ..f..l.I.&gt;..Vb..&lt;br /&gt;  0x00000250 7c7f6582 212adf78 57ad7bda 7a002224 |.e.!*.xW.{.z."$&lt;br /&gt;  0x00000260 6735e684 a2e96080 5aa1f20c 592edcae g5....`.Z...Y...&lt;br /&gt;  0x00000270 69cc095e c35c2bea 5493a3ba 714c870f i..^.\+.T...qL..&lt;br /&gt;&lt;/pre&gt;&lt;b&gt;&lt;i&gt;Note&lt;/i&gt;&lt;/b&gt;: I have no explanation right now why there is a discrepancy in the second line.  As it has been shown &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt; can be used to convert compressed byte stream to wrapped bytes, it is now possible to obtain the reverse table that can be used to unwrap stored PL/SQL code (the secret sauce of the Oracle Wrap process that is known to be obtained using a brute-force algorithm): &lt;pre class="brush:sql"&gt;SQL&gt; declare&lt;br /&gt;  2    v_forward_table raw(256) :=&lt;br /&gt;  3      hextoraw('7038e00b9101c91711de27f67e794820'||&lt;br /&gt;  4               'b852c0c7f5329fbf30422312cf103faa'||&lt;br /&gt;  5               'a937acd646024007e3f4186d5ff04ad0'||&lt;br /&gt;  6               'c8f7f1b7898da79c7558ec136e90414f'||&lt;br /&gt;  7               '0e6b518c1a63e8b04d26e50ad83be264'||&lt;br /&gt;  8               '4b2dc203a00d61c453be459834edbc9d'||&lt;br /&gt;  9               'ddaf156adb95d4c685fa97d947d7ff72'||&lt;br /&gt; 10               '50b325eb773d3cb1b43183056855199a'||&lt;br /&gt; 11               '8fee06865d438bc17d29fc1e8acdb9bb'||&lt;br /&gt; 12               'a5089b4ed28133fece3a92f8e473f9b5'||&lt;br /&gt; 13               'a6fbe11d3644395be7bd9e9974b2cb28'||&lt;br /&gt; 14               '2ff3d3b68e946f1f0488abfd76a41c2c'||&lt;br /&gt; 15               'caa866ef146c1b49163ec5d55662d196'||&lt;br /&gt; 16               '7c7f6582212adf7857ad7bda7a002224'||&lt;br /&gt; 17               '6735e684a2e960805aa1f20c592edcae'||&lt;br /&gt; 18               '69cc095ec35c2bea5493a3ba714c870f');&lt;br /&gt; 19    type wrap_table_type is table of raw(1) index by pls_integer;&lt;br /&gt; 20    v_reverse_table wrap_table_type;&lt;br /&gt; 21    procedure populate_reverse_table&lt;br /&gt; 22    is&lt;br /&gt; 23      v_byte raw(1);&lt;br /&gt; 24      v_index pls_integer;&lt;br /&gt; 25    begin&lt;br /&gt; 26      for i in 0..255&lt;br /&gt; 27      loop&lt;br /&gt; 28        v_index := i;&lt;br /&gt; 29        v_byte := utl_raw.substr(v_forward_table, v_index + 1, 1);&lt;br /&gt; 30        v_reverse_table(to_number(rawtohex(v_byte),'XX')):=hextoraw(to_char(mod(v_index - 160 + 256, 25&lt;br /&gt;6), 'fm0X'));&lt;br /&gt; 31      end loop;&lt;br /&gt; 32    end populate_reverse_table;&lt;br /&gt; 33    procedure print_reverse_table&lt;br /&gt; 34    is&lt;br /&gt; 35    begin&lt;br /&gt; 36      for i in 0..255&lt;br /&gt; 37      loop&lt;br /&gt; 38        if mod(i,16)=0&lt;br /&gt; 39        then&lt;br /&gt; 40          dbms_output.new_line();&lt;br /&gt; 41        end if;&lt;br /&gt; 42        dbms_output.put(lower(rawtohex(v_reverse_table(i))));&lt;br /&gt; 43      end loop;&lt;br /&gt; 44      dbms_output.new_line();&lt;br /&gt; 45    end print_reverse_table;&lt;br /&gt; 46  begin&lt;br /&gt; 47    populate_reverse_table();&lt;br /&gt; 48    print_reverse_table();&lt;br /&gt; 49  end;&lt;br /&gt; 50  /&lt;br /&gt;3d6585b318dbe287f152ab634bb5a05f&lt;br /&gt;7d687b9b24c228678adea4261e03eb17&lt;br /&gt;6f343e7a3fd2a96a0fe935561fb14d10&lt;br /&gt;78d975f6bc4104816106f9add6d5297e&lt;br /&gt;869e79e505ba84cc6e278eb05da8f39f&lt;br /&gt;d0a271b858dd2c38994c480755e4538c&lt;br /&gt;46b62da5af322240dc50c3a1258b9c16&lt;br /&gt;605ccffd0c981cd4376d3c3a30e86c31&lt;br /&gt;47f533da43c8e35e1994ece6a39514e0&lt;br /&gt;9d64fa5915c52fcabb0bdff297bf0a76&lt;br /&gt;b449445a1df0009621807f1a82394fc1&lt;br /&gt;a7d70dd1d8ff139370ee5befbe09b977&lt;br /&gt;72e7b254b72ac7739066200e51edf87c&lt;br /&gt;8f2ef412c62b83cdaccb3bc44ec06936&lt;br /&gt;6202ae88fcaa4208a64557d39abde123&lt;br /&gt;8d924a1189746b91fbfec901ea1bf7ce&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;Now I can try to rewrap a sample piece of code using that substitution table: &lt;pre class="brush:sql"&gt;SQL&gt; with src as (&lt;br /&gt;  2    select q'!package body test_pkg&lt;br /&gt;  3  is&lt;br /&gt;  4  procedure p1&lt;br /&gt;  5  is&lt;br /&gt;  6     v_local_var pls_integer := 10;&lt;br /&gt;  7  begin&lt;br /&gt;  8    dbms_output.put_line(123);&lt;br /&gt;  9  end;&lt;br /&gt; 10  function f1 return varchar2&lt;br /&gt; 11  is&lt;br /&gt; 12    /* code comment*/&lt;br /&gt; 13  begin&lt;br /&gt; 14    return 'string';&lt;br /&gt; 15  end;&lt;br /&gt; 16  end;!' txt&lt;br /&gt; 17      from dual),&lt;br /&gt; 18    wrap as (&lt;br /&gt; 19      select dbms_ddl.wrap( 'create ' || src.txt ) wrap&lt;br /&gt; 20        from src),&lt;br /&gt; 21    base64_dcd as(&lt;br /&gt; 22      select substr( utl_encode.base64_decode( utl_raw.cast_to_raw(rtrim( substr( wrap.wrap, instr( wra&lt;br /&gt;p.wrap, chr( 10 ), 1, 20 ) + 1 ), chr(10) )  ) ), 41 ) x&lt;br /&gt; 23        from wrap),&lt;br /&gt; 24    subst as (&lt;br /&gt; 25      select utl_raw.translate( x,&lt;br /&gt; 26               hextoraw('000102030405060708090A0B0C0D0E0F' ||&lt;br /&gt; 27                        '101112131415161718191A1B1C1D1E1F' ||&lt;br /&gt; 28                        '202122232425262728292A2B2C2D2E2F' ||&lt;br /&gt; 29                        '303132333435363738393A3B3C3D3E3F' ||&lt;br /&gt; 30                        '404142434445464748494A4B4C4D4E4F' ||&lt;br /&gt; 31                        '505152535455565758595A5B5C5D5E5F' ||&lt;br /&gt; 32                        '606162636465666768696A6B6C6D6E6F' ||&lt;br /&gt; 33                        '707172737475767778797A7B7C7D7E7F' ||&lt;br /&gt; 34                        '808182838485868788898A8B8C8D8E8F' ||&lt;br /&gt; 35                        '909192939495969798999A9B9C9D9E9F' ||&lt;br /&gt; 36                        'A0A1A2A3A4A5A6A7A8A9AAABACADAEAF' ||&lt;br /&gt; 37                        'B0B1B2B3B4B5B6B7B8B9BABBBCBDBEBF' ||&lt;br /&gt; 38                        'C0C1C2C3C4C5C6C7C8C9CACBCCCDCECF' ||&lt;br /&gt; 39                        'D0D1D2D3D4D5D6D7D8D9DADBDCDDDEDF' ||&lt;br /&gt; 40                        'E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF' ||&lt;br /&gt; 41                        'F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF'),&lt;br /&gt; 42               hextoraw('3D6585B318DBE287F152AB634BB5A05F' ||&lt;br /&gt; 43                        '7D687B9B24C228678ADEA4261E03EB17' ||&lt;br /&gt; 44                        '6F343E7A3FD2A96A0FE935561FB14D10' ||&lt;br /&gt; 45                        '78D975F6BC4104816106F9ADD6D5297E' ||&lt;br /&gt; 46                        '869E79E505BA84CC6E278EB05DA8F39F' ||&lt;br /&gt; 47                        'D0A271B858DD2C38994C480755E4538C' ||&lt;br /&gt; 48                        '46B62DA5AF322240DC50C3A1258B9C16' ||&lt;br /&gt; 49                        '605CCFFD0C981CD4376D3C3A30E86C31' ||&lt;br /&gt; 50                        '47F533DA43C8E35E1994ECE6A39514E0' ||&lt;br /&gt; 51                        '9D64FA5915C52FCABB0BDFF297BF0A76' ||&lt;br /&gt; 52                        'B449445A1DF0009621807F1A82394FC1' ||&lt;br /&gt; 53                        'A7D70DD1D8FF139370EE5BEFBE09B977' ||&lt;br /&gt; 54                        '72E7B254B72AC7739066200E51EDF87C' ||&lt;br /&gt; 55                        '8F2EF412C62B83CDACCB3BC44EC06936' ||&lt;br /&gt; 56                        '6202AE88FCAA4208A64557D39ABDE123' ||&lt;br /&gt; 57                        '8D924A1189746B91FBFEC901EA1BF7CE')) s&lt;br /&gt; 58      from base64_dcd)&lt;br /&gt; 59  select mycompress.inflate( s ) unwrapped_code&lt;br /&gt; 60    from subst&lt;br /&gt; 61  /&lt;br /&gt;&lt;br /&gt;UNWRAPPED_CODE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;PACKAGE BODY test_pkg&lt;br /&gt;IS&lt;br /&gt;PROCEDURE P1&lt;br /&gt;IS&lt;br /&gt;   V_LOCAL_VAR PLS_INTEGER := 10;&lt;br /&gt;BEGIN&lt;br /&gt;  DBMS_OUTPUT.PUT_LINE(123);&lt;br /&gt;END;&lt;br /&gt;FUNCTION F1 RETURN VARCHAR2&lt;br /&gt;IS&lt;br /&gt;&lt;br /&gt;BEGIN&lt;br /&gt;  RETURN 'string';&lt;br /&gt;END;&lt;br /&gt;END;&lt;br /&gt;&lt;/pre&gt;Therefore, it has been demonstrated that the reverse table obtained with a help of &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt; can be used to unwrap this sample piece of PL/SQL code.  &lt;br/&gt;&lt;br/&gt; Going back to &lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt;, let's take a look at both &lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt; and &lt;b&gt;&lt;i&gt;my_reverse_table&lt;/i&gt;&lt;/b&gt; tables together to see if we can find any commonality among them: 1. &lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt; that we do not know how to use yet: &lt;pre class="brush:sql"&gt;  dd052553 b87b8227 91f24b03 eb5540ff&lt;br /&gt;  1d081b3b c462c807 2a7e44c6 bea38bb7&lt;br /&gt;  0fd4de1a df72490a af89d5f6 bf51edb0&lt;br /&gt;  18791596 5ce1a421 01a6994d 7675c91e&lt;br /&gt;  263e1985 a55a246c 0ec72e50 fd48933f&lt;br /&gt;  70421158 f87dccd8 39ece8a7 f584f32c&lt;br /&gt;  e656cd45 4fd2c2e0 7cf06341 c52b3cb6&lt;br /&gt;  00fc6f9d ac38bc74 d70ddcda d0880cd1&lt;br /&gt;  e795d37a e36883fe b9348c86 4335b480&lt;br /&gt;  3d049af9 b565cf6a 5bab7f92 375faa16&lt;br /&gt;  54e9e4fa bd90a036 c1201fba 22d9ef61&lt;br /&gt;  4777ad71 789fb333 108efb8f 5ea95917&lt;br /&gt;  128752f4 57ca6713 3006c0ae f18d981c&lt;br /&gt;  2fce94b2 66cb236d 4c6bdb64 ee6009d6&lt;br /&gt;  02a24e28 9c4ae2a8 46e5f773 3a5d81c3&lt;br /&gt;  2d32eab1 29140b31 9b9e69a1 8abb976e&lt;br /&gt;&lt;/pre&gt;2. the reverse table that I obtained running my PL/SQL code against &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt;: &lt;pre class="brush:sql"&gt;  3d6585b3 18dbe287 f152ab63 4bb5a05f&lt;br /&gt;  7d687b9b 24c22867 8adea426 1e03eb17&lt;br /&gt;  6f343e7a 3fd2a96a 0fe93556 1fb14d10&lt;br /&gt;  78d975f6 bc410481 6106f9ad d6d5297e&lt;br /&gt;  869e79e5 05ba84cc 6e278eb0 5da8f39f&lt;br /&gt;  d0a271b8 58dd2c38 994c4807 55e4538c&lt;br /&gt;  46b62da5 af322240 dc50c3a1 258b9c16&lt;br /&gt;  605ccffd 0c981cd4 376d3c3a 30e86c31&lt;br /&gt;  47f533da 43c8e35e 1994ece6 a39514e0&lt;br /&gt;  9d64fa59 15c52fca bb0bdff2 97bf0a76&lt;br /&gt;  b449445a 1df00096 21807f1a 82394fc1&lt;br /&gt;  a7d70dd1 d8ff1393 70ee5bef be09b977&lt;br /&gt;  72e7b254 b72ac773 9066200e 51edf87c&lt;br /&gt;  8f2ef412 c62b83cd accb3bc4 4ec06936&lt;br /&gt;  6202ae88 fcaa4208 a64557d3 9abde123&lt;br /&gt;  8d924a11 89746b91 fbfec901 ea1bf7ce&lt;br /&gt;&lt;/pre&gt;It can be easily spotted that the bytes in these tables differ from one another by a fixed offset &lt;b&gt;&lt;i&gt;0x60&lt;/i&gt;&lt;/b&gt; (96 in decimal). For example: &lt;ul&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;0xDD&lt;/i&gt;&lt;/b&gt;(pkwrap_reverse_table[&lt;b&gt;&lt;i&gt;0x00&lt;/i&gt;&lt;/b&gt;]) + &lt;b&gt;&lt;i&gt;0x60&lt;/i&gt;&lt;/b&gt; = &lt;b&gt;&lt;i&gt;0x3D&lt;/i&gt;&lt;/b&gt;(the value of my_reverse_table[&lt;b&gt;&lt;i&gt;0x00&lt;/i&gt;&lt;/b&gt;])&lt;/li&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;0xB7&lt;/i&gt;&lt;/b&gt;(pkwrap_reverse_table[&lt;b&gt;&lt;i&gt;0x1F&lt;/i&gt;&lt;/b&gt;]) + &lt;b&gt;&lt;i&gt;0x60&lt;/i&gt;&lt;/b&gt; = &lt;b&gt;&lt;i&gt;0x17&lt;/i&gt;&lt;/b&gt;(the value of my_reverse_table[&lt;b&gt;&lt;i&gt;0x1F&lt;/i&gt;&lt;/b&gt;])&lt;/li&gt;&lt;/ul&gt;Hence, that could be the way that reverse table is used within Oracle code (I know that it is used in the &lt;b&gt;&lt;i&gt;pkwrap_read_source&lt;/i&gt;&lt;/b&gt; function for sure). &lt;br/&gt;&lt;br/&gt; References:  &lt;ol&gt;&lt;li&gt;&lt;a href="https://www.blackhat.com/presentations/bh-usa-06/BH-US-06-Finnigan.pdf"&gt;How to unwrap PL/SQL by Pete Finnigan&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://macrotoneconsulting.co.uk/images/Documents/unwrap.pdf"&gt;Unwrapping Oracle PLSQL&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://technology.amis.nl/2009/02/03/unwrapping-10g-wrapped-plsql/"&gt;Unwrapping 10G wrapped PL/SQL by Anton Scheffer&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="http://blog.teusink.net/2010/04/unwrapping-oracle-plsql-with-unwrappy.html"&gt;Unwrapping Oracle PL/SQL with unwrap.py by Niels Teusink&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/2683273528777757591/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/09/unwrapping-plsql-systematic-approach.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/2683273528777757591'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/2683273528777757591'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/09/unwrapping-plsql-systematic-approach.html' title='Unwrapping PL/SQL: a Systematic Approach'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-1155641777997770935</id><published>2019-09-06T19:15:00.002+06:00</published><updated>2019-09-06T19:15:26.227+06:00</updated><app:control xmlns:app='http://purl.org/atom/app#'><app:draft>yes</app:draft></app:control><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='re'/><title type='text'>Unwrapping PL/SQL: Making Use of pkwrap_reverse_table</title><content type='html'>The previous article in this series:&lt;br /&gt;&lt;ol&gt;&lt;li&gt;Unwrapping PL/SQL: a Systematic Approach&lt;/li&gt;&lt;/ol&gt;&lt;br /&gt;Going back to &lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt;, let's take a look at both &lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt; and &lt;b&gt;&lt;i&gt;my_reverse_table&lt;/i&gt;&lt;/b&gt;(the one I obtained through &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt; in part 1 of this series) tables together and see if we can find any commonality among them:&lt;br /&gt;1. &lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt; that we do not know how to use yet:&lt;br /&gt;&lt;pre class="brush:sql"&gt;  dd052553 b87b8227 91f24b03 eb5540ff&lt;br /&gt;  1d081b3b c462c807 2a7e44c6 bea38bb7&lt;br /&gt;  0fd4de1a df72490a af89d5f6 bf51edb0&lt;br /&gt;  18791596 5ce1a421 01a6994d 7675c91e&lt;br /&gt;  263e1985 a55a246c 0ec72e50 fd48933f&lt;br /&gt;  70421158 f87dccd8 39ece8a7 f584f32c&lt;br /&gt;  e656cd45 4fd2c2e0 7cf06341 c52b3cb6&lt;br /&gt;  00fc6f9d ac38bc74 d70ddcda d0880cd1&lt;br /&gt;  e795d37a e36883fe b9348c86 4335b480&lt;br /&gt;  3d049af9 b565cf6a 5bab7f92 375faa16&lt;br /&gt;  54e9e4fa bd90a036 c1201fba 22d9ef61&lt;br /&gt;  4777ad71 789fb333 108efb8f 5ea95917&lt;br /&gt;  128752f4 57ca6713 3006c0ae f18d981c&lt;br /&gt;  2fce94b2 66cb236d 4c6bdb64 ee6009d6&lt;br /&gt;  02a24e28 9c4ae2a8 46e5f773 3a5d81c3&lt;br /&gt;  2d32eab1 29140b31 9b9e69a1 8abb976e&lt;br /&gt;&lt;/pre&gt;2. the reverse table that I obtained running my PL/SQL code against &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt;:&lt;br /&gt;&lt;pre class="brush:sql"&gt;  3d6585b3 18dbe287 f152ab63 4bb5a05f&lt;br /&gt;  7d687b9b 24c22867 8adea426 1e03eb17&lt;br /&gt;  6f343e7a 3fd2a96a 0fe93556 1fb14d10&lt;br /&gt;  78d975f6 bc410481 6106f9ad d6d5297e&lt;br /&gt;  869e79e5 05ba84cc 6e278eb0 5da8f39f&lt;br /&gt;  d0a271b8 58dd2c38 994c4807 55e4538c&lt;br /&gt;  46b62da5 af322240 dc50c3a1 258b9c16&lt;br /&gt;  605ccffd 0c981cd4 376d3c3a 30e86c31&lt;br /&gt;  47f533da 43c8e35e 1994ece6 a39514e0&lt;br /&gt;  9d64fa59 15c52fca bb0bdff2 97bf0a76&lt;br /&gt;  b449445a 1df00096 21807f1a 82394fc1&lt;br /&gt;  a7d70dd1 d8ff1393 70ee5bef be09b977&lt;br /&gt;  72e7b254 b72ac773 9066200e 51edf87c&lt;br /&gt;  8f2ef412 c62b83cd accb3bc4 4ec06936&lt;br /&gt;  6202ae88 fcaa4208 a64557d3 9abde123&lt;br /&gt;  8d924a11 89746b91 fbfec901 ea1bf7ce&lt;br /&gt;&lt;/pre&gt;It can be easily spotted that the bytes in these tables differ from one another by a fixed offset &lt;b&gt;&lt;i&gt;0x60&lt;/i&gt;&lt;/b&gt; (96 in decimal).&lt;br /&gt;For example:&lt;br /&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;0xDD&lt;/i&gt;&lt;/b&gt;(pkwrap_reverse_table[&lt;b&gt;&lt;i&gt;0x00&lt;/i&gt;&lt;/b&gt;]) + &lt;b&gt;&lt;i&gt;0x60&lt;/i&gt;&lt;/b&gt; = &lt;b&gt;&lt;i&gt;0x3D&lt;/i&gt;&lt;/b&gt;(the value of my_reverse_table[&lt;b&gt;&lt;i&gt;0x00&lt;/i&gt;&lt;/b&gt;])&lt;/li&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;0xB7&lt;/i&gt;&lt;/b&gt;(pkwrap_reverse_table[&lt;b&gt;&lt;i&gt;0x1F&lt;/i&gt;&lt;/b&gt;]) + &lt;b&gt;&lt;i&gt;0x60&lt;/i&gt;&lt;/b&gt; = &lt;b&gt;&lt;i&gt;0x17&lt;/i&gt;&lt;/b&gt;(the value of my_reverse_table[&lt;b&gt;&lt;i&gt;0x1F&lt;/i&gt;&lt;/b&gt;])&lt;/li&gt;&lt;/ul&gt;Hence, that could be the way that reverse table is used within Oracle code (I know that it is used in the &lt;b&gt;&lt;i&gt;pkwrap_read_source&lt;/i&gt;&lt;/b&gt; function for sure).</content><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/09/unwrapping-plsql-making-use-of.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/1155641777997770935'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/1155641777997770935'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8929260401073132878</id><published>2019-09-06T17:27:00.001+06:00</published><updated>2019-09-06T17:27:50.453+06:00</updated><app:control xmlns:app='http://purl.org/atom/app#'><app:draft>yes</app:draft></app:control><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='re'/><title type='text'>Unwrapping PL/SQL: Wrap Tables</title><content type='html'>The high-level steps of how PL/SQL code appears to be wrapped since 10g on are below:&lt;br /&gt;&lt;ol&gt;&lt;li&gt;The source code is &lt;b&gt;&lt;i&gt;normalized&lt;/i&gt;&lt;/b&gt; (converted to upper-case, comments are removed, etc.)&lt;/li&gt;&lt;li&gt;&lt;a name="step2"&gt;&lt;/a&gt;The normalized code is compressed using zip&lt;/li&gt;&lt;li&gt;&lt;a name="step3"&gt;&lt;/a&gt;The compressed byte stream is obfuscated using a substitution table&lt;/li&gt;&lt;li&gt;Finally, Base64 encoding is applied&lt;/li&gt;&lt;/ol&gt;&lt;br /&gt;If we want to rewind that process and get the unwrapped code, the best we can do is to get the &lt;b&gt;&lt;i&gt;normalized&lt;/i&gt;&lt;/b&gt; code.&lt;br /&gt;Steps 4 (Base64 Encoding) and 2 (ZIP Compression) are reversible, however, the obfuscation step 3 supposedly uses a substitution table which is the secret sauce of Oracle Wrap process.&lt;br /&gt;It is known how to obtain that substitution table using a kind of a brute-force approach, as it was demonstrated in the following links:&lt;br /&gt;&lt;ul&gt;&lt;li&gt;&lt;a href="https://macrotoneconsulting.co.uk/images/Documents/unwrap.pdf"&gt;Unwrapping Oracle PLSQL&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://technology.amis.nl/2009/02/03/unwrapping-10g-wrapped-plsql/"&gt;Unwrapping 10G wrapped PL/SQL by Anton Scheffer&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;Once the substitution table is known, it becomes feasible to write a fully-fledged unwrapper. See for example&lt;br /&gt;&lt;a href="http://blog.teusink.net/2010/04/unwrapping-oracle-plsql-with-unwrappy.html"&gt;Unwrapping Oracle PL/SQL with unwrap.py by Niels Teusink&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;In this blog post, I will show how I discovered that Wrap substitution table by Reverse Engineering Oracle binaries.&lt;br /&gt;&lt;br /&gt;I will be using that code that Anton Scheffer referred to in his &lt;a href="https://technology.amis.nl/wp-content/uploads/file/generate2.txt"&gt;blog post&lt;/a&gt;, namely I need to be able to compress and decompress data in SQL:&lt;br /&gt;&lt;pre class="brush:sql"&gt;create or replace java source named MY_COMPRESS&lt;br /&gt;as&lt;br /&gt;import java.io.*;&lt;br /&gt;import java.util.zip.*;&lt;br /&gt;&lt;br /&gt;public class MY_COMPRESS&lt;br /&gt;{&lt;br /&gt;  public static String Inflate( byte[] src )&lt;br /&gt;  {&lt;br /&gt;    try&lt;br /&gt;    {&lt;br /&gt;      ByteArrayInputStream bis = new ByteArrayInputStream( src );&lt;br /&gt;      InflaterInputStream iis = new InflaterInputStream( bis );&lt;br /&gt;      StringBuffer sb = new StringBuffer();&lt;br /&gt;      for( int c = iis.read(); c != -1; c = iis.read() )&lt;br /&gt;      {&lt;br /&gt;        sb.append( (char) c );&lt;br /&gt;      }&lt;br /&gt;      return sb.toString();&lt;br /&gt;    } catch ( Exception e )&lt;br /&gt;    {&lt;br /&gt;    }&lt;br /&gt;    return null;&lt;br /&gt;  }&lt;br /&gt;  public static byte[] Deflate( String src, int quality )&lt;br /&gt;  {&lt;br /&gt;    try&lt;br /&gt;    {&lt;br /&gt;      byte[] tmp = new byte[ src.length() + 100 ];&lt;br /&gt;      Deflater defl = new Deflater( quality );&lt;br /&gt;      defl.setInput( src.getBytes( "UTF-8" ) );&lt;br /&gt;      defl.finish();&lt;br /&gt;      int cnt = defl.deflate( tmp );&lt;br /&gt;      byte[] res = new byte[ cnt ];&lt;br /&gt;      for( int i = 0; i &lt; cnt; i++ )&lt;br /&gt;        res[i] = tmp[i];&lt;br /&gt;      return res;&lt;br /&gt;    } catch ( Exception e )&lt;br /&gt;    {&lt;br /&gt;    }&lt;br /&gt;    return null;&lt;br /&gt;  }&lt;br /&gt;}&lt;br /&gt;/&lt;br /&gt;&lt;br /&gt;alter java source MY_COMPRESS compile&lt;br /&gt;/&lt;br /&gt;&lt;br /&gt;create or replace package mycompress&lt;br /&gt;is&lt;br /&gt;  function deflate( src in varchar2 )&lt;br /&gt;  return raw;&lt;br /&gt;--&lt;br /&gt;  function deflate( src in varchar2, quality in number )&lt;br /&gt;  return raw;&lt;br /&gt;--&lt;br /&gt;  function inflate( src in raw )&lt;br /&gt;  return varchar2;&lt;br /&gt;--&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;&lt;br /&gt;create or replace package body mycompress&lt;br /&gt;is&lt;br /&gt;  function deflate( src in varchar2 )&lt;br /&gt;  return raw&lt;br /&gt;  is&lt;br /&gt;  begin&lt;br /&gt;    return deflate( src, 6 );&lt;br /&gt;  end;&lt;br /&gt;--&lt;br /&gt;  function deflate( src in varchar2, quality in number )&lt;br /&gt;  return raw&lt;br /&gt;  as language java&lt;br /&gt;  name 'MY_COMPRESS.Deflate( java.lang.String, int ) return byte[]';&lt;br /&gt;--&lt;br /&gt;  function inflate( src in raw )&lt;br /&gt;  return varchar2&lt;br /&gt;  as language java&lt;br /&gt;  name 'MY_COMPRESS.Inflate( byte[] ) return java.lang.String';&lt;br /&gt;--&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;&lt;/pre&gt;Let's now obtain some data for analysis that will be used throughout this post: &lt;pre class="brush:sql"&gt;SQL&gt; with src as (&lt;br /&gt;  2    select 'FUNCTION F RETURN NUMBER IS BEGIN RETURN 1; END;' txt&lt;br /&gt;  3      from dual),&lt;br /&gt;  4  wrap as (&lt;br /&gt;  5    select src.txt,&lt;br /&gt;  6           dbms_ddl.wrap( 'CREATE OR REPLACE ' || src.txt) wrap&lt;br /&gt;  7      from src),&lt;br /&gt;  8  subst as (&lt;br /&gt;  9    select substr(utl_encode.base64_decode(utl_raw.cast_to_raw(rtrim(substr(wrap.wrap, instr(wrap.wrap,&lt;br /&gt; chr(10), 1, 20) + 1), chr(10)))), 41) x,&lt;br /&gt; 10           mycompress.deflate(wrap.txt||chr(0)) d&lt;br /&gt; 11      from wrap)&lt;br /&gt; 12  select to_number(substr(x, r*2 -1,2), 'xx') wrapped,&lt;br /&gt; 13         substr(x, r*2 -1, 2) wrapped_hex,&lt;br /&gt; 14         to_number(substr(d, r*2 -1,2), 'xx') zipped,&lt;br /&gt; 15         substr(d, r*2 -1, 2) zipped_hex&lt;br /&gt; 16    from subst,&lt;br /&gt; 17         (select rownum r from dual connect by rownum &lt;= 10);&lt;br /&gt;&lt;br /&gt;   WRAPPED WRAPPED_HEX     ZIPPED ZIPPED_HEX&lt;br /&gt;---------- ----------- ---------- -----------&lt;br /&gt;        48 30                 120 78&lt;br /&gt;       131 83                 156 9C&lt;br /&gt;       199 C7                 115 73&lt;br /&gt;       153 99                  11 0B&lt;br /&gt;       129 81                 245 F5&lt;br /&gt;       199 C7                 115 73&lt;br /&gt;       203 CB                  14 0E&lt;br /&gt;         8 08                 241 F1&lt;br /&gt;       210 D2                 244 F4&lt;br /&gt;       254 FE                 247 F7&lt;br /&gt;&lt;/pre&gt;The &lt;b&gt;&lt;i&gt;ZIPPED_HEX&lt;/i&gt;&lt;/b&gt; column shows compressed bytes whereas &lt;b&gt;&lt;i&gt;WRAPPED_HEX&lt;/i&gt;&lt;/b&gt; shows the corresponding wrapped byte. A simple brute-force approach can be used to obtain the reverse wrap substitution table to convert a wrapped byte to its corresponding zipped byte. Then, it is just enough to unzip the final byte stream to complete the unwrap exercise.   I was curious how to do the same by using a more systematic approach. For that, I was recording the function calls using DebugTrace from &lt;a href="https://software.intel.com/en-us/articles/pin-a-dynamic-binary-instrumentation-tool"&gt;the Intel Pin Tools&lt;/a&gt; of a session wrapping PL/SQL code. I came across the &lt;b&gt;&lt;i&gt;pkwrap_obfuscate_source&lt;/i&gt;&lt;/b&gt; function: &lt;pre class="brush:sql"&gt;pkwrap_obfuscate_source(0x7feb38878af8, 0x9, ...)&lt;br /&gt;&gt; bam_init(0x7feb38878af8, 0x7ffd567e9d18, ...)&lt;br /&gt;| &gt; kghalp(0x7feb3e4a69a0, 0x7feb3e4abe00, ...)&lt;br /&gt;| | &gt; kghprmalo(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | &gt; kghtshrt(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | &lt; kghtshrt+0x000000000169 returns: 0x40b38f0000000139&lt;br /&gt;| | | &gt; kghfnd_in_free_lists(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | &lt; kghfnd_in_free_lists+0x0000000001d5 returns: 0&lt;br /&gt;| | | &gt; kghfnd(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | | &gt; kghgex(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | | | &gt; kghalo(0x7feb3e4a69a0, 0x7feb3e4ad700, ...)&lt;br /&gt;| | | | | | &gt; kghfnd_in_free_lists(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | | | | &lt; kghfnd_in_free_lists+0x0000000001d5 returns: 0x7feb3e37bc00&lt;br /&gt;| | | | | | &gt; kghbshrt(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | | | | &lt; kghbshrt+0x000000000130 returns: 0x7feb3e37dbc8&lt;br /&gt;| | | | | | &gt; ksmpga_allo_cb(0x7feb3e4a69a0, 0x7feb3e4ad700, ...)&lt;br /&gt;| | | | | | | &gt; ksm_near_pga_limit_pdb(0x1, 0x3, ...)&lt;br /&gt;| | | | | | | &lt; ksm_near_pga_limit_pdb+0x00000000017f returns: 0&lt;br /&gt;| | | | | | &lt; ksmpga_allo_cb+0x0000000006a4 returns: 0&lt;br /&gt;| | | | | &lt; kghalo+0x000000000722 returns: 0x7feb3e37dbe0&lt;br /&gt;| | | | | &gt; kghaddex(0x7feb3e4a69a0, 0, ...)&lt;br /&gt;| | | | | &lt; kghaddex+0x00000000026a returns: 0x7feb3e37dbf0&lt;br /&gt;| | | | &lt; kghgex+0x00000000034e returns: 0x7feb3e37dbf0&lt;br /&gt;| | | &lt; kghfnd+0x00000000018b returns: 0x7feb3e37dbf0&lt;br /&gt;| | &lt; kghprmalo+0x00000000045e returns: 0x7feb3e37dc18&lt;br /&gt;| | &gt; _intel_fast_memset(0x7feb3e37dc18, 0, ...)&lt;br /&gt;| | &lt;&gt; _intel_fast_memset.J(0x7feb3e37dc18, 0, ...)&lt;br /&gt;| | &lt;&gt; __intel_memset(0x7feb3e37dc18, 0, ...)&lt;br /&gt;| | &lt; __intel_memset+0x000000000818 returns: 0x7feb3e37dc18&lt;br /&gt;| &lt; kghalp+0x0000000002d9 returns: 0x7feb3e37dc18&lt;br /&gt;&lt; bam_init+0x000000000105 returns: 0x7ffd567e9d18&lt;br /&gt;&lt;/pre&gt;It is coming from the &lt;b&gt;&lt;i&gt;pkwrap.o&lt;/i&gt;&lt;/b&gt; library within the &lt;b&gt;&lt;i&gt;$ORACLE_HOME/lib/libpls12.a&lt;/i&gt;&lt;/b&gt; archive. There's one especially interesting line in that file: &lt;pre class="brush:sql;highlight:[17]"&gt;$ objdump -dzr pkwrap.o&lt;br /&gt;&lt;br /&gt;    4ecd:       ff c3                   inc    %ebx&lt;br /&gt;    4ecf:       89 d8                   mov    %ebx,%eax&lt;br /&gt;    4ed1:       83 fb 14                cmp    $0x14,%ebx&lt;br /&gt;    4ed4:       72 de                   jb     4eb4 &amp;lt;pkwrap_obfuscate_source+0x194&gt;&lt;br /&gt;    4ed6:       48 8b 55 c8             mov    -0x38(%rbp),%rdx&lt;br /&gt;    4eda:       33 c9                   xor    %ecx,%ecx&lt;br /&gt;    4edc:       48 8b 45 e0             mov    -0x20(%rbp),%rax&lt;br /&gt;    4ee0:       48 85 c0                test   %rax,%rax&lt;br /&gt;    4ee3:       48 89 55 d0             mov    %rdx,-0x30(%rbp)&lt;br /&gt;    4ee7:       76 27                   jbe    4f10 &amp;lt;pkwrap_obfuscate_source+0x1f0&gt;&lt;br /&gt;    4ee9:       0f b6 04 0a             movzbl (%rdx,%rcx,1),%eax&lt;br /&gt;    4eed:       48 83 c0 a0             add    $0xffffffffffffffa0,%rax&lt;br /&gt;    4ef1:       0f b6 d8                movzbl %al,%ebx&lt;br /&gt;    4ef4:       44 8a 83 00 00 00 00    mov    0x0(%rbx),%r8b&lt;br /&gt;                        4ef7: R_X86_64_32S      pkwrap_forward_table&lt;br /&gt;&lt;/pre&gt;&lt;b&gt;&lt;i&gt;R_X86_64_32S&lt;/i&gt;&lt;/b&gt; is one of relocation types as it is defined in &lt;a href="http://refspecs.linuxbase.org/elf/x86_64-abi-0.98.pdf"&gt;System V Application Binary Interface&lt;/a&gt;. Here's how to get that table: &lt;pre class="brush:sql;highlight:[26,30]"&gt;$ readelf --syms pkwrap.o&lt;br /&gt;&lt;br /&gt;Symbol table '.symtab' contains 94 entries:&lt;br /&gt;   Num:    Value          Size Type    Bind   Vis      Ndx Name&lt;br /&gt;     0: 0000000000000000     0 NOTYPE  LOCAL  DEFAULT  UND&lt;br /&gt;     1: 0000000000000000     0 FILE    LOCAL  DEFAULT  ABS pkwrap.c&lt;br /&gt;     2: 0000000000000000     0 SECTION LOCAL  DEFAULT    2&lt;br /&gt;     3: 0000000000000000     0 SECTION LOCAL  DEFAULT    3&lt;br /&gt;     4: 0000000000000000     0 SECTION LOCAL  DEFAULT    4&lt;br /&gt;     5: 0000000000000000     0 SECTION LOCAL  DEFAULT    5&lt;br /&gt;     6: 0000000000000000     0 SECTION LOCAL  DEFAULT    6&lt;br /&gt;     7: 0000000000000010    80 FUNC    LOCAL  DEFAULT    6 pkwrap_skip_white_space&lt;br /&gt;     8: 0000000000000060   304 FUNC    LOCAL  DEFAULT    6 pkwrap_read_hex&lt;br /&gt;     9: 0000000000000000     0 SECTION LOCAL  DEFAULT    7&lt;br /&gt;    10: 0000000000000190   272 FUNC    LOCAL  DEFAULT    6 pkwrap_read_hex_multi&lt;br /&gt;    11: 00000000000002a0  3440 FUNC    LOCAL  DEFAULT    6 pkwrap_read_string&lt;br /&gt;    12: 0000000000001010   896 FUNC    LOCAL  DEFAULT    6 pkwrap_read_string_paro&lt;br /&gt;    13: 0000000000001390   192 FUNC    LOCAL  DEFAULT    6 pkwrap_read_number&lt;br /&gt;    14: 0000000000001450   416 FUNC    LOCAL  DEFAULT    6 pkwrap_read_number_paro&lt;br /&gt;    15: 00000000000015f0   400 FUNC    LOCAL  DEFAULT    6 pkwrap_2_to_4&lt;br /&gt;    16: 0000000000001780   384 FUNC    LOCAL  DEFAULT    6 pkwrap_4_to_8&lt;br /&gt;    17: 0000000000001900   976 FUNC    LOCAL  DEFAULT    6 pkwrap_read_ub_paro&lt;br /&gt;    18: 0000000000001cd0   736 FUNC    LOCAL  DEFAULT    6 pkwrap_read_symtab&lt;br /&gt;    19: 0000000000001fb0  1728 FUNC    LOCAL  DEFAULT    6 pkwrap_read_source&lt;br /&gt;    20: 0000000000000000     0 SECTION LOCAL  DEFAULT    8&lt;br /&gt;    21: 0000000000000080   256 OBJECT  LOCAL  DEFAULT    8 pkwrap_reverse_table&lt;br /&gt;    22: 0000000000003cc0  4192 FUNC    LOCAL  DEFAULT    6 pkwrap_is_plsql&lt;br /&gt;    23: 0000000000000000     0 SECTION LOCAL  DEFAULT    9&lt;br /&gt;    24: 0000000000004d20  1072 FUNC    LOCAL  DEFAULT    6 pkwrap_obfuscate_source&lt;br /&gt;    25: 0000000000000180   256 OBJECT  LOCAL  DEFAULT    8 pkwrap_forward_table&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Those tables are coming from section 8 and start at addresses &lt;tt&gt;0x00000080&lt;/tt&gt; (&lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt;) and &lt;tt&gt;0x00000180&lt;/tt&gt; (&lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt;). The aforementioned section can be seen as follows: &lt;pre class="brush:sql;highlight:[13,29]"&gt;$readelf --hex-dump=8 pkwrap.o&lt;br /&gt;&lt;br /&gt;Hex dump of section '.rodata':&lt;br /&gt; NOTE: This section has relocations against it, but these have NOT been applied to this dump.&lt;br /&gt;  0x00000000 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000010 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000020 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000030 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000040 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000050 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000060 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000070 00000000 00000000 00000000 00000000 ................&lt;br /&gt;  0x00000080 dd052553 b87b8227 91f24b03 eb5540ff ..%S.{.'..K..U@.&lt;br /&gt;  0x00000090 1d081b3b c462c807 2a7e44c6 bea38bb7 ...;.b..*~D.....&lt;br /&gt;  0x000000a0 0fd4de1a df72490a af89d5f6 bf51edb0 .....rI......Q..&lt;br /&gt;  0x000000b0 18791596 5ce1a421 01a6994d 7675c91e .y..\..!...Mvu..&lt;br /&gt;  0x000000c0 263e1985 a55a246c 0ec72e50 fd48933f &amp;&gt;...Z$l...P.H.?&lt;br /&gt;  0x000000d0 70421158 f87dccd8 39ece8a7 f584f32c pB.X.}..9......,&lt;br /&gt;  0x000000e0 e656cd45 4fd2c2e0 7cf06341 c52b3cb6 .V.EO...|.cA.+&lt;.&lt;br /&gt;  0x000000f0 00fc6f9d ac38bc74 d70ddcda d0880cd1 ..o..8.t........&lt;br /&gt;  0x00000100 e795d37a e36883fe b9348c86 4335b480 ...z.h...4..C5..&lt;br /&gt;  0x00000110 3d049af9 b565cf6a 5bab7f92 375faa16 =....e.j[...7_..&lt;br /&gt;  0x00000120 54e9e4fa bd90a036 c1201fba 22d9ef61 T......6. .."..a&lt;br /&gt;  0x00000130 4777ad71 789fb333 108efb8f 5ea95917 Gw.qx..3....^.Y.&lt;br /&gt;  0x00000140 128752f4 57ca6713 3006c0ae f18d981c ..R.W.g.0.......&lt;br /&gt;  0x00000150 2fce94b2 66cb236d 4c6bdb64 ee6009d6 /...f.#mLk.d.`..&lt;br /&gt;  0x00000160 02a24e28 9c4ae2a8 46e5f773 3a5d81c3 ..N(.J..F..s:]..&lt;br /&gt;  0x00000170 2d32eab1 29140b31 9b9e69a1 8abb976e -2..)..1..i....n&lt;br /&gt;  0x00000180 7038e00b 9101c917 11de27f6 7e794820 p8........'.~yH&lt;br /&gt;  0x00000190 b852c0c7 f5329fbf 30422312 cf103faa .R...2..0B#...?.&lt;br /&gt;  0x000001a0 a937acd6 46024007 e3f4186d 5ff04ad0 .7..F.@....m_.J.&lt;br /&gt;  0x000001b0 c8f7f1b7 898da79c 7558ec13 6e90414f ........uX..n.AO&lt;br /&gt;  0x000001c0 0e6b518c 1a63e8b0 4d26e50a d83be264 .kQ..c..M&amp;...;.d&lt;br /&gt;  0x000001d0 4b2dc203 a00d61c4 53be4598 34edbc9d K-....a.S.E.4...&lt;br /&gt;  0x000001e0 ddaf156a db95d4c6 85fa97d9 47d7ff72 ...j........G..r&lt;br /&gt;  0x000001f0 50b325eb 773d3cb1 b4318305 6855199a P.%.w=&lt;..1..hU..&lt;br /&gt;  0x00000200 8fee0686 5d438bc1 7d29fc1e 8acdb9bb ....]C..})......&lt;br /&gt;  0x00000210 a5089b4e d28133fe ce3a92f8 e473f9b5 ...N..3..:...s..&lt;br /&gt;  0x00000220 a6fbe11d 3644395b e7bd9e99 74b2cb28 ....6D9[....t..(&lt;br /&gt;  0x00000230 2ff3d3b6 8e946f1f 0488abfd 76a41c2c /.....o.....v..,&lt;br /&gt;  0x00000240 caa866ef 146c1b49 163ec5d5 5662d196 ..f..l.I.&gt;..Vb..&lt;br /&gt;  0x00000250 7c7f6582 212adf78 57ad7bda 7a002224 |.e.!*.xW.{.z."$&lt;br /&gt;  0x00000260 6735e684 a2e96080 5aa1f20c 592edcae g5....`.Z...Y...&lt;br /&gt;  0x00000270 69cc095e c35c2bea 5493a3ba 714c870f i..^.\+.T...qL..&lt;br /&gt;  0x00000280 9a999999 9999f13f 00000000 00002840 .......?......(@&lt;br /&gt;  0x00000290 00000000 00003440 66666666 6666f63f ......4@ffffff.?&lt;br /&gt;  0x000002a0 00000000 0000e043 0000005f 00000000 .......C..._....&lt;br /&gt;  0x000002b0 00000000 00000000 00000000 00000000 ................&lt;br /&gt;&lt;/pre&gt;Judging by their names: &lt;ul&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt; should be applied at &lt;a href="#step3"&gt;step 3&lt;/a&gt; when the zipped byte stream is converted using the substitution table.&lt;/li&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt; can be used to reverse that step.&lt;/li&gt;&lt;/ul&gt;Initially, I could not find out how both of those tables are used.  Then, while I was studying the &lt;b&gt;&lt;i&gt;pkwrap_obfuscate_source&lt;/i&gt;&lt;/b&gt; procedure in &lt;a href="https://ghidra-sre.org/"&gt;Ghidra&lt;/a&gt;, I found a block of code that seemed quite promising: &lt;pre class="brush:sql;highlight:[4]"&gt;if (CONCAT44(uStack36,local_28) != 0) {&lt;br /&gt;    do {&lt;br /&gt;      *(undefined *)(local_40 + uVar7) =&lt;br /&gt;           pkwrap_forward_table[(ulong)(byte)(*(char *)(local_40 + uVar7) + 0xa0)];&lt;br /&gt;      uVar7 = (ulong)((int)uVar7 + 1);&lt;br /&gt;    } while (uVar7 &lt; CONCAT44(uStack36,local_28));&lt;br /&gt;  }&lt;br /&gt;&lt;/pre&gt;The important part here is how that table is accessed - there is &lt;b&gt;&lt;i&gt;0xA0&lt;/i&gt;&lt;/b&gt; which is 160 in decimal. Let's just try to lookup those zipped bytes against &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt; by adding that offset &lt;b&gt;&lt;i&gt;0xA0&lt;/i&gt;&lt;/b&gt; to them: &lt;pre class="brush:sql"&gt;SQL&gt; with src as (&lt;br /&gt;  2    select 'FUNCTION F RETURN NUMBER IS BEGIN RETURN 1; END;' txt&lt;br /&gt;  3      from dual),&lt;br /&gt;  4  wrap as (&lt;br /&gt;  5    select src.txt,&lt;br /&gt;  6           dbms_ddl.wrap( 'CREATE OR REPLACE ' || src.txt) wrap&lt;br /&gt;  7      from src),&lt;br /&gt;  8  subst as (&lt;br /&gt;  9    select substr(utl_encode.base64_decode(utl_raw.cast_to_raw(rtrim(substr(wrap.wrap, instr(wrap.wrap,&lt;br /&gt; chr(10), 1, 20) + 1), chr(10)))), 41) x,&lt;br /&gt; 10           mycompress.deflate(wrap.txt||chr(0)) d&lt;br /&gt; 11      from wrap)&lt;br /&gt; 12  select to_number(substr(x, r*2 -1,2), 'xx') wrapped,&lt;br /&gt; 13         substr(x, r*2 -1, 2) wrapped_hex,&lt;br /&gt; 14         to_number(substr(d, r*2 -1,2), 'xx') zipped,&lt;br /&gt; 15         substr(d, r*2 -1, 2) zipped_hex&lt;br /&gt; 16    from subst,&lt;br /&gt; 17         (select rownum r from dual connect by rownum &lt;= 10);&lt;br /&gt;&lt;br /&gt;   WRAPPED WRAPPED_HEX     ZIPPED ZIPPED_HEX&lt;br /&gt;---------- ----------- ---------- -----------&lt;br /&gt;        48 30                 120 78&lt;br /&gt;       131 83                 156 9C&lt;br /&gt;       199 C7                 115 73&lt;br /&gt;       153 99                  11 0B&lt;br /&gt;       129 81                 245 F5&lt;br /&gt;       199 C7                 115 73&lt;br /&gt;       203 CB                  14 0E&lt;br /&gt;         8 08                 241 F1&lt;br /&gt;       210 D2                 244 F4&lt;br /&gt;       254 FE                 247 F7&lt;br /&gt;&lt;/pre&gt;I got the following table: &lt;style type="text/css"&gt;th.awrbg {     font: bold 8pt Arial,Helvetica,Geneva,sans-serif;     color: White;     background: #0066CC;     padding-left: 4px;     padding-right: 4px;     padding-bottom: 2px; } td.awrc {     font: 8pt Arial,Helvetica,Geneva,sans-serif;     color: black;     background: #FFFFCC;     vertical-align: top; } td.awrnc {     font: 8pt Arial,Helvetica,Geneva,sans-serif;     color: black;     background: White;     vertical-align: top; }  td.error {     color: red; } &lt;/style&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th class="awrbg"&gt;WRAPPED_HEX&lt;/th&gt;&lt;th class="awrbg"&gt;ZIPPED_HEX&lt;/th&gt;&lt;th class="awrbg"&gt;MOD(ZIPPED_HEX+0xA0,0x100)&lt;/th&gt;&lt;th class="awrbg"&gt;PKWRAP_FORWARD_TABLE(MOD(ZIPPED_HEX+0xA0,0x100))&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc"&gt;0x30&lt;/td&gt;&lt;td class="awrc"&gt;0x78&lt;/td&gt;&lt;td class="awrc"&gt;0x18&lt;/td&gt;&lt;td class="awrc"&gt;0x30&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrnc"&gt;0x83&lt;/td&gt;&lt;td class="awrnc"&gt;0x9C&lt;/td&gt;&lt;td class="awrnc"&gt;0x3C&lt;/td&gt;&lt;td class="awrnc error"&gt;0x6E&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc"&gt;0xC7&lt;/td&gt;&lt;td class="awrc"&gt;0x78&lt;/td&gt;&lt;td class="awrc"&gt;0x73&lt;/td&gt;&lt;td class="awrc"&gt;0xC7&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrnc"&gt;0x99&lt;/td&gt;&lt;td class="awrnc"&gt;0x0B&lt;/td&gt;&lt;td class="awrnc"&gt;0xAB&lt;/td&gt;&lt;td class="awrnc"&gt;0x99&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc"&gt;0x81&lt;/td&gt;&lt;td class="awrc"&gt;0xF5&lt;/td&gt;&lt;td class="awrc"&gt;0x95&lt;/td&gt;&lt;td class="awrc"&gt;0x81&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrnc"&gt;0xC7&lt;/td&gt;&lt;td class="awrnc"&gt;0x78&lt;/td&gt;&lt;td class="awrnc"&gt;0x73&lt;/td&gt;&lt;td class="awrnc"&gt;0xC7&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc"&gt;0xCB&lt;/td&gt;&lt;td class="awrc"&gt;0x0E&lt;/td&gt;&lt;td class="awrc"&gt;0xAE&lt;/td&gt;&lt;td class="awrc"&gt;0xCB&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrnc"&gt;0x08&lt;/td&gt;&lt;td class="awrnc"&gt;0xF1&lt;/td&gt;&lt;td class="awrnc"&gt;0x91&lt;/td&gt;&lt;td class="awrnc"&gt;0x08&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrc"&gt;0xD2&lt;/td&gt;&lt;td class="awrc"&gt;0xF4&lt;/td&gt;&lt;td class="awrc"&gt;0x94&lt;/td&gt;&lt;td class="awrc"&gt;0xD2&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="awrnc"&gt;0xFE&lt;/td&gt;&lt;td class="awrnc"&gt;0xF7&lt;/td&gt;&lt;td class="awrnc"&gt;0x97&lt;/td&gt;&lt;td class="awrnc"&gt;0xFE&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt; &lt;/table&gt;Let me explain how the right most column is obtained. I will take the last row for this example. The wrapped byte is &lt;b&gt;&lt;i&gt;0xFE&lt;/i&gt;&lt;/b&gt;, its corresponding zipped byte is &lt;b&gt;&lt;i&gt;0xF7&lt;/i&gt;&lt;/b&gt;. &lt;tt&gt;MOD(0xF7 + 0xA0, 0x100)=0x97&lt;/tt&gt;. The relevant entry from &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt; at index &lt;b&gt;&lt;i&gt;0x97&lt;/i&gt;&lt;/b&gt; is &lt;b&gt;&lt;i&gt;0xFE&lt;/i&gt;&lt;/b&gt; (the same as the wrapped byte): &lt;pre class="brush:sql;highlight:[10]"&gt;0x00000180 7038e00b 9101c917 11de27f6 7e794820 p8........'.~yH&lt;br /&gt;  0x00000190 b852c0c7 f5329fbf 30422312 cf103faa .R...2..0B#...?.&lt;br /&gt;  0x000001a0 a937acd6 46024007 e3f4186d 5ff04ad0 .7..F.@....m_.J.&lt;br /&gt;  0x000001b0 c8f7f1b7 898da79c 7558ec13 6e90414f ........uX..n.AO&lt;br /&gt;  0x000001c0 0e6b518c 1a63e8b0 4d26e50a d83be264 .kQ..c..M&amp;...;.d&lt;br /&gt;  0x000001d0 4b2dc203 a00d61c4 53be4598 34edbc9d K-....a.S.E.4...&lt;br /&gt;  0x000001e0 ddaf156a db95d4c6 85fa97d9 47d7ff72 ...j........G..r&lt;br /&gt;  0x000001f0 50b325eb 773d3cb1 b4318305 6855199a P.%.w=&lt;..1..hU..&lt;br /&gt;  0x00000200 8fee0686 5d438bc1 7d29fc1e 8acdb9bb ....]C..})......&lt;br /&gt;  0x00000210 a5089b4e d28133fe ce3a92f8 e473f9b5 ...N..3..:...s..&lt;br /&gt;  0x00000220 a6fbe11d 3644395b e7bd9e99 74b2cb28 ....6D9[....t..(&lt;br /&gt;  0x00000230 2ff3d3b6 8e946f1f 0488abfd 76a41c2c /.....o.....v..,&lt;br /&gt;  0x00000240 caa866ef 146c1b49 163ec5d5 5662d196 ..f..l.I.&gt;..Vb..&lt;br /&gt;  0x00000250 7c7f6582 212adf78 57ad7bda 7a002224 |.e.!*.xW.{.z."$&lt;br /&gt;  0x00000260 6735e684 a2e96080 5aa1f20c 592edcae g5....`.Z...Y...&lt;br /&gt;  0x00000270 69cc095e c35c2bea 5493a3ba 714c870f i..^.\+.T...qL..&lt;br /&gt;&lt;/pre&gt;&lt;b&gt;&lt;i&gt;Note&lt;/i&gt;&lt;/b&gt;: I have no explanation right now why there is a discrepancy in the second line.  As it has been shown &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt; can be used to convert compressed byte stream to wrapped bytes, it is now possible to obtain the reverse table that can be used to unwrap stored PL/SQL code (the secret sauce of the Oracle Wrap process that is known to be obtained using a brute-force algorithm): &lt;pre class="brush:sql"&gt;SQL&gt; declare&lt;br /&gt;  2    v_forward_table raw(256) :=&lt;br /&gt;  3      hextoraw('7038e00b9101c91711de27f67e794820'||&lt;br /&gt;  4               'b852c0c7f5329fbf30422312cf103faa'||&lt;br /&gt;  5               'a937acd646024007e3f4186d5ff04ad0'||&lt;br /&gt;  6               'c8f7f1b7898da79c7558ec136e90414f'||&lt;br /&gt;  7               '0e6b518c1a63e8b04d26e50ad83be264'||&lt;br /&gt;  8               '4b2dc203a00d61c453be459834edbc9d'||&lt;br /&gt;  9               'ddaf156adb95d4c685fa97d947d7ff72'||&lt;br /&gt; 10               '50b325eb773d3cb1b43183056855199a'||&lt;br /&gt; 11               '8fee06865d438bc17d29fc1e8acdb9bb'||&lt;br /&gt; 12               'a5089b4ed28133fece3a92f8e473f9b5'||&lt;br /&gt; 13               'a6fbe11d3644395be7bd9e9974b2cb28'||&lt;br /&gt; 14               '2ff3d3b68e946f1f0488abfd76a41c2c'||&lt;br /&gt; 15               'caa866ef146c1b49163ec5d55662d196'||&lt;br /&gt; 16               '7c7f6582212adf7857ad7bda7a002224'||&lt;br /&gt; 17               '6735e684a2e960805aa1f20c592edcae'||&lt;br /&gt; 18               '69cc095ec35c2bea5493a3ba714c870f');&lt;br /&gt; 19    type wrap_table_type is table of raw(1) index by pls_integer;&lt;br /&gt; 20    v_reverse_table wrap_table_type;&lt;br /&gt; 21    procedure populate_reverse_table&lt;br /&gt; 22    is&lt;br /&gt; 23      v_byte raw(1);&lt;br /&gt; 24      v_index pls_integer;&lt;br /&gt; 25    begin&lt;br /&gt; 26      for i in 0..255&lt;br /&gt; 27      loop&lt;br /&gt; 28        v_index := i;&lt;br /&gt; 29        v_byte := utl_raw.substr(v_forward_table, v_index + 1, 1);&lt;br /&gt; 30        v_reverse_table(to_number(rawtohex(v_byte),'XX')):=hextoraw(to_char(mod(v_index - 160 + 256, 25&lt;br /&gt;6), 'fm0X'));&lt;br /&gt; 31      end loop;&lt;br /&gt; 32    end populate_reverse_table;&lt;br /&gt; 33    procedure print_reverse_table&lt;br /&gt; 34    is&lt;br /&gt; 35    begin&lt;br /&gt; 36      for i in 0..255&lt;br /&gt; 37      loop&lt;br /&gt; 38        if mod(i,16)=0&lt;br /&gt; 39        then&lt;br /&gt; 40          dbms_output.new_line();&lt;br /&gt; 41        end if;&lt;br /&gt; 42        dbms_output.put(lower(rawtohex(v_reverse_table(i))));&lt;br /&gt; 43      end loop;&lt;br /&gt; 44      dbms_output.new_line();&lt;br /&gt; 45    end print_reverse_table;&lt;br /&gt; 46  begin&lt;br /&gt; 47    populate_reverse_table();&lt;br /&gt; 48    print_reverse_table();&lt;br /&gt; 49  end;&lt;br /&gt; 50  /&lt;br /&gt;3d6585b318dbe287f152ab634bb5a05f&lt;br /&gt;7d687b9b24c228678adea4261e03eb17&lt;br /&gt;6f343e7a3fd2a96a0fe935561fb14d10&lt;br /&gt;78d975f6bc4104816106f9add6d5297e&lt;br /&gt;869e79e505ba84cc6e278eb05da8f39f&lt;br /&gt;d0a271b858dd2c38994c480755e4538c&lt;br /&gt;46b62da5af322240dc50c3a1258b9c16&lt;br /&gt;605ccffd0c981cd4376d3c3a30e86c31&lt;br /&gt;47f533da43c8e35e1994ece6a39514e0&lt;br /&gt;9d64fa5915c52fcabb0bdff297bf0a76&lt;br /&gt;b449445a1df0009621807f1a82394fc1&lt;br /&gt;a7d70dd1d8ff139370ee5befbe09b977&lt;br /&gt;72e7b254b72ac7739066200e51edf87c&lt;br /&gt;8f2ef412c62b83cdaccb3bc44ec06936&lt;br /&gt;6202ae88fcaa4208a64557d39abde123&lt;br /&gt;8d924a1189746b91fbfec901ea1bf7ce&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;Now I can try to rewrap a sample piece of code using that substitution table: &lt;pre class="brush:sql"&gt;SQL&gt; with src as (&lt;br /&gt;  2    select q'!package body test_pkg&lt;br /&gt;  3  is&lt;br /&gt;  4  procedure p1&lt;br /&gt;  5  is&lt;br /&gt;  6     v_local_var pls_integer := 10;&lt;br /&gt;  7  begin&lt;br /&gt;  8    dbms_output.put_line(123);&lt;br /&gt;  9  end;&lt;br /&gt; 10  function f1 return varchar2&lt;br /&gt; 11  is&lt;br /&gt; 12    /* code comment*/&lt;br /&gt; 13  begin&lt;br /&gt; 14    return 'string';&lt;br /&gt; 15  end;&lt;br /&gt; 16  end;!' txt&lt;br /&gt; 17      from dual),&lt;br /&gt; 18    wrap as (&lt;br /&gt; 19      select dbms_ddl.wrap( 'create ' || src.txt ) wrap&lt;br /&gt; 20        from src),&lt;br /&gt; 21    base64_dcd as(&lt;br /&gt; 22      select substr( utl_encode.base64_decode( utl_raw.cast_to_raw(rtrim( substr( wrap.wrap, instr( wra&lt;br /&gt;p.wrap, chr( 10 ), 1, 20 ) + 1 ), chr(10) )  ) ), 41 ) x&lt;br /&gt; 23        from wrap),&lt;br /&gt; 24    subst as (&lt;br /&gt; 25      select utl_raw.translate( x,&lt;br /&gt; 26               hextoraw('000102030405060708090A0B0C0D0E0F' ||&lt;br /&gt; 27                        '101112131415161718191A1B1C1D1E1F' ||&lt;br /&gt; 28                        '202122232425262728292A2B2C2D2E2F' ||&lt;br /&gt; 29                        '303132333435363738393A3B3C3D3E3F' ||&lt;br /&gt; 30                        '404142434445464748494A4B4C4D4E4F' ||&lt;br /&gt; 31                        '505152535455565758595A5B5C5D5E5F' ||&lt;br /&gt; 32                        '606162636465666768696A6B6C6D6E6F' ||&lt;br /&gt; 33                        '707172737475767778797A7B7C7D7E7F' ||&lt;br /&gt; 34                        '808182838485868788898A8B8C8D8E8F' ||&lt;br /&gt; 35                        '909192939495969798999A9B9C9D9E9F' ||&lt;br /&gt; 36                        'A0A1A2A3A4A5A6A7A8A9AAABACADAEAF' ||&lt;br /&gt; 37                        'B0B1B2B3B4B5B6B7B8B9BABBBCBDBEBF' ||&lt;br /&gt; 38                        'C0C1C2C3C4C5C6C7C8C9CACBCCCDCECF' ||&lt;br /&gt; 39                        'D0D1D2D3D4D5D6D7D8D9DADBDCDDDEDF' ||&lt;br /&gt; 40                        'E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF' ||&lt;br /&gt; 41                        'F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF'),&lt;br /&gt; 42               hextoraw('3D6585B318DBE287F152AB634BB5A05F' ||&lt;br /&gt; 43                        '7D687B9B24C228678ADEA4261E03EB17' ||&lt;br /&gt; 44                        '6F343E7A3FD2A96A0FE935561FB14D10' ||&lt;br /&gt; 45                        '78D975F6BC4104816106F9ADD6D5297E' ||&lt;br /&gt; 46                        '869E79E505BA84CC6E278EB05DA8F39F' ||&lt;br /&gt; 47                        'D0A271B858DD2C38994C480755E4538C' ||&lt;br /&gt; 48                        '46B62DA5AF322240DC50C3A1258B9C16' ||&lt;br /&gt; 49                        '605CCFFD0C981CD4376D3C3A30E86C31' ||&lt;br /&gt; 50                        '47F533DA43C8E35E1994ECE6A39514E0' ||&lt;br /&gt; 51                        '9D64FA5915C52FCABB0BDFF297BF0A76' ||&lt;br /&gt; 52                        'B449445A1DF0009621807F1A82394FC1' ||&lt;br /&gt; 53                        'A7D70DD1D8FF139370EE5BEFBE09B977' ||&lt;br /&gt; 54                        '72E7B254B72AC7739066200E51EDF87C' ||&lt;br /&gt; 55                        '8F2EF412C62B83CDACCB3BC44EC06936' ||&lt;br /&gt; 56                        '6202AE88FCAA4208A64557D39ABDE123' ||&lt;br /&gt; 57                        '8D924A1189746B91FBFEC901EA1BF7CE')) s&lt;br /&gt; 58      from base64_dcd)&lt;br /&gt; 59  select mycompress.inflate( s ) unwrapped_code&lt;br /&gt; 60    from subst&lt;br /&gt; 61  /&lt;br /&gt;&lt;br /&gt;UNWRAPPED_CODE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;PACKAGE BODY test_pkg&lt;br /&gt;IS&lt;br /&gt;PROCEDURE P1&lt;br /&gt;IS&lt;br /&gt;   V_LOCAL_VAR PLS_INTEGER := 10;&lt;br /&gt;BEGIN&lt;br /&gt;  DBMS_OUTPUT.PUT_LINE(123);&lt;br /&gt;END;&lt;br /&gt;FUNCTION F1 RETURN VARCHAR2&lt;br /&gt;IS&lt;br /&gt;&lt;br /&gt;BEGIN&lt;br /&gt;  RETURN 'string';&lt;br /&gt;END;&lt;br /&gt;END;&lt;br /&gt;&lt;/pre&gt;Therefore, it has been demonstrated that the reverse table obtained with a help of &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt; can be used to unwrap this sample piece of PL/SQL code.   Going back to &lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt;, let's take a look at both &lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt; and &lt;b&gt;&lt;i&gt;my_reverse_table&lt;/i&gt;&lt;/b&gt;(the one I obtained through &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt;) tables together and see if we can find any commonality among them: 1. &lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt; that we do not know how to use yet: &lt;pre class="brush:sql"&gt;dd052553 b87b8227 91f24b03 eb5540ff&lt;br /&gt;  1d081b3b c462c807 2a7e44c6 bea38bb7&lt;br /&gt;  0fd4de1a df72490a af89d5f6 bf51edb0&lt;br /&gt;  18791596 5ce1a421 01a6994d 7675c91e&lt;br /&gt;  263e1985 a55a246c 0ec72e50 fd48933f&lt;br /&gt;  70421158 f87dccd8 39ece8a7 f584f32c&lt;br /&gt;  e656cd45 4fd2c2e0 7cf06341 c52b3cb6&lt;br /&gt;  00fc6f9d ac38bc74 d70ddcda d0880cd1&lt;br /&gt;  e795d37a e36883fe b9348c86 4335b480&lt;br /&gt;  3d049af9 b565cf6a 5bab7f92 375faa16&lt;br /&gt;  54e9e4fa bd90a036 c1201fba 22d9ef61&lt;br /&gt;  4777ad71 789fb333 108efb8f 5ea95917&lt;br /&gt;  128752f4 57ca6713 3006c0ae f18d981c&lt;br /&gt;  2fce94b2 66cb236d 4c6bdb64 ee6009d6&lt;br /&gt;  02a24e28 9c4ae2a8 46e5f773 3a5d81c3&lt;br /&gt;  2d32eab1 29140b31 9b9e69a1 8abb976e&lt;br /&gt;&lt;/pre&gt;2. the reverse table that I obtained running my PL/SQL code against &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt;: &lt;pre class="brush:sql"&gt;3d6585b3 18dbe287 f152ab63 4bb5a05f&lt;br /&gt;  7d687b9b 24c22867 8adea426 1e03eb17&lt;br /&gt;  6f343e7a 3fd2a96a 0fe93556 1fb14d10&lt;br /&gt;  78d975f6 bc410481 6106f9ad d6d5297e&lt;br /&gt;  869e79e5 05ba84cc 6e278eb0 5da8f39f&lt;br /&gt;  d0a271b8 58dd2c38 994c4807 55e4538c&lt;br /&gt;  46b62da5 af322240 dc50c3a1 258b9c16&lt;br /&gt;  605ccffd 0c981cd4 376d3c3a 30e86c31&lt;br /&gt;  47f533da 43c8e35e 1994ece6 a39514e0&lt;br /&gt;  9d64fa59 15c52fca bb0bdff2 97bf0a76&lt;br /&gt;  b449445a 1df00096 21807f1a 82394fc1&lt;br /&gt;  a7d70dd1 d8ff1393 70ee5bef be09b977&lt;br /&gt;  72e7b254 b72ac773 9066200e 51edf87c&lt;br /&gt;  8f2ef412 c62b83cd accb3bc4 4ec06936&lt;br /&gt;  6202ae88 fcaa4208 a64557d3 9abde123&lt;br /&gt;  8d924a11 89746b91 fbfec901 ea1bf7ce&lt;br /&gt;&lt;/pre&gt;It can be easily spotted that the bytes in these tables differ from one another by a fixed offset &lt;b&gt;&lt;i&gt;0x60&lt;/i&gt;&lt;/b&gt; (96 in decimal). For example: &lt;ul&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;0xDD&lt;/i&gt;&lt;/b&gt;(pkwrap_reverse_table[&lt;b&gt;&lt;i&gt;0x00&lt;/i&gt;&lt;/b&gt;]) + &lt;b&gt;&lt;i&gt;0x60&lt;/i&gt;&lt;/b&gt; = &lt;b&gt;&lt;i&gt;0x3D&lt;/i&gt;&lt;/b&gt;(the value of my_reverse_table[&lt;b&gt;&lt;i&gt;0x00&lt;/i&gt;&lt;/b&gt;])&lt;/li&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;0xB7&lt;/i&gt;&lt;/b&gt;(pkwrap_reverse_table[&lt;b&gt;&lt;i&gt;0x1F&lt;/i&gt;&lt;/b&gt;]) + &lt;b&gt;&lt;i&gt;0x60&lt;/i&gt;&lt;/b&gt; = &lt;b&gt;&lt;i&gt;0x17&lt;/i&gt;&lt;/b&gt;(the value of my_reverse_table[&lt;b&gt;&lt;i&gt;0x1F&lt;/i&gt;&lt;/b&gt;])&lt;/li&gt;&lt;/ul&gt;Hence, that could be the way that reverse table is used within Oracle code (I know that it is used in the &lt;b&gt;&lt;i&gt;pkwrap_read_source&lt;/i&gt;&lt;/b&gt; function for sure).   As a bonus, I decided to apply that discovered knowledge about Oracle Wrap tables. Thus, I created my own version of the &lt;b&gt;&lt;i&gt;oracle&lt;/i&gt;&lt;/b&gt; binary and put trivial wrap tables in it - the ones keeping all bytes the same: &lt;pre class="brush:sql;highlight:[3,21,39,57]"&gt;$ diff &lt;(xxd oracle) &lt;(xxd /tmp/oracle_modified)&lt;br /&gt;19775119,19775150c19775119,19775150&lt;br /&gt;-- pkwrap_reverse_table&lt;br /&gt;&lt; 12dbe8e0:dd05 2553 b87b 8227 91f2 4b03 eb55 40ff  ..%S.{.'..K..U@.&lt;br /&gt;&lt; 12dbe8f0:1d08 1b3b c462 c807 2a7e 44c6 bea3 8bb7  ...;.b..*~D.....&lt;br /&gt;&lt; 12dbe900:0fd4 de1a df72 490a af89 d5f6 bf51 edb0  .....rI......Q..&lt;br /&gt;&lt; 12dbe910:1879 1596 5ce1 a421 01a6 994d 7675 c91e  .y..\..!...Mvu..&lt;br /&gt;&lt; 12dbe920:263e 1985 a55a 246c 0ec7 2e50 fd48 933f  &amp;&gt;...Z$l...P.H.?&lt;br /&gt;&lt; 12dbe930:7042 1158 f87d ccd8 39ec e8a7 f584 f32c  pB.X.}..9......,&lt;br /&gt;&lt; 12dbe940:e656 cd45 4fd2 c2e0 7cf0 6341 c52b 3cb6  .V.EO...|.cA.+&lt;.&lt;br /&gt;&lt; 12dbe950:00fc 6f9d ac38 bc74 d70d dcda d088 0cd1  ..o..8.t........&lt;br /&gt;&lt; 12dbe960:e795 d37a e368 83fe b934 8c86 4335 b480  ...z.h...4..C5..&lt;br /&gt;&lt; 12dbe970:3d04 9af9 b565 cf6a 5bab 7f92 375f aa16  =....e.j[...7_..&lt;br /&gt;&lt; 12dbe980:54e9 e4fa bd90 a036 c120 1fba 22d9 ef61  T......6. .."..a&lt;br /&gt;&lt; 12dbe990:4777 ad71 789f b333 108e fb8f 5ea9 5917  Gw.qx..3....^.Y.&lt;br /&gt;&lt; 12dbe9a0:1287 52f4 57ca 6713 3006 c0ae f18d 981c  ..R.W.g.0.......&lt;br /&gt;&lt; 12dbe9b0:2fce 94b2 66cb 236d 4c6b db64 ee60 09d6  /...f.#mLk.d.`..&lt;br /&gt;&lt; 12dbe9c0:02a2 4e28 9c4a e2a8 46e5 f773 3a5d 81c3  ..N(.J..F..s:]..&lt;br /&gt;&lt; 12dbe9d0:2d32 eab1 2914 0b31 9b9e 69a1 8abb 976e  -2..)..1..i....n&lt;br /&gt;---&lt;br /&gt;-- modified pkwrap_reverse_table&lt;br /&gt;&gt; 12dbe8e0:a0a1 a2a3 a4a5 a6a7 a8a9 aaab acad aeaf  ................&lt;br /&gt;&gt; 12dbe8f0:b0b1 b2b3 b4b5 b6b7 b8b9 babb bcbd bebf  ................&lt;br /&gt;&gt; 12dbe900:c0c1 c2c3 c4c5 c6c7 c8c9 cacb cccd cecf  ................&lt;br /&gt;&gt; 12dbe910:d0d1 d2d3 d4d5 d6d7 d8d9 dadb dcdd dedf  ................&lt;br /&gt;&gt; 12dbe920:e0e1 e2e3 e4e5 e6e7 e8e9 eaeb eced eeef  ................&lt;br /&gt;&gt; 12dbe930:f0f1 f2f3 f4f5 f6f7 f8f9 fafb fcfd feff  ................&lt;br /&gt;&gt; 12dbe940:0001 0203 0405 0607 0809 0a0b 0c0d 0e0f  ................&lt;br /&gt;&gt; 12dbe950:1011 1213 1415 1617 1819 1a1b 1c1d 1e1f  ................&lt;br /&gt;&gt; 12dbe960:2021 2223 2425 2627 2829 2a2b 2c2d 2e2f   !"#$%&amp;'()*+,-./&lt;br /&gt;&gt; 12dbe970:3031 3233 3435 3637 3839 3a3b 3c3d 3e3f  0123456789:;&lt;=&gt;?&lt;br /&gt;&gt; 12dbe980:4041 4243 4445 4647 4849 4a4b 4c4d 4e4f  @ABCDEFGHIJKLMNO&lt;br /&gt;&gt; 12dbe990:5051 5253 5455 5657 5859 5a5b 5c5d 5e5f  PQRSTUVWXYZ[\]^_&lt;br /&gt;&gt; 12dbe9a0:6061 6263 6465 6667 6869 6a6b 6c6d 6e6f  `abcdefghijklmno&lt;br /&gt;&gt; 12dbe9b0:7071 7273 7475 7677 7879 7a7b 7c7d 7e7f  pqrstuvwxyz{|}~.&lt;br /&gt;&gt; 12dbe9c0:8081 8283 8485 8687 8889 8a8b 8c8d 8e8f  ................&lt;br /&gt;&gt; 12dbe9d0:9091 9293 9495 9697 9899 9a9b 9c9d 9e9f  ................&lt;br /&gt;&lt;br /&gt;-- pkwrap_forward_table&lt;br /&gt;&lt; 12dbe9e0:7038 e00b 9101 c917 11de 27f6 7e79 4820  p8........'.~yH&lt;br /&gt;&lt; 12dbe9f0:b852 c0c7 f532 9fbf 3042 2312 cf10 3faa  .R...2..0B#...?.&lt;br /&gt;&lt; 12dbea00:a937 acd6 4602 4007 e3f4 186d 5ff0 4ad0  .7..F.@....m_.J.&lt;br /&gt;&lt; 12dbea10:c8f7 f1b7 898d a79c 7558 ec13 6e90 414f  ........uX..n.AO&lt;br /&gt;&lt; 12dbea20:0e6b 518c 1a63 e8b0 4d26 e50a d83b e264  .kQ..c..M&amp;...;.d&lt;br /&gt;&lt; 12dbea30:4b2d c203 a00d 61c4 53be 4598 34ed bc9d  K-....a.S.E.4...&lt;br /&gt;&lt; 12dbea40:ddaf 156a db95 d4c6 85fa 97d9 47d7 ff72  ...j........G..r&lt;br /&gt;&lt; 12dbea50:50b3 25eb 773d 3cb1 b431 8305 6855 199a  P.%.w=&lt;..1..hU..&lt;br /&gt;&lt; 12dbea60:8fee 0686 5d43 8bc1 7d29 fc1e 8acd b9bb  ....]C..})......&lt;br /&gt;&lt; 12dbea70:a508 9b4e d281 33fe ce3a 92f8 e473 f9b5  ...N..3..:...s..&lt;br /&gt;&lt; 12dbea80:a6fb e11d 3644 395b e7bd 9e99 74b2 cb28  ....6D9[....t..(&lt;br /&gt;&lt; 12dbea90:2ff3 d3b6 8e94 6f1f 0488 abfd 76a4 1c2c  /.....o.....v..,&lt;br /&gt;&lt; 12dbeaa0:caa8 66ef 146c 1b49 163e c5d5 5662 d196  ..f..l.I.&gt;..Vb..&lt;br /&gt;&lt; 12dbeab0:7c7f 6582 212a df78 57ad 7bda 7a00 2224  |.e.!*.xW.{.z."$&lt;br /&gt;&lt; 12dbeac0:6735 e684 a2e9 6080 5aa1 f20c 592e dcae  g5....`.Z...Y...&lt;br /&gt;&lt; 12dbead0:69cc 095e c35c 2bea 5493 a3ba 714c 870f  i..^.\+.T...qL..&lt;br /&gt;---&lt;br /&gt;-- modified pkwrap_forward_tble&lt;br /&gt;&gt; 12dbe9e0:6061 6263 6465 6667 6869 6a6b 6c6d 6e6f  `abcdefghijklmno&lt;br /&gt;&gt; 12dbe9f0:7071 7273 7475 7677 7879 7a7b 7c7d 7e7f  pqrstuvwxyz{|}~.&lt;br /&gt;&gt; 12dbea00:8081 8283 8485 8687 8889 8a8b 8c8d 8e8f  ................&lt;br /&gt;&gt; 12dbea10:9091 9293 9495 9697 9899 9a9b 9c9d 9e9f  ................&lt;br /&gt;&gt; 12dbea20:a0a1 a2a3 a4a5 a6a7 a8a9 aaab acad aeaf  ................&lt;br /&gt;&gt; 12dbea30:b0b1 b2b3 b4b5 b6b7 b8b9 babb bcbd bebf  ................&lt;br /&gt;&gt; 12dbea40:c0c1 c2c3 c4c5 c6c7 c8c9 cacb cccd cecf  ................&lt;br /&gt;&gt; 12dbea50:d0d1 d2d3 d4d5 d6d7 d8d9 dadb dcdd dedf  ................&lt;br /&gt;&gt; 12dbea60:e0e1 e2e3 e4e5 e6e7 e8e9 eaeb eced eeef  ................&lt;br /&gt;&gt; 12dbea70:f0f1 f2f3 f4f5 f6f7 f8f9 fafb fcfd feff  ................&lt;br /&gt;&gt; 12dbea80:0001 0203 0405 0607 0809 0a0b 0c0d 0e0f  ................&lt;br /&gt;&gt; 12dbea90:1011 1213 1415 1617 1819 1a1b 1c1d 1e1f  ................&lt;br /&gt;&gt; 12dbeaa0:2021 2223 2425 2627 2829 2a2b 2c2d 2e2f   !"#$%&amp;'()*+,-./&lt;br /&gt;&gt; 12dbeab0:3031 3233 3435 3637 3839 3a3b 3c3d 3e3f  0123456789:;&lt;=&gt;?&lt;br /&gt;&gt; 12dbeac0:4041 4243 4445 4647 4849 4a4b 4c4d 4e4f  @ABCDEFGHIJKLMNO&lt;br /&gt;&gt; 12dbead0:5051 5253 5455 5657 5859 5a5b 5c5d 5e5f  PQRSTUVWXYZ[\]^_&lt;br /&gt;&lt;/pre&gt;Remember, this wrap process, which uses modified substitution tables, should hold the following invariant to keep bytes the same: &lt;tt&gt;MOD(pkwrap_reverse_table[&lt;b&gt;BYTE&lt;/b&gt;] + 0x60, 0x100) = pkwrap_forward_table[MOD(&lt;b&gt;BYTE&lt;/b&gt; + 0xA0, 0x100)] = &lt;b&gt;BYTE&lt;/b&gt;&lt;/tt&gt; for all &lt;b&gt;&lt;i&gt;BYTE&lt;/i&gt;&lt;/b&gt;s from 0 to 255 Here is a sample package that I wrapped using that modified oracle binary: &lt;pre class="brush:sql;highlight:[87]"&gt;SQL&gt; with src as (&lt;br /&gt;  2    select q'!package test_pkg&lt;br /&gt;  3  is&lt;br /&gt;  4  procedure p1;&lt;br /&gt;  5  function f1 return varchar2;&lt;br /&gt;  6  end;!' txt&lt;br /&gt;  7      from dual),&lt;br /&gt;  8    wrap as (&lt;br /&gt;  9      select dbms_ddl.wrap( 'create ' || src.txt ) wrap&lt;br /&gt; 10        from src)&lt;br /&gt; 11  select wrap wrapped_code&lt;br /&gt; 12    from wrap&lt;br /&gt; 13  /&lt;br /&gt;&lt;br /&gt;WRAPPED_CODE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;create package test_pkg wrapped&lt;br /&gt;a000000&lt;br /&gt;369&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;9&lt;br /&gt;44 81&lt;br /&gt;kuXPwLaDK0xzws78Nfs5dvIfvtl42gtwdPZ2dHdVKEktLokvyE7n8gzmCgjyd3Z1CQ1yVQgw&lt;br /&gt;tOZyC/VzDvH091NwM1QIcg0JDfJTCHMMcvZwDDKy5nL1c7FmAACeSxJa&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt; with src as (&lt;br /&gt;  2    select q'!package body test_pkg&lt;br /&gt;  3  is&lt;br /&gt;  4  procedure p1&lt;br /&gt;  5  is&lt;br /&gt;  6     v_local_var pls_integer := 10;&lt;br /&gt;  7  begin&lt;br /&gt;  8    dbms_output.put_line(123);&lt;br /&gt;  9  end;&lt;br /&gt; 10  function f1 return varchar2&lt;br /&gt; 11  is&lt;br /&gt; 12    /* code comment*/&lt;br /&gt; 13  begin&lt;br /&gt; 14    return 'string';&lt;br /&gt; 15  end;&lt;br /&gt; 16  end;!' txt&lt;br /&gt; 17      from dual),&lt;br /&gt; 18    wrap as (&lt;br /&gt; 19      select dbms_ddl.wrap( 'create ' || src.txt ) wrap&lt;br /&gt; 20        from src)&lt;br /&gt; 21  select wrap wrapped_code&lt;br /&gt; 22    from wrap&lt;br /&gt; 23  /&lt;br /&gt;&lt;br /&gt;WRAPPED_CODE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;create package body test_pkg wrapped&lt;br /&gt;a000000&lt;br /&gt;369&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;abcd&lt;br /&gt;b&lt;br /&gt;b8 eb&lt;br /&gt;Fhyioql6UlwVZh69G4MDdFUfl9V42j1NPQvCMBR0zq94W3URUzeLQ5q81mB8Ca9JwSmTFBFE&lt;br /&gt;bP8/tigOd3DcV1D6rFqE2psrTLdxyq/HIGwnAnuNJjFCkIsGgD47r5XLvWIIrsuWIrbIcDiC&lt;br /&gt;3FWixtbSnDP1pcs+xZDidkZ2lnAty/2mEkimEk0iHa0naCQwxsQE86I+KS6/R/+ln1uM0/v+&lt;br /&gt;HIpff6HVB57RL3k=&lt;br /&gt;&lt;/pre&gt;As it is intended, there is no need to use the &lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt; to unwrap that code - it is enough to unzip: &lt;pre class="brush:sql"&gt;SQL&gt; select mycompress.inflate(substr(utl_encode.base64_decode(utl_raw.cast_to_raw('Fhyioql6UlwVZh69G4MDdFUfl9V42j1NPQvCMBR0zq94W3URUzeLQ5q81mB8Ca9JwSmTFBFEbP8/tigOd3DcV1D6rFqE2psrTLdxyq/HIGwnAnuNJjFCkIsGgD47r5XL&lt;br /&gt;vWIIrsuWIrbIcDiC3FWixtbSnDP1pcs+xZDidkZ2lnAty/2mEkimEk0iHa0naCQwxsQE86I+KS6/R/+ln1uM0/v+HIpff6HVB57RL3k=')), 41)) unwrapped_code from dual&lt;br /&gt;  2  /&lt;br /&gt;&lt;br /&gt;UNWRAPPED_CODE&lt;br /&gt;----------------------------------------------------&lt;br /&gt;PACKAGE BODY test_pkg&lt;br /&gt;IS&lt;br /&gt;PROCEDURE P1&lt;br /&gt;IS&lt;br /&gt;   V_LOCAL_VAR PLS_INTEGER := 10;&lt;br /&gt;BEGIN&lt;br /&gt;  DBMS_OUTPUT.PUT_LINE(123);&lt;br /&gt;END;&lt;br /&gt;FUNCTION F1 RETURN VARCHAR2&lt;br /&gt;IS&lt;br /&gt;&lt;br /&gt;BEGIN&lt;br /&gt;  RETURN 'string';&lt;br /&gt;END;&lt;br /&gt;END;&lt;br /&gt;&lt;/pre&gt;That wrapped code can be correctly compiled as well: &lt;pre class="brush:sql;highlight:[60,61]"&gt;SQL&gt; drop package test_pkg&lt;br /&gt;  2  /&lt;br /&gt;&lt;br /&gt;Package dropped.&lt;br /&gt;&lt;br /&gt;SQL&gt; create package test_pkg wrapped&lt;br /&gt;  2  a000000&lt;br /&gt;  3  369&lt;br /&gt;  4  abcd&lt;br /&gt;  5  abcd&lt;br /&gt;  6  abcd&lt;br /&gt;  7  abcd&lt;br /&gt;  8  abcd&lt;br /&gt;  9  abcd&lt;br /&gt; 10  abcd&lt;br /&gt; 11  abcd&lt;br /&gt; 12  abcd&lt;br /&gt; 13  abcd&lt;br /&gt; 14  abcd&lt;br /&gt; 15  abcd&lt;br /&gt; 16  abcd&lt;br /&gt; 17  abcd&lt;br /&gt; 18  abcd&lt;br /&gt; 19  9&lt;br /&gt; 20  44 81&lt;br /&gt; 21  kuXPwLaDK0xzws78Nfs5dvIfvtl42gtwdPZ2dHdVKEktLokvyE7n8gzmCgjyd3Z1CQ1yVQgw&lt;br /&gt; 22  tOZyC/VzDvH091NwM1QIcg0JDfJTCHMMcvZwDDKy5nL1c7FmAACeSxJa&lt;br /&gt; 23  /&lt;br /&gt;&lt;br /&gt;Package created.&lt;br /&gt;&lt;br /&gt;SQL&gt; create package body test_pkg wrapped&lt;br /&gt;  2  a000000&lt;br /&gt;  3  369&lt;br /&gt;  4  abcd&lt;br /&gt;  5  abcd&lt;br /&gt;  6  abcd&lt;br /&gt;  7  abcd&lt;br /&gt;  8  abcd&lt;br /&gt;  9  abcd&lt;br /&gt; 10  abcd&lt;br /&gt; 11  abcd&lt;br /&gt; 12  abcd&lt;br /&gt; 13  abcd&lt;br /&gt; 14  abcd&lt;br /&gt; 15  abcd&lt;br /&gt; 16  abcd&lt;br /&gt; 17  abcd&lt;br /&gt; 18  abcd&lt;br /&gt; 19  b&lt;br /&gt; 20  b8 eb&lt;br /&gt; 21  Fhyioql6UlwVZh69G4MDdFUfl9V42j1NPQvCMBR0zq94W3URUzeLQ5q81mB8Ca9JwSmTFBFE&lt;br /&gt; 22  bP8/tigOd3DcV1D6rFqE2psrTLdxyq/HIGwnAnuNJjFCkIsGgD47r5XLvWIIrsuWIrbIcDiC&lt;br /&gt; 23  3FWixtbSnDP1pcs+xZDidkZ2lnAty/2mEkimEk0iHa0naCQwxsQE86I+KS6/R/+ln1uM0/v+&lt;br /&gt; 24  HIpff6HVB57RL3k=&lt;br /&gt; 25  /&lt;br /&gt;&lt;br /&gt;Package body created.&lt;br /&gt;&lt;br /&gt;SQL&gt; exec test_pkg.p1&lt;br /&gt;123&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;Thus, the unwrapping can be now done without using that substitution table - I made the &lt;a href="#step3"&gt;step 3&lt;/a&gt; (obfuscation of zipped code) an effective noop operation keeping all bytes in place: &lt;pre class="brush:sql"&gt;SQL&gt; with wrap as (&lt;br /&gt;  2      select 'create package body test_pkg wrapped&lt;br /&gt;  3  a000000&lt;br /&gt;  4  369&lt;br /&gt;  5  abcd&lt;br /&gt;  6  abcd&lt;br /&gt;  7  abcd&lt;br /&gt;  8  abcd&lt;br /&gt;  9  abcd&lt;br /&gt; 10  abcd&lt;br /&gt; 11  abcd&lt;br /&gt; 12  abcd&lt;br /&gt; 13  abcd&lt;br /&gt; 14  abcd&lt;br /&gt; 15  abcd&lt;br /&gt; 16  abcd&lt;br /&gt; 17  abcd&lt;br /&gt; 18  abcd&lt;br /&gt; 19  abcd&lt;br /&gt; 20  b&lt;br /&gt; 21  b8 eb&lt;br /&gt; 22  Fhyioql6UlwVZh69G4MDdFUfl9V42j1NPQvCMBR0zq94W3URUzeLQ5q81mB8Ca9JwSmTFBFE&lt;br /&gt; 23  bP8/tigOd3DcV1D6rFqE2psrTLdxyq/HIGwnAnuNJjFCkIsGgD47r5XLvWIIrsuWIrbIcDiC&lt;br /&gt; 24  3FWixtbSnDP1pcs+xZDidkZ2lnAty/2mEkimEk0iHa0naCQwxsQE86I+KS6/R/+ln1uM0/v+&lt;br /&gt; 25  HIpff6HVB57RL3k=' wrap&lt;br /&gt; 26        from dual),&lt;br /&gt; 27    base64_dcd as(&lt;br /&gt; 28      select substr( utl_encode.base64_decode( utl_raw.cast_to_raw(rtrim( substr( wrap.wrap, instr( wrap.wrap, chr( 10 ), 1, 20 ) + 1 ), chr(10) )  ) ), 41 ) x&lt;br /&gt; 29        from wrap),&lt;br /&gt; 30    subst as (&lt;br /&gt; 31      select x s&lt;br /&gt; 32      from base64_dcd)&lt;br /&gt; 33  select mycompress.inflate( s ) unwrapped_code&lt;br /&gt; 34    from subst&lt;br /&gt; 35  /&lt;br /&gt;&lt;br /&gt;UNWRAPPED_CODE&lt;br /&gt;----------------------------------------&lt;br /&gt;PACKAGE BODY test_pkg&lt;br /&gt;IS&lt;br /&gt;PROCEDURE P1&lt;br /&gt;IS&lt;br /&gt;   V_LOCAL_VAR PLS_INTEGER := 10;&lt;br /&gt;BEGIN&lt;br /&gt;  DBMS_OUTPUT.PUT_LINE(123);&lt;br /&gt;END;&lt;br /&gt;FUNCTION F1 RETURN VARCHAR2&lt;br /&gt;IS&lt;br /&gt;&lt;br /&gt;BEGIN&lt;br /&gt;  RETURN 'string';&lt;br /&gt;END;&lt;br /&gt;END;&lt;br /&gt;&lt;/pre&gt;The last demonstration is used only to show how &lt;b&gt;&lt;i&gt;pkwrap_forward_table&lt;/i&gt;&lt;/b&gt; and &lt;b&gt;&lt;i&gt;pkwrap_reverse_table&lt;/i&gt;&lt;/b&gt; are used during Oracle Wrap process. It has no practical meaning apart from verifying an assumption about how Oracle code uses these tables. It is also an example of how behavior of Oracle can be changed without having access to source code by way of patching binary files used by Oracle utilities.  References:  &lt;ol&gt;&lt;li&gt;&lt;a href="https://www.blackhat.com/presentations/bh-usa-06/BH-US-06-Finnigan.pdf"&gt;How to unwrap PL/SQL by Pete Finnigan&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://macrotoneconsulting.co.uk/images/Documents/unwrap.pdf"&gt;Unwrapping Oracle PLSQL&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="https://technology.amis.nl/2009/02/03/unwrapping-10g-wrapped-plsql/"&gt;Unwrapping 10G wrapped PL/SQL by Anton Scheffer&lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;a href="http://blog.teusink.net/2010/04/unwrapping-oracle-plsql-with-unwrappy.html"&gt;Unwrapping Oracle PL/SQL with unwrap.py by Niels Teusink&lt;/a&gt;&lt;/li&gt;&lt;/ol&gt;</content><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/09/unwrapping-plsql-wrap-tables.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8929260401073132878'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8929260401073132878'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-803759387711328444</id><published>2019-09-04T21:51:00.002+06:00</published><updated>2019-09-04T21:51:30.209+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><category scheme='http://www.blogger.com/atom/ns#' term='wrong_results'/><title type='text'>Bug 26588069 - Wrong Result (Duplicate Rows Produced) Using Group By After Upgrading To 12.2.0.1</title><content type='html'>I have stumbled upon this bug after upgrading one of my databases to 12.2.0.1.&lt;br /&gt;Here is a simplified test case:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[14,15,16]"&gt;SQL&gt; create table gby_elim(x varchar2(10) primary key);&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt; insert into gby_elim values ('a');&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt; insert into gby_elim values ('b');&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select length(x), count(*)&lt;br /&gt;  2    from gby_elim&lt;br /&gt;  3   group by length(x);&lt;br /&gt;&lt;br /&gt; LENGTH(X)   COUNT(*)&lt;br /&gt;---------- ----------&lt;br /&gt;         1          1&lt;br /&gt;         1          1&lt;br /&gt;&lt;/pre&gt;The last query should have produced 1 row but it returned 2 rows.&lt;br /&gt;Notice how Oracle eliminated the GROUP BY, which it should not have done:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; #0 explain plan for&lt;br /&gt;SQL&gt; /&lt;br /&gt;&lt;br /&gt;Explained.&lt;br /&gt;&lt;br /&gt;SQL&gt; select * from table(dbms_xplan.display);&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 1635879943&lt;br /&gt;&lt;br /&gt;------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation         | Name     | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT  |          |     2 |    14 |     2   (0)| 00:00:01 |&lt;br /&gt;|   1 |  TABLE ACCESS FULL| GBY_ELIM |     2 |    14 |     2   (0)| 00:00:01 |&lt;br /&gt;------------------------------------------------------------------------------&lt;br /&gt;&lt;/pre&gt;The SQL Optimizer trace file:&lt;br /&gt;&lt;pre class="brush:sql"&gt;QB before group-by removal:******* UNPARSED QUERY IS *******&lt;br /&gt;SELECT LENGTH("GBY_ELIM"."X") "LENGTH(X)",COUNT(*) "COUNT(*)" FROM "TC"."GBY_ELIM" "GBY_ELIM" GROUP BY LENGTH("GBY_ELIM"."X")&lt;br /&gt;QB before group-by elimination:******* UNPARSED QUERY IS *******&lt;br /&gt;SELECT LENGTH("GBY_ELIM"."X") "LENGTH(X)",COUNT(*) "COUNT(*)" FROM "TC"."GBY_ELIM" "GBY_ELIM" GROUP BY LENGTH("GBY_ELIM"."X")&lt;br /&gt;Registered qb: SEL$47952E7A 0x88af59e8 (ELIMINATION OF GROUP BY SEL$1; SEL$1)&lt;br /&gt;---------------------&lt;br /&gt;QUERY BLOCK SIGNATURE&lt;br /&gt;---------------------&lt;br /&gt;  signature (): qb_name=SEL$47952E7A nbfros=1 flg=0&lt;br /&gt;    fro(0): flg=0 objn=261334 hint_alias="GBY_ELIM"@"SEL$1"&lt;br /&gt;&lt;br /&gt;QB after group-by elimination:******* UNPARSED QUERY IS *******&lt;br /&gt;SELECT LENGTH("GBY_ELIM"."X") "LENGTH(X)",1 "COUNT(*)" FROM "TC"."GBY_ELIM" "GBY_ELIM"&lt;br /&gt;Registered qb: SEL$9BB7A81A 0x88af59e8 (ELIMINATION OF GROUP BY SEL$47952E7A; SEL$47952E7A)&lt;br /&gt;---------------------&lt;br /&gt;QUERY BLOCK SIGNATURE&lt;br /&gt;---------------------&lt;br /&gt;  signature (): qb_name=SEL$9BB7A81A nbfros=1 flg=0&lt;br /&gt;    fro(0): flg=0 objn=261334 hint_alias="GBY_ELIM"@"SEL$1"&lt;br /&gt;&lt;br /&gt;QB after group-by removal:******* UNPARSED QUERY IS *******&lt;br /&gt;SELECT LENGTH("GBY_ELIM"."X") "LENGTH(X)",1 "COUNT(*)" FROM "TC"."GBY_ELIM" "GBY_ELIM"&lt;br /&gt;&lt;/pre&gt;The plan table from the trace file:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[38]"&gt;----- Explain Plan Dump -----&lt;br /&gt;----- Plan Table -----&lt;br /&gt;&lt;br /&gt;============&lt;br /&gt;Plan Table&lt;br /&gt;============&lt;br /&gt;-------------------------------------+-----------------------------------+&lt;br /&gt;| Id  | Operation          | Name    | Rows  | Bytes | Cost  | Time      |&lt;br /&gt;-------------------------------------+-----------------------------------+&lt;br /&gt;| 0   | SELECT STATEMENT   |         |       |       |     2 |           |&lt;br /&gt;| 1   |  TABLE ACCESS FULL | GBY_ELIM|     2 |    14 |     2 |  00:00:01 |&lt;br /&gt;-------------------------------------+-----------------------------------+&lt;br /&gt;Query Block Name / Object Alias(identified by operation id):&lt;br /&gt;------------------------------------------------------------&lt;br /&gt; 1 - SEL$9BB7A81A         / GBY_ELIM@SEL$1&lt;br /&gt;------------------------------------------------------------&lt;br /&gt;Predicate Information:&lt;br /&gt;----------------------&lt;br /&gt;&lt;br /&gt;Content of other_xml column&lt;br /&gt;===========================&lt;br /&gt;  db_version     : 12.2.0.1&lt;br /&gt;  parse_schema   : TC&lt;br /&gt;  dynamic_sampling: 2&lt;br /&gt;  plan_hash_full : 619495063&lt;br /&gt;  plan_hash      : 1635879943&lt;br /&gt;  plan_hash_2    : 619495063&lt;br /&gt;  Outline Data:&lt;br /&gt;  /*+&lt;br /&gt;    BEGIN_OUTLINE_DATA&lt;br /&gt;      IGNORE_OPTIM_EMBEDDED_HINTS&lt;br /&gt;      OPTIMIZER_FEATURES_ENABLE('12.2.0.1')&lt;br /&gt;      DB_VERSION('12.2.0.1')&lt;br /&gt;      ALL_ROWS&lt;br /&gt;      OUTLINE_LEAF(@"SEL$9BB7A81A")&lt;br /&gt;      ELIM_GROUPBY(@"SEL$47952E7A")&lt;br /&gt;      OUTLINE(@"SEL$47952E7A")&lt;br /&gt;      ELIM_GROUPBY(@"SEL$1")&lt;br /&gt;      OUTLINE(@"SEL$1")&lt;br /&gt;      FULL(@"SEL$9BB7A81A" "GBY_ELIM"@"SEL$1")&lt;br /&gt;    END_OUTLINE_DATA&lt;br /&gt;  */&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;This is &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=26588069.8"&gt;Bug 26588069 - Wrong Result (Duplicate Rows Produced) Using Group By After Upgrading To 12.2.0.1 (Doc ID 26588069.8)&lt;/a&gt; and any workaround mentioned in the aforementioned document will work. To demonstrate a few:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[1,11]"&gt;SQL&gt; select /*+ opt_param('_fix_control' '23210039:0')*/&lt;br /&gt;  2         length(x), count(*)&lt;br /&gt;  3    from gby_elim&lt;br /&gt;  4   group by length(x);&lt;br /&gt;&lt;br /&gt; LENGTH(X)   COUNT(*)&lt;br /&gt;---------- ----------&lt;br /&gt;         1          2&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select /*+ opt_param('_optimizer_aggr_groupby_elim' 'false')*/&lt;br /&gt;  2         length(x), count(*)&lt;br /&gt;  3    from gby_elim&lt;br /&gt;  4   group by length(x);&lt;br /&gt;&lt;br /&gt; LENGTH(X)   COUNT(*)&lt;br /&gt;---------- ----------&lt;br /&gt;         1          2&lt;br /&gt;&lt;/pre&gt;I can also add my own workaround using the NO_ELIM_GROUPBY hint:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[1]"&gt;SQL&gt; select /*+ no_elim_groupby(@sel$1)*/&lt;br /&gt;  2         length(x), count(*)&lt;br /&gt;  3    from gby_elim&lt;br /&gt;  4   group by length(x);&lt;br /&gt;&lt;br /&gt; LENGTH(X)   COUNT(*)&lt;br /&gt;---------- ----------&lt;br /&gt;         1          2&lt;br /&gt;&lt;/pre&gt;The patch for this bug is also available for most platforms.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/803759387711328444/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/09/bug-26588069-wrong-result-duplicate.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/803759387711328444'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/803759387711328444'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/09/bug-26588069-wrong-result-duplicate.html' title='Bug 26588069 - Wrong Result (Duplicate Rows Produced) Using Group By After Upgrading To 12.2.0.1'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-5874148890804219280</id><published>2019-08-15T00:40:00.000+06:00</published><updated>2019-08-15T00:40:13.418+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='systemd'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><title type='text'>Starting Oracle Database on Demand Using Socket Activation</title><content type='html'>I remember watching a video about &lt;a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/aurora-serverless.how-it-works.html#aurora-serverless.how-it-works.pause-resume"&gt;Amazon Aurora Serverless&lt;/a&gt; where it was demonstrated that your database can be started on demand when the first connection comes. Although it is not something that you might want for your 24x7 OLTP database, it can come in handy for Development environments that have the intermittent usage pattern. I decided to write a blog post about how that can be done for an Oracle Database server working on a systemd-based Linux Operating System.&lt;br /&gt;&lt;br /&gt;My setup uses systemd Socket Activation which you can read more about on &lt;a href="http://0pointer.de/blog/projects/socket-activation.html"&gt;Lennart Poettering's website&lt;/a&gt;.&lt;br /&gt;The following link has been used as a basis for that setup: &lt;a href="https://unix.stackexchange.com/questions/352495/systemd-on-demand-start-of-services-like-postgresql-and-mysql-that-do-not-yet-s"&gt;systemd: on-demand start of services like postgresql and mysql that do not yet support socket-based activation&lt;/a&gt;.&lt;br /&gt;I took Amazon Linux distribution for this demo with the following kernel: &lt;tt&gt;4.14.123-111.109.amzn2.x86_64&lt;/tt&gt;, however, the setup steps should be the same for any other Red Hat based distributions.&lt;br /&gt;The Oracle Database version is 19.3.&lt;br /&gt;&lt;br /&gt;In a nutshell, we need to create several systemd units:&lt;br /&gt;1. &lt;tt&gt;/etc/systemd/system/proxy-to-oracle.socket&lt;/tt&gt;:&lt;br /&gt;&lt;pre class="brush:sql"&gt;[Unit]&lt;br /&gt;Description="Socket for Oracle Socket Proxy"&lt;br /&gt;Documentation=https://www.freedesktop.org/software/systemd/man/systemd-socket-proxyd.html&lt;br /&gt;&lt;br /&gt;[Socket]&lt;br /&gt;ListenStream=0.0.0.0:1522&lt;br /&gt;&lt;br /&gt;[Install]&lt;br /&gt;WantedBy=sockets.target&lt;br /&gt;&lt;/pre&gt;The socket listens on port 1522 which accepts client connections to the database. When a connection comes, it starts the following service if it's not already running:&lt;br /&gt;2. &lt;tt&gt;/etc/systemd/system/proxy-to-oracle.service&lt;/tt&gt;:&lt;br /&gt;&lt;pre class="brush:sql"&gt;[Unit]&lt;br /&gt;Description="Oracle Socket Proxy"&lt;br /&gt;Documentation=https://www.freedesktop.org/software/systemd/man/systemd-socket-proxyd.html&lt;br /&gt;Requires=dbora.service&lt;br /&gt;After=dbora.service&lt;br /&gt;&lt;br /&gt;[Service]&lt;br /&gt;User=nobody&lt;br /&gt;Group=nobody&lt;br /&gt;ExecStart=/lib/systemd/systemd-socket-proxyd ip-172-17-31-208.ec2.internal:1521&lt;br /&gt;Restart=on-failure&lt;br /&gt;PrivateTmp=true&lt;br /&gt;&lt;/pre&gt;I am using &lt;a href="https://www.freedesktop.org/software/systemd/man/systemd-socket-proxyd.html"&gt;systemd-socket-proxyd&lt;/a&gt; that proxies the connection to the host ip-172-17-31-208.ec2.internal on port 1521 - it's just the hostname/port of the server where the listener is running (I'm using the same machine to host all services).&lt;br /&gt;There are &lt;tt&gt;After&lt;/tt&gt; and &lt;tt&gt;Requires&lt;/tt&gt; dependencies on &lt;tt&gt;dbora.service&lt;/tt&gt;, which manages the database and the listener.&lt;br /&gt;3. &lt;tt&gt;/etc/systemd/system/dbora.service&lt;/tt&gt;:&lt;br /&gt;&lt;pre class="brush:sql"&gt;[Unit]&lt;br /&gt;Description="The Oracle Database Service"&lt;br /&gt;After=syslog.target network.target&lt;br /&gt;&lt;br /&gt;[Service]&lt;br /&gt;LimitMEMLOCK=infinity&lt;br /&gt;LimitNOFILE=65535&lt;br /&gt;RemainAfterExit=yes&lt;br /&gt;User=oracle&lt;br /&gt;Group=dba&lt;br /&gt;ExecStart=/home/oracle/scripts/start_oracle.sh&lt;br /&gt;ExecStop=/u01/app/oracle/product/19/dbhome_1/bin/dbshut /u01/app/oracle/product/19/dbhome_1&lt;br /&gt;&lt;br /&gt;[Install]&lt;br /&gt;WantedBy=multi-user.target&lt;br /&gt;&lt;/pre&gt;In the service above, I used the standard stop command and a slightly changed startup script: &lt;tt&gt;start_oracle.sh&lt;/tt&gt;:&lt;br /&gt;&lt;pre class="brush:sql"&gt;#!/bin/sh&lt;br /&gt;&lt;br /&gt;export ORACLE_SID=orcl&lt;br /&gt;ORAENV_ASK=NO . /usr/local/bin/oraenv -s&lt;br /&gt;sqlplus / as sysdba &lt;&lt;_EOF&lt;br /&gt;startup&lt;br /&gt;_EOF&lt;br /&gt;&lt;br /&gt;lsnrctl start&lt;br /&gt;&lt;br /&gt;sqlplus / as sysdba &lt;&lt;_EOF&lt;br /&gt;alter system register;&lt;br /&gt;_EOF&lt;br /&gt;&lt;/pre&gt;I did not use the dbstart command as it starts the listener first before bringing up databases. I was getting &lt;b&gt;&lt;i&gt;ORA-01109: database not open&lt;/i&gt;&lt;/b&gt; errors with the standard dbstart script, so I resorted to my own version of the startup script. The TNS-descriptor is below: &lt;pre class="brush:sql;highlight:[6]"&gt;pdb =&lt;br /&gt;    (DESCRIPTION=&lt;br /&gt;      (RETRY_COUNT=10)&lt;br /&gt;      (RETRY_DELAY=10)&lt;br /&gt;      (ADDRESS=&lt;br /&gt;        (PROTOCOL=TCP)(HOST=ip-172-17-31-208.ec2.internal)(PORT=1522)&lt;br /&gt;      )&lt;br /&gt;      (CONNECT_DATA=&lt;br /&gt;        (SERVICE_NAME=pdb)&lt;br /&gt;      )&lt;br /&gt;    )&lt;br /&gt;&lt;/pre&gt;It's worth mentioning that the port is set to 1522 - that is where the systemd proxy is listening on. I use a non-standard client sqlnet.ora file that disables Out of Band Break (see more information about it: &lt;a href="https://support.oracle.com/rs?type=doc&amp;id=373475.1"&gt;What is DISABLE_OOB (Out Of Band Break)? (Doc ID 373475.1)&lt;/a&gt;): &lt;pre class="brush:sql"&gt;DISABLE_OOB=ON&lt;br /&gt;&lt;/pre&gt;Without that, I kept getting the &lt;b&gt;&lt;i&gt;ORA-12637: Packet receive failed&lt;/i&gt;&lt;/b&gt; error. I searched through SQL*Net traces and finally found a clue that pointed out to that parameter disabling Out of Band Breaks. Actually, I do not recall that I got that error when I configured a similar setup on Oracle Database 12.1 and Oracle Linux 6 last year.   I'm going to connect to the socket on port 1522; the &lt;tt&gt;proxy-to-oracle.service&lt;/tt&gt; should start the &lt;tt&gt;dbora.service&lt;/tt&gt; if it is not running, and proxy the connection to the listener. There is a little helper script to test the database connection that writes some output to estimate how long it takes to establish the connection: &lt;pre class="brush:sql"&gt;-- test_db_conn.sh&lt;br /&gt;#!/bin/sh&lt;br /&gt;export TNS_ADMIN="${HOME}/tns_admin"&lt;br /&gt;echo "Started at: "$(date +"%F %T")&lt;br /&gt;&lt;br /&gt;sqlplus -L tc/tc@pdb &lt;&lt;_EOF&lt;br /&gt;select to_char(sysdate, 'yyyy-mm-dd hh24:mi:ss') current_date&lt;br /&gt;  from dual;&lt;br /&gt;_EOF&lt;br /&gt;&lt;br /&gt;echo ""&lt;br /&gt;echo "Finished at: "$(date +"%F %T")&lt;br /&gt;&lt;/pre&gt;The initial state of services is below - only the &lt;tt&gt;proxy-to-oracle.socket&lt;/tt&gt; is running: &lt;pre class="brush:sql"&gt;# systemctl status proxy-to-oracle.socket proxy-to-oracle.service dbora.service&lt;br /&gt;● proxy-to-oracle.socket - "Socket for Oracle Socket Proxy"&lt;br /&gt;   Loaded: loaded (/etc/systemd/system/proxy-to-oracle.socket; enabled; vendor preset: disabled)&lt;br /&gt;   Active: active (listening) since Thu 2019-08-08 13:31:19 UTC; 20h ago&lt;br /&gt;     Docs: https://www.freedesktop.org/software/systemd/man/systemd-socket-proxyd.html&lt;br /&gt;   Listen: 0.0.0.0:1522 (Stream)&lt;br /&gt;&lt;br /&gt;● proxy-to-oracle.service - "Oracle Socket Proxy"&lt;br /&gt;   Loaded: loaded (/etc/systemd/system/proxy-to-oracle.service; static; vendor preset: disabled)&lt;br /&gt;   Active: inactive (dead) since Fri 2019-08-09 10:25:21 UTC; 3min 15s ago&lt;br /&gt;     Docs: https://www.freedesktop.org/software/systemd/man/systemd-socket-proxyd.html&lt;br /&gt;  Process: 16042 ExecStart=/lib/systemd/systemd-socket-proxyd ip-172-17-31-208.ec2.internal:1521 (code=killed, signal=TERM)&lt;br /&gt; Main PID: 16042 (code=killed, signal=TERM)&lt;br /&gt;&lt;br /&gt;● dbora.service - "The Oracle Database Service"&lt;br /&gt;   Loaded: loaded (/etc/systemd/system/dbora.service; enabled; vendor preset: disabled)&lt;br /&gt;   Active: inactive (dead) since Fri 2019-08-09 10:25:46 UTC; 2min 50s ago&lt;br /&gt;  Process: 22234 ExecStop=/u01/app/oracle/product/19/dbhome_1/bin/dbshut /u01/app/oracle/product/19/dbhome_1 (code=exited, status=0/SUCCESS)&lt;br /&gt;  Process: 16032 ExecStart=/home/oracle/scripts/start_oracle.sh (code=exited, status=0/SUCCESS)&lt;br /&gt; Main PID: 16032 (code=exited, status=0/SUCCESS)&lt;br /&gt;&lt;/pre&gt;Neither the instance nor the listener are running: &lt;pre class="brush:sql"&gt;[oracle@ip-172-17-31-208 ~]$ pgrep -af 'pmon|tnslsnr'&lt;br /&gt;[oracle@ip-172-17-31-208 ~]$&lt;br /&gt;&lt;/pre&gt;Now I am starting the script that tests the database connection: &lt;pre class="brush:sql"&gt;[oracle@ip-172-17-31-208 scripts]$ ./test_db_conn.sh&lt;br /&gt;Started at: 2019-08-09 10:32:53&lt;br /&gt;&lt;br /&gt;SQL*Plus: Release 19.0.0.0.0 - Production on Fri Aug 9 10:32:53 2019&lt;br /&gt;Version 19.3.0.0.0&lt;br /&gt;&lt;br /&gt;Copyright (c) 1982, 2019, Oracle.  All rights reserved.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Last Successful login time: Fri Aug 09 2019 09:27:45 +00:00&lt;br /&gt;&lt;br /&gt;Connected to:&lt;br /&gt;Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production&lt;br /&gt;Version 19.3.0.0.0&lt;br /&gt;&lt;br /&gt;SQL&gt;   2&lt;br /&gt;CURRENT_DATE&lt;br /&gt;-------------------&lt;br /&gt;2019-08-09 10:33:13&lt;br /&gt;&lt;br /&gt;SQL&gt; Disconnected from Oracle Database 19c Enterprise Edition Release 19.0.0.0.0 - Production&lt;br /&gt;Version 19.3.0.0.0&lt;br /&gt;&lt;br /&gt;Finished at: 2019-08-09 10:33:14&lt;br /&gt;&lt;/pre&gt;It takes less than 20 seconds to start the instance (the TNS descriptor used &lt;b&gt;&lt;i&gt;RETRY_DELAY=10&lt;/i&gt;&lt;/b&gt;, so that the client tries to establish a connection every 10 seconds).</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/5874148890804219280/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/08/starting-oracle-database-on-demand.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5874148890804219280'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5874148890804219280'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/08/starting-oracle-database-on-demand.html' title='Starting Oracle Database on Demand Using Socket Activation'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-7227792742077143111</id><published>2019-08-09T00:49:00.000+06:00</published><updated>2019-08-09T00:49:59.090+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-01551'/><title type='text'>That Old Restart Problem Strikes Back: Triggers to the Rescue</title><content type='html'>The previous articles in this series: &lt;br /&gt;1. &lt;a href="https://mvelikikh.blogspot.com/2019/08/that-old-restart-problem-strikes-back.html"&gt;That Old Restart Problem Strikes Back: Setting the Stage&lt;/a&gt;&lt;br /&gt;2. &lt;a href="https://mvelikikh.blogspot.com/2019/08/that-old-restart-problem-strikes-back_2.html"&gt;That Old Restart Problem Strikes Back: Getting What You Pay for&lt;/a&gt; &lt;br /&gt;&lt;br /&gt;Database triggers are notoriously known for slowing down DML operations.&lt;br /&gt;Yet, they lead to a remarkable consequence while applying to the first post of this series in which I demonstrated statement restarts within a single user session updating a non-partitioned table.&lt;br /&gt;&lt;br /&gt;Let's create a non-partitioned table using the script from &lt;a href="https://mvelikikh.blogspot.com/2019/08/that-old-restart-problem-strikes-back.html"&gt;the first part&lt;/a&gt; of this series:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; create table big(id int, pad char(100), val int);&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert /*+ append*/&lt;br /&gt;  2    into big&lt;br /&gt;  3  select rownum,&lt;br /&gt;  4         'x',&lt;br /&gt;  5         case&lt;br /&gt;  6           when rownum &lt;= 10000000 - 100000&lt;br /&gt;  7           then 0&lt;br /&gt;  8           else 1&lt;br /&gt;  9         end&lt;br /&gt; 10    from xmltable('1 to 10000000');&lt;br /&gt;&lt;br /&gt;10000000 rows created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select blocks, bytes/power(2,20) mbytes&lt;br /&gt;  2    from user_segments&lt;br /&gt;  3   where segment_name = 'BIG';&lt;br /&gt;&lt;br /&gt;    BLOCKS     MBYTES&lt;br /&gt;---------- ----------&lt;br /&gt;    164352       1284&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select val, count(*)&lt;br /&gt;  2    from big&lt;br /&gt;  3   group by val&lt;br /&gt;  4   order by val;&lt;br /&gt;&lt;br /&gt;       VAL   COUNT(*)&lt;br /&gt;---------- ----------&lt;br /&gt;         0    9900000&lt;br /&gt;         1     100000&lt;br /&gt;&lt;/pre&gt;This time, though, I am adding a new after update row-level trigger:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; create trigger big_au_trg&lt;br /&gt;  2  after update&lt;br /&gt;  3  on big&lt;br /&gt;  4  for each row&lt;br /&gt;  5  declare&lt;br /&gt;  6  begin&lt;br /&gt;  7    null;&lt;br /&gt;  8  end;&lt;br /&gt;  9  /&lt;br /&gt;&lt;br /&gt;Trigger created.&lt;br /&gt;&lt;/pre&gt;Then I am updating the table and am going to measure consistent and current buffer gets statistics:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; alter session set events 'trace[dml]:sql_trace wait=true';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select name, value&lt;br /&gt;  2    from v$mystat natural join v$statname&lt;br /&gt;  3   where name in ('db block gets', 'consistent gets')&lt;br /&gt;  4   order by name;&lt;br /&gt;&lt;br /&gt;NAME                                                                  VALUE&lt;br /&gt;---------------------------------------------------------------- ----------&lt;br /&gt;consistent gets                                                          45&lt;br /&gt;db block gets                                                             3&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; update big&lt;br /&gt;  2     set val = val + 1&lt;br /&gt;  3   where val = 1;&lt;br /&gt;&lt;br /&gt;100000 rows updated.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select name, value&lt;br /&gt;  2    from v$mystat natural join v$statname&lt;br /&gt;  3   where name in ('db block gets', 'consistent gets')&lt;br /&gt;  4   order by name;&lt;br /&gt;&lt;br /&gt;NAME                                                                  VALUE&lt;br /&gt;---------------------------------------------------------------- ----------&lt;br /&gt;consistent gets                                                      158587&lt;br /&gt;db block gets                                                        103337&lt;br /&gt;&lt;/pre&gt;We got &lt;b&gt;&lt;i&gt;158K&lt;/i&gt;&lt;/b&gt; consistent gets and &lt;b&gt;&lt;i&gt;103K&lt;/i&gt;&lt;/b&gt; current gets for our &lt;b&gt;&lt;i&gt;164K&lt;/i&gt;&lt;/b&gt; block table - that is a decent amount of buffer gets in this scenario.&lt;br /&gt;The SQL Monitoring Report shows that we executed the rowsource functions only once and read &lt;b&gt;&lt;i&gt;1GB&lt;/i&gt;&lt;/b&gt; of data:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[31,39,40,41]"&gt;SQL&gt; select dbms_sqltune.report_sql_monitor('7z5h5dg0pa0fv') from dual;&lt;br /&gt;&lt;br /&gt;DBMS_SQLTUNE.REPORT_SQL_MONITOR('7Z5H5DG0PA0FV')&lt;br /&gt;---------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL Monitoring Report&lt;br /&gt;&lt;br /&gt;SQL Text&lt;br /&gt;------------------------------&lt;br /&gt;update big set val = val + 1 where val = 1&lt;br /&gt;&lt;br /&gt;Global Information&lt;br /&gt;------------------------------&lt;br /&gt; Status              :  DONE&lt;br /&gt; Instance ID         :  1&lt;br /&gt; Session             :  TC (48:40781)&lt;br /&gt; SQL ID              :  7z5h5dg0pa0fv&lt;br /&gt; SQL Execution ID    :  16777226&lt;br /&gt; Execution Started   :  08/01/2019 12:02:01&lt;br /&gt; First Refresh Time  :  08/01/2019 12:02:05&lt;br /&gt; Last Refresh Time   :  08/01/2019 12:02:12&lt;br /&gt; Duration            :  11s&lt;br /&gt; Module/Action       :  SQL*Plus/-&lt;br /&gt; Service             :  pdb&lt;br /&gt; Program             :  sqlplus.exe&lt;br /&gt;&lt;br /&gt;Global Stats&lt;br /&gt;================================================================================&lt;br /&gt;| Elapsed |   Cpu   |    IO    | Concurrency | PL/SQL  | Buffer | Read | Read  |&lt;br /&gt;| Time(s) | Time(s) | Waits(s) |  Waits(s)   | Time(s) |  Gets  | Reqs | Bytes |&lt;br /&gt;================================================================================&lt;br /&gt;|      11 |    4.58 |     6.30 |        0.00 |    0.08 |   262K | 2931 |   1GB |&lt;br /&gt;================================================================================&lt;br /&gt;&lt;br /&gt;SQL Plan Monitoring Details (Plan Hash Value=3225303172)&lt;br /&gt;=====================================================================================================================================================&lt;br /&gt;| Id |      Operation       | Name |  Rows   | Cost  |   Time    | Start  | Execs |   Rows   | Read | Read  | Activity |      Activity Detail       |&lt;br /&gt;|    |                      |      | (Estim) |       | Active(s) | Active |       | (Actual) | Reqs | Bytes |   (%)    |        (# samples)         |&lt;br /&gt;=====================================================================================================================================================&lt;br /&gt;|  0 | UPDATE STATEMENT     |      |         |       |         4 |     +8 |     1 |        0 |      |       |          |                            |&lt;br /&gt;|  1 |   UPDATE             | BIG  |         |       |         5 |     +8 |     1 |        0 | 1112 |   9MB |    22.22 | Cpu (2)                    |&lt;br /&gt;|  2 |    TABLE ACCESS FULL | BIG  |      5M | 43217 |        11 |     +1 |     1 |     100K | 1818 |   1GB |    77.78 | db file scattered read (7) |&lt;br /&gt;=====================================================================================================================================================&lt;br /&gt;&lt;/pre&gt;Notice also that it took us only 11 seconds to execute that update statement whereas it was around 16 seconds without any triggers - your mileage can vary.&lt;br /&gt;I would not jump to conclusions keeping in mind that there still might be statement restarts even when the rowsource functions were executed only once (it was demonstrated in &lt;a href="https://mvelikikh.blogspot.com/2019/08/that-old-restart-problem-strikes-back_2.html"&gt;the second article&lt;/a&gt; of this series), so that I provide the relevant output from the trace file instead:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[22,24]"&gt;PARSING IN CURSOR #140092319088552 len=46 dep=0 uid=138 oct=6 lid=138 tim=2680019864414 hv=3243573723 ad='c7471690' sqlid='7z5h5dg0pa0fv'&lt;br /&gt;update big&lt;br /&gt;   set val = val + 1&lt;br /&gt; where val = 1&lt;br /&gt;END OF STMT&lt;br /&gt;PARSE #140092319088552:c=130,e=131,p=0,cr=0,cu=0,mis=0,r=0,dep=0,og=1,plh=3225303172,tim=2680019864414&lt;br /&gt;updSetExecCmpColInfo: not RHS: objn=136467, cid=3&lt;br /&gt;  kduukcmpf=0x7f69ce5d99ea, kduukcmpl=0x7f69ce5d99e8, kduukcmpp=(nil)&lt;br /&gt;updThreePhaseExe: objn=136467 phase=NOT LOCKED&lt;br /&gt;updaul: phase is NOT LOCKED snap oldsnap env: (scn: 0x8000.0277b741  xid: 0x0000.000.00000000  uba: 0x00000000.0000.00  statement num=0  parent xid: xid: 0x0000.000.00000000  scn: 0x0000.00000000  97sch: scn: 0x0000.00000000  mascn: (scn: 0&lt;br /&gt;x8000.0277b72c) env: (scn: 0x0000.00000000  xid: 0x0000.000.00000000  uba: 0x00000000.0000.00  statement num=0  parent xid: xid: 0x0000.000.00000000  scn: 0x0000.00000000  512sch: scn: 0x0000.00000000  mascn: (scn: 0x0000.00000000)&lt;br /&gt;..&lt;br /&gt;updrow: objn=136467 phase=NOT LOCKED&lt;br /&gt;updrow: kauupd objn:136467 table:0 rowMigrated:FALSE  rowid 00021513.098a6964.34 code 0&lt;br /&gt;updrow: objn=136467 phase=NOT LOCKED&lt;br /&gt;updrow: kauupd objn:136467 table:0 rowMigrated:FALSE  rowid 00021513.098a6964.35 code 0&lt;br /&gt;updrow: objn=136467 phase=NOT LOCKED&lt;br /&gt;updrow: kauupd objn:136467 table:0 rowMigrated:FALSE  rowid 00021513.098a6964.36 code 0&lt;br /&gt;.. there are many updrow calls&lt;br /&gt;.. there are several ROW_RETRY as well&lt;br /&gt;WAIT #140092319088552: nam='undo segment extension' ela= 15 segment#=6 p2=0 p3=0 obj#=0 tim=2680026841072&lt;br /&gt;updrow: objn=136467 error=1551&lt;br /&gt;updrow: qecinvsub objn=136467&lt;br /&gt;updrow: setting ROW_RETRY objn=136467&lt;br /&gt;updrow: retry_this_row: ROW_RETRY set, objn= 136467 phase=NOT LOCKED&lt;br /&gt;WAIT #140092319088552: nam='undo segment extension' ela= 10848 segment#=6 p2=0 p3=0 obj#=0 tim=2680026852020&lt;br /&gt;updrow: objn=136467 error=1551&lt;br /&gt;updrow: qecinvsub objn=136467&lt;br /&gt;updrow: setting ROW_RETRY objn=136467&lt;br /&gt;updrow: retry_this_row: ROW_RETRY set, objn= 136467 phase=NOT LOCKED&lt;br /&gt;updrow: kauupd objn:136467 table:0 rowMigrated:FALSE  rowid 00021513.098a698b.23 code 0&lt;br /&gt;updrow: objn=136467 phase=NOT LOCKED&lt;br /&gt;updrow: kauupd objn:136467 table:0 rowMigrated:FALSE  rowid 00021513.098a698b.24 code 0&lt;br /&gt;.. &lt;br /&gt;updrow: objn=136467 phase=NOT LOCKED&lt;br /&gt;updrow: kauupd objn:136467 table:0 rowMigrated:FALSE  rowid 00021513.098a6fb1.2c code 0&lt;br /&gt;EXEC #140092319088552:c=4580202,e=10824372,p=158086,cr=158543,cu=103457,mis=0,r=100000,dep=0,og=1,plh=3225303172,tim=2680030688827&lt;br /&gt;STAT #140092319088552 id=1 cnt=0 pid=0 pos=1 obj=0 op='UPDATE  BIG (cr=158543 pr=158086 pw=0 str=1 time=10824071 us)'&lt;br /&gt;STAT #140092319088552 id=2 cnt=100000 pid=1 pos=1 obj=136467 op='TABLE ACCESS FULL BIG (cr=158531 pr=156973 pw=0 str=1 time=6924111 us cost=43217 size=15000000 card=5000000)'&lt;br /&gt;&lt;/pre&gt;There are no &lt;b&gt;&lt;i&gt;updrowFastPath&lt;/i&gt;&lt;/b&gt; lines and that output which looks suspiciously similar to the corresponding output with a partitioned table from &lt;a href="https://mvelikikh.blogspot.com/2019/08/that-old-restart-problem-strikes-back_2.html"&gt;the second part&lt;/a&gt; of this series.&lt;br /&gt;That statement does not use the &lt;b&gt;&lt;i&gt;fast-path&lt;/i&gt;&lt;/b&gt; code path anymore and follows the usual &lt;b&gt;&lt;i&gt;non-fast&lt;/i&gt;&lt;/b&gt; code path that appears to be due to the presence of a trigger.&lt;br /&gt;&lt;br /&gt;The &lt;b&gt;&lt;i&gt;ORA-01551&lt;/i&gt;&lt;/b&gt; error can also explain the issue described in &lt;a href="https://plsql-challenge.blogspot.com/2011/02/dml-restarts-only-happen-with.html"&gt;this link&lt;/a&gt; when after a certain number of executions the statement restart is observed. In fact, I ran the sample code provided by (Valentin?) Nikotin on &lt;a href="https://www.sql.ru/forum/833618/undo-management-statement-restart?mid=10331463#10331463"&gt;the SQL.RU forum&lt;/a&gt; and I got the same &lt;b&gt;&lt;i&gt;ROW_RETRY&lt;/i&gt;&lt;/b&gt; messages in the trace file when there was a mismatch between the number of times the trigger was fired and the number of rows being updated.&lt;br /&gt;&lt;br /&gt;&lt;h3&gt;tl;dr.&lt;/h3&gt;When triggers are present, the &lt;b&gt;&lt;i&gt;updrowFastPath&lt;/i&gt;&lt;/b&gt; function appears to be not used anymore and the execution goes through the &lt;b&gt;&lt;i&gt;updrow&lt;/i&gt;&lt;/b&gt; code path (the same one is used for partitioned tables).&lt;br /&gt;In this specific example, the statement executes faster and generates far less load - it does not read the table three times after all, so that the UPDATE statement is actually &lt;b&gt;&lt;i&gt;faster with&lt;/i&gt;&lt;/b&gt; a trigger then &lt;b&gt;&lt;i&gt;without&lt;/i&gt;&lt;/b&gt; it.&lt;br /&gt;Therefore, a suggestion to optimize a DML statement by creating a new trigger (a statement level trigger works as well) - does not sound so wacky anymore (of course, I am making use of the Oracle deficiency here).</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/7227792742077143111/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/08/that-old-restart-problem-strikes-back_9.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7227792742077143111'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7227792742077143111'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/08/that-old-restart-problem-strikes-back_9.html' title='That Old Restart Problem Strikes Back: Triggers to the Rescue'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-2085773282037377198</id><published>2019-08-02T22:49:00.000+06:00</published><updated>2019-08-02T22:49:09.882+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-01551'/><title type='text'>That Old Restart Problem Strikes Back: Getting What You Pay for</title><content type='html'>The previous article in this series: &lt;br /&gt;1. &lt;a href="https://mvelikikh.blogspot.com/2019/08/that-old-restart-problem-strikes-back.html"&gt;That Old Restart Problem Strikes Back: Setting the Stage&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;During my previous research, I was also testing the same UPDATE statement against a partitioned table.&lt;br /&gt;I was slightly puzzled that I did not observe any statement restarts in the performance statistics, even after I updated tens of millions of rows in the partitioned table.&lt;br /&gt;It turns out that there are still statement restarts there, however, they do not lead to such dreadful ramifications when a table is being read three times.&lt;br /&gt;&lt;b&gt;Disclaimer&lt;/b&gt;: Please bear in mind, I am talking about statement restarts happening without any concurrent activity in this series of articles. Statement restarts when several sessions are involved can result in reading a table being modified several times under these circumstances (I would refer to &lt;a href="https://www.youtube.com/watch?v=jSvk0lxPjzY"&gt;the excellent Tanel Poder's video on this subject&lt;/a&gt;).&lt;br /&gt;&lt;br /&gt;For this demo, I am going to create a partitioned table with one partition (that's right, one is enough) and populate it with the same data that I used in my previous post:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; create table big_part(&lt;br /&gt;  2    id int,&lt;br /&gt;  3    pad char(100),&lt;br /&gt;  4    val int)&lt;br /&gt;  5  partition by hash(id)&lt;br /&gt;  6  partitions 1;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert /*+ append*/&lt;br /&gt;  2    into big_part&lt;br /&gt;  3  select rownum,&lt;br /&gt;  4         'x',&lt;br /&gt;  5         case&lt;br /&gt;  6           when rownum &lt;= 10000000 - 100000&lt;br /&gt;  7           then 0&lt;br /&gt;  8           else 1&lt;br /&gt;  9         end&lt;br /&gt; 10    from xmltable('1 to 10000000');&lt;br /&gt;&lt;br /&gt;10000000 rows created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select partition_name, blocks, bytes/power(2,20) mbytes&lt;br /&gt;  2    from user_segments&lt;br /&gt;  3   where segment_name = 'BIG_PART';&lt;br /&gt;&lt;br /&gt;PARTITION_NAME      BLOCKS     MBYTES&lt;br /&gt;--------------- ---------- ----------&lt;br /&gt;SYS_P3408           159744       1248&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select val, count(*)&lt;br /&gt;  2    from big_part&lt;br /&gt;  3   group by val&lt;br /&gt;  4   order by val;&lt;br /&gt;&lt;br /&gt;       VAL   COUNT(*)&lt;br /&gt;---------- ----------&lt;br /&gt;         0    9900000&lt;br /&gt;         1     100000&lt;br /&gt;&lt;/pre&gt;Let us update the table:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; alter session set events 'trace[dml]:sql_trace wait=true';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select name, value&lt;br /&gt;  2    from v$mystat natural join v$statname&lt;br /&gt;  3   where name in ('db block gets', 'consistent gets')&lt;br /&gt;  4   order by name;&lt;br /&gt;&lt;br /&gt;NAME                                                                  VALUE&lt;br /&gt;---------------------------------------------------------------- ----------&lt;br /&gt;consistent gets                                                        2472&lt;br /&gt;db block gets                                                             6&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; update big_part&lt;br /&gt;  2     set val = val + 1&lt;br /&gt;  3   where val = 1;&lt;br /&gt;&lt;br /&gt;100000 rows updated.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select name, value&lt;br /&gt;  2    from v$mystat natural join v$statname&lt;br /&gt;  3   where name in ('db block gets', 'consistent gets')&lt;br /&gt;  4   order by name;&lt;br /&gt;&lt;br /&gt;NAME                                                                  VALUE&lt;br /&gt;---------------------------------------------------------------- ----------&lt;br /&gt;consistent gets                                                      161286&lt;br /&gt;db block gets                                                        103448&lt;br /&gt;&lt;/pre&gt;We performed &lt;b&gt;&lt;i&gt;160K&lt;/i&gt;&lt;/b&gt; consistent gets and &lt;b&gt;&lt;i&gt;100K&lt;/i&gt;&lt;/b&gt; current gets which is perfectly fine for a &lt;b&gt;&lt;i&gt;160K&lt;/i&gt;&lt;/b&gt; table.&lt;br /&gt;The SQL Monitoring report does not contain anything unusual:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; select dbms_sqltune.report_sql_monitor('2k4ggcsqqwjgb') from dual;&lt;br /&gt;&lt;br /&gt;DBMS_SQLTUNE.REPORT_SQL_MONITOR('2K4GGCSQQWJGB')&lt;br /&gt;--------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL Monitoring Report&lt;br /&gt;&lt;br /&gt;SQL Text&lt;br /&gt;------------------------------&lt;br /&gt;update big_part set val = val + 1 where val = 1&lt;br /&gt;&lt;br /&gt;Global Information&lt;br /&gt;------------------------------&lt;br /&gt; Status              :  DONE&lt;br /&gt; Instance ID         :  1&lt;br /&gt; Session             :  TC (44:11676)&lt;br /&gt; SQL ID              :  2k4ggcsqqwjgb&lt;br /&gt; SQL Execution ID    :  16777218&lt;br /&gt; Execution Started   :  08/01/2019 09:26:06&lt;br /&gt; First Refresh Time  :  08/01/2019 09:26:10&lt;br /&gt; Last Refresh Time   :  08/01/2019 09:26:14&lt;br /&gt; Duration            :  8s&lt;br /&gt; Module/Action       :  SQL*Plus/-&lt;br /&gt; Service             :  pdb&lt;br /&gt; Program             :  sqlplus.exe&lt;br /&gt;&lt;br /&gt;Global Stats&lt;br /&gt;======================================================================&lt;br /&gt;| Elapsed |   Cpu   |    IO    | Application | Buffer | Read | Read  |&lt;br /&gt;| Time(s) | Time(s) | Waits(s) |  Waits(s)   |  Gets  | Reqs | Bytes |&lt;br /&gt;======================================================================&lt;br /&gt;|    7.80 |    3.04 |     4.76 |        0.00 |   262K | 5211 |   1GB |&lt;br /&gt;======================================================================&lt;br /&gt;&lt;br /&gt;SQL Plan Monitoring Details (Plan Hash Value=1296248929)&lt;br /&gt;==============================================================================================================================================================&lt;br /&gt;| Id |        Operation         |   Name   |  Rows   | Cost  |   Time    | Start  | Execs |   Rows   | Read | Read  | Activity |       Activity Detail       |&lt;br /&gt;|    |                          |          | (Estim) |       | Active(s) | Active |       | (Actual) | Reqs | Bytes |   (%)    |         (# samples)         |&lt;br /&gt;==============================================================================================================================================================&lt;br /&gt;|  0 | UPDATE STATEMENT         |          |         |       |         3 |     +6 |     1 |        0 |      |       |          |                             |&lt;br /&gt;|  1 |   UPDATE                 | BIG_PART |         |       |         4 |     +5 |     1 |        0 | 2724 |  21MB |    42.86 | Cpu (1)                     |&lt;br /&gt;|    |                          |          |         |       |           |        |       |          |      |       |          | db file sequential read (2) |&lt;br /&gt;|  2 |    PARTITION HASH SINGLE |          |    157K | 43213 |         3 |     +6 |     1 |     100K |      |       |          |                             |&lt;br /&gt;|  3 |     TABLE ACCESS FULL    | BIG_PART |    157K | 43213 |         8 |     +1 |     1 |     100K | 2487 |   1GB |    57.14 | direct path read (4)        |&lt;br /&gt;==============================================================================================================================================================&lt;br /&gt;&lt;/pre&gt;The exact amount of data read is &lt;b&gt;&lt;i&gt;1259MB&lt;/i&gt;&lt;/b&gt; and our single partition is &lt;b&gt;&lt;i&gt;1248MB&lt;/i&gt;&lt;/b&gt; in size:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; select physical_read_bytes/power(2,20) read_mbytes&lt;br /&gt;  2    from v$sql_monitor&lt;br /&gt;  3   where sql_id = '2k4ggcsqqwjgb'&lt;br /&gt;  4     and sql_exec_id = 16777218&lt;br /&gt;  5     and sid = sys_context('userenv', 'sid');&lt;br /&gt;&lt;br /&gt;READ_MBYTES&lt;br /&gt;-----------&lt;br /&gt;   1259.625&lt;br /&gt;&lt;/pre&gt;The same update took &lt;b&gt;&lt;i&gt;16&lt;/i&gt;&lt;/b&gt; seconds and read &lt;b&gt;&lt;i&gt;3.6G&lt;/i&gt;&lt;/b&gt; for a non-partitioned table, so that this partitioned table update is twice as faster and reads three times less data.&lt;br /&gt;It might have seen as if there were no statement restarts but it would be a misconception. The relevant entries from the trace file are below:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[19,21]"&gt;PARSING IN CURSOR #140643497507696 len=51 dep=0 uid=138 oct=6 lid=138 tim=2670664237436 hv=762201579 ad='ba7d5268' sqlid='2k4ggcsqqwjgb'&lt;br /&gt;update big_part&lt;br /&gt;   set val = val + 1&lt;br /&gt; where val = 1&lt;br /&gt;END OF STMT&lt;br /&gt;PARSE #140643497507696:c=42246,e=64115,p=14,cr=291,cu=0,mis=1,r=0,dep=0,og=1,plh=1296248929,tim=2670664237436&lt;br /&gt;updSetExecCmpColInfo: not RHS: objn=136464, cid=3&lt;br /&gt;  kduukcmpf=0x7fea236d560a, kduukcmpl=0x7fea236d5608, kduukcmpp=(nil)&lt;br /&gt;updThreePhaseExe: objn=136464 phase=NOT LOCKED&lt;br /&gt;updaul: phase is NOT LOCKED snap oldsnap env: (scn: 0x8000.02777f0c  xid: 0x0000.000.00000000  uba: 0x00000000.0000.00  statement num=0  parent xid: xid: 0x0000.000.00000000  scn: 0x0000.00000000  97sch: scn: 0x0000.00000000  mascn: (scn: 0x8000.02777ef6) env: (scn: 0x0000.00000000  xid: 0x0000.000.00000000  uba: 0x00000000.0000.00  statement num=0  parent xid: xid: 0x0000.000.00000000  scn: 0x0000.00000000  512sch: scn: 0x0000.00000000  mascn: (scn: 0x0000.00000000)&lt;br /&gt;..&lt;br /&gt;updrow: kauupd objn:136465 table:0 rowMigrated:FALSE  rowid 00021511.098b274b.34 code 0&lt;br /&gt;updrow: objn=136464 phase=NOT LOCKED&lt;br /&gt;updrow: kauupd objn:136465 table:0 rowMigrated:FALSE  rowid 00021511.098b274b.35 code 0&lt;br /&gt;updrow: objn=136464 phase=NOT LOCKED&lt;br /&gt;updrow: kauupd objn:136465 table:0 rowMigrated:FALSE  rowid 00021511.098b274b.36 code 0&lt;br /&gt;.. a lot of updrow calls ..&lt;br /&gt;..&lt;br /&gt;updrow: objn=136464 error=1551&lt;br /&gt;updrow: qecinvsub objn=136464&lt;br /&gt;updrow: setting ROW_RETRY objn=136464&lt;br /&gt;updrow: retry_this_row: ROW_RETRY set, objn= 136464 phase=NOT LOCKED&lt;br /&gt;updrow: kauupd objn:136465 table:0 rowMigrated:FALSE  rowid 00021511.098b27ab.37 code 0&lt;br /&gt;updrow: objn=136464 phase=NOT LOCKED&lt;br /&gt;..&lt;br /&gt;STAT #140643497507696 id=1 cnt=0 pid=0 pos=1 obj=0 op='UPDATE  BIG_PART (cr=158523 pr=161232 pw=0 str=1 time=7769538 us)'&lt;br /&gt;STAT #140643497507696 id=2 cnt=100000 pid=1 pos=1 obj=0 op='PARTITION HASH SINGLE PARTITION: 1 1 (cr=158514 pr=158508 pw=0 str=1 time=4086054 us cost=43213 size=2035865 card=156605)'&lt;br /&gt;STAT #140643497507696 id=3 cnt=100000 pid=2 pos=1 obj=136464 op='TABLE ACCESS FULL BIG_PART PARTITION: 1 1 (cr=158514 pr=158508 pw=0 str=1 time=4063030 us cost=43213 size=2035865 card=156605)'&lt;br /&gt;&lt;/pre&gt;Although we got the same &lt;b&gt;&lt;i&gt;ORA-01551&lt;/i&gt;&lt;/b&gt; error, it was gracefully handled using some &lt;b&gt;&lt;i&gt;ROW_RETRY&lt;/i&gt;&lt;/b&gt; logic without resorting to the &lt;b&gt;&lt;i&gt;LOCK/UPDATE&lt;/i&gt;&lt;/b&gt; sequence.&lt;br /&gt;It can also be spotted that Oracle uses the &lt;b&gt;&lt;i&gt;updrow&lt;/i&gt;&lt;/b&gt; function whereas it used &lt;b&gt;&lt;i&gt;updrowFastPath&lt;/i&gt;&lt;/b&gt; for the non-partitioned table from my previous post.&lt;br /&gt;It seems to be because of a different code path - partitioned tables just processed by another routine within Oracle kernel: &lt;b&gt;&lt;i&gt;updrow&lt;/i&gt;&lt;/b&gt;.&lt;br /&gt;Non-partitioned tables are going through the &lt;b&gt;&lt;i&gt;updrowFastPath&lt;/i&gt;&lt;/b&gt; function that does not follow the cheap &lt;b&gt;&lt;i&gt;ROW_RETRY&lt;/i&gt;&lt;/b&gt; flow, so when we get an &lt;b&gt;&lt;i&gt;ORA-01551&lt;/i&gt;&lt;/b&gt; error the underlying Oracle routine restarts the whole statement from scratch to pass it through the &lt;b&gt;&lt;i&gt;LOCK/UPDATE&lt;/i&gt;&lt;/b&gt; sequence.&lt;br /&gt;&lt;br /&gt;&lt;h3&gt;tl;dr.&lt;/h3&gt;This post demonstrates that a certain kind of statement restart, which are presumably caused by &lt;b&gt;&lt;i&gt;ORA-01551&lt;/i&gt;&lt;/b&gt;, are handled differently for partitioned tables than for non-partitioned ones.&lt;br /&gt;The consequences are such that updates performed to partitioned tables can be much faster than the same updates against non-partitioned tables (it was twice as faster in the example from this post).&lt;br /&gt;Hence, that is where this joking title &lt;b&gt;&lt;i&gt;getting what you pay for&lt;/i&gt;&lt;/b&gt; is coming from - &lt;b&gt;&lt;i&gt;Oracle Partitioning&lt;/i&gt;&lt;/b&gt; option costs money after all (I don't want to say that Oracle made this deliberately - it's just a random consequence of that statement restart anomaly).</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/2085773282037377198/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/08/that-old-restart-problem-strikes-back_2.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/2085773282037377198'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/2085773282037377198'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/08/that-old-restart-problem-strikes-back_2.html' title='That Old Restart Problem Strikes Back: Getting What You Pay for'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-5143576580814883534</id><published>2019-08-01T23:50:00.000+06:00</published><updated>2019-08-02T16:18:12.715+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-01551'/><title type='text'>That Old Restart Problem Strikes Back: Setting the Stage</title><content type='html'>When I was reading about &lt;a href="https://asktom.oracle.com/Misc/that-old-restart-problem-again.html"&gt;statement restarts&lt;/a&gt;, I thought it usually happens in a multi-user system or in the presence of triggers. However, last week one of our developers asked me to help him to figure out why a simple update statement was reading far more data than it was in the table. That blog post is published to share my findings about that.&lt;br /&gt;I created a simple non-partitioned table for this demo that I performed on the Oracle Database &lt;b&gt;&lt;i&gt;12.2.0.1.190416&lt;/i&gt;&lt;/b&gt; (the issue has been also reproduced on &lt;b&gt;&lt;i&gt;19.4.0.0.190716&lt;/i&gt;&lt;/b&gt;):&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; create table big(id int, pad char(100), val int);&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; insert /*+ append*/&lt;br /&gt;  2    into big&lt;br /&gt;  3  select rownum,&lt;br /&gt;  4         'x',&lt;br /&gt;  5         case&lt;br /&gt;  6           when rownum &lt;= 10000000 - 100000&lt;br /&gt;  7           then 0&lt;br /&gt;  8           else 1&lt;br /&gt;  9         end&lt;br /&gt; 10    from xmltable('1 to 10000000');&lt;br /&gt;&lt;br /&gt;10000000 rows created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select blocks, bytes/power(2,20) mbytes&lt;br /&gt;  2    from user_segments&lt;br /&gt;  3   where segment_name = 'BIG';&lt;br /&gt;&lt;br /&gt;    BLOCKS     MBYTES&lt;br /&gt;---------- ----------&lt;br /&gt;    163840       1280&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select val, count(*)&lt;br /&gt;  2    from big&lt;br /&gt;  3   group by val&lt;br /&gt;  4   order by val;&lt;br /&gt;&lt;br /&gt;       VAL   COUNT(*)&lt;br /&gt;---------- ----------&lt;br /&gt;         0    9900000&lt;br /&gt;         1     100000&lt;br /&gt;&lt;/pre&gt;It has 10M rows and 163K blocks occupying &lt;b&gt;&lt;i&gt;1280MB&lt;/i&gt;&lt;/b&gt;; there are 9.9M 0's and 100K 1's.&lt;br /&gt;Now I am going to update that table and set all VAL=1 to 2 (I will be using a new session because I am going to query some statistics as well):&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; select name, value&lt;br /&gt;  2    from v$mystat natural join v$statname&lt;br /&gt;  3   where name in ('db block gets', 'consistent gets')&lt;br /&gt;  4   order by name;&lt;br /&gt;&lt;br /&gt;NAME                                                                  VALUE&lt;br /&gt;---------------------------------------------------------------- ----------&lt;br /&gt;consistent gets                                                          45&lt;br /&gt;db block gets                                                             3&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; update big&lt;br /&gt;  2     set val = val + 1&lt;br /&gt;  3   where val = 1;&lt;br /&gt;&lt;br /&gt;100000 rows updated.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select name, value&lt;br /&gt;  2    from v$mystat natural join v$statname&lt;br /&gt;  3   where name in ('db block gets', 'consistent gets')&lt;br /&gt;  4   order by name;&lt;br /&gt;&lt;br /&gt;NAME                                                                  VALUE&lt;br /&gt;---------------------------------------------------------------- ----------&lt;br /&gt;consistent gets                                                      479962&lt;br /&gt;db block gets                                                        107064&lt;br /&gt;&lt;/pre&gt;It's a slightly unusual number of consistent gets given that that table has only 163K blocks.&lt;br /&gt;Let's see how the SQL Monitoring report looks like:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[31,39,40,41]"&gt;SQL&gt; select dbms_sqltune.report_sql_monitor('7z5h5dg0pa0fv') from dual;&lt;br /&gt;&lt;br /&gt;DBMS_SQLTUNE.REPORT_SQL_MONITOR('7Z5H5DG0PA0FV')&lt;br /&gt;------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL Monitoring Report&lt;br /&gt;&lt;br /&gt;SQL Text&lt;br /&gt;------------------------------&lt;br /&gt;update big set val = val + 1 where val = 1&lt;br /&gt;&lt;br /&gt;Global Information&lt;br /&gt;------------------------------&lt;br /&gt; Status              :  DONE&lt;br /&gt; Instance ID         :  1&lt;br /&gt; Session             :  TC (15:16913)&lt;br /&gt; SQL ID              :  7z5h5dg0pa0fv&lt;br /&gt; SQL Execution ID    :  16777224&lt;br /&gt; Execution Started   :  08/01/2019 07:53:30&lt;br /&gt; First Refresh Time  :  08/01/2019 07:53:34&lt;br /&gt; Last Refresh Time   :  08/01/2019 07:53:46&lt;br /&gt; Duration            :  16s&lt;br /&gt; Module/Action       :  SQL*Plus/-&lt;br /&gt; Service             :  pdb&lt;br /&gt; Program             :  sqlplus.exe&lt;br /&gt;&lt;br /&gt;Global Stats&lt;br /&gt;========================================================&lt;br /&gt;| Elapsed |   Cpu   |    IO    | Buffer | Read | Read  |&lt;br /&gt;| Time(s) | Time(s) | Waits(s) |  Gets  | Reqs | Bytes |&lt;br /&gt;========================================================&lt;br /&gt;|      17 |    5.80 |       11 |   587K | 6786 |   4GB |&lt;br /&gt;========================================================&lt;br /&gt;&lt;br /&gt;SQL Plan Monitoring Details (Plan Hash Value=3225303172)&lt;br /&gt;======================================================================================================================================================&lt;br /&gt;| Id |      Operation       | Name |  Rows   | Cost  |   Time    | Start  | Execs |   Rows   | Read | Read  | Activity |       Activity Detail       |&lt;br /&gt;|    |                      |      | (Estim) |       | Active(s) | Active |       | (Actual) | Reqs | Bytes |   (%)    |         (# samples)         |&lt;br /&gt;======================================================================================================================================================&lt;br /&gt;|  0 | UPDATE STATEMENT     |      |         |       |        11 |     +6 |     3 |        0 |      |       |          |                             |&lt;br /&gt;|  1 |   UPDATE             | BIG  |         |       |        11 |     +6 |     3 |        0 | 1502 |  12MB |    13.33 | Cpu (2)                     |&lt;br /&gt;|  2 |    TABLE ACCESS FULL | BIG  |      5M | 43216 |        16 |     +1 |     3 |     205K | 5284 |   4GB |    86.67 | Cpu (3)                     |&lt;br /&gt;|    |                      |      |         |       |           |        |       |          |      |       |          | db file scattered read (10) |&lt;br /&gt;======================================================================================================================================================&lt;br /&gt;&lt;/pre&gt;So my session read &lt;b&gt;&lt;i&gt;4G&lt;/i&gt;&lt;/b&gt; and all plan lines started thrice. Here is the exact amount of data read:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; select physical_read_bytes/power(2,20) read_mbytes&lt;br /&gt;  2    from v$sql_monitor&lt;br /&gt;  3   where sql_id = '7z5h5dg0pa0fv'&lt;br /&gt;  4     and sql_exec_id = 16777224&lt;br /&gt;  5     and sid = sys_context('userenv', 'sid');&lt;br /&gt;&lt;br /&gt;READ_MBYTES&lt;br /&gt;-----------&lt;br /&gt; 3689.39063&lt;br /&gt;&lt;/pre&gt;Remember, that the table's size is &lt;b&gt;&lt;i&gt;1200M&lt;/i&gt;&lt;/b&gt;, so that we read that table three times. It can be also confirmed by looking into the raw trace file (notice the &lt;b&gt;&lt;i&gt;str=3&lt;/i&gt;&lt;/b&gt; string which means that that row-source started three times):&lt;br /&gt;&lt;pre class="brush:sql"&gt;STAT #140538058031192 id=1 cnt=0 pid=0 pos=1 obj=0 op='UPDATE  BIG (cr=322910 pr=315316 pw=0 str=3 time=11011457 us)'&lt;br /&gt;STAT #140538058031192 id=2 cnt=205426 pid=1 pos=1 obj=136452 op='TABLE ACCESS FULL BIG (cr=479905 pr=470740 pw=0 str=3 time=13478866 us cost=43216 size=15000000 card=5000000)'&lt;br /&gt;&lt;/pre&gt;If I set some diagnostic events in my session:&lt;br /&gt;&lt;pre class="brush:sql"&gt;alter session set events 'trace[dml]:sql_trace wait=true';&lt;br /&gt;&lt;/pre&gt;I am able to see what is going on in the trace file:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[9,12,14,15,24]"&gt;PARSING IN CURSOR #140538058031192 len=46 dep=0 uid=138 oct=6 lid=138 tim=2665107653071 hv=3243573723 ad='c7471690' sqlid='7z5h5dg0pa0fv'&lt;br /&gt;update big&lt;br /&gt;   set val = val + 1&lt;br /&gt; where val = 1&lt;br /&gt;END OF STMT&lt;br /&gt;PARSE #140538058031192:c=1704,e=1744,p=0,cr=0,cu=0,mis=1,r=0,dep=0,og=1,plh=3225303172,tim=2665107653070&lt;br /&gt;updSetExecCmpColInfo: not RHS: objn=136452, cid=3&lt;br /&gt;  kduukcmpf=0x7fd1968399ea, kduukcmpl=0x7fd1968399e8, kduukcmpp=(nil)&lt;br /&gt;updThreePhaseExe: objn=136452 phase=NOT LOCKED&lt;br /&gt;updaul: phase is NOT LOCKED snap oldsnap env: (scn: 0x8000.02774b2c  xid: 0x0000.000.00000000  uba: 0x00000000.0000.00  statement num=0  parent xid: xid: 0x0000.000.00000000  scn: 0x0000.00000000  97sch: scn: 0x0000.00000000  mascn: (scn: 0x8000.02774b0e) env: (scn: 0x0000.00000000  xid: 0x0000.000.00000000  uba: 0x00000000.0000.00  statement num=0  parent xid: xid: 0x0000.000.00000000  scn: 0x0000.00000000  512sch: scn: 0x0000.00000000  mascn: (scn: 0x0000.00000000)&lt;br /&gt;...&lt;br /&gt;updrowFastPath: objn=136452 error=1551&lt;br /&gt;updrowFastPath: qecinvsub objn=136452&lt;br /&gt;updrowFastPath: resignal error due to array update objn=136452updaul: objn=136452 error=1551&lt;br /&gt;updThreePhaseExe: objn=136452 phase=LOCK&lt;br /&gt;updaul: phase is LOCK snap oldsnap env: (scn: 0x8000.02774b2e  xid: 0x0008.009.00009487  uba: 0x00000000.0000.00  statement num=0  parent xid: xid: 0x0000.000.00000000  scn: 0x8000.02774b2e  97sch: scn: 0x0000.00000000  mascn: (scn: 0x8000.02774b0e) env: (scn: 0x8000.02774b2c  xid: 0x0000.000.00000000  uba: 0x00000000.0000.00  statement num=0  parent xid: xid: 0x0000.000.00000000  scn: 0x0000.00000000  608sch: scn: 0x0000.00000000  mascn: (scn: 0x8000.02774b0e)&lt;br /&gt;...&lt;br /&gt;updrowFastPath: kddlkr objn 136452 table 0  rowid 00021504.09874962.34 code 0&lt;br /&gt;updrowFastPath: kddlkr objn 136452 table 0  rowid 00021504.09874962.35 code 0&lt;br /&gt;updrowFastPath: kddlkr objn 136452 table 0  rowid 00021504.09874962.36 code 0&lt;br /&gt;updrowFastPath: kddlkr objn 136452 table 0  rowid 00021504.09874962.37 code 0&lt;br /&gt;--100K such lines&lt;br /&gt;updrowFastPath: kddlkr objn 136452 table 0  rowid 00021504.09874faf.2c code 0&lt;br /&gt;updThreePhaseExe: objn=136452 phase=ALL LOCKED&lt;br /&gt;updaul: phase is ALL LOCKED snap oldsnap env: (scn: 0x8000.02774b2e  xid: 0x0008.009.00009487  uba: 0x00000000.0000.00  statement num=0  parent xid: xid: 0x0000.000.00000000  scn: 0x8000.02774b2e  96sch: scn: 0x0000.00000000  mascn: (scn: 0&lt;br /&gt;x8000.02774b0e) env: (scn: 0x8000.02774b2c  xid: 0x0000.000.00000000  uba: 0x00000000.0000.00  statement num=0  parent xid: xid: 0x0000.000.00000000  scn: 0x0000.00000000  608sch: scn: 0x0000.00000000  mascn: (scn: 0x8000.02774b0e)&lt;br /&gt;&lt;/pre&gt;Somehow the update hit &lt;b&gt;&lt;i&gt;ORA-01551&lt;/i&gt;&lt;/b&gt; and fell back to the LOCK/UPDATE sequence (which is similar to SELECT FOR UPDATE/UPDATE in SQL).&lt;br /&gt;The table was read three times:&lt;br /&gt;1. the first time we read it at the &lt;b&gt;&lt;i&gt;NOT LOCKED&lt;/i&gt;&lt;/b&gt; stage&lt;br /&gt;2. we seemed to get &lt;b&gt;&lt;i&gt;ORA-01551&lt;/i&gt;&lt;/b&gt; and went through the &lt;b&gt;&lt;i&gt;LOCK&lt;/i&gt;&lt;/b&gt; stage to lock all the rows (the &lt;b&gt;&lt;i&gt;kddlkr&lt;/i&gt;&lt;/b&gt; lines)&lt;br /&gt;3. once we locked all the rows, we reached the &lt;b&gt;&lt;i&gt;ALL LOCKED&lt;/i&gt;&lt;/b&gt; stage and started changing the column&lt;br /&gt;The error appears to be internal for Oracle:&lt;br /&gt;&lt;pre class="brush:sql"&gt;$oerr ora 1551&lt;br /&gt;01551, 00000, "extended rollback segment, pinned blocks released"&lt;br /&gt;// *Cause: Doing recursive extent of rollback segment, trapped internally&lt;br /&gt;//        by the system&lt;br /&gt;// *Action: None&lt;br /&gt;&lt;/pre&gt;It might be related to the &lt;b&gt;&lt;i&gt;_inplace_update_retry&lt;/i&gt;&lt;/b&gt; parameter that has the following description: "inplace update retry for ora1551", but I have not tested it yet.&lt;br /&gt;The closest issue that I found for this error is &lt;a href="https://groups.google.com/forum/#!msg/relcom.comp.dbms.oracle/HOr403spfi0/Xm-mZ2NvDMQJ"&gt;this old thread&lt;/a&gt; (2002) on Google Groups which was left without resolution and a detailed explanation (it's in Russian).&lt;br /&gt;There is also &lt;a href="https://support.oracle.com/rs?type=bug&amp;id=24827102"&gt;Bug 24827102 : PERFORMANCE OF UPDATE STATEMENT IS NOT CONSISTENT&lt;/a&gt; that mentions the same error.&lt;br /&gt;I cannot reproduce this issue every time and it has not happened in one session twice which makes me think that it is related to the undo segment assigned to that transaction (&lt;b&gt;update&lt;/b&gt;: that could happen in one session multiple times as well, my initial observation was wrong).&lt;br /&gt;&lt;br /&gt;&lt;h3&gt;tl;dr.&lt;/h3&gt;DML restarts are possible even in a single-user system. At least, that is how all modern versions of Oracle Database work (I tested 12.2 and 19c).&lt;br /&gt;Thankfully, it's easy to identify them in SQL Monitoring reports or in trace files (when the &lt;b&gt;&lt;i&gt;trace[DML]&lt;/i&gt;&lt;/b&gt; or &lt;b&gt;&lt;i&gt;sql_trace&lt;/i&gt;&lt;/b&gt; events are set).&lt;br /&gt;When you see some unexpected hikes in buffer gets or reads that cannot be explained by the amount of data being processed, it might as well be due to statement restarts as this post demonstrates.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/5143576580814883534/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/08/that-old-restart-problem-strikes-back.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5143576580814883534'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5143576580814883534'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/08/that-old-restart-problem-strikes-back.html' title='That Old Restart Problem Strikes Back: Setting the Stage'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8650676224511024835</id><published>2019-07-31T03:24:00.001+06:00</published><updated>2020-04-15T16:22:03.521+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><title type='text'>Session spending its time IN_CURSOR_CLOSE</title><content type='html'>I encountered that issue originally when I migrated one of my databases to 12.2.0.1.190416.&lt;br /&gt;I started my investigation when observed the following rows in V$ACTIVE_SESSION_HISTORY for one execution:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; select to_char(sample_time, 'hh24:mi:ss') sample_time, sql_id, sql_opname, top_level_sql_id, session_state, event,&lt;br /&gt;  2         trim(case when IN_CONNECTION_MGMT='Y' then ' IN_CONNECTION_MGMT' end||&lt;br /&gt;  3              case when IN_PARSE='Y' then ' IN_PARSE' end||&lt;br /&gt;  4              case when IN_HARD_PARSE='Y' then ' IN_HARD_PARSE' end||&lt;br /&gt;  5              case when IN_SQL_EXECUTION='Y' then ' IN_SQL_EXECUTION' end||&lt;br /&gt;  6              case when IN_PLSQL_EXECUTION='Y' then ' IN_PLSQL_EXECUTION' end||&lt;br /&gt;  7              case when IN_PLSQL_RPC='Y' then ' IN_PLSQL_RPC' end||&lt;br /&gt;  8              case when IN_PLSQL_COMPILATION='Y' then ' IN_PLSQL_COMPILATION' end||&lt;br /&gt;  9              case when IN_JAVA_EXECUTION='Y' then ' IN_JAVA_EXECUTION' end||&lt;br /&gt; 10              case when IN_BIND='Y' then ' IN_BIND' end||&lt;br /&gt; 11              case when IN_CURSOR_CLOSE='Y' then ' IN_CURSOR_CLOSE' end||&lt;br /&gt; 12              case when IN_SEQUENCE_LOAD='Y' then ' IN_SEQUENCE_LOAD' end||&lt;br /&gt; 13              case when IN_INMEMORY_QUERY='Y' then ' IN_INMEMORY_QUERY' end||&lt;br /&gt; 14              case when IN_INMEMORY_POPULATE='Y' then ' IN_INMEMORY_POPULATE' end||&lt;br /&gt; 15              case when IN_INMEMORY_PREPOPULATE='Y' then ' IN_INMEMORY_PREPOPULATE' end||&lt;br /&gt; 16              case when IN_INMEMORY_REPOPULATE='Y' then ' IN_INMEMORY_REPOPULATE' end||&lt;br /&gt; 17              case when IN_INMEMORY_TREPOPULATE='Y' then ' IN_INMEMORY_TREPOPULATE' end||&lt;br /&gt; 18              case when IN_TABLESPACE_ENCRYPTION='Y' then ' IN_TABLESPACE_ENCRYPTION' end) activity&lt;br /&gt; 19    from v$active_session_history&lt;br /&gt; 20   where session_id = 58&lt;br /&gt; 21     and sample_time between timestamp'2019-07-30 20:47:41' and timestamp'2019-07-30 20:48:30'&lt;br /&gt; 22   order by sample_time;&lt;br /&gt;&lt;br /&gt;SAMPLE_T SQL_ID        SQL_OPNAME TOP_LEVEL_SQL SESSION EVENT      ACTIVITY&lt;br /&gt;-------- ------------- ---------- ------------- ------- ---------- ---------------------------------------------------&lt;br /&gt;20:47:42 a6n6qc8g855q6 SELECT     2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION&lt;br /&gt;20:47:43 a6n6qc8g855q6 SELECT     2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION&lt;br /&gt;20:47:44                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:45                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:46                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:47                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:48                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:49                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:50                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:51                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:52                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:53                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:54                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:55                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:56                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:57                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:58                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:47:59                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:00                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:01                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:02                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:03                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:04                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:05                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:06                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:07                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:08                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:09                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:10                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:11                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:12                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:13                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:14                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:15                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:16                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:17                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:18                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:19                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:20                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:21                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:22                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:23                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:24                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:25                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:26                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:27                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:28                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;20:48:29                          2puw0smn3qw99 ON CPU             IN_SQL_EXECUTION IN_PLSQL_EXECUTION IN_CURSOR_CLOSE&lt;br /&gt;&lt;/pre&gt;That was quite unusual as there was no SQL_ID and IN_CURSOR_CLOSE was set to 'Y'.&lt;br /&gt;Here's an over-simplified version of what the session was doing:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[32,33]"&gt;SQL&gt; declare&lt;br /&gt;  2    cursor test_csr is&lt;br /&gt;  3      select t1.*, user_agg_function(to_char(l)) c1&lt;br /&gt;  4        from (select level l from dual connect by level&lt;=30001) t1&lt;br /&gt;  5       group by t1.l;&lt;br /&gt;  6    type test_tbl_type is table of test_csr%rowtype;&lt;br /&gt;  7    v_test_tbl test_tbl_type;&lt;br /&gt;  8  begin&lt;br /&gt;  9    open test_csr;&lt;br /&gt; 10&lt;br /&gt; 11    dbms_output.put_line(systimestamp||' After open');&lt;br /&gt; 12&lt;br /&gt; 13    for i in 1..6&lt;br /&gt; 14    loop&lt;br /&gt; 15      fetch test_csr bulk collect into v_test_tbl limit 5000;&lt;br /&gt; 16      dbms_output.put_line(systimestamp||' After fetch');&lt;br /&gt; 17    end loop;&lt;br /&gt; 18&lt;br /&gt; 19    dbms_output.put_line(systimestamp||' After all fetches');&lt;br /&gt; 20&lt;br /&gt; 21    close test_csr;&lt;br /&gt; 22    dbms_output.put_line(systimestamp||' After close');&lt;br /&gt; 23  end;&lt;br /&gt; 24  /&lt;br /&gt;30-JUL-19 08.47.41.576257000 PM +01:00 After open&lt;br /&gt;30-JUL-19 08.47.41.866173000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 08.47.42.153764000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 08.47.42.455019000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 08.47.42.775041000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 08.47.43.137562000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 08.47.43.688608000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 08.47.43.688630000 PM +01:00 After all fetches&lt;br /&gt;30-JUL-19 08.48.30.799487000 PM +01:00 After close&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:49.80&lt;br /&gt;&lt;/pre&gt;So it performed 6 fetches in 2 seconds and then spent the remaining 47 seconds while closing the cursor, huh?  &lt;a href="https://github.com/brendangregg/FlameGraph"&gt;Flamegraphs&lt;/a&gt; are quite useful in diagnosing such issues: &lt;?xml version="1.0" standalone="no"?&gt;&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;&lt;svg version="1.1" width="1200" height="1606" onload="init(evt)" viewBox="0 0 1200 1606" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"&gt;&lt;!-- Flame graph stack visualization. See https://github.com/brendangregg/FlameGraph for latest version, and http://www.brendangregg.com/flamegraphs.html for examples. --&gt;&lt;!-- NOTES:  --&gt;&lt;defs&gt; &lt;lineargradient id="background" y1="0" y2="1" x1="0" x2="0" &gt;  &lt;stop stop-color="#eeeeee" offset="5%" /&gt;  &lt;stop stop-color="#eeeeb0" offset="95%" /&gt; &lt;/linearGradient&gt;&lt;/defs&gt;&lt;style type="text/css"&gt; text { font-family:Verdana; font-size:12px; fill:rgb(0,0,0); }  #search { opacity:0.1; cursor:pointer; }  #search:hover, #search.show { opacity:1; }  #subtitle { text-anchor:middle; font-color:rgb(160,160,160); }  #title { text-anchor:middle; font-size:17px}  #unzoom { cursor:pointer; }  #frames &gt; *:hover { stroke:black; stroke-width:0.5; cursor:pointer; }  .hide { display:none; }  .parent { opacity:0.5; } &lt;/style&gt;&lt;script type="text/ecmascript"&gt;&lt;![CDATA[  "use strict";  var details, searchbtn, unzoombtn, matchedtxt, svg, searching;  function init(evt) {   details = document.getElementById("details").firstChild;   searchbtn = document.getElementById("search");   unzoombtn = document.getElementById("unzoom");   matchedtxt = document.getElementById("matched");   svg = document.getElementsByTagName("svg")[0];   searching = 0;  }   window.addEventListener("click", function(e) {   var target = find_group(e.target);   if (target) {    if (target.nodeName == "a") {     if (e.ctrlKey === false) return;     e.preventDefault();    }    if (target.classList.contains("parent")) unzoom();    zoom(target);   }   else if (e.target.id == "unzoom") unzoom();   else if (e.target.id == "search") search_prompt();  }, false)   // mouse-over for info  // show  window.addEventListener("mouseover", function(e) {   var target = find_group(e.target);   if (target) details.nodeValue = "Function: " + g_to_text(target);  }, false)   // clear  window.addEventListener("mouseout", function(e) {   var target = find_group(e.target);   if (target) details.nodeValue = ' ';  }, false)   // ctrl-F for search  window.addEventListener("keydown",function (e) {   if (e.keyCode === 114 || (e.ctrlKey &amp;&amp; e.keyCode === 70)) {    e.preventDefault();    search_prompt();   }  }, false)   // functions  function find_child(node, selector) {   var children = node.querySelectorAll(selector);   if (children.length) return children[0];   return;  }  function find_group(node) {   var parent = node.parentElement;   if (!parent) return;   if (parent.id == "frames") return node;   return find_group(parent);  }  function orig_save(e, attr, val) {   if (e.attributes["_orig_" + attr] != undefined) return;   if (e.attributes[attr] == undefined) return;   if (val == undefined) val = e.attributes[attr].value;   e.setAttribute("_orig_" + attr, val);  }  function orig_load(e, attr) {   if (e.attributes["_orig_"+attr] == undefined) return;   e.attributes[attr].value = e.attributes["_orig_" + attr].value;   e.removeAttribute("_orig_"+attr);  }  function g_to_text(e) {   var text = find_child(e, "title").firstChild.nodeValue;   return (text)  }  function g_to_func(e) {   var func = g_to_text(e);   // if there's any manipulation we want to do to the function   // name before it's searched, do it here before returning.   return (func);  }  function update_text(e) {   var r = find_child(e, "rect");   var t = find_child(e, "text");   var w = parseFloat(r.attributes.width.value) -3;   var txt = find_child(e, "title").textContent.replace(/\([^(]*\)$/,"");   t.attributes.x.value = parseFloat(r.attributes.x.value) + 3;    // Smaller than this size won't fit anything   if (w &lt; 2 * 12 * 0.59) {    t.textContent = "";    return;   }    t.textContent = txt;   // Fit in full text width   if (/^ *$/.test(txt) || t.getSubStringLength(0, txt.length) &lt; w)    return;    for (var x = txt.length - 2; x &gt; 0; x--) {    if (t.getSubStringLength(0, x + 2) &lt;= w) {     t.textContent = txt.substring(0, x) + "..";     return;    }   }   t.textContent = "";  }   // zoom  function zoom_reset(e) {   if (e.attributes != undefined) {    orig_load(e, "x");    orig_load(e, "width");   }   if (e.childNodes == undefined) return;   for (var i = 0, c = e.childNodes; i &lt; c.length; i++) {    zoom_reset(c[i]);   }  }  function zoom_child(e, x, ratio) {   if (e.attributes != undefined) {    if (e.attributes.x != undefined) {     orig_save(e, "x");     e.attributes.x.value = (parseFloat(e.attributes.x.value) - x - 10) * ratio + 10;     if (e.tagName == "text")      e.attributes.x.value = find_child(e.parentNode, "rect[x]").attributes.x.value + 3;    }    if (e.attributes.width != undefined) {     orig_save(e, "width");     e.attributes.width.value = parseFloat(e.attributes.width.value) * ratio;    }   }    if (e.childNodes == undefined) return;   for (var i = 0, c = e.childNodes; i &lt; c.length; i++) {    zoom_child(c[i], x - 10, ratio);   }  }  function zoom_parent(e) {   if (e.attributes) {    if (e.attributes.x != undefined) {     orig_save(e, "x");     e.attributes.x.value = 10;    }    if (e.attributes.width != undefined) {     orig_save(e, "width");     e.attributes.width.value = parseInt(svg.width.baseVal.value) - (10 * 2);    }   }   if (e.childNodes == undefined) return;   for (var i = 0, c = e.childNodes; i &lt; c.length; i++) {    zoom_parent(c[i]);   }  }  function zoom(node) {   var attr = find_child(node, "rect").attributes;   var width = parseFloat(attr.width.value);   var xmin = parseFloat(attr.x.value);   var xmax = parseFloat(xmin + width);   var ymin = parseFloat(attr.y.value);   var ratio = (svg.width.baseVal.value - 2 * 10) / width;    // XXX: Workaround for JavaScript float issues (fix me)   var fudge = 0.0001;    unzoombtn.classList.remove("hide");    var el = document.getElementById("frames").children;   for (var i = 0; i &lt; el.length; i++) {    var e = el[i];    var a = find_child(e, "rect").attributes;    var ex = parseFloat(a.x.value);    var ew = parseFloat(a.width.value);    var upstack;    // Is it an ancestor    if (0 == 0) {     upstack = parseFloat(a.y.value) &gt; ymin;    } else {     upstack = parseFloat(a.y.value) &lt; ymin;    }    if (upstack) {     // Direct ancestor     if (ex &lt;= xmin &amp;&amp; (ex+ew+fudge) &gt;= xmax) {      e.classList.add("parent");      zoom_parent(e);      update_text(e);     }     // not in current path     else      e.classList.add("hide");    }    // Children maybe    else {     // no common path     if (ex &lt; xmin || ex + fudge &gt;= xmax) {      e.classList.add("hide");     }     else {      zoom_child(e, xmin, ratio);      update_text(e);     }    }   }  }  function unzoom() {   unzoombtn.classList.add("hide");   var el = document.getElementById("frames").children;   for(var i = 0; i &lt; el.length; i++) {    el[i].classList.remove("parent");    el[i].classList.remove("hide");    zoom_reset(el[i]);    update_text(el[i]);   }  }   // search  function reset_search() {   var el = document.querySelectorAll("#frames rect");   for (var i = 0; i &lt; el.length; i++) {    orig_load(el[i], "fill")   }  }  function search_prompt() {   if (!searching) {    var term = prompt("Enter a search term (regexp " +        "allowed, eg: ^ext4_)", "");    if (term != null) {     search(term)    }   } else {    reset_search();    searching = 0;    searchbtn.classList.remove("show");    searchbtn.firstChild.nodeValue = "Search"    matchedtxt.classList.add("hide");    matchedtxt.firstChild.nodeValue = ""   }  }  function search(term) {   var re = new RegExp(term);   var el = document.getElementById("frames").children;   var matches = new Object();   var maxwidth = 0;   for (var i = 0; i &lt; el.length; i++) {    var e = el[i];    var func = g_to_func(e);    var rect = find_child(e, "rect");    if (func == null || rect == null)     continue;     // Save max width. Only works as we have a root frame    var w = parseFloat(rect.attributes.width.value);    if (w &gt; maxwidth)     maxwidth = w;     if (func.match(re)) {     // highlight     var x = parseFloat(rect.attributes.x.value);     orig_save(rect, "fill");     rect.attributes.fill.value = "rgb(230,0,230)";      // remember matches     if (matches[x] == undefined) {      matches[x] = w;     } else {      if (w &gt; matches[x]) {       // overwrite with parent       matches[x] = w;      }     }     searching = 1;    }   }   if (!searching)    return;    searchbtn.classList.add("show");   searchbtn.firstChild.nodeValue = "Reset Search";    // calculate percent matched, excluding vertical overlap   var count = 0;   var lastx = -1;   var lastw = 0;   var keys = Array();   for (k in matches) {    if (matches.hasOwnProperty(k))     keys.push(k);   }   // sort the matched frames by their x location   // ascending, then width descending   keys.sort(function(a, b){    return a - b;   });   // Step through frames saving only the biggest bottom-up frames   // thanks to the sort order. This relies on the tree property   // where children are always smaller than their parents.   var fudge = 0.0001; // JavaScript floating point   for (var k in keys) {    var x = parseFloat(keys[k]);    var w = matches[keys[k]];    if (x &gt;= lastx + lastw - fudge) {     count += w;     lastx = x;     lastw = w;    }   }   // display matched percent   matchedtxt.classList.remove("hide");   var pct = 100 * count / maxwidth;   if (pct != 100) pct = pct.toFixed(1)   matchedtxt.firstChild.nodeValue = "Matched: " + pct + "%";  } ]]&gt;&lt;/script&gt;&lt;rect x="0.0" y="0" width="1200.0" height="1606.0" fill="url(#background)"  /&gt;&lt;text id="title" x="600.00" y="24" &gt;Flame Graph&lt;/text&gt;&lt;text id="details" x="10.00" y="1589" &gt; &lt;/text&gt;&lt;text id="unzoom" x="10.00" y="24" class="hide"&gt;Reset Zoom&lt;/text&gt;&lt;text id="search" x="1090.00" y="24" &gt;Search&lt;/text&gt;&lt;text id="matched" x="1090.00" y="1589" &gt; &lt;/text&gt;&lt;g id="frames"&gt;&lt;g &gt;&lt;title&gt;kolrgrfc2 (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="65.7" y="821" width="0.9" height="15.0" fill="rgb(212,94,38)" rx="2" ry="2" /&gt;&lt;text  x="68.69" y="831.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1177.5" y="741" width="0.3" height="15.0" fill="rgb(207,135,5)" rx="2" ry="2" /&gt;&lt;text  x="1180.53" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sou2o (4,061 samples, 99.83%)&lt;/title&gt;&lt;rect x="10.0" y="1461" width="1178.0" height="15.0" fill="rgb(205,130,11)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1471.5" &gt;sou2o&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;psdghp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="58.7" y="757" width="0.3" height="15.0" fill="rgb(241,48,23)" rx="2" ry="2" /&gt;&lt;text  x="61.73" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sys_mmap_pgoff (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="1188.3" y="1461" width="1.7" height="15.0" fill="rgb(243,52,30)" rx="2" ry="2" /&gt;&lt;text  x="1191.26" y="1471.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbgcur (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="895.6" y="629" width="0.3" height="15.0" fill="rgb(211,119,49)" rx="2" ry="2" /&gt;&lt;text  x="898.58" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrrun_no_tool (141 samples, 3.47%)&lt;/title&gt;&lt;rect x="19.0" y="821" width="40.9" height="15.0" fill="rgb(236,76,51)" rx="2" ry="2" /&gt;&lt;text  x="21.99" y="831.5" &gt;pfr..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkxexe (4,061 samples, 99.83%)&lt;/title&gt;&lt;rect x="10.0" y="1317" width="1178.0" height="15.0" fill="rgb(230,222,33)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1327.5" &gt;kkxexe&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaFree_rfc (3,832 samples, 94.20%)&lt;/title&gt;&lt;rect x="66.6" y="789" width="1111.5" height="15.0" fill="rgb(246,211,14)" rx="2" ry="2" /&gt;&lt;text  x="69.56" y="799.5" &gt;kolaFree_rfc&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdl_write1 (82 samples, 2.02%)&lt;/title&gt;&lt;rect x="19.6" y="597" width="23.8" height="15.0" fill="rgb(253,137,24)" rx="2" ry="2" /&gt;&lt;text  x="22.57" y="607.5" &gt;k..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rcu_process_callbacks (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="336.0" y="597" width="0.3" height="15.0" fill="rgb(249,19,13)" rx="2" ry="2" /&gt;&lt;text  x="339.04" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrinstr_CNVMSC (138 samples, 3.39%)&lt;/title&gt;&lt;rect x="19.0" y="805" width="40.0" height="15.0" fill="rgb(219,13,28)" rx="2" ry="2" /&gt;&lt;text  x="21.99" y="815.5" &gt;pfr..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghbshrt (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="54.7" y="565" width="0.8" height="15.0" fill="rgb(225,154,45)" rx="2" ry="2" /&gt;&lt;text  x="57.67" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pevm_MOVADT (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="64.2" y="885" width="0.3" height="15.0" fill="rgb(233,1,29)" rx="2" ry="2" /&gt;&lt;text  x="67.24" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkxmpbms (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="789" width="0.3" height="15.0" fill="rgb(207,167,8)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaAssign_rfc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="11.5" y="917" width="0.2" height="15.0" fill="rgb(230,71,23)" rx="2" ry="2" /&gt;&lt;text  x="14.45" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__intel_new_memset (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="18.1" y="869" width="0.3" height="15.0" fill="rgb(206,41,5)" rx="2" ry="2" /&gt;&lt;text  x="21.12" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbivbr (5 samples, 0.12%)&lt;/title&gt;&lt;rect x="894.1" y="629" width="1.5" height="15.0" fill="rgb(218,44,53)" rx="2" ry="2" /&gt;&lt;text  x="897.13" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_softirq (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="59.6" y="693" width="0.3" height="15.0" fill="rgb(224,169,35)" rx="2" ry="2" /&gt;&lt;text  x="62.60" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgscReleaseACursor (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1205" width="1113.3" height="15.0" fill="rgb(228,191,4)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1215.5" &gt;kgscReleaseACursor&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfindctl (31 samples, 0.76%)&lt;/title&gt;&lt;rect x="599.7" y="645" width="9.0" height="15.0" fill="rgb(213,101,21)" rx="2" ry="2" /&gt;&lt;text  x="602.71" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghualloc (8 samples, 0.20%)&lt;/title&gt;&lt;rect x="56.4" y="693" width="2.3" height="15.0" fill="rgb(247,162,40)" rx="2" ry="2" /&gt;&lt;text  x="59.41" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfre (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="64.8" y="837" width="0.3" height="15.0" fill="rgb(233,12,41)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;free_hot_cold_page_list (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1188.8" y="1269" width="0.6" height="15.0" fill="rgb(205,45,51)" rx="2" ry="2" /&gt;&lt;text  x="1191.84" y="1279.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlclose (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="43.6" y="549" width="0.3" height="15.0" fill="rgb(229,0,24)" rx="2" ry="2" /&gt;&lt;text  x="46.65" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstdle_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1187.7" y="1029" width="0.3" height="15.0" fill="rgb(225,166,47)" rx="2" ry="2" /&gt;&lt;text  x="1190.68" y="1039.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;irq_exit (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="880.5" y="597" width="0.9" height="15.0" fill="rgb(227,178,45)" rx="2" ry="2" /&gt;&lt;text  x="883.50" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklwrite (88 samples, 2.16%)&lt;/title&gt;&lt;rect x="19.3" y="645" width="25.5" height="15.0" fill="rgb(206,168,18)" rx="2" ry="2" /&gt;&lt;text  x="22.28" y="655.5" &gt;k..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;entry_SYSCALL_64_after_hwframe (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="277" width="0.3" height="15.0" fill="rgb(229,120,21)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="287.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkxmpexe (142 samples, 3.49%)&lt;/title&gt;&lt;rect x="18.7" y="917" width="41.2" height="15.0" fill="rgb(207,25,31)" rx="2" ry="2" /&gt;&lt;text  x="21.70" y="927.5" &gt;kkx..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opifcr (14 samples, 0.34%)&lt;/title&gt;&lt;rect x="10.9" y="1013" width="4.0" height="15.0" fill="rgb(253,95,36)" rx="2" ry="2" /&gt;&lt;text  x="13.87" y="1023.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpidru (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1141" width="0.3" height="15.0" fill="rgb(247,26,45)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1151.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksl_get_shared_latch_int (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="895.0" y="565" width="0.6" height="15.0" fill="rgb(247,159,39)" rx="2" ry="2" /&gt;&lt;text  x="898.00" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pdy1F80_Generate_Code (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="629" width="0.3" height="15.0" fill="rgb(230,24,8)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kco_issue_callback (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="897.9" y="565" width="0.3" height="15.0" fill="rgb(237,2,30)" rx="2" ry="2" /&gt;&lt;text  x="900.90" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbchg1_main (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="21.6" y="437" width="0.6" height="15.0" fill="rgb(230,157,15)" rx="2" ry="2" /&gt;&lt;text  x="24.60" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;anon_vma_interval_tree_remove (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1189.7" y="1365" width="0.3" height="15.0" fill="rgb(241,76,5)" rx="2" ry="2" /&gt;&lt;text  x="1192.71" y="1375.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrddc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1187.7" y="1045" width="0.3" height="15.0" fill="rgb(210,139,13)" rx="2" ry="2" /&gt;&lt;text  x="1190.68" y="1055.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrempty (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="10.0" y="1221" width="0.6" height="15.0" fill="rgb(205,147,6)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1231.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_async_page_fault (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="56.7" y="597" width="0.3" height="15.0" fill="rgb(206,198,27)" rx="2" ry="2" /&gt;&lt;text  x="59.70" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kocedd (33 samples, 0.81%)&lt;/title&gt;&lt;rect x="1178.4" y="1189" width="9.6" height="15.0" fill="rgb(215,99,33)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1199.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlt_createtemp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="45.1" y="581" width="0.3" height="15.0" fill="rgb(248,71,35)" rx="2" ry="2" /&gt;&lt;text  x="48.10" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__intel_new_memset (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="55.8" y="693" width="0.6" height="15.0" fill="rgb(232,213,23)" rx="2" ry="2" /&gt;&lt;text  x="58.83" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koltitfr (31 samples, 0.76%)&lt;/title&gt;&lt;rect x="1178.7" y="1013" width="9.0" height="15.0" fill="rgb(246,187,50)" rx="2" ry="2" /&gt;&lt;text  x="1181.69" y="1023.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_raw_spin_lock_irq (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="42.5" y="373" width="0.3" height="15.0" fill="rgb(244,155,54)" rx="2" ry="2" /&gt;&lt;text  x="45.49" y="383.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__handle_mm_fault (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="57.9" y="581" width="0.5" height="15.0" fill="rgb(223,35,45)" rx="2" ry="2" /&gt;&lt;text  x="60.86" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlgsp (13 samples, 0.32%)&lt;/title&gt;&lt;rect x="20.4" y="565" width="3.8" height="15.0" fill="rgb(213,6,1)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbbscn (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="21.0" y="517" width="1.8" height="15.0" fill="rgb(220,185,53)" rx="2" ry="2" /&gt;&lt;text  x="24.02" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kfk_submit_lib_io (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="325" width="0.3" height="15.0" fill="rgb(207,63,37)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="335.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbbset (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="21.3" y="485" width="1.2" height="15.0" fill="rgb(227,92,45)" rx="2" ry="2" /&gt;&lt;text  x="24.31" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalo (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="54.7" y="581" width="1.1" height="15.0" fill="rgb(229,128,4)" rx="2" ry="2" /&gt;&lt;text  x="57.67" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbgcur (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="23.3" y="469" width="0.3" height="15.0" fill="rgb(234,220,47)" rx="2" ry="2" /&gt;&lt;text  x="26.34" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kfioRequestPriv (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="405" width="0.3" height="15.0" fill="rgb(230,223,28)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="415.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pdw0F82_Run_Code_Gen (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="661" width="0.3" height="15.0" fill="rgb(251,118,5)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcoapl (53 samples, 1.30%)&lt;/title&gt;&lt;rect x="27.4" y="501" width="15.4" height="15.0" fill="rgb(229,170,45)" rx="2" ry="2" /&gt;&lt;text  x="30.40" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sltrgatime64 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="899.1" y="581" width="0.3" height="15.0" fill="rgb(226,11,15)" rx="2" ry="2" /&gt;&lt;text  x="902.06" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;apic_timer_interrupt (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="42.5" y="437" width="0.3" height="15.0" fill="rgb(223,121,1)" rx="2" ry="2" /&gt;&lt;text  x="45.49" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbbsrch (7 samples, 0.17%)&lt;/title&gt;&lt;rect x="21.0" y="533" width="2.1" height="15.0" fill="rgb(253,186,49)" rx="2" ry="2" /&gt;&lt;text  x="24.02" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;tlb_flush_mmu (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1188.8" y="1333" width="0.6" height="15.0" fill="rgb(242,70,12)" rx="2" ry="2" /&gt;&lt;text  x="1191.84" y="1343.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbvopn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="22.8" y="517" width="0.3" height="15.0" fill="rgb(239,172,3)" rx="2" ry="2" /&gt;&lt;text  x="25.76" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="56.4" y="661" width="1.2" height="15.0" fill="rgb(209,75,20)" rx="2" ry="2" /&gt;&lt;text  x="59.41" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opipls (187 samples, 4.60%)&lt;/title&gt;&lt;rect x="10.6" y="1077" width="54.2" height="15.0" fill="rgb(227,152,32)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1087.5" &gt;opipls&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kole_t2u_int (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="44.5" y="597" width="0.3" height="15.0" fill="rgb(212,117,52)" rx="2" ry="2" /&gt;&lt;text  x="47.52" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrdrfc (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1173.5" y="693" width="0.5" height="15.0" fill="rgb(216,88,31)" rx="2" ry="2" /&gt;&lt;text  x="1176.47" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koccngt (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="63.4" y="933" width="0.3" height="15.0" fill="rgb(237,192,27)" rx="2" ry="2" /&gt;&lt;text  x="66.37" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalo (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="54.7" y="629" width="1.1" height="15.0" fill="rgb(234,161,10)" rx="2" ry="2" /&gt;&lt;text  x="57.67" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrarfc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="59.3" y="725" width="0.3" height="15.0" fill="rgb(218,89,35)" rx="2" ry="2" /&gt;&lt;text  x="62.31" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sys_mmap (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="1188.3" y="1477" width="1.7" height="15.0" fill="rgb(220,196,18)" rx="2" ry="2" /&gt;&lt;text  x="1191.26" y="1487.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrrun (141 samples, 3.47%)&lt;/title&gt;&lt;rect x="19.0" y="837" width="40.9" height="15.0" fill="rgb(227,76,0)" rx="2" ry="2" /&gt;&lt;text  x="21.99" y="847.5" &gt;pfr..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_async_page_fault (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="54.7" y="533" width="0.8" height="15.0" fill="rgb(214,200,3)" rx="2" ry="2" /&gt;&lt;text  x="57.67" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_raw_spin_lock (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="54.7" y="437" width="0.6" height="15.0" fill="rgb(232,81,43)" rx="2" ry="2" /&gt;&lt;text  x="57.67" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaAssign_rfc (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="59.0" y="741" width="0.6" height="15.0" fill="rgb(211,158,31)" rx="2" ry="2" /&gt;&lt;text  x="62.02" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__alloc_pages_nodemask (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="55.3" y="421" width="0.2" height="15.0" fill="rgb(219,116,40)" rx="2" ry="2" /&gt;&lt;text  x="58.25" y="431.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qctcopn_internal (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="853" width="0.3" height="15.0" fill="rgb(253,224,45)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kole_t2u (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="44.5" y="613" width="0.3" height="15.0" fill="rgb(250,77,49)" rx="2" ry="2" /&gt;&lt;text  x="47.52" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaslWrite (98 samples, 2.41%)&lt;/title&gt;&lt;rect x="19.3" y="677" width="28.4" height="15.0" fill="rgb(248,19,26)" rx="2" ry="2" /&gt;&lt;text  x="22.28" y="687.5" &gt;ko..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;free_pages_and_swap_cache (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1188.8" y="1301" width="0.6" height="15.0" fill="rgb(221,93,37)" rx="2" ry="2" /&gt;&lt;text  x="1191.84" y="1311.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1173.8" y="661" width="0.2" height="15.0" fill="rgb(224,146,51)" rx="2" ry="2" /&gt;&lt;text  x="1176.76" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="57.0" y="613" width="0.6" height="15.0" fill="rgb(218,216,44)" rx="2" ry="2" /&gt;&lt;text  x="59.99" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opifch2 (187 samples, 4.60%)&lt;/title&gt;&lt;rect x="10.6" y="1045" width="54.2" height="15.0" fill="rgb(247,211,22)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1055.5" &gt;opifch2&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrinstr_RET (33 samples, 0.81%)&lt;/title&gt;&lt;rect x="1178.4" y="1237" width="9.6" height="15.0" fill="rgb(252,166,38)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1247.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolttfr (31 samples, 0.76%)&lt;/title&gt;&lt;rect x="1178.7" y="1029" width="9.0" height="15.0" fill="rgb(227,154,38)" rx="2" ry="2" /&gt;&lt;text  x="1181.69" y="1039.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrdladd (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="50.0" y="661" width="0.3" height="15.0" fill="rgb(236,82,31)" rx="2" ry="2" /&gt;&lt;text  x="53.03" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__GI___libc_poll (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.3" y="805" width="0.3" height="15.0" fill="rgb(220,195,0)" rx="2" ry="2" /&gt;&lt;text  x="64.34" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kfioRequest (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="421" width="0.3" height="15.0" fill="rgb(229,75,21)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="431.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrw (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="67.4" y="725" width="0.9" height="15.0" fill="rgb(232,207,48)" rx="2" ry="2" /&gt;&lt;text  x="70.43" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_vfs_ioctl (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="229" width="0.3" height="15.0" fill="rgb(236,32,50)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="239.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfinddur (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="608.7" y="645" width="0.9" height="15.0" fill="rgb(242,56,23)" rx="2" ry="2" /&gt;&lt;text  x="611.70" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkxpispbn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="59.9" y="933" width="0.3" height="15.0" fill="rgb(224,201,14)" rx="2" ry="2" /&gt;&lt;text  x="62.89" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__schedule (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="1155.8" y="581" width="0.8" height="15.0" fill="rgb(242,151,49)" rx="2" ry="2" /&gt;&lt;text  x="1158.77" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;afdc_execute_ioctl (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="165" width="0.3" height="15.0" fill="rgb(229,38,40)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="175.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbchg1_main (54 samples, 1.33%)&lt;/title&gt;&lt;rect x="27.1" y="517" width="15.7" height="15.0" fill="rgb(212,51,31)" rx="2" ry="2" /&gt;&lt;text  x="30.11" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;main (4,061 samples, 99.83%)&lt;/title&gt;&lt;rect x="10.0" y="1509" width="1178.0" height="15.0" fill="rgb(215,222,0)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1519.5" &gt;main&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;schedule (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="881.4" y="581" width="0.5" height="15.0" fill="rgb(240,182,16)" rx="2" ry="2" /&gt;&lt;text  x="884.37" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgmpia_process_in_args (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="17.8" y="917" width="0.3" height="15.0" fill="rgb(246,69,22)" rx="2" ry="2" /&gt;&lt;text  x="20.83" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrw (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="1174.9" y="693" width="1.2" height="15.0" fill="rgb(234,57,48)" rx="2" ry="2" /&gt;&lt;text  x="1177.92" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kole_ba2l (127 samples, 3.12%)&lt;/title&gt;&lt;rect x="19.0" y="757" width="36.8" height="15.0" fill="rgb(218,165,46)" rx="2" ry="2" /&gt;&lt;text  x="21.99" y="767.5" &gt;kol..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sltrgftime64 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="899.1" y="565" width="0.3" height="15.0" fill="rgb(210,161,36)" rx="2" ry="2" /&gt;&lt;text  x="902.06" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;evapls (146 samples, 3.59%)&lt;/title&gt;&lt;rect x="17.8" y="965" width="42.4" height="15.0" fill="rgb(211,29,48)" rx="2" ry="2" /&gt;&lt;text  x="20.83" y="975.5" &gt;eva..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_setjmp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="60.2" y="981" width="0.3" height="15.0" fill="rgb(229,81,50)" rx="2" ry="2" /&gt;&lt;text  x="63.18" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbrls (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="895.9" y="629" width="0.3" height="15.0" fill="rgb(211,78,44)" rx="2" ry="2" /&gt;&lt;text  x="898.87" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smp_apic_timer_interrupt (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="335.7" y="645" width="0.6" height="15.0" fill="rgb(253,96,48)" rx="2" ry="2" /&gt;&lt;text  x="338.75" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaAssign (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="11.2" y="933" width="0.3" height="15.0" fill="rgb(214,128,36)" rx="2" ry="2" /&gt;&lt;text  x="14.16" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;nsmore2recv (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.3" y="837" width="0.3" height="15.0" fill="rgb(247,227,18)" rx="2" ry="2" /&gt;&lt;text  x="64.34" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__sigsetjmp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="16.4" y="997" width="0.3" height="15.0" fill="rgb(205,51,10)" rx="2" ry="2" /&gt;&lt;text  x="19.38" y="1007.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (923 samples, 22.69%)&lt;/title&gt;&lt;rect x="69.5" y="677" width="267.7" height="15.0" fill="rgb(215,78,0)" rx="2" ry="2" /&gt;&lt;text  x="72.46" y="687.5" &gt;_intel_fast_memcmp&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qesaAddDistValue (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="15.8" y="981" width="0.3" height="15.0" fill="rgb(234,72,8)" rx="2" ry="2" /&gt;&lt;text  x="18.80" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolttfr (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="16.7" y="965" width="0.6" height="15.0" fill="rgb(250,96,49)" rx="2" ry="2" /&gt;&lt;text  x="19.67" y="975.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbbfill (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="21.0" y="501" width="1.8" height="15.0" fill="rgb(233,46,1)" rx="2" ry="2" /&gt;&lt;text  x="24.02" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;phpcmp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="693" width="0.3" height="15.0" fill="rgb(207,139,46)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrinstr_MOVLOB (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="59.0" y="805" width="0.9" height="15.0" fill="rgb(205,85,40)" rx="2" ry="2" /&gt;&lt;text  x="62.02" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opiodr (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1061" width="1113.3" height="15.0" fill="rgb(222,211,40)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1071.5" &gt;opiodr&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcblibr_int (5 samples, 0.12%)&lt;/title&gt;&lt;rect x="894.1" y="645" width="1.5" height="15.0" fill="rgb(240,201,32)" rx="2" ry="2" /&gt;&lt;text  x="897.13" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__vma_adjust (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1189.7" y="1381" width="0.3" height="15.0" fill="rgb(229,118,49)" rx="2" ry="2" /&gt;&lt;text  x="1192.71" y="1391.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;async_page_fault (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="57.6" y="661" width="1.1" height="15.0" fill="rgb(239,59,32)" rx="2" ry="2" /&gt;&lt;text  x="60.57" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_async_page_fault (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="57.6" y="645" width="1.1" height="15.0" fill="rgb(216,122,18)" rx="2" ry="2" /&gt;&lt;text  x="60.57" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;handle_mm_fault (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="56.7" y="549" width="0.3" height="15.0" fill="rgb(239,157,52)" rx="2" ry="2" /&gt;&lt;text  x="59.70" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokapvpr (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="357" width="0.3" height="15.0" fill="rgb(218,124,51)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="367.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlrdo (53 samples, 1.30%)&lt;/title&gt;&lt;rect x="27.4" y="469" width="15.4" height="15.0" fill="rgb(246,78,8)" rx="2" ry="2" /&gt;&lt;text  x="30.40" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_page_fault (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="57.6" y="629" width="1.1" height="15.0" fill="rgb(226,53,21)" rx="2" ry="2" /&gt;&lt;text  x="60.57" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfsadrc (12 samples, 0.29%)&lt;/title&gt;&lt;rect x="11.5" y="997" width="3.4" height="15.0" fill="rgb(225,143,52)" rx="2" ry="2" /&gt;&lt;text  x="14.45" y="1007.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrcomp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="17.0" y="885" width="0.3" height="15.0" fill="rgb(211,62,5)" rx="2" ry="2" /&gt;&lt;text  x="19.96" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrinstr_EXECC (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1237" width="0.3" height="15.0" fill="rgb(252,195,20)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1247.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kpdbHashTable_Find (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="893.8" y="597" width="0.3" height="15.0" fill="rgb(215,7,44)" rx="2" ry="2" /&gt;&lt;text  x="896.84" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;prepare_exit_to_usermode (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="12.6" y="821" width="0.3" height="15.0" fill="rgb(254,23,52)" rx="2" ry="2" /&gt;&lt;text  x="15.61" y="831.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;skgmstack (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1125" width="0.3" height="15.0" fill="rgb(232,7,43)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1135.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbtse_get_tbskey_info1_pdb (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="24.8" y="517" width="0.3" height="15.0" fill="rgb(244,226,51)" rx="2" ry="2" /&gt;&lt;text  x="27.79" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;psddr0 (187 samples, 4.60%)&lt;/title&gt;&lt;rect x="10.6" y="1189" width="54.2" height="15.0" fill="rgb(212,211,12)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1199.5" &gt;psddr0&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollfre (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="67.4" y="757" width="0.9" height="15.0" fill="rgb(245,44,36)" rx="2" ry="2" /&gt;&lt;text  x="70.43" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgmgaocn (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="18.1" y="901" width="0.6" height="15.0" fill="rgb(242,147,15)" rx="2" ry="2" /&gt;&lt;text  x="21.12" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrr (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1176.7" y="725" width="0.2" height="15.0" fill="rgb(224,225,5)" rx="2" ry="2" /&gt;&lt;text  x="1179.66" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kglpin (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="293" width="0.3" height="15.0" fill="rgb(213,135,21)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="303.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkxmesu (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="805" width="0.3" height="15.0" fill="rgb(226,192,33)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;skgmstack (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1093" width="1113.3" height="15.0" fill="rgb(222,100,12)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1103.5" &gt;skgmstack&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kksParseCursor (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1045" width="0.3" height="15.0" fill="rgb(228,28,12)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1055.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgshx (5 samples, 0.12%)&lt;/title&gt;&lt;rect x="899.4" y="613" width="1.4" height="15.0" fill="rgb(229,68,6)" rx="2" ry="2" /&gt;&lt;text  x="902.35" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokacau (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="373" width="0.3" height="15.0" fill="rgb(213,69,54)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="383.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qervwRowProcedure (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="15.2" y="981" width="0.3" height="15.0" fill="rgb(226,81,22)" rx="2" ry="2" /&gt;&lt;text  x="18.22" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__schedule (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="348.8" y="597" width="0.3" height="15.0" fill="rgb(205,35,44)" rx="2" ry="2" /&gt;&lt;text  x="351.80" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrmrg (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="64.8" y="821" width="0.3" height="15.0" fill="rgb(219,78,26)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="831.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qctopls (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="837" width="0.3" height="15.0" fill="rgb(253,41,16)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstine_wfp (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="48.9" y="661" width="1.1" height="15.0" fill="rgb(238,9,54)" rx="2" ry="2" /&gt;&lt;text  x="51.87" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;skgmstack (187 samples, 4.60%)&lt;/title&gt;&lt;rect x="10.6" y="1125" width="54.2" height="15.0" fill="rgb(248,3,33)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1135.5" &gt;skgms..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="12.9" y="869" width="0.3" height="15.0" fill="rgb(248,19,47)" rx="2" ry="2" /&gt;&lt;text  x="15.90" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolredur (3,837 samples, 94.32%)&lt;/title&gt;&lt;rect x="65.1" y="869" width="1113.0" height="15.0" fill="rgb(229,45,22)" rx="2" ry="2" /&gt;&lt;text  x="68.11" y="879.5" &gt;kolredur&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollfrfn (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="67.4" y="741" width="0.9" height="15.0" fill="rgb(234,5,16)" rx="2" ry="2" /&gt;&lt;text  x="70.43" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfnd (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="55.5" y="517" width="0.3" height="15.0" fill="rgb(245,64,35)" rx="2" ry="2" /&gt;&lt;text  x="58.54" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaWrite (98 samples, 2.41%)&lt;/title&gt;&lt;rect x="19.3" y="693" width="28.4" height="15.0" fill="rgb(249,169,39)" rx="2" ry="2" /&gt;&lt;text  x="22.28" y="703.5" &gt;ko..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__dta_afdc_dispatch_ioctl_155 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="149" width="0.3" height="15.0" fill="rgb(223,72,29)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="159.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rb_next (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1189.7" y="1349" width="0.3" height="15.0" fill="rgb(232,75,0)" rx="2" ry="2" /&gt;&lt;text  x="1192.71" y="1359.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qesmmIPgaFreeCb (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="10.0" y="1269" width="0.6" height="15.0" fill="rgb(249,50,25)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1279.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;prepare_exit_to_usermode (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="38.7" y="421" width="0.3" height="15.0" fill="rgb(249,31,15)" rx="2" ry="2" /&gt;&lt;text  x="41.72" y="431.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1174.0" y="661" width="0.3" height="15.0" fill="rgb(227,67,14)" rx="2" ry="2" /&gt;&lt;text  x="1177.05" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfnd_get_extent (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="54.7" y="645" width="1.1" height="15.0" fill="rgb(219,26,21)" rx="2" ry="2" /&gt;&lt;text  x="57.67" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpiswu2 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1157" width="0.3" height="15.0" fill="rgb(221,133,26)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1167.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaCreateClob (18 samples, 0.44%)&lt;/title&gt;&lt;rect x="48.3" y="709" width="5.2" height="15.0" fill="rgb(220,95,23)" rx="2" ry="2" /&gt;&lt;text  x="51.29" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kss_get_pdbid (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="893.8" y="629" width="0.3" height="15.0" fill="rgb(227,202,3)" rx="2" ry="2" /&gt;&lt;text  x="896.84" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlclose (895 samples, 22.00%)&lt;/title&gt;&lt;rect x="350.0" y="661" width="259.6" height="15.0" fill="rgb(215,112,17)" rx="2" ry="2" /&gt;&lt;text  x="352.96" y="671.5" &gt;kdlclose&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;exit_to_usermode_loop (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="881.4" y="597" width="0.5" height="15.0" fill="rgb(219,174,32)" rx="2" ry="2" /&gt;&lt;text  x="884.37" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokegGarbageCollectOpn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="17.3" y="997" width="0.2" height="15.0" fill="rgb(229,51,34)" rx="2" ry="2" /&gt;&lt;text  x="20.25" y="1007.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__handle_mm_fault (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="54.7" y="469" width="0.8" height="15.0" fill="rgb(239,219,28)" rx="2" ry="2" /&gt;&lt;text  x="57.67" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ztchn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="47.1" y="565" width="0.3" height="15.0" fill="rgb(214,59,50)" rx="2" ry="2" /&gt;&lt;text  x="50.13" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kss_get_pdbid (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="43.9" y="517" width="0.3" height="15.0" fill="rgb(210,67,9)" rx="2" ry="2" /&gt;&lt;text  x="46.94" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qesaAggDistincts (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="15.8" y="1013" width="0.6" height="15.0" fill="rgb(237,141,21)" rx="2" ry="2" /&gt;&lt;text  x="18.80" y="1023.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1176.9" y="741" width="0.3" height="15.0" fill="rgb(223,127,0)" rx="2" ry="2" /&gt;&lt;text  x="1179.95" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;finish_task_switch (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="336.9" y="581" width="0.3" height="15.0" fill="rgb(222,78,15)" rx="2" ry="2" /&gt;&lt;text  x="339.91" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrmrg (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="10.0" y="1189" width="0.3" height="15.0" fill="rgb(237,184,32)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1199.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kxsGetRuntimeLock (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="309" width="0.3" height="15.0" fill="rgb(253,172,33)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="319.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pdy5F00_Generate (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="613" width="0.3" height="15.0" fill="rgb(243,52,28)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghprmalo (5 samples, 0.12%)&lt;/title&gt;&lt;rect x="54.4" y="661" width="1.4" height="15.0" fill="rgb(227,78,5)" rx="2" ry="2" /&gt;&lt;text  x="57.38" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalmc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="50.0" y="613" width="0.3" height="15.0" fill="rgb(237,149,27)" rx="2" ry="2" /&gt;&lt;text  x="53.03" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollfrfn (5 samples, 0.12%)&lt;/title&gt;&lt;rect x="1174.6" y="709" width="1.5" height="15.0" fill="rgb(214,177,13)" rx="2" ry="2" /&gt;&lt;text  x="1177.63" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaFree_rfc (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="16.7" y="933" width="0.6" height="15.0" fill="rgb(238,118,18)" rx="2" ry="2" /&gt;&lt;text  x="19.67" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbzar (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.7" y="517" width="0.3" height="15.0" fill="rgb(245,206,32)" rx="2" ry="2" /&gt;&lt;text  x="23.73" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcoapl (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="897.6" y="581" width="0.9" height="15.0" fill="rgb(226,137,11)" rx="2" ry="2" /&gt;&lt;text  x="900.61" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_syscall_64 (7 samples, 0.17%)&lt;/title&gt;&lt;rect x="1188.0" y="1493" width="2.0" height="15.0" fill="rgb(221,59,0)" rx="2" ry="2" /&gt;&lt;text  x="1190.97" y="1503.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrfree (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1173.5" y="661" width="0.3" height="15.0" fill="rgb(234,40,20)" rx="2" ry="2" /&gt;&lt;text  x="1176.47" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;up_read (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="58.4" y="597" width="0.3" height="15.0" fill="rgb(220,26,36)" rx="2" ry="2" /&gt;&lt;text  x="61.44" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlf_length (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="43.6" y="581" width="0.6" height="15.0" fill="rgb(238,54,35)" rx="2" ry="2" /&gt;&lt;text  x="46.65" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbinvbrhb (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="894.4" y="613" width="1.2" height="15.0" fill="rgb(252,229,9)" rx="2" ry="2" /&gt;&lt;text  x="897.42" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;psiini0_internal (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="63.1" y="901" width="0.3" height="15.0" fill="rgb(244,53,25)" rx="2" ry="2" /&gt;&lt;text  x="66.08" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__GI___ioctl (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="293" width="0.3" height="15.0" fill="rgb(244,217,3)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="303.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;prepare_exit_to_usermode (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="348.8" y="645" width="0.3" height="15.0" fill="rgb(237,24,32)" rx="2" ry="2" /&gt;&lt;text  x="351.80" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kpmdurend (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="917" width="1113.3" height="15.0" fill="rgb(231,222,10)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="927.5" &gt;kpmdurend&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="55.5" y="549" width="0.3" height="15.0" fill="rgb(214,109,2)" rx="2" ry="2" /&gt;&lt;text  x="58.54" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrem (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="67.7" y="693" width="0.6" height="15.0" fill="rgb(250,64,19)" rx="2" ry="2" /&gt;&lt;text  x="70.72" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;evapls (14 samples, 0.34%)&lt;/title&gt;&lt;rect x="60.5" y="949" width="4.0" height="15.0" fill="rgb(218,132,15)" rx="2" ry="2" /&gt;&lt;text  x="63.47" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrdrfc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="12.9" y="885" width="0.3" height="15.0" fill="rgb(249,203,4)" rx="2" ry="2" /&gt;&lt;text  x="15.90" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbhfix_tail (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="897.6" y="565" width="0.3" height="15.0" fill="rgb(219,206,30)" rx="2" ry="2" /&gt;&lt;text  x="900.61" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;afd_ioctl (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="181" width="0.3" height="15.0" fill="rgb(216,16,13)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="191.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrrun (4,059 samples, 99.78%)&lt;/title&gt;&lt;rect x="10.6" y="1269" width="1177.4" height="15.0" fill="rgb(220,26,10)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1279.5" &gt;pfrrun&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="65.7" y="805" width="0.9" height="15.0" fill="rgb(214,1,36)" rx="2" ry="2" /&gt;&lt;text  x="68.69" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrde_free (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1187.7" y="1013" width="0.3" height="15.0" fill="rgb(222,77,32)" rx="2" ry="2" /&gt;&lt;text  x="1190.68" y="1023.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbgcur (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="533" width="0.3" height="15.0" fill="rgb(233,95,13)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kxsGetRuntimeLock (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="997" width="0.3" height="15.0" fill="rgb(239,76,44)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1007.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pcicmp0 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="709" width="0.3" height="15.0" fill="rgb(238,201,29)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="13.2" y="869" width="1.7" height="15.0" fill="rgb(252,175,26)" rx="2" ry="2" /&gt;&lt;text  x="16.19" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfnd (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="57.0" y="629" width="0.6" height="15.0" fill="rgb(240,16,41)" rx="2" ry="2" /&gt;&lt;text  x="59.99" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbzar (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="23.1" y="501" width="0.2" height="15.0" fill="rgb(253,70,13)" rx="2" ry="2" /&gt;&lt;text  x="26.05" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__clock_gettime (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="18.7" y="869" width="0.3" height="15.0" fill="rgb(213,44,47)" rx="2" ry="2" /&gt;&lt;text  x="21.70" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkdllpoOpt (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="165" width="0.3" height="15.0" fill="rgb(253,63,32)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="175.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;lxhcsn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1173.2" y="677" width="0.3" height="15.0" fill="rgb(242,111,13)" rx="2" ry="2" /&gt;&lt;text  x="1176.18" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpidrus (187 samples, 4.60%)&lt;/title&gt;&lt;rect x="10.6" y="1109" width="54.2" height="15.0" fill="rgb(251,56,13)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1119.5" &gt;rpidrus&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaslCreateCtx (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="54.1" y="709" width="1.7" height="15.0" fill="rgb(237,173,12)" rx="2" ry="2" /&gt;&lt;text  x="57.09" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;evaopn2 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="14.9" y="949" width="0.3" height="15.0" fill="rgb(248,229,40)" rx="2" ry="2" /&gt;&lt;text  x="17.93" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_softirq (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="880.5" y="581" width="0.9" height="15.0" fill="rgb(254,181,51)" rx="2" ry="2" /&gt;&lt;text  x="883.50" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pevm_CLOSC (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1221" width="1113.3" height="15.0" fill="rgb(230,9,20)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1231.5" &gt;pevm_CLOSC&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaslFree (32 samples, 0.79%)&lt;/title&gt;&lt;rect x="1178.4" y="1045" width="9.3" height="15.0" fill="rgb(214,88,9)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1055.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcpy (27 samples, 0.66%)&lt;/title&gt;&lt;rect x="31.2" y="453" width="7.8" height="15.0" fill="rgb(246,226,54)" rx="2" ry="2" /&gt;&lt;text  x="34.18" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;finish_task_switch (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="881.4" y="549" width="0.5" height="15.0" fill="rgb(217,98,30)" rx="2" ry="2" /&gt;&lt;text  x="884.37" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcpy (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="68.6" y="741" width="0.3" height="15.0" fill="rgb(215,93,10)" rx="2" ry="2" /&gt;&lt;text  x="71.59" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;alloc_pages_vma (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="58.2" y="549" width="0.2" height="15.0" fill="rgb(254,94,1)" rx="2" ry="2" /&gt;&lt;text  x="61.15" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__clock_gettime (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="23.9" y="469" width="0.3" height="15.0" fill="rgb(254,6,30)" rx="2" ry="2" /&gt;&lt;text  x="26.92" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbo_unlink_q1 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="25.4" y="501" width="0.3" height="15.0" fill="rgb(210,45,33)" rx="2" ry="2" /&gt;&lt;text  x="28.37" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.4" y="997" width="0.3" height="15.0" fill="rgb(208,46,9)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1007.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgpdbid (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="48.0" y="725" width="0.3" height="15.0" fill="rgb(253,20,4)" rx="2" ry="2" /&gt;&lt;text  x="51.00" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollfre (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="1174.3" y="725" width="1.8" height="15.0" fill="rgb(217,137,49)" rx="2" ry="2" /&gt;&lt;text  x="1177.34" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbchg1_main (8 samples, 0.20%)&lt;/title&gt;&lt;rect x="896.2" y="597" width="2.3" height="15.0" fill="rgb(226,148,35)" rx="2" ry="2" /&gt;&lt;text  x="899.16" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sorgetqb (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="15.5" y="981" width="0.3" height="15.0" fill="rgb(247,225,11)" rx="2" ry="2" /&gt;&lt;text  x="18.51" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kfk_submit_sync_lib_ioq (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="309" width="0.3" height="15.0" fill="rgb(240,18,37)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="319.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgsc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="22.5" y="437" width="0.3" height="15.0" fill="rgb(237,57,34)" rx="2" ry="2" /&gt;&lt;text  x="25.47" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;async_page_fault (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="56.7" y="613" width="0.3" height="15.0" fill="rgb(226,204,39)" rx="2" ry="2" /&gt;&lt;text  x="59.70" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgmexwi (145 samples, 3.56%)&lt;/title&gt;&lt;rect x="17.8" y="933" width="42.1" height="15.0" fill="rgb(220,167,3)" rx="2" ry="2" /&gt;&lt;text  x="20.83" y="943.5" &gt;kgm..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollasg (12 samples, 0.29%)&lt;/title&gt;&lt;rect x="11.5" y="949" width="3.4" height="15.0" fill="rgb(249,31,22)" rx="2" ry="2" /&gt;&lt;text  x="14.45" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kpoal8 (4,061 samples, 99.83%)&lt;/title&gt;&lt;rect x="10.0" y="1349" width="1178.0" height="15.0" fill="rgb(223,158,6)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1359.5" &gt;kpoal8&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokltfc (31 samples, 0.76%)&lt;/title&gt;&lt;rect x="1178.7" y="997" width="9.0" height="15.0" fill="rgb(239,74,36)" rx="2" ry="2" /&gt;&lt;text  x="1181.69" y="1007.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;evareo (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="14.9" y="965" width="0.3" height="15.0" fill="rgb(232,47,28)" rx="2" ry="2" /&gt;&lt;text  x="17.93" y="975.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolredurHashMapCbk (3,836 samples, 94.30%)&lt;/title&gt;&lt;rect x="65.4" y="837" width="1112.7" height="15.0" fill="rgb(217,67,0)" rx="2" ry="2" /&gt;&lt;text  x="68.40" y="847.5" &gt;kolredurHashMapCbk&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;finish_task_switch (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="348.8" y="581" width="0.3" height="15.0" fill="rgb(206,117,35)" rx="2" ry="2" /&gt;&lt;text  x="351.80" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrem (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="47.4" y="549" width="0.3" height="15.0" fill="rgb(212,205,28)" rx="2" ry="2" /&gt;&lt;text  x="50.42" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolredur (33 samples, 0.81%)&lt;/title&gt;&lt;rect x="1178.4" y="1141" width="9.6" height="15.0" fill="rgb(215,214,31)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1151.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgiinb (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="62.5" y="885" width="0.3" height="15.0" fill="rgb(213,94,52)" rx="2" ry="2" /&gt;&lt;text  x="65.50" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolredurHashMapCbk (33 samples, 0.81%)&lt;/title&gt;&lt;rect x="1178.4" y="1109" width="9.6" height="15.0" fill="rgb(218,197,54)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1119.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgdc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1177.8" y="773" width="0.3" height="15.0" fill="rgb(228,11,34)" rx="2" ry="2" /&gt;&lt;text  x="1180.82" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kfk_io1 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="357" width="0.3" height="15.0" fill="rgb(208,151,22)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="367.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kxsFreeExecutionHeap (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="965" width="1113.3" height="15.0" fill="rgb(242,188,35)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="975.5" &gt;kxsFreeExecutionHeap&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfnd (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="54.7" y="613" width="1.1" height="15.0" fill="rgb(218,97,20)" rx="2" ry="2" /&gt;&lt;text  x="57.67" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;irq_exit (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1155.2" y="613" width="0.3" height="15.0" fill="rgb(214,118,24)" rx="2" ry="2" /&gt;&lt;text  x="1158.19" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kzcksgn (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="46.5" y="581" width="0.9" height="15.0" fill="rgb(233,227,46)" rx="2" ry="2" /&gt;&lt;text  x="49.55" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;lxhci2h (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="44.5" y="581" width="0.3" height="15.0" fill="rgb(207,93,23)" rx="2" ry="2" /&gt;&lt;text  x="47.52" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_munmap (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="1188.5" y="1397" width="1.2" height="15.0" fill="rgb(209,76,52)" rx="2" ry="2" /&gt;&lt;text  x="1191.55" y="1407.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kglpnp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="62.5" y="869" width="0.3" height="15.0" fill="rgb(224,78,8)" rx="2" ry="2" /&gt;&lt;text  x="65.50" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1177.5" y="757" width="0.3" height="15.0" fill="rgb(205,128,50)" rx="2" ry="2" /&gt;&lt;text  x="1180.53" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghufreetop (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="57.6" y="677" width="1.1" height="15.0" fill="rgb(239,102,41)" rx="2" ry="2" /&gt;&lt;text  x="60.57" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (940 samples, 23.11%)&lt;/title&gt;&lt;rect x="609.6" y="645" width="272.6" height="15.0" fill="rgb(235,85,27)" rx="2" ry="2" /&gt;&lt;text  x="612.57" y="655.5" &gt;_intel_fast_memcmp&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qesaAggDistincts_1 (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="15.8" y="997" width="0.6" height="15.0" fill="rgb(223,159,27)" rx="2" ry="2" /&gt;&lt;text  x="18.80" y="1007.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalf (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="45.7" y="565" width="0.6" height="15.0" fill="rgb(233,60,1)" rx="2" ry="2" /&gt;&lt;text  x="48.68" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (11 samples, 0.27%)&lt;/title&gt;&lt;rect x="1179.0" y="949" width="3.2" height="15.0" fill="rgb(228,104,16)" rx="2" ry="2" /&gt;&lt;text  x="1181.98" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="46.3" y="549" width="0.2" height="15.0" fill="rgb(211,174,43)" rx="2" ry="2" /&gt;&lt;text  x="49.26" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrinstr_CLOSC (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1237" width="1113.3" height="15.0" fill="rgb(251,117,20)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1247.5" &gt;pfrinstr_CLOSC&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlt_remove_tlob_ctl_link (935 samples, 22.98%)&lt;/title&gt;&lt;rect x="901.4" y="677" width="271.2" height="15.0" fill="rgb(210,10,3)" rx="2" ry="2" /&gt;&lt;text  x="904.38" y="687.5" &gt;kdlt_remove_tlob_ctl_link&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksu_dispatch_tac (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="10.0" y="1285" width="0.6" height="15.0" fill="rgb(205,19,12)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1295.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="48.0" y="709" width="0.3" height="15.0" fill="rgb(210,26,12)" rx="2" ry="2" /&gt;&lt;text  x="51.00" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstdle_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1173.5" y="677" width="0.3" height="15.0" fill="rgb(226,82,44)" rx="2" ry="2" /&gt;&lt;text  x="1176.47" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;async_page_fault (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="57.0" y="517" width="0.3" height="15.0" fill="rgb(226,119,36)" rx="2" ry="2" /&gt;&lt;text  x="59.99" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kksfbc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1013" width="0.3" height="15.0" fill="rgb(250,160,48)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1023.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;peidxr_run (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.9" y="853" width="0.3" height="15.0" fill="rgb(209,145,21)" rx="2" ry="2" /&gt;&lt;text  x="64.92" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="12.0" y="869" width="0.9" height="15.0" fill="rgb(232,165,2)" rx="2" ry="2" /&gt;&lt;text  x="15.03" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opitca (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="965" width="0.3" height="15.0" fill="rgb(221,206,39)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="975.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_setjmp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="897.3" y="581" width="0.3" height="15.0" fill="rgb(229,46,28)" rx="2" ry="2" /&gt;&lt;text  x="900.32" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opiodr (4,061 samples, 99.83%)&lt;/title&gt;&lt;rect x="10.0" y="1429" width="1178.0" height="15.0" fill="rgb(249,57,0)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1439.5" &gt;opiodr&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_softirq (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1155.2" y="597" width="0.3" height="15.0" fill="rgb(230,66,29)" rx="2" ry="2" /&gt;&lt;text  x="1158.19" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;schedule (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="599.1" y="581" width="0.3" height="15.0" fill="rgb(237,48,22)" rx="2" ry="2" /&gt;&lt;text  x="602.13" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlopen (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="43.9" y="549" width="0.3" height="15.0" fill="rgb(233,178,7)" rx="2" ry="2" /&gt;&lt;text  x="46.94" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollasg (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="59.0" y="773" width="0.9" height="15.0" fill="rgb(215,179,17)" rx="2" ry="2" /&gt;&lt;text  x="62.02" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaAssign (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="59.0" y="757" width="0.6" height="15.0" fill="rgb(253,193,34)" rx="2" ry="2" /&gt;&lt;text  x="62.02" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlt_filltid (12 samples, 0.29%)&lt;/title&gt;&lt;rect x="1179.0" y="965" width="3.5" height="15.0" fill="rgb(221,102,4)" rx="2" ry="2" /&gt;&lt;text  x="1181.98" y="975.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgsc (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="23.3" y="485" width="0.6" height="15.0" fill="rgb(251,153,7)" rx="2" ry="2" /&gt;&lt;text  x="26.34" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghufreetop (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1176.1" y="629" width="0.3" height="15.0" fill="rgb(212,63,34)" rx="2" ry="2" /&gt;&lt;text  x="1179.08" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokegOpnGC_Lob (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="17.3" y="981" width="0.2" height="15.0" fill="rgb(242,25,41)" rx="2" ry="2" /&gt;&lt;text  x="20.25" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;safd_bio_submit (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="101" width="0.3" height="15.0" fill="rgb(218,59,53)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="111.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;afdq_batch_submit (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="117" width="0.3" height="15.0" fill="rgb(252,24,22)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="127.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_raw_spin_unlock_irqrestore (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="59.6" y="645" width="0.3" height="15.0" fill="rgb(215,23,38)" rx="2" ry="2" /&gt;&lt;text  x="62.60" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;skgmrf_alloc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="55.5" y="437" width="0.3" height="15.0" fill="rgb(215,137,44)" rx="2" ry="2" /&gt;&lt;text  x="58.54" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalmc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1176.1" y="661" width="0.3" height="15.0" fill="rgb(215,192,31)" rx="2" ry="2" /&gt;&lt;text  x="1179.08" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaAssign (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="11.5" y="933" width="0.2" height="15.0" fill="rgb(239,81,53)" rx="2" ry="2" /&gt;&lt;text  x="14.45" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgrfc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="11.7" y="933" width="0.3" height="15.0" fill="rgb(208,154,17)" rx="2" ry="2" /&gt;&lt;text  x="14.74" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrh_internal (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="64.8" y="853" width="0.3" height="15.0" fill="rgb(243,75,43)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1184.2" y="917" width="0.6" height="15.0" fill="rgb(206,13,22)" rx="2" ry="2" /&gt;&lt;text  x="1187.20" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qergsRowP (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="15.2" y="965" width="0.3" height="15.0" fill="rgb(235,37,0)" rx="2" ry="2" /&gt;&lt;text  x="18.22" y="975.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcfrbd1 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="501" width="0.3" height="15.0" fill="rgb(235,53,12)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kews_pls_jvm_event_begin_i (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.3" y="869" width="0.3" height="15.0" fill="rgb(244,64,45)" rx="2" ry="2" /&gt;&lt;text  x="64.34" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaCreate_rfc (18 samples, 0.44%)&lt;/title&gt;&lt;rect x="48.3" y="693" width="5.2" height="15.0" fill="rgb(253,221,54)" rx="2" ry="2" /&gt;&lt;text  x="51.29" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;psdcls (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1173" width="1113.3" height="15.0" fill="rgb(235,173,31)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1183.5" &gt;psdcls&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdl_destroy (1,902 samples, 46.76%)&lt;/title&gt;&lt;rect x="349.7" y="677" width="551.7" height="15.0" fill="rgb(241,92,12)" rx="2" ry="2" /&gt;&lt;text  x="352.67" y="687.5" &gt;kdl_destroy&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kpdbUidToId (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="893.8" y="613" width="0.3" height="15.0" fill="rgb(216,122,28)" rx="2" ry="2" /&gt;&lt;text  x="896.84" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;psiini0_internal (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="59.9" y="917" width="0.3" height="15.0" fill="rgb(210,82,14)" rx="2" ry="2" /&gt;&lt;text  x="62.89" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__schedule (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="12.6" y="773" width="0.3" height="15.0" fill="rgb(229,191,23)" rx="2" ry="2" /&gt;&lt;text  x="15.61" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklpost1 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="44.2" y="613" width="0.3" height="15.0" fill="rgb(244,207,3)" rx="2" ry="2" /&gt;&lt;text  x="47.23" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opitsk (4,061 samples, 99.83%)&lt;/title&gt;&lt;rect x="10.0" y="1397" width="1178.0" height="15.0" fill="rgb(236,81,42)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1407.5" &gt;opitsk&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sorgetqb (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="64.5" y="1013" width="0.3" height="15.0" fill="rgb(214,186,12)" rx="2" ry="2" /&gt;&lt;text  x="67.53" y="1023.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kpdbUidToId (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="43.9" y="501" width="0.3" height="15.0" fill="rgb(250,148,11)" rx="2" ry="2" /&gt;&lt;text  x="46.94" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="349.7" y="661" width="0.3" height="15.0" fill="rgb(253,102,25)" rx="2" ry="2" /&gt;&lt;text  x="352.67" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpidrus (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1109" width="0.3" height="15.0" fill="rgb(223,97,20)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1119.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlsinode (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="599.4" y="645" width="0.3" height="15.0" fill="rgb(216,6,20)" rx="2" ry="2" /&gt;&lt;text  x="602.42" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qmuhshput (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="17.3" y="949" width="0.2" height="15.0" fill="rgb(228,9,38)" rx="2" ry="2" /&gt;&lt;text  x="20.25" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbvopn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="22.5" y="485" width="0.3" height="15.0" fill="rgb(221,185,11)" rx="2" ry="2" /&gt;&lt;text  x="25.47" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koltitfr (3,818 samples, 93.85%)&lt;/title&gt;&lt;rect x="68.9" y="741" width="1107.5" height="15.0" fill="rgb(231,100,34)" rx="2" ry="2" /&gt;&lt;text  x="71.88" y="751.5" &gt;koltitfr&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlclose (5 samples, 0.12%)&lt;/title&gt;&lt;rect x="1182.7" y="933" width="1.5" height="15.0" fill="rgb(221,7,18)" rx="2" ry="2" /&gt;&lt;text  x="1185.75" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;apic_timer_interrupt (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="59.6" y="741" width="0.3" height="15.0" fill="rgb(225,110,2)" rx="2" ry="2" /&gt;&lt;text  x="62.60" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbrls (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="23.1" y="517" width="0.2" height="15.0" fill="rgb(226,46,2)" rx="2" ry="2" /&gt;&lt;text  x="26.05" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfre (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1172.3" y="661" width="0.3" height="15.0" fill="rgb(210,182,22)" rx="2" ry="2" /&gt;&lt;text  x="1175.31" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kss_get_pdbid (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="609.3" y="629" width="0.3" height="15.0" fill="rgb(222,153,53)" rx="2" ry="2" /&gt;&lt;text  x="612.28" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkxmpexe (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="61.3" y="901" width="0.9" height="15.0" fill="rgb(237,78,23)" rx="2" ry="2" /&gt;&lt;text  x="64.34" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgh_invoke_alloc_cb (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="57.0" y="549" width="0.3" height="15.0" fill="rgb(208,47,45)" rx="2" ry="2" /&gt;&lt;text  x="59.99" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kksCloseCursorCbk (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1013" width="1113.3" height="15.0" fill="rgb(227,26,24)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1023.5" &gt;kksCloseCursorCbk&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;lxgcnvb (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1172.6" y="613" width="0.6" height="15.0" fill="rgb(214,211,15)" rx="2" ry="2" /&gt;&lt;text  x="1175.60" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlrsp (23 samples, 0.57%)&lt;/title&gt;&lt;rect x="894.1" y="661" width="6.7" height="15.0" fill="rgb(244,162,4)" rx="2" ry="2" /&gt;&lt;text  x="897.13" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkxpispbn (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="62.8" y="917" width="0.6" height="15.0" fill="rgb(245,100,25)" rx="2" ry="2" /&gt;&lt;text  x="65.79" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrempty_ex (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="10.0" y="1253" width="0.6" height="15.0" fill="rgb(249,18,53)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1263.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokltcc (8 samples, 0.20%)&lt;/title&gt;&lt;rect x="45.1" y="613" width="2.3" height="15.0" fill="rgb(221,24,33)" rx="2" ry="2" /&gt;&lt;text  x="48.10" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdl_inst (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="901.1" y="645" width="0.3" height="15.0" fill="rgb(206,180,28)" rx="2" ry="2" /&gt;&lt;text  x="904.09" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="45.4" y="565" width="0.3" height="15.0" fill="rgb(207,7,2)" rx="2" ry="2" /&gt;&lt;text  x="48.39" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__mmap64 (7 samples, 0.17%)&lt;/title&gt;&lt;rect x="1188.0" y="1525" width="2.0" height="15.0" fill="rgb(249,142,11)" rx="2" ry="2" /&gt;&lt;text  x="1190.97" y="1535.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="57.0" y="565" width="0.6" height="15.0" fill="rgb(246,221,13)" rx="2" ry="2" /&gt;&lt;text  x="59.99" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfindctl (41 samples, 1.01%)&lt;/title&gt;&lt;rect x="337.2" y="677" width="11.9" height="15.0" fill="rgb(244,109,42)" rx="2" ry="2" /&gt;&lt;text  x="340.20" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pevm_MOVLOB (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="59.0" y="789" width="0.9" height="15.0" fill="rgb(205,217,39)" rx="2" ry="2" /&gt;&lt;text  x="62.02" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbzgb (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="25.1" y="533" width="1.1" height="15.0" fill="rgb(225,11,2)" rx="2" ry="2" /&gt;&lt;text  x="28.08" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollalop (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1176.1" y="709" width="0.3" height="15.0" fill="rgb(206,204,35)" rx="2" ry="2" /&gt;&lt;text  x="1179.08" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalo (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="56.4" y="645" width="1.2" height="15.0" fill="rgb(233,170,27)" rx="2" ry="2" /&gt;&lt;text  x="59.41" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;psdnal (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1205" width="0.3" height="15.0" fill="rgb(228,25,7)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1215.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;prepare_exit_to_usermode (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="1155.5" y="629" width="1.1" height="15.0" fill="rgb(231,98,35)" rx="2" ry="2" /&gt;&lt;text  x="1158.48" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;exit_to_usermode_loop (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="1155.5" y="613" width="1.1" height="15.0" fill="rgb(248,111,33)" rx="2" ry="2" /&gt;&lt;text  x="1158.48" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;run_timer_softirq (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="880.8" y="565" width="0.6" height="15.0" fill="rgb(246,108,46)" rx="2" ry="2" /&gt;&lt;text  x="883.79" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokaccx (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="197" width="0.3" height="15.0" fill="rgb(225,124,23)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="207.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sltrgatime64 (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="900.2" y="581" width="0.6" height="15.0" fill="rgb(238,152,8)" rx="2" ry="2" /&gt;&lt;text  x="903.22" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;alloc_pages_vma (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="55.3" y="437" width="0.2" height="15.0" fill="rgb(205,194,4)" rx="2" ry="2" /&gt;&lt;text  x="58.25" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;exit_to_usermode_loop (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="348.8" y="629" width="0.3" height="15.0" fill="rgb(243,136,14)" rx="2" ry="2" /&gt;&lt;text  x="351.80" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kews_pls_jvm_event_end_i (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="18.7" y="885" width="0.3" height="15.0" fill="rgb(240,30,45)" rx="2" ry="2" /&gt;&lt;text  x="21.70" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpidrv (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1173" width="0.3" height="15.0" fill="rgb(240,152,50)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1183.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__intel_ssse3_rep_memcpy (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="48.3" y="677" width="0.3" height="15.0" fill="rgb(246,163,38)" rx="2" ry="2" /&gt;&lt;text  x="51.29" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kksLoadChild (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="981" width="0.3" height="15.0" fill="rgb(246,119,39)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="11.7" y="917" width="0.3" height="15.0" fill="rgb(221,181,31)" rx="2" ry="2" /&gt;&lt;text  x="14.74" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohedu (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="901" width="1113.3" height="15.0" fill="rgb(248,80,41)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="911.5" &gt;kohedu&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="54.7" y="597" width="1.1" height="15.0" fill="rgb(224,176,6)" rx="2" ry="2" /&gt;&lt;text  x="57.67" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="65.7" y="789" width="0.9" height="15.0" fill="rgb(232,41,47)" rx="2" ry="2" /&gt;&lt;text  x="68.69" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;swapgs_restore_regs_and_return_to_usermode (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="881.4" y="629" width="0.8" height="15.0" fill="rgb(254,38,1)" rx="2" ry="2" /&gt;&lt;text  x="884.37" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;evaopn2 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="15.2" y="917" width="0.3" height="15.0" fill="rgb(252,80,38)" rx="2" ry="2" /&gt;&lt;text  x="18.22" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbrls (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.7" y="533" width="0.3" height="15.0" fill="rgb(237,14,23)" rx="2" ry="2" /&gt;&lt;text  x="23.73" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_page_fault (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="56.7" y="581" width="0.3" height="15.0" fill="rgb(246,116,54)" rx="2" ry="2" /&gt;&lt;text  x="59.70" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koltitcr (10 samples, 0.25%)&lt;/title&gt;&lt;rect x="44.8" y="629" width="2.9" height="15.0" fill="rgb(246,183,4)" rx="2" ry="2" /&gt;&lt;text  x="47.81" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sltrgatime64 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="22.8" y="469" width="0.3" height="15.0" fill="rgb(218,146,14)" rx="2" ry="2" /&gt;&lt;text  x="25.76" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;snttmoredata (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.3" y="821" width="0.3" height="15.0" fill="rgb(230,37,21)" rx="2" ry="2" /&gt;&lt;text  x="64.34" y="831.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksfdread (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="485" width="0.3" height="15.0" fill="rgb(228,218,18)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbchg1 (8 samples, 0.20%)&lt;/title&gt;&lt;rect x="896.2" y="613" width="2.3" height="15.0" fill="rgb(211,28,51)" rx="2" ry="2" /&gt;&lt;text  x="899.16" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kksumc (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="981" width="1113.3" height="15.0" fill="rgb(230,141,39)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="991.5" &gt;kksumc&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgetsh (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="22.5" y="453" width="0.3" height="15.0" fill="rgb(225,18,48)" rx="2" ry="2" /&gt;&lt;text  x="25.47" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pevm_CNVMSC (138 samples, 3.39%)&lt;/title&gt;&lt;rect x="19.0" y="789" width="40.0" height="15.0" fill="rgb(217,215,27)" rx="2" ry="2" /&gt;&lt;text  x="21.99" y="799.5" &gt;pev..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_anonymous_page (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="58.2" y="565" width="0.2" height="15.0" fill="rgb(216,170,44)" rx="2" ry="2" /&gt;&lt;text  x="61.15" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgdc (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="13.2" y="885" width="1.7" height="15.0" fill="rgb(232,80,4)" rx="2" ry="2" /&gt;&lt;text  x="16.19" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrarfc (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="45.4" y="581" width="1.1" height="15.0" fill="rgb(243,7,45)" rx="2" ry="2" /&gt;&lt;text  x="48.39" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgetsh (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="23.3" y="501" width="0.9" height="15.0" fill="rgb(209,82,28)" rx="2" ry="2" /&gt;&lt;text  x="26.34" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kksCancelCursor (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="997" width="1113.3" height="15.0" fill="rgb(252,10,11)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1007.5" &gt;kksCancelCursor&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaFree_rfc (10 samples, 0.25%)&lt;/title&gt;&lt;rect x="12.0" y="901" width="2.9" height="15.0" fill="rgb(218,79,50)" rx="2" ry="2" /&gt;&lt;text  x="15.03" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolttfr_ed (3,832 samples, 94.20%)&lt;/title&gt;&lt;rect x="66.6" y="821" width="1111.5" height="15.0" fill="rgb(239,184,4)" rx="2" ry="2" /&gt;&lt;text  x="69.56" y="831.5" &gt;kolttfr_ed&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smp_apic_timer_interrupt (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="59.6" y="725" width="0.3" height="15.0" fill="rgb(212,198,1)" rx="2" ry="2" /&gt;&lt;text  x="62.60" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opiexe (4,061 samples, 99.83%)&lt;/title&gt;&lt;rect x="10.0" y="1333" width="1178.0" height="15.0" fill="rgb(236,211,35)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1343.5" &gt;opiexe&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;apic_timer_interrupt (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1155.2" y="645" width="0.3" height="15.0" fill="rgb(242,151,2)" rx="2" ry="2" /&gt;&lt;text  x="1158.19" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbzib (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="517" width="0.3" height="15.0" fill="rgb(210,83,14)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrr (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1187.7" y="997" width="0.3" height="15.0" fill="rgb(254,177,43)" rx="2" ry="2" /&gt;&lt;text  x="1190.68" y="1007.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfnd (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="55.5" y="565" width="0.3" height="15.0" fill="rgb(239,47,43)" rx="2" ry="2" /&gt;&lt;text  x="58.54" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlt_freetemp (2,837 samples, 69.74%)&lt;/title&gt;&lt;rect x="349.7" y="693" width="822.9" height="15.0" fill="rgb(254,193,48)" rx="2" ry="2" /&gt;&lt;text  x="352.67" y="703.5" &gt;kdlt_freetemp&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgetsh (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="22.8" y="485" width="0.3" height="15.0" fill="rgb(232,16,27)" rx="2" ry="2" /&gt;&lt;text  x="25.76" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrust (33 samples, 0.81%)&lt;/title&gt;&lt;rect x="1178.4" y="1205" width="9.6" height="15.0" fill="rgb(246,96,41)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1215.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_syscall_64 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="261" width="0.3" height="15.0" fill="rgb(218,32,13)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="271.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;schedule (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="1155.8" y="597" width="0.8" height="15.0" fill="rgb(241,112,14)" rx="2" ry="2" /&gt;&lt;text  x="1158.77" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgmexec (10 samples, 0.25%)&lt;/title&gt;&lt;rect x="60.5" y="933" width="2.9" height="15.0" fill="rgb(210,218,35)" rx="2" ry="2" /&gt;&lt;text  x="63.47" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbz_fr_buf (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="895.9" y="597" width="0.3" height="15.0" fill="rgb(232,109,16)" rx="2" ry="2" /&gt;&lt;text  x="898.87" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaGetHeap (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="53.5" y="709" width="0.6" height="15.0" fill="rgb(223,223,0)" rx="2" ry="2" /&gt;&lt;text  x="56.51" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktbchgro (8 samples, 0.20%)&lt;/title&gt;&lt;rect x="896.2" y="629" width="2.3" height="15.0" fill="rgb(253,196,1)" rx="2" ry="2" /&gt;&lt;text  x="899.16" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkdllpo (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="181" width="0.3" height="15.0" fill="rgb(233,102,51)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="191.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;prepare_exit_to_usermode (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="881.4" y="613" width="0.8" height="15.0" fill="rgb(242,90,31)" rx="2" ry="2" /&gt;&lt;text  x="884.37" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_softirq (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="42.5" y="389" width="0.3" height="15.0" fill="rgb(226,166,54)" rx="2" ry="2" /&gt;&lt;text  x="45.49" y="399.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstmap (33 samples, 0.81%)&lt;/title&gt;&lt;rect x="1178.4" y="1125" width="9.6" height="15.0" fill="rgb(220,71,23)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1135.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kocobld (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="469" width="0.3" height="15.0" fill="rgb(216,229,0)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalw (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1176.1" y="693" width="0.3" height="15.0" fill="rgb(253,178,4)" rx="2" ry="2" /&gt;&lt;text  x="1179.08" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgshx (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="22.5" y="469" width="0.3" height="15.0" fill="rgb(223,170,14)" rx="2" ry="2" /&gt;&lt;text  x="25.47" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kodclod (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="453" width="0.3" height="15.0" fill="rgb(253,109,34)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opicca (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1029" width="1113.3" height="15.0" fill="rgb(221,28,3)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1039.5" &gt;opicca&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaAssign_rfc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="59.6" y="757" width="0.3" height="15.0" fill="rgb(234,76,45)" rx="2" ry="2" /&gt;&lt;text  x="62.60" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_page_fault (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="56.7" y="565" width="0.3" height="15.0" fill="rgb(234,169,22)" rx="2" ry="2" /&gt;&lt;text  x="59.70" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qesaEvalDistAggOpns (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="15.2" y="933" width="0.3" height="15.0" fill="rgb(206,121,15)" rx="2" ry="2" /&gt;&lt;text  x="18.22" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktbchgro (54 samples, 1.33%)&lt;/title&gt;&lt;rect x="27.1" y="549" width="15.7" height="15.0" fill="rgb(227,143,39)" rx="2" ry="2" /&gt;&lt;text  x="30.11" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstmap (3,837 samples, 94.32%)&lt;/title&gt;&lt;rect x="65.1" y="853" width="1113.0" height="15.0" fill="rgb(206,39,4)" rx="2" ry="2" /&gt;&lt;text  x="68.11" y="863.5" &gt;kgghstmap&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrinstr_MOVADT (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="64.2" y="901" width="0.3" height="15.0" fill="rgb(236,208,21)" rx="2" ry="2" /&gt;&lt;text  x="67.24" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaslWriteCreateTempLob (10 samples, 0.25%)&lt;/title&gt;&lt;rect x="44.8" y="661" width="2.9" height="15.0" fill="rgb(253,88,21)" rx="2" ry="2" /&gt;&lt;text  x="47.81" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_mmap (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="1188.3" y="1429" width="1.7" height="15.0" fill="rgb(216,81,16)" rx="2" ry="2" /&gt;&lt;text  x="1191.26" y="1439.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlrsp (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1185.1" y="933" width="0.5" height="15.0" fill="rgb(215,140,42)" rx="2" ry="2" /&gt;&lt;text  x="1188.07" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrem (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1176.7" y="709" width="0.2" height="15.0" fill="rgb(245,52,32)" rx="2" ry="2" /&gt;&lt;text  x="1179.66" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;prepare_exit_to_usermode (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="336.3" y="645" width="0.9" height="15.0" fill="rgb(227,114,9)" rx="2" ry="2" /&gt;&lt;text  x="339.33" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;tlb_finish_mmu (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1188.8" y="1365" width="0.6" height="15.0" fill="rgb(237,56,44)" rx="2" ry="2" /&gt;&lt;text  x="1191.84" y="1375.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;evaopn2 (146 samples, 3.59%)&lt;/title&gt;&lt;rect x="17.8" y="981" width="42.4" height="15.0" fill="rgb(226,166,3)" rx="2" ry="2" /&gt;&lt;text  x="20.83" y="991.5" &gt;eva..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbgsp1 (13 samples, 0.32%)&lt;/title&gt;&lt;rect x="20.4" y="549" width="3.8" height="15.0" fill="rgb(212,94,21)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktcsna (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.2" y="565" width="0.2" height="15.0" fill="rgb(252,60,43)" rx="2" ry="2" /&gt;&lt;text  x="23.15" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1176.1" y="677" width="0.3" height="15.0" fill="rgb(221,93,26)" rx="2" ry="2" /&gt;&lt;text  x="1179.08" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;apic_timer_interrupt (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="335.7" y="661" width="0.6" height="15.0" fill="rgb(254,164,23)" rx="2" ry="2" /&gt;&lt;text  x="338.75" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpiswu2 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="757" width="0.3" height="15.0" fill="rgb(212,178,34)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlfill (13 samples, 0.32%)&lt;/title&gt;&lt;rect x="39.0" y="453" width="3.8" height="15.0" fill="rgb(243,144,14)" rx="2" ry="2" /&gt;&lt;text  x="42.01" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbvcls (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="23.1" y="533" width="0.2" height="15.0" fill="rgb(227,112,17)" rx="2" ry="2" /&gt;&lt;text  x="26.05" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlt_freetemp (18 samples, 0.44%)&lt;/title&gt;&lt;rect x="1182.5" y="965" width="5.2" height="15.0" fill="rgb(239,74,40)" rx="2" ry="2" /&gt;&lt;text  x="1185.46" y="975.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfindctl (39 samples, 0.96%)&lt;/title&gt;&lt;rect x="882.5" y="645" width="11.3" height="15.0" fill="rgb(240,142,46)" rx="2" ry="2" /&gt;&lt;text  x="885.53" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgrfc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1174.0" y="693" width="0.3" height="15.0" fill="rgb(228,99,17)" rx="2" ry="2" /&gt;&lt;text  x="1177.05" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgmgaicn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.1" y="885" width="0.2" height="15.0" fill="rgb(229,83,52)" rx="2" ry="2" /&gt;&lt;text  x="64.05" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaFree (3,832 samples, 94.20%)&lt;/title&gt;&lt;rect x="66.6" y="805" width="1111.5" height="15.0" fill="rgb(237,109,12)" rx="2" ry="2" /&gt;&lt;text  x="69.56" y="815.5" &gt;kolaFree&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (5 samples, 0.12%)&lt;/title&gt;&lt;rect x="1182.7" y="917" width="1.5" height="15.0" fill="rgb(211,87,39)" rx="2" ry="2" /&gt;&lt;text  x="1185.75" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghuwrlength (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1175.8" y="645" width="0.3" height="15.0" fill="rgb(247,188,24)" rx="2" ry="2" /&gt;&lt;text  x="1178.79" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kpdbUidToIdHash (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="43.9" y="469" width="0.3" height="15.0" fill="rgb(213,213,40)" rx="2" ry="2" /&gt;&lt;text  x="46.94" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrw (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="47.4" y="581" width="0.3" height="15.0" fill="rgb(216,118,18)" rx="2" ry="2" /&gt;&lt;text  x="50.42" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ztchmd5m (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="46.5" y="517" width="0.6" height="15.0" fill="rgb(212,71,45)" rx="2" ry="2" /&gt;&lt;text  x="49.55" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgmtconv (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="18.1" y="885" width="0.3" height="15.0" fill="rgb(242,41,38)" rx="2" ry="2" /&gt;&lt;text  x="21.12" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="50.0" y="629" width="0.3" height="15.0" fill="rgb(250,94,22)" rx="2" ry="2" /&gt;&lt;text  x="53.03" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="12.0" y="853" width="0.6" height="15.0" fill="rgb(210,130,10)" rx="2" ry="2" /&gt;&lt;text  x="15.03" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__clock_gettime (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="900.2" y="565" width="0.6" height="15.0" fill="rgb(234,159,39)" rx="2" ry="2" /&gt;&lt;text  x="903.22" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrrun (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.9" y="821" width="0.3" height="15.0" fill="rgb(210,92,38)" rx="2" ry="2" /&gt;&lt;text  x="64.92" y="831.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpidrus (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1077" width="1113.3" height="15.0" fill="rgb(219,151,44)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1087.5" &gt;rpidrus&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrf (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1175.2" y="645" width="0.6" height="15.0" fill="rgb(240,163,10)" rx="2" ry="2" /&gt;&lt;text  x="1178.21" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;release_pages (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1188.8" y="1285" width="0.6" height="15.0" fill="rgb(244,20,30)" rx="2" ry="2" /&gt;&lt;text  x="1191.84" y="1295.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrrun (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="63.7" y="933" width="0.8" height="15.0" fill="rgb(222,166,28)" rx="2" ry="2" /&gt;&lt;text  x="66.66" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;arch_local_irq_disable (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="336.3" y="629" width="0.6" height="15.0" fill="rgb(214,78,35)" rx="2" ry="2" /&gt;&lt;text  x="339.33" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklSurrCheck (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="43.6" y="613" width="0.6" height="15.0" fill="rgb(212,189,46)" rx="2" ry="2" /&gt;&lt;text  x="46.65" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;async_page_fault (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="54.7" y="549" width="0.8" height="15.0" fill="rgb(223,155,38)" rx="2" ry="2" /&gt;&lt;text  x="57.67" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_softirq (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="335.7" y="613" width="0.6" height="15.0" fill="rgb(233,103,7)" rx="2" ry="2" /&gt;&lt;text  x="338.75" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpidrv (187 samples, 4.60%)&lt;/title&gt;&lt;rect x="10.6" y="1173" width="54.2" height="15.0" fill="rgb(219,82,30)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1183.5" &gt;rpidrv&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;peidxr_run (141 samples, 3.47%)&lt;/title&gt;&lt;rect x="19.0" y="869" width="40.9" height="15.0" fill="rgb(205,66,49)" rx="2" ry="2" /&gt;&lt;text  x="21.99" y="879.5" &gt;pei..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;finish_task_switch (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="12.6" y="757" width="0.3" height="15.0" fill="rgb(211,24,10)" rx="2" ry="2" /&gt;&lt;text  x="15.61" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksfdafIO (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="453" width="0.3" height="15.0" fill="rgb(234,99,43)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgrfc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="68.3" y="757" width="0.3" height="15.0" fill="rgb(228,130,16)" rx="2" ry="2" /&gt;&lt;text  x="71.30" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kocgpn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="501" width="0.3" height="15.0" fill="rgb(238,19,47)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgh_invoke_alloc_cb (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="55.5" y="485" width="0.3" height="15.0" fill="rgb(244,67,25)" rx="2" ry="2" /&gt;&lt;text  x="58.54" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbz_mk_fr (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="894.7" y="597" width="0.9" height="15.0" fill="rgb(233,136,52)" rx="2" ry="2" /&gt;&lt;text  x="897.71" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbz_fp_shr (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="23.6" y="469" width="0.3" height="15.0" fill="rgb(216,214,48)" rx="2" ry="2" /&gt;&lt;text  x="26.63" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;all (4,068 samples, 100%)&lt;/title&gt;&lt;rect x="10.0" y="1557" width="1180.0" height="15.0" fill="rgb(233,218,34)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1567.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkspsc0 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="341" width="0.3" height="15.0" fill="rgb(238,218,18)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="351.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ztchmd5n (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="46.5" y="533" width="0.6" height="15.0" fill="rgb(212,97,34)" rx="2" ry="2" /&gt;&lt;text  x="49.55" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sltrgatime64 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="23.9" y="485" width="0.3" height="15.0" fill="rgb(242,170,54)" rx="2" ry="2" /&gt;&lt;text  x="26.92" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_page_fault (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="57.0" y="485" width="0.3" height="15.0" fill="rgb(247,50,4)" rx="2" ry="2" /&gt;&lt;text  x="59.99" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcmlf_read (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="22.2" y="437" width="0.3" height="15.0" fill="rgb(241,45,19)" rx="2" ry="2" /&gt;&lt;text  x="25.18" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opiosq0 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1061" width="0.3" height="15.0" fill="rgb(207,77,46)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1071.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrinstr_BFTCHC (187 samples, 4.60%)&lt;/title&gt;&lt;rect x="10.6" y="1237" width="54.2" height="15.0" fill="rgb(237,143,9)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1247.5" &gt;pfrin..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;psdnal (187 samples, 4.60%)&lt;/title&gt;&lt;rect x="10.6" y="1205" width="54.2" height="15.0" fill="rgb(216,10,4)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1215.5" &gt;psdnal&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="46.3" y="533" width="0.2" height="15.0" fill="rgb(232,112,53)" rx="2" ry="2" /&gt;&lt;text  x="49.26" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpidrv (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1141" width="1113.3" height="15.0" fill="rgb(230,155,37)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1151.5" &gt;rpidrv&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrcomp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1177.2" y="757" width="0.3" height="15.0" fill="rgb(241,140,53)" rx="2" ry="2" /&gt;&lt;text  x="1180.24" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktucloGetGlobalMinScn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="43.1" y="565" width="0.3" height="15.0" fill="rgb(209,214,41)" rx="2" ry="2" /&gt;&lt;text  x="46.07" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.4" y="1013" width="0.3" height="15.0" fill="rgb(227,127,30)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1023.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalo (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="55.5" y="533" width="0.3" height="15.0" fill="rgb(232,63,35)" rx="2" ry="2" /&gt;&lt;text  x="58.54" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;peiinspbn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="62.8" y="901" width="0.3" height="15.0" fill="rgb(210,173,49)" rx="2" ry="2" /&gt;&lt;text  x="65.79" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;vm_mmap_pgoff (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="1188.3" y="1445" width="1.7" height="15.0" fill="rgb(207,43,47)" rx="2" ry="2" /&gt;&lt;text  x="1191.26" y="1455.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;psddr0 (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1157" width="1113.3" height="15.0" fill="rgb(221,206,4)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1167.5" &gt;psddr0&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="68.3" y="741" width="0.3" height="15.0" fill="rgb(222,89,28)" rx="2" ry="2" /&gt;&lt;text  x="71.30" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opidrv (4,061 samples, 99.83%)&lt;/title&gt;&lt;rect x="10.0" y="1445" width="1178.0" height="15.0" fill="rgb(243,131,18)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1455.5" &gt;opidrv&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opiclo (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1045" width="1113.3" height="15.0" fill="rgb(215,100,41)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1055.5" &gt;opiclo&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;handle_mm_fault (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="57.9" y="597" width="0.5" height="15.0" fill="rgb(228,169,0)" rx="2" ry="2" /&gt;&lt;text  x="60.86" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbvini (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="23.3" y="533" width="0.9" height="15.0" fill="rgb(226,167,43)" rx="2" ry="2" /&gt;&lt;text  x="26.34" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaslFree (3,824 samples, 94.00%)&lt;/title&gt;&lt;rect x="67.1" y="773" width="1109.3" height="15.0" fill="rgb(244,3,6)" rx="2" ry="2" /&gt;&lt;text  x="70.14" y="783.5" &gt;kolaslFree&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokltfc (3,810 samples, 93.66%)&lt;/title&gt;&lt;rect x="69.2" y="725" width="1105.1" height="15.0" fill="rgb(211,95,39)" rx="2" ry="2" /&gt;&lt;text  x="72.17" y="735.5" &gt;kokltfc&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbdba_vbn (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="898.5" y="629" width="0.9" height="15.0" fill="rgb(246,125,53)" rx="2" ry="2" /&gt;&lt;text  x="901.48" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;tlb_flush_mmu_free (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1188.8" y="1317" width="0.6" height="15.0" fill="rgb(225,131,34)" rx="2" ry="2" /&gt;&lt;text  x="1191.84" y="1327.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ttcpip (4,061 samples, 99.83%)&lt;/title&gt;&lt;rect x="10.0" y="1381" width="1178.0" height="15.0" fill="rgb(227,183,17)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1391.5" &gt;ttcpip&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktbchgro (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="21.3" y="469" width="1.2" height="15.0" fill="rgb(217,184,33)" rx="2" ry="2" /&gt;&lt;text  x="24.31" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrr (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="1174.9" y="677" width="1.2" height="15.0" fill="rgb(254,83,10)" rx="2" ry="2" /&gt;&lt;text  x="1177.92" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="53.8" y="677" width="0.3" height="15.0" fill="rgb(237,185,40)" rx="2" ry="2" /&gt;&lt;text  x="56.80" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrinstr_ENTERZ (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.9" y="789" width="0.3" height="15.0" fill="rgb(237,94,6)" rx="2" ry="2" /&gt;&lt;text  x="64.92" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;peiinbd (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="62.5" y="901" width="0.3" height="15.0" fill="rgb(237,111,5)" rx="2" ry="2" /&gt;&lt;text  x="65.50" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokdlod (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="437" width="0.3" height="15.0" fill="rgb(238,44,41)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kglsim_upd_newhp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="101" width="0.3" height="15.0" fill="rgb(216,144,26)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="111.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pmuocpy (12 samples, 0.29%)&lt;/title&gt;&lt;rect x="11.5" y="981" width="3.4" height="15.0" fill="rgb(249,114,32)" rx="2" ry="2" /&gt;&lt;text  x="14.45" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;note_gp_changes (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="59.6" y="661" width="0.3" height="15.0" fill="rgb(244,221,17)" rx="2" ry="2" /&gt;&lt;text  x="62.60" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklc_write (101 samples, 2.48%)&lt;/title&gt;&lt;rect x="19.0" y="741" width="29.3" height="15.0" fill="rgb(244,23,21)" rx="2" ry="2" /&gt;&lt;text  x="21.99" y="751.5" &gt;ko..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qervwFetch (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="14.9" y="1013" width="0.9" height="15.0" fill="rgb(247,84,47)" rx="2" ry="2" /&gt;&lt;text  x="17.93" y="1023.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksmrf_init_alloc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="55.5" y="453" width="0.3" height="15.0" fill="rgb(252,156,9)" rx="2" ry="2" /&gt;&lt;text  x="58.54" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smp_apic_timer_interrupt (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="880.5" y="613" width="0.9" height="15.0" fill="rgb(251,138,18)" rx="2" ry="2" /&gt;&lt;text  x="883.50" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smp_apic_timer_interrupt (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1155.2" y="629" width="0.3" height="15.0" fill="rgb(239,189,22)" rx="2" ry="2" /&gt;&lt;text  x="1158.19" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlird (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.2" y="581" width="0.2" height="15.0" fill="rgb(231,12,54)" rx="2" ry="2" /&gt;&lt;text  x="23.15" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="66.0" y="773" width="0.6" height="15.0" fill="rgb(227,91,11)" rx="2" ry="2" /&gt;&lt;text  x="68.98" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolttfr_ed (33 samples, 0.81%)&lt;/title&gt;&lt;rect x="1178.4" y="1093" width="9.6" height="15.0" fill="rgb(220,168,51)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1103.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;evastr (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="15.2" y="901" width="0.3" height="15.0" fill="rgb(236,210,15)" rx="2" ry="2" /&gt;&lt;text  x="18.22" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbgcur (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="21.0" y="485" width="0.3" height="15.0" fill="rgb(216,201,15)" rx="2" ry="2" /&gt;&lt;text  x="24.02" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;smp_apic_timer_interrupt (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="42.5" y="421" width="0.3" height="15.0" fill="rgb(238,42,45)" rx="2" ry="2" /&gt;&lt;text  x="45.49" y="431.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcblibr_int (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1185.1" y="917" width="0.3" height="15.0" fill="rgb(253,187,45)" rx="2" ry="2" /&gt;&lt;text  x="1188.07" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstdle_wfp (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="16.7" y="901" width="0.6" height="15.0" fill="rgb(206,183,6)" rx="2" ry="2" /&gt;&lt;text  x="19.67" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlgdata (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="882.2" y="645" width="0.3" height="15.0" fill="rgb(241,115,42)" rx="2" ry="2" /&gt;&lt;text  x="885.24" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrdrfc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1177.5" y="773" width="0.3" height="15.0" fill="rgb(211,11,5)" rx="2" ry="2" /&gt;&lt;text  x="1180.53" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__intel_new_memset (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="50.0" y="597" width="0.3" height="15.0" fill="rgb(237,19,17)" rx="2" ry="2" /&gt;&lt;text  x="53.03" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghbshrt (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="56.4" y="629" width="0.6" height="15.0" fill="rgb(218,177,38)" rx="2" ry="2" /&gt;&lt;text  x="59.41" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ztchmd5f (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="46.5" y="549" width="0.6" height="15.0" fill="rgb(244,196,46)" rx="2" ry="2" /&gt;&lt;text  x="49.55" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="68.3" y="725" width="0.3" height="15.0" fill="rgb(213,173,24)" rx="2" ry="2" /&gt;&lt;text  x="71.30" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kglpin (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="149" width="0.3" height="15.0" fill="rgb(228,142,51)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="159.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kprcdt (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="10.9" y="981" width="0.6" height="15.0" fill="rgb(252,34,54)" rx="2" ry="2" /&gt;&lt;text  x="13.87" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;apic_timer_interrupt (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="880.5" y="629" width="0.9" height="15.0" fill="rgb(235,198,23)" rx="2" ry="2" /&gt;&lt;text  x="883.50" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokegUnpinLob (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="16.7" y="981" width="0.6" height="15.0" fill="rgb(236,221,5)" rx="2" ry="2" /&gt;&lt;text  x="19.67" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;handle_mm_fault (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="54.7" y="485" width="0.8" height="15.0" fill="rgb(213,221,44)" rx="2" ry="2" /&gt;&lt;text  x="57.67" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;swapgs_restore_regs_and_return_to_usermode (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="38.7" y="437" width="0.3" height="15.0" fill="rgb(233,117,41)" rx="2" ry="2" /&gt;&lt;text  x="41.72" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;unmap_single_vma (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1189.4" y="1349" width="0.3" height="15.0" fill="rgb(246,87,10)" rx="2" ry="2" /&gt;&lt;text  x="1192.42" y="1359.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrem (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="1175.2" y="661" width="0.9" height="15.0" fill="rgb(214,78,48)" rx="2" ry="2" /&gt;&lt;text  x="1178.21" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbinvbrhb (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1185.1" y="885" width="0.3" height="15.0" fill="rgb(221,40,42)" rx="2" ry="2" /&gt;&lt;text  x="1188.07" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrf (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="67.1" y="757" width="0.3" height="15.0" fill="rgb(229,168,43)" rx="2" ry="2" /&gt;&lt;text  x="70.14" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;arch_local_irq_enable (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="38.7" y="389" width="0.3" height="15.0" fill="rgb(206,79,5)" rx="2" ry="2" /&gt;&lt;text  x="41.72" y="399.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaFree (33 samples, 0.81%)&lt;/title&gt;&lt;rect x="1178.4" y="1077" width="9.6" height="15.0" fill="rgb(213,45,10)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1087.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;irq_exit (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="42.5" y="405" width="0.3" height="15.0" fill="rgb(219,122,11)" rx="2" ry="2" /&gt;&lt;text  x="45.49" y="415.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbgcur (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="899.4" y="581" width="0.2" height="15.0" fill="rgb(207,95,17)" rx="2" ry="2" /&gt;&lt;text  x="902.35" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkxdexe (142 samples, 3.49%)&lt;/title&gt;&lt;rect x="18.7" y="901" width="41.2" height="15.0" fill="rgb(243,223,14)" rx="2" ry="2" /&gt;&lt;text  x="21.70" y="911.5" &gt;kkx..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlwfb (77 samples, 1.89%)&lt;/title&gt;&lt;rect x="20.4" y="581" width="22.4" height="15.0" fill="rgb(210,110,10)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="591.5" &gt;k..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfindctl (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1187.4" y="933" width="0.3" height="15.0" fill="rgb(221,75,12)" rx="2" ry="2" /&gt;&lt;text  x="1190.39" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="11.2" y="885" width="0.3" height="15.0" fill="rgb(246,120,31)" rx="2" ry="2" /&gt;&lt;text  x="14.16" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;arch_tlb_finish_mmu (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1188.8" y="1349" width="0.6" height="15.0" fill="rgb(253,57,31)" rx="2" ry="2" /&gt;&lt;text  x="1191.84" y="1359.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;unmap_region (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="1188.8" y="1381" width="0.9" height="15.0" fill="rgb(221,55,28)" rx="2" ry="2" /&gt;&lt;text  x="1191.84" y="1391.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_async_page_fault (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="57.0" y="501" width="0.3" height="15.0" fill="rgb(207,93,11)" rx="2" ry="2" /&gt;&lt;text  x="59.99" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollfre (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="47.4" y="613" width="0.3" height="15.0" fill="rgb(222,2,46)" rx="2" ry="2" /&gt;&lt;text  x="50.42" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrgrfc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.4" y="1029" width="0.3" height="15.0" fill="rgb(231,0,35)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1039.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kole_src2dst (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1172.6" y="645" width="0.6" height="15.0" fill="rgb(214,22,5)" rx="2" ry="2" /&gt;&lt;text  x="1175.60" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrde_alloc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="50.0" y="645" width="0.3" height="15.0" fill="rgb(242,56,30)" rx="2" ry="2" /&gt;&lt;text  x="53.03" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrde_free (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1176.7" y="741" width="0.2" height="15.0" fill="rgb(227,143,19)" rx="2" ry="2" /&gt;&lt;text  x="1179.66" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kocpin (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="517" width="0.3" height="15.0" fill="rgb(246,115,47)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;exit_to_usermode_loop (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="599.1" y="597" width="0.3" height="15.0" fill="rgb(237,144,39)" rx="2" ry="2" /&gt;&lt;text  x="602.13" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kglobpn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="117" width="0.3" height="15.0" fill="rgb(234,183,52)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="127.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghualloc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1176.1" y="645" width="0.3" height="15.0" fill="rgb(221,18,5)" rx="2" ry="2" /&gt;&lt;text  x="1179.08" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgmtobim (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="18.4" y="885" width="0.3" height="15.0" fill="rgb(243,17,33)" rx="2" ry="2" /&gt;&lt;text  x="21.41" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolradc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="11.2" y="901" width="0.3" height="15.0" fill="rgb(250,32,21)" rx="2" ry="2" /&gt;&lt;text  x="14.16" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__dta_afdc_io_153 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="133" width="0.3" height="15.0" fill="rgb(244,223,41)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="143.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pevm_ENTER (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.9" y="773" width="0.3" height="15.0" fill="rgb(238,145,31)" rx="2" ry="2" /&gt;&lt;text  x="64.92" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qxuag_val2workarea (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="15.8" y="965" width="0.3" height="15.0" fill="rgb(251,217,13)" rx="2" ry="2" /&gt;&lt;text  x="18.80" y="975.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;clear_page_erms (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="56.7" y="469" width="0.3" height="15.0" fill="rgb(228,191,26)" rx="2" ry="2" /&gt;&lt;text  x="59.70" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sltrgftime64 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="55.5" y="421" width="0.3" height="15.0" fill="rgb(226,197,41)" rx="2" ry="2" /&gt;&lt;text  x="58.54" y="431.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opiodr (4,061 samples, 99.83%)&lt;/title&gt;&lt;rect x="10.0" y="1365" width="1178.0" height="15.0" fill="rgb(213,45,4)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1375.5" &gt;opiodr&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlt_remove_tlob_ctl_link (7 samples, 0.17%)&lt;/title&gt;&lt;rect x="1185.6" y="949" width="2.1" height="15.0" fill="rgb(251,154,50)" rx="2" ry="2" /&gt;&lt;text  x="1188.65" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfindctl (54 samples, 1.33%)&lt;/title&gt;&lt;rect x="1156.6" y="661" width="15.7" height="15.0" fill="rgb(231,3,31)" rx="2" ry="2" /&gt;&lt;text  x="1159.64" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalf (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="17.3" y="933" width="0.2" height="15.0" fill="rgb(247,111,2)" rx="2" ry="2" /&gt;&lt;text  x="20.25" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgshx (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="23.3" y="517" width="0.9" height="15.0" fill="rgb(227,150,34)" rx="2" ry="2" /&gt;&lt;text  x="26.34" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgshx (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="898.8" y="613" width="0.6" height="15.0" fill="rgb(226,13,18)" rx="2" ry="2" /&gt;&lt;text  x="901.77" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaslCreateClob (26 samples, 0.64%)&lt;/title&gt;&lt;rect x="48.3" y="725" width="7.5" height="15.0" fill="rgb(217,139,46)" rx="2" ry="2" /&gt;&lt;text  x="51.29" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="68.3" y="709" width="0.3" height="15.0" fill="rgb(223,100,10)" rx="2" ry="2" /&gt;&lt;text  x="71.30" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kglobpn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="261" width="0.3" height="15.0" fill="rgb(220,215,20)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="271.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;free_hot_cold_page (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1188.8" y="1253" width="0.6" height="15.0" fill="rgb(224,174,49)" rx="2" ry="2" /&gt;&lt;text  x="1191.84" y="1263.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbvini (5 samples, 0.12%)&lt;/title&gt;&lt;rect x="899.4" y="629" width="1.4" height="15.0" fill="rgb(226,181,34)" rx="2" ry="2" /&gt;&lt;text  x="902.35" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;swapgs_restore_regs_and_return_to_usermode (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="348.8" y="661" width="0.3" height="15.0" fill="rgb(230,19,10)" rx="2" ry="2" /&gt;&lt;text  x="351.80" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlopen (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="1184.2" y="933" width="0.9" height="15.0" fill="rgb(251,189,39)" rx="2" ry="2" /&gt;&lt;text  x="1187.20" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrrun_no_tool (4,059 samples, 99.78%)&lt;/title&gt;&lt;rect x="10.6" y="1253" width="1177.4" height="15.0" fill="rgb(241,166,4)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1263.5" &gt;pfrrun_no_tool&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolradc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="11.5" y="901" width="0.2" height="15.0" fill="rgb(253,213,49)" rx="2" ry="2" /&gt;&lt;text  x="14.45" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kxsdmc (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="933" width="1113.3" height="15.0" fill="rgb(224,142,12)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="943.5" &gt;kxsdmc&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qximeop_fbk (147 samples, 3.61%)&lt;/title&gt;&lt;rect x="17.5" y="997" width="42.7" height="15.0" fill="rgb(225,175,14)" rx="2" ry="2" /&gt;&lt;text  x="20.54" y="1007.5" &gt;qxim..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;unmap_page_range (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1189.4" y="1333" width="0.3" height="15.0" fill="rgb(242,80,30)" rx="2" ry="2" /&gt;&lt;text  x="1192.42" y="1343.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;peicnt (4,059 samples, 99.78%)&lt;/title&gt;&lt;rect x="10.6" y="1301" width="1177.4" height="15.0" fill="rgb(224,88,40)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1311.5" &gt;peicnt&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghufree (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1176.7" y="693" width="0.2" height="15.0" fill="rgb(236,168,16)" rx="2" ry="2" /&gt;&lt;text  x="1179.66" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrr (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="47.4" y="565" width="0.3" height="15.0" fill="rgb(210,65,4)" rx="2" ry="2" /&gt;&lt;text  x="50.42" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;plsql_run (141 samples, 3.47%)&lt;/title&gt;&lt;rect x="19.0" y="853" width="40.9" height="15.0" fill="rgb(213,151,8)" rx="2" ry="2" /&gt;&lt;text  x="21.99" y="863.5" &gt;pls..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokltfr_pdbcbk (30 samples, 0.74%)&lt;/title&gt;&lt;rect x="1179.0" y="981" width="8.7" height="15.0" fill="rgb(210,57,3)" rx="2" ry="2" /&gt;&lt;text  x="1181.98" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolttfr (3,819 samples, 93.88%)&lt;/title&gt;&lt;rect x="68.6" y="757" width="1107.8" height="15.0" fill="rgb(221,25,32)" rx="2" ry="2" /&gt;&lt;text  x="71.59" y="767.5" &gt;kolttfr&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;blk_mq_flush_plug_list (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="53" width="0.3" height="15.0" fill="rgb(253,209,33)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="63.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlopen (981 samples, 24.12%)&lt;/title&gt;&lt;rect x="609.6" y="661" width="284.5" height="15.0" fill="rgb(221,85,28)" rx="2" ry="2" /&gt;&lt;text  x="612.57" y="671.5" &gt;kdlopen&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbtse_is_ts_enc_pdb (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="24.8" y="533" width="0.3" height="15.0" fill="rgb(233,15,2)" rx="2" ry="2" /&gt;&lt;text  x="27.79" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrddc (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="1176.4" y="773" width="1.1" height="15.0" fill="rgb(231,27,36)" rx="2" ry="2" /&gt;&lt;text  x="1179.37" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opiodr (187 samples, 4.60%)&lt;/title&gt;&lt;rect x="10.6" y="1093" width="54.2" height="15.0" fill="rgb(234,119,10)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1103.5" &gt;opiodr&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlt_add_tlob_ctl_link (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="45.1" y="565" width="0.3" height="15.0" fill="rgb(236,44,42)" rx="2" ry="2" /&gt;&lt;text  x="48.10" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksmarfg (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="55.5" y="469" width="0.3" height="15.0" fill="rgb(241,164,7)" rx="2" ry="2" /&gt;&lt;text  x="58.54" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokavpr (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="405" width="0.3" height="15.0" fill="rgb(251,31,13)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="415.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksfdafRequest (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="437" width="0.3" height="15.0" fill="rgb(250,164,53)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlrsp_init (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="900.8" y="661" width="0.6" height="15.0" fill="rgb(212,174,20)" rx="2" ry="2" /&gt;&lt;text  x="903.80" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrempty_subheaps_all (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="10.0" y="1237" width="0.6" height="15.0" fill="rgb(245,140,40)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1247.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalp (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="54.1" y="677" width="1.7" height="15.0" fill="rgb(253,143,39)" rx="2" ry="2" /&gt;&lt;text  x="57.09" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgmexec (146 samples, 3.59%)&lt;/title&gt;&lt;rect x="17.8" y="949" width="42.4" height="15.0" fill="rgb(230,114,17)" rx="2" ry="2" /&gt;&lt;text  x="20.83" y="959.5" &gt;kgm..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;blkdev_ioctl (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="197" width="0.3" height="15.0" fill="rgb(249,54,33)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="207.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfinddur (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="43.9" y="533" width="0.3" height="15.0" fill="rgb(248,116,49)" rx="2" ry="2" /&gt;&lt;text  x="46.94" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolradc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="59.0" y="725" width="0.3" height="15.0" fill="rgb(229,36,42)" rx="2" ry="2" /&gt;&lt;text  x="62.02" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfrf (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1174.9" y="661" width="0.3" height="15.0" fill="rgb(217,160,53)" rx="2" ry="2" /&gt;&lt;text  x="1177.92" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;exit_to_usermode_loop (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="12.6" y="805" width="0.3" height="15.0" fill="rgb(208,53,4)" rx="2" ry="2" /&gt;&lt;text  x="15.61" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbchg1 (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="21.6" y="453" width="0.9" height="15.0" fill="rgb(218,148,21)" rx="2" ry="2" /&gt;&lt;text  x="24.60" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbz_mk_fr (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="25.4" y="517" width="0.3" height="15.0" fill="rgb(210,13,46)" rx="2" ry="2" /&gt;&lt;text  x="28.37" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kglpim (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="133" width="0.3" height="15.0" fill="rgb(214,115,16)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="143.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgsc (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="899.6" y="581" width="0.6" height="15.0" fill="rgb(254,153,47)" rx="2" ry="2" /&gt;&lt;text  x="902.64" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kfioSubmitIO (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="389" width="0.3" height="15.0" fill="rgb(249,66,11)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="399.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklc_write (88 samples, 2.16%)&lt;/title&gt;&lt;rect x="19.3" y="661" width="25.5" height="15.0" fill="rgb(205,188,11)" rx="2" ry="2" /&gt;&lt;text  x="22.28" y="671.5" &gt;k..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbdba_vbn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1185.4" y="901" width="0.2" height="15.0" fill="rgb(239,87,8)" rx="2" ry="2" /&gt;&lt;text  x="1188.36" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlu_timers_on (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="43.4" y="597" width="0.2" height="15.0" fill="rgb(205,6,44)" rx="2" ry="2" /&gt;&lt;text  x="46.36" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kco_issue_callback (53 samples, 1.30%)&lt;/title&gt;&lt;rect x="27.4" y="485" width="15.4" height="15.0" fill="rgb(247,150,44)" rx="2" ry="2" /&gt;&lt;text  x="30.40" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;entry_SYSCALL_64_after_hwframe (7 samples, 0.17%)&lt;/title&gt;&lt;rect x="1188.0" y="1509" width="2.0" height="15.0" fill="rgb(217,91,32)" rx="2" ry="2" /&gt;&lt;text  x="1190.97" y="1519.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbchg1 (54 samples, 1.33%)&lt;/title&gt;&lt;rect x="27.1" y="533" width="15.7" height="15.0" fill="rgb(232,105,54)" rx="2" ry="2" /&gt;&lt;text  x="30.11" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__libc_start_main (4,061 samples, 99.83%)&lt;/title&gt;&lt;rect x="10.0" y="1525" width="1178.0" height="15.0" fill="rgb(219,124,50)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1535.5" &gt;__libc_start_main&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgmpoa_process_out_args (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="18.1" y="917" width="0.6" height="15.0" fill="rgb(231,64,0)" rx="2" ry="2" /&gt;&lt;text  x="21.12" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;peidxexe (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.9" y="869" width="0.3" height="15.0" fill="rgb(241,211,7)" rx="2" ry="2" /&gt;&lt;text  x="64.92" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;evaopn2 (14 samples, 0.34%)&lt;/title&gt;&lt;rect x="60.5" y="965" width="4.0" height="15.0" fill="rgb(223,192,47)" rx="2" ry="2" /&gt;&lt;text  x="63.47" y="975.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpidru (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1109" width="1113.3" height="15.0" fill="rgb(235,110,47)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1119.5" &gt;rpidru&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalw (10 samples, 0.25%)&lt;/title&gt;&lt;rect x="55.8" y="741" width="2.9" height="15.0" fill="rgb(241,17,5)" rx="2" ry="2" /&gt;&lt;text  x="58.83" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaFree_rfc (33 samples, 0.81%)&lt;/title&gt;&lt;rect x="1178.4" y="1061" width="9.6" height="15.0" fill="rgb(231,200,20)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1071.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qximeop_fbk (14 samples, 0.34%)&lt;/title&gt;&lt;rect x="60.5" y="981" width="4.0" height="15.0" fill="rgb(232,114,38)" rx="2" ry="2" /&gt;&lt;text  x="63.47" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qxuageag (166 samples, 4.08%)&lt;/title&gt;&lt;rect x="16.4" y="1013" width="48.1" height="15.0" fill="rgb(217,47,40)" rx="2" ry="2" /&gt;&lt;text  x="19.38" y="1023.5" &gt;qxua..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kocgpn2 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="485" width="0.3" height="15.0" fill="rgb(215,33,41)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksmarfg (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="57.3" y="549" width="0.3" height="15.0" fill="rgb(213,34,1)" rx="2" ry="2" /&gt;&lt;text  x="60.28" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kole_templob_init (26 samples, 0.64%)&lt;/title&gt;&lt;rect x="48.3" y="741" width="7.5" height="15.0" fill="rgb(246,81,42)" rx="2" ry="2" /&gt;&lt;text  x="51.29" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_page_fault (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="57.0" y="469" width="0.3" height="15.0" fill="rgb(208,87,21)" rx="2" ry="2" /&gt;&lt;text  x="59.99" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbivbr (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1185.1" y="901" width="0.3" height="15.0" fill="rgb(246,7,2)" rx="2" ry="2" /&gt;&lt;text  x="1188.07" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kotgHashCode (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="533" width="0.3" height="15.0" fill="rgb(233,219,11)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;tred2i (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="64.2" y="853" width="0.3" height="15.0" fill="rgb(254,176,24)" rx="2" ry="2" /&gt;&lt;text  x="67.24" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;schedule (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="348.8" y="613" width="0.3" height="15.0" fill="rgb(232,178,13)" rx="2" ry="2" /&gt;&lt;text  x="351.80" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkspbd0 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1029" width="0.3" height="15.0" fill="rgb(243,91,28)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1039.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfinddur (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="349.1" y="677" width="0.6" height="15.0" fill="rgb(228,17,15)" rx="2" ry="2" /&gt;&lt;text  x="352.09" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opimai_real (4,061 samples, 99.83%)&lt;/title&gt;&lt;rect x="10.0" y="1477" width="1178.0" height="15.0" fill="rgb(241,210,10)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1487.5" &gt;opimai_real&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;unmap_vmas (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1189.4" y="1365" width="0.3" height="15.0" fill="rgb(226,216,34)" rx="2" ry="2" /&gt;&lt;text  x="1192.42" y="1375.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksl_get_shared_latch_int (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="26.2" y="533" width="0.9" height="15.0" fill="rgb(241,6,25)" rx="2" ry="2" /&gt;&lt;text  x="29.24" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbfsp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1185.4" y="917" width="0.2" height="15.0" fill="rgb(240,151,42)" rx="2" ry="2" /&gt;&lt;text  x="1188.36" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgetsh (5 samples, 0.12%)&lt;/title&gt;&lt;rect x="899.4" y="597" width="1.4" height="15.0" fill="rgb(241,223,24)" rx="2" ry="2" /&gt;&lt;text  x="902.35" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;get_page_from_freelist (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="55.3" y="405" width="0.2" height="15.0" fill="rgb(225,45,33)" rx="2" ry="2" /&gt;&lt;text  x="58.25" y="415.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgmexwi (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="60.5" y="917" width="1.7" height="15.0" fill="rgb(213,147,17)" rx="2" ry="2" /&gt;&lt;text  x="63.47" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;plsql_run (4,059 samples, 99.78%)&lt;/title&gt;&lt;rect x="10.6" y="1285" width="1177.4" height="15.0" fill="rgb(214,173,27)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1295.5" &gt;plsql_run&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__intel_new_memset (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="19.9" y="581" width="0.3" height="15.0" fill="rgb(217,0,47)" rx="2" ry="2" /&gt;&lt;text  x="22.86" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pmuocpy2_copy_recur (12 samples, 0.29%)&lt;/title&gt;&lt;rect x="11.5" y="965" width="3.4" height="15.0" fill="rgb(228,65,17)" rx="2" ry="2" /&gt;&lt;text  x="14.45" y="975.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_raw_spin_lock (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1189.4" y="1301" width="0.3" height="15.0" fill="rgb(205,206,18)" rx="2" ry="2" /&gt;&lt;text  x="1192.42" y="1311.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (5 samples, 0.12%)&lt;/title&gt;&lt;rect x="13.5" y="853" width="1.4" height="15.0" fill="rgb(228,39,35)" rx="2" ry="2" /&gt;&lt;text  x="16.48" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;swapgs_restore_regs_and_return_to_usermode (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="1155.5" y="645" width="1.1" height="15.0" fill="rgb(227,179,10)" rx="2" ry="2" /&gt;&lt;text  x="1158.48" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrdef1_get_tdo (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="64.2" y="869" width="0.3" height="15.0" fill="rgb(227,182,0)" rx="2" ry="2" /&gt;&lt;text  x="67.24" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;blk_flush_plug_list (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="69" width="0.3" height="15.0" fill="rgb(218,96,46)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="79.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kglobld (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="245" width="0.3" height="15.0" fill="rgb(210,182,42)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="255.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbgcur (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="22.5" y="421" width="0.3" height="15.0" fill="rgb(254,24,2)" rx="2" ry="2" /&gt;&lt;text  x="25.47" y="431.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbzar (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="895.9" y="613" width="0.3" height="15.0" fill="rgb(241,120,16)" rx="2" ry="2" /&gt;&lt;text  x="898.87" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbhfix_tail (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="24.5" y="517" width="0.3" height="15.0" fill="rgb(215,56,46)" rx="2" ry="2" /&gt;&lt;text  x="27.50" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;alloc_pages_vma (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="56.7" y="501" width="0.3" height="15.0" fill="rgb(228,173,32)" rx="2" ry="2" /&gt;&lt;text  x="59.70" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;run_timer_softirq (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1155.2" y="581" width="0.3" height="15.0" fill="rgb(228,32,3)" rx="2" ry="2" /&gt;&lt;text  x="1158.19" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (860 samples, 21.14%)&lt;/title&gt;&lt;rect x="350.0" y="645" width="249.4" height="15.0" fill="rgb(221,19,20)" rx="2" ry="2" /&gt;&lt;text  x="352.96" y="655.5" &gt;_intel_fast_memcmp&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;lxdgetobj (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="44.5" y="565" width="0.3" height="15.0" fill="rgb(223,219,43)" rx="2" ry="2" /&gt;&lt;text  x="47.52" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;free_pgtables (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1188.5" y="1381" width="0.3" height="15.0" fill="rgb(249,8,13)" rx="2" ry="2" /&gt;&lt;text  x="1191.55" y="1391.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kole_getFillChar (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="1172.6" y="693" width="0.9" height="15.0" fill="rgb(218,94,10)" rx="2" ry="2" /&gt;&lt;text  x="1175.60" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;lxgcnv (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1172.6" y="629" width="0.6" height="15.0" fill="rgb(219,183,38)" rx="2" ry="2" /&gt;&lt;text  x="1175.60" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlt_filltid (967 samples, 23.77%)&lt;/title&gt;&lt;rect x="69.2" y="693" width="280.5" height="15.0" fill="rgb(240,55,16)" rx="2" ry="2" /&gt;&lt;text  x="72.17" y="703.5" &gt;kdlt_filltid&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghash (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="48.0" y="677" width="0.3" height="15.0" fill="rgb(254,199,8)" rx="2" ry="2" /&gt;&lt;text  x="51.00" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;zap_pte_range (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1189.4" y="1317" width="0.3" height="15.0" fill="rgb(214,150,43)" rx="2" ry="2" /&gt;&lt;text  x="1192.42" y="1327.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;irq_exit (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="59.6" y="709" width="0.3" height="15.0" fill="rgb(247,125,8)" rx="2" ry="2" /&gt;&lt;text  x="62.60" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pevm_EXECC (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1221" width="0.3" height="15.0" fill="rgb(234,112,20)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1231.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrrun_no_tool (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="63.7" y="917" width="0.8" height="15.0" fill="rgb(236,99,35)" rx="2" ry="2" /&gt;&lt;text  x="66.66" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;nioqts (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.3" y="853" width="0.3" height="15.0" fill="rgb(208,130,3)" rx="2" ry="2" /&gt;&lt;text  x="64.34" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;irq_exit (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="335.7" y="629" width="0.6" height="15.0" fill="rgb(248,214,32)" rx="2" ry="2" /&gt;&lt;text  x="338.75" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="1185.6" y="933" width="1.8" height="15.0" fill="rgb(228,173,42)" rx="2" ry="2" /&gt;&lt;text  x="1188.65" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__handle_mm_fault (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="56.7" y="533" width="0.3" height="15.0" fill="rgb(238,41,4)" rx="2" ry="2" /&gt;&lt;text  x="59.70" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pdw0F01_Code_Gen (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="677" width="0.3" height="15.0" fill="rgb(233,116,24)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrinstr_INHFA1 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="64.0" y="901" width="0.2" height="15.0" fill="rgb(251,15,39)" rx="2" ry="2" /&gt;&lt;text  x="66.95" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kews_pls_jvm_event_begin_i (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="10.0" y="1301" width="0.6" height="15.0" fill="rgb(206,96,0)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1311.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbfsp (18 samples, 0.44%)&lt;/title&gt;&lt;rect x="895.6" y="645" width="5.2" height="15.0" fill="rgb(224,116,33)" rx="2" ry="2" /&gt;&lt;text  x="898.58" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohdee (33 samples, 0.81%)&lt;/title&gt;&lt;rect x="1178.4" y="1157" width="9.6" height="15.0" fill="rgb(207,208,29)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1167.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;plcurClose (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1189" width="1113.3" height="15.0" fill="rgb(251,207,33)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1199.5" &gt;plcurClose&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaAssign_rfc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="11.2" y="917" width="0.3" height="15.0" fill="rgb(223,61,51)" rx="2" ry="2" /&gt;&lt;text  x="14.16" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;oracle_19722_sf (4,068 samples, 100.00%)&lt;/title&gt;&lt;rect x="10.0" y="1541" width="1180.0" height="15.0" fill="rgb(243,212,19)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1551.5" &gt;oracle_19722_sf&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="12.9" y="853" width="0.3" height="15.0" fill="rgb(243,3,49)" rx="2" ry="2" /&gt;&lt;text  x="15.90" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcoapl_validate (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="898.2" y="565" width="0.3" height="15.0" fill="rgb(229,195,6)" rx="2" ry="2" /&gt;&lt;text  x="901.19" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktsbiredo (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="897.9" y="549" width="0.3" height="15.0" fill="rgb(226,156,34)" rx="2" ry="2" /&gt;&lt;text  x="900.90" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrr (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="67.4" y="709" width="0.9" height="15.0" fill="rgb(211,8,39)" rx="2" ry="2" /&gt;&lt;text  x="70.43" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbzgs (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="899.9" y="549" width="0.3" height="15.0" fill="rgb(230,91,26)" rx="2" ry="2" /&gt;&lt;text  x="902.93" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;block_ioctl (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="213" width="0.3" height="15.0" fill="rgb(243,166,33)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="223.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghash (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="12.6" y="853" width="0.3" height="15.0" fill="rgb(229,5,17)" rx="2" ry="2" /&gt;&lt;text  x="15.61" y="863.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1176.9" y="757" width="0.3" height="15.0" fill="rgb(232,41,1)" rx="2" ry="2" /&gt;&lt;text  x="1179.95" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ztchf (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="46.5" y="565" width="0.6" height="15.0" fill="rgb(246,118,15)" rx="2" ry="2" /&gt;&lt;text  x="49.55" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgshx (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="22.8" y="501" width="0.3" height="15.0" fill="rgb(205,217,40)" rx="2" ry="2" /&gt;&lt;text  x="25.76" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_anonymous_page (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="54.7" y="453" width="0.8" height="15.0" fill="rgb(228,77,40)" rx="2" ry="2" /&gt;&lt;text  x="57.67" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfindctl (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1182.2" y="949" width="0.3" height="15.0" fill="rgb(207,6,53)" rx="2" ry="2" /&gt;&lt;text  x="1185.17" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghssgai (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="54.1" y="693" width="1.7" height="15.0" fill="rgb(248,107,5)" rx="2" ry="2" /&gt;&lt;text  x="57.09" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qergsFetch (187 samples, 4.60%)&lt;/title&gt;&lt;rect x="10.6" y="1029" width="54.2" height="15.0" fill="rgb(230,29,16)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1039.5" &gt;qergs..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kole_t2u (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1172.6" y="677" width="0.6" height="15.0" fill="rgb(229,89,4)" rx="2" ry="2" /&gt;&lt;text  x="1175.60" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;expeal (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="14.9" y="981" width="0.3" height="15.0" fill="rgb(210,112,24)" rx="2" ry="2" /&gt;&lt;text  x="17.93" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;plsql_run (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.9" y="837" width="0.3" height="15.0" fill="rgb(239,121,26)" rx="2" ry="2" /&gt;&lt;text  x="64.92" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokegCopyGarbageFromOpn (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="16.7" y="997" width="0.6" height="15.0" fill="rgb(211,138,42)" rx="2" ry="2" /&gt;&lt;text  x="19.67" y="1007.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="11.2" y="869" width="0.3" height="15.0" fill="rgb(208,128,53)" rx="2" ry="2" /&gt;&lt;text  x="14.16" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opiodr (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1093" width="0.3" height="15.0" fill="rgb(244,217,50)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1103.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1173.8" y="677" width="0.2" height="15.0" fill="rgb(241,47,50)" rx="2" ry="2" /&gt;&lt;text  x="1176.76" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdl_destroy (11 samples, 0.27%)&lt;/title&gt;&lt;rect x="1182.5" y="949" width="3.1" height="15.0" fill="rgb(208,11,53)" rx="2" ry="2" /&gt;&lt;text  x="1185.46" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pdy8M23_Fill_TDO_Hash (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="549" width="0.3" height="15.0" fill="rgb(230,46,53)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_page_fault (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="54.7" y="517" width="0.8" height="15.0" fill="rgb(254,180,47)" rx="2" ry="2" /&gt;&lt;text  x="57.67" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpidru (187 samples, 4.60%)&lt;/title&gt;&lt;rect x="10.6" y="1141" width="54.2" height="15.0" fill="rgb(229,17,20)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1151.5" &gt;rpidru&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkxdexe (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="61.3" y="885" width="0.9" height="15.0" fill="rgb(222,85,11)" rx="2" ry="2" /&gt;&lt;text  x="64.34" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghgex (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="55.5" y="501" width="0.3" height="15.0" fill="rgb(232,122,46)" rx="2" ry="2" /&gt;&lt;text  x="58.54" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktcsna (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="42.8" y="581" width="0.6" height="15.0" fill="rgb(208,102,12)" rx="2" ry="2" /&gt;&lt;text  x="45.78" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kfk_transitIO (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="373" width="0.3" height="15.0" fill="rgb(208,173,44)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="383.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__alloc_pages_nodemask (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="58.2" y="533" width="0.2" height="15.0" fill="rgb(238,181,3)" rx="2" ry="2" /&gt;&lt;text  x="61.15" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;swapgs_restore_regs_and_return_to_usermode (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="599.1" y="629" width="0.3" height="15.0" fill="rgb(216,114,29)" rx="2" ry="2" /&gt;&lt;text  x="602.13" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;psddr0 (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1189" width="0.3" height="15.0" fill="rgb(223,45,4)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1199.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="52.9" y="661" width="0.3" height="15.0" fill="rgb(251,159,22)" rx="2" ry="2" /&gt;&lt;text  x="55.93" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrrun_no_tool (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.9" y="805" width="0.3" height="15.0" fill="rgb(237,1,27)" rx="2" ry="2" /&gt;&lt;text  x="64.92" y="815.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kprccu (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="10.9" y="997" width="0.6" height="15.0" fill="rgb(242,221,49)" rx="2" ry="2" /&gt;&lt;text  x="13.87" y="1007.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kpdbUidToId (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="609.3" y="613" width="0.3" height="15.0" fill="rgb(209,41,39)" rx="2" ry="2" /&gt;&lt;text  x="612.28" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pevm_RET (33 samples, 0.81%)&lt;/title&gt;&lt;rect x="1178.4" y="1221" width="9.6" height="15.0" fill="rgb(212,116,7)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1231.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalf (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="53.5" y="693" width="0.6" height="15.0" fill="rgb(250,139,6)" rx="2" ry="2" /&gt;&lt;text  x="56.51" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opiino (4,061 samples, 99.83%)&lt;/title&gt;&lt;rect x="10.0" y="1413" width="1178.0" height="15.0" fill="rgb(236,146,6)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1423.5" &gt;opiino&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohdee (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="885" width="1113.3" height="15.0" fill="rgb(243,136,14)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="895.5" &gt;kohdee&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalo (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="57.0" y="597" width="0.6" height="15.0" fill="rgb(219,25,51)" rx="2" ry="2" /&gt;&lt;text  x="59.99" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdl_length (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="43.6" y="565" width="0.6" height="15.0" fill="rgb(233,46,3)" rx="2" ry="2" /&gt;&lt;text  x="46.65" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcmp (879 samples, 21.61%)&lt;/title&gt;&lt;rect x="901.7" y="661" width="254.9" height="15.0" fill="rgb(247,83,1)" rx="2" ry="2" /&gt;&lt;text  x="904.67" y="671.5" &gt;_intel_fast_memcmp&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qctcpqb (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="949" width="0.3" height="15.0" fill="rgb(237,107,32)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;swapgs_restore_regs_and_return_to_usermode (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="336.3" y="661" width="0.9" height="15.0" fill="rgb(242,110,22)" rx="2" ry="2" /&gt;&lt;text  x="339.33" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kpdbHashTable_Find (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="43.9" y="485" width="0.3" height="15.0" fill="rgb(225,130,30)" rx="2" ry="2" /&gt;&lt;text  x="46.94" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbnew (10 samples, 0.25%)&lt;/title&gt;&lt;rect x="24.2" y="549" width="2.9" height="15.0" fill="rgb(208,90,10)" rx="2" ry="2" /&gt;&lt;text  x="27.21" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalo (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="53.8" y="661" width="0.3" height="15.0" fill="rgb(228,201,45)" rx="2" ry="2" /&gt;&lt;text  x="56.80" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;vma_merge (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1189.7" y="1397" width="0.3" height="15.0" fill="rgb(231,149,7)" rx="2" ry="2" /&gt;&lt;text  x="1192.71" y="1407.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollas2 (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="10.9" y="965" width="0.6" height="15.0" fill="rgb(245,112,14)" rx="2" ry="2" /&gt;&lt;text  x="13.87" y="975.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohfrem (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1187.7" y="981" width="0.3" height="15.0" fill="rgb(209,28,14)" rx="2" ry="2" /&gt;&lt;text  x="1190.68" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstdle_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1176.7" y="757" width="0.2" height="15.0" fill="rgb(225,115,42)" rx="2" ry="2" /&gt;&lt;text  x="1179.66" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokegPinLob (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="17.3" y="965" width="0.2" height="15.0" fill="rgb(205,95,23)" rx="2" ry="2" /&gt;&lt;text  x="20.25" y="975.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pfrcvfc_format_conversion (138 samples, 3.39%)&lt;/title&gt;&lt;rect x="19.0" y="773" width="40.0" height="15.0" fill="rgb(234,120,42)" rx="2" ry="2" /&gt;&lt;text  x="21.99" y="783.5" &gt;pfr..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghash (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="16.7" y="885" width="0.3" height="15.0" fill="rgb(215,58,34)" rx="2" ry="2" /&gt;&lt;text  x="19.67" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qercbiFetch (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="14.9" y="997" width="0.9" height="15.0" fill="rgb(230,53,21)" rx="2" ry="2" /&gt;&lt;text  x="17.93" y="1007.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksmarfg (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="57.0" y="533" width="0.3" height="15.0" fill="rgb(222,67,48)" rx="2" ry="2" /&gt;&lt;text  x="59.99" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkxswcm (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="773" width="0.3" height="15.0" fill="rgb(227,172,31)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="783.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sys_ioctl (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="245" width="0.3" height="15.0" fill="rgb(206,207,36)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="255.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;blk_finish_plug (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="85" width="0.3" height="15.0" fill="rgb(249,157,45)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="95.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrddc (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="16.7" y="917" width="0.6" height="15.0" fill="rgb(218,91,26)" rx="2" ry="2" /&gt;&lt;text  x="19.67" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpiswu2 (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="1125" width="1113.3" height="15.0" fill="rgb(246,65,38)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="1135.5" &gt;rpiswu2&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokasuc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="389" width="0.3" height="15.0" fill="rgb(246,119,5)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="399.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;exit_to_usermode_loop (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="38.7" y="405" width="0.3" height="15.0" fill="rgb(242,39,0)" rx="2" ry="2" /&gt;&lt;text  x="41.72" y="415.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_page_fault (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="54.7" y="501" width="0.8" height="15.0" fill="rgb(252,184,45)" rx="2" ry="2" /&gt;&lt;text  x="57.67" y="511.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;lxhasc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="59.9" y="901" width="0.3" height="15.0" fill="rgb(229,77,20)" rx="2" ry="2" /&gt;&lt;text  x="62.89" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkxcrc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.6" y="869" width="0.3" height="15.0" fill="rgb(244,164,24)" rx="2" ry="2" /&gt;&lt;text  x="64.63" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qxuag_initself (15 samples, 0.37%)&lt;/title&gt;&lt;rect x="60.2" y="997" width="4.3" height="15.0" fill="rgb(223,60,9)" rx="2" ry="2" /&gt;&lt;text  x="63.18" y="1007.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollalop (10 samples, 0.25%)&lt;/title&gt;&lt;rect x="55.8" y="757" width="2.9" height="15.0" fill="rgb(235,105,29)" rx="2" ry="2" /&gt;&lt;text  x="58.83" y="767.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgmgaicn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="17.8" y="901" width="0.3" height="15.0" fill="rgb(245,84,26)" rx="2" ry="2" /&gt;&lt;text  x="20.83" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghufree (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1187.7" y="965" width="0.3" height="15.0" fill="rgb(219,116,16)" rx="2" ry="2" /&gt;&lt;text  x="1190.68" y="975.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opipls (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="1077" width="0.3" height="15.0" fill="rgb(228,40,5)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="1087.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;exit_to_usermode_loop (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="336.9" y="629" width="0.3" height="15.0" fill="rgb(207,157,36)" rx="2" ry="2" /&gt;&lt;text  x="339.91" y="639.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ktecgetsh (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="898.8" y="597" width="0.6" height="15.0" fill="rgb(249,17,44)" rx="2" ry="2" /&gt;&lt;text  x="901.77" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklwrite (99 samples, 2.43%)&lt;/title&gt;&lt;rect x="19.3" y="725" width="28.7" height="15.0" fill="rgb(226,105,24)" rx="2" ry="2" /&gt;&lt;text  x="22.28" y="735.5" &gt;ko..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;_intel_fast_memcpy (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="47.1" y="549" width="0.3" height="15.0" fill="rgb(205,17,28)" rx="2" ry="2" /&gt;&lt;text  x="50.13" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;schedule (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="336.9" y="613" width="0.3" height="15.0" fill="rgb(210,36,52)" rx="2" ry="2" /&gt;&lt;text  x="339.91" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="46.3" y="565" width="0.2" height="15.0" fill="rgb(251,27,22)" rx="2" ry="2" /&gt;&lt;text  x="49.26" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklWrite (99 samples, 2.43%)&lt;/title&gt;&lt;rect x="19.3" y="709" width="28.7" height="15.0" fill="rgb(213,97,42)" rx="2" ry="2" /&gt;&lt;text  x="22.28" y="719.5" &gt;ko..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__do_page_fault (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="57.6" y="613" width="1.1" height="15.0" fill="rgb(251,14,42)" rx="2" ry="2" /&gt;&lt;text  x="60.57" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;opifch (187 samples, 4.60%)&lt;/title&gt;&lt;rect x="10.6" y="1061" width="54.2" height="15.0" fill="rgb(251,143,26)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1071.5" &gt;opifch&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;mmap_region (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="1188.3" y="1413" width="1.7" height="15.0" fill="rgb(238,46,6)" rx="2" ry="2" /&gt;&lt;text  x="1191.26" y="1423.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfindctl (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1184.8" y="917" width="0.3" height="15.0" fill="rgb(213,100,46)" rx="2" ry="2" /&gt;&lt;text  x="1187.78" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qctcopn_internal (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="917" width="0.3" height="15.0" fill="rgb(233,100,52)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;swapgs_restore_regs_and_return_to_usermode (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="12.6" y="837" width="0.3" height="15.0" fill="rgb(210,97,46)" rx="2" ry="2" /&gt;&lt;text  x="15.61" y="847.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qesaEvaAndPutDistAggOpns (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="15.2" y="949" width="0.3" height="15.0" fill="rgb(209,89,10)" rx="2" ry="2" /&gt;&lt;text  x="18.22" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;schedule (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="881.9" y="597" width="0.3" height="15.0" fill="rgb(213,7,10)" rx="2" ry="2" /&gt;&lt;text  x="884.95" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokltfr_pdbcbk (3,810 samples, 93.66%)&lt;/title&gt;&lt;rect x="69.2" y="709" width="1105.1" height="15.0" fill="rgb(206,208,16)" rx="2" ry="2" /&gt;&lt;text  x="72.17" y="719.5" &gt;kokltfr_pdbcbk&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;finish_task_switch (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="1155.8" y="565" width="0.8" height="15.0" fill="rgb(217,222,51)" rx="2" ry="2" /&gt;&lt;text  x="1158.77" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;xtypls (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="821" width="0.3" height="15.0" fill="rgb(247,144,47)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="831.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="11.5" y="885" width="0.2" height="15.0" fill="rgb(247,172,5)" rx="2" ry="2" /&gt;&lt;text  x="14.45" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__schedule (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="881.4" y="565" width="0.5" height="15.0" fill="rgb(225,116,12)" rx="2" ry="2" /&gt;&lt;text  x="884.37" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rpiswu2 (187 samples, 4.60%)&lt;/title&gt;&lt;rect x="10.6" y="1157" width="54.2" height="15.0" fill="rgb(247,166,40)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1167.5" &gt;rpiswu2&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbo_unlink_q1 (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="894.7" y="581" width="0.9" height="15.0" fill="rgb(249,141,39)" rx="2" ry="2" /&gt;&lt;text  x="897.71" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pdy8M06_Create_TDO_Lite (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="565" width="0.3" height="15.0" fill="rgb(253,144,26)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kglpim (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="277" width="0.3" height="15.0" fill="rgb(241,49,19)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="287.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pdy4M17_Create (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="597" width="0.3" height="15.0" fill="rgb(240,202,46)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokageti (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="421" width="0.3" height="15.0" fill="rgb(242,13,38)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="431.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlwdb (64 samples, 1.57%)&lt;/title&gt;&lt;rect x="24.2" y="565" width="18.6" height="15.0" fill="rgb(226,37,24)" rx="2" ry="2" /&gt;&lt;text  x="27.21" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;do_anonymous_page (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="56.7" y="517" width="0.3" height="15.0" fill="rgb(222,111,49)" rx="2" ry="2" /&gt;&lt;text  x="59.70" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollulin (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1176.1" y="725" width="0.3" height="15.0" fill="rgb(215,122,37)" rx="2" ry="2" /&gt;&lt;text  x="1179.08" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalmc (10 samples, 0.25%)&lt;/title&gt;&lt;rect x="55.8" y="709" width="2.9" height="15.0" fill="rgb(220,167,54)" rx="2" ry="2" /&gt;&lt;text  x="58.83" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__vdso_clock_gettime (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="900.5" y="549" width="0.3" height="15.0" fill="rgb(216,36,49)" rx="2" ry="2" /&gt;&lt;text  x="903.51" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolttfr (10 samples, 0.25%)&lt;/title&gt;&lt;rect x="12.0" y="933" width="2.9" height="15.0" fill="rgb(231,133,28)" rx="2" ry="2" /&gt;&lt;text  x="15.03" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrEnabled (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="59.3" y="709" width="0.3" height="15.0" fill="rgb(218,94,25)" rx="2" ry="2" /&gt;&lt;text  x="62.31" y="719.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__schedule (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="599.1" y="565" width="0.3" height="15.0" fill="rgb(243,207,1)" rx="2" ry="2" /&gt;&lt;text  x="602.13" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kole_t2u_int (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="1172.6" y="661" width="0.6" height="15.0" fill="rgb(227,74,8)" rx="2" ry="2" /&gt;&lt;text  x="1175.60" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;sorlookqb (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="16.1" y="981" width="0.3" height="15.0" fill="rgb(249,208,25)" rx="2" ry="2" /&gt;&lt;text  x="19.09" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__vdso_clock_gettime (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="22.8" y="437" width="0.3" height="15.0" fill="rgb(207,40,25)" rx="2" ry="2" /&gt;&lt;text  x="25.76" y="447.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;schedule (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="12.6" y="789" width="0.3" height="15.0" fill="rgb(222,45,7)" rx="2" ry="2" /&gt;&lt;text  x="15.61" y="799.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kpdbHashTable_Find (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="609.3" y="597" width="0.3" height="15.0" fill="rgb(235,165,16)" rx="2" ry="2" /&gt;&lt;text  x="612.28" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrEnabled (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="47.7" y="693" width="0.3" height="15.0" fill="rgb(225,128,2)" rx="2" ry="2" /&gt;&lt;text  x="50.71" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrghte (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1174.0" y="677" width="0.3" height="15.0" fill="rgb(212,23,48)" rx="2" ry="2" /&gt;&lt;text  x="1177.05" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qctcopn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="933" width="0.3" height="15.0" fill="rgb(231,59,51)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kksfbc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="325" width="0.3" height="15.0" fill="rgb(240,194,21)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="335.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaFree (10 samples, 0.25%)&lt;/title&gt;&lt;rect x="12.0" y="917" width="2.9" height="15.0" fill="rgb(211,211,23)" rx="2" ry="2" /&gt;&lt;text  x="15.03" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolradlst (6 samples, 0.15%)&lt;/title&gt;&lt;rect x="48.6" y="677" width="1.7" height="15.0" fill="rgb(219,101,42)" rx="2" ry="2" /&gt;&lt;text  x="51.58" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__schedule (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="336.9" y="597" width="0.3" height="15.0" fill="rgb(253,48,15)" rx="2" ry="2" /&gt;&lt;text  x="339.91" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrarfc (10 samples, 0.25%)&lt;/title&gt;&lt;rect x="50.3" y="677" width="2.9" height="15.0" fill="rgb(216,209,26)" rx="2" ry="2" /&gt;&lt;text  x="53.32" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkxcms (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="741" width="0.3" height="15.0" fill="rgb(206,151,19)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="751.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgmpia_process_in_args (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="61.1" y="901" width="0.2" height="15.0" fill="rgb(207,182,45)" rx="2" ry="2" /&gt;&lt;text  x="64.05" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokltcr (8 samples, 0.20%)&lt;/title&gt;&lt;rect x="45.1" y="597" width="2.3" height="15.0" fill="rgb(228,209,1)" rx="2" ry="2" /&gt;&lt;text  x="48.10" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kxsFreeWorkArea (3,838 samples, 94.35%)&lt;/title&gt;&lt;rect x="64.8" y="949" width="1113.3" height="15.0" fill="rgb(243,11,35)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="959.5" &gt;kxsFreeWorkArea&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__intel_new_memset (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1182.5" y="933" width="0.2" height="15.0" fill="rgb(254,58,39)" rx="2" ry="2" /&gt;&lt;text  x="1185.46" y="943.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollfrfn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="47.4" y="597" width="0.3" height="15.0" fill="rgb(227,15,24)" rx="2" ry="2" /&gt;&lt;text  x="50.42" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;finish_task_switch (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="599.1" y="549" width="0.3" height="15.0" fill="rgb(243,17,19)" rx="2" ry="2" /&gt;&lt;text  x="602.13" y="559.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pcicms (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="725" width="0.3" height="15.0" fill="rgb(248,207,53)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__clock_gettime (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="22.8" y="453" width="0.3" height="15.0" fill="rgb(222,152,12)" rx="2" ry="2" /&gt;&lt;text  x="25.76" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcoapl (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="21.9" y="421" width="0.3" height="15.0" fill="rgb(206,37,26)" rx="2" ry="2" /&gt;&lt;text  x="24.89" y="431.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pevm_BFTCHC (187 samples, 4.60%)&lt;/title&gt;&lt;rect x="10.6" y="1221" width="54.2" height="15.0" fill="rgb(223,163,42)" rx="2" ry="2" /&gt;&lt;text  x="13.58" y="1231.5" &gt;pevm_..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghufree (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="68.0" y="677" width="0.3" height="15.0" fill="rgb(252,145,30)" rx="2" ry="2" /&gt;&lt;text  x="71.01" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;peidxexe (141 samples, 3.47%)&lt;/title&gt;&lt;rect x="19.0" y="885" width="40.9" height="15.0" fill="rgb(214,163,29)" rx="2" ry="2" /&gt;&lt;text  x="21.99" y="895.5" &gt;pei..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolaFree (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="16.7" y="949" width="0.6" height="15.0" fill="rgb(246,173,10)" rx="2" ry="2" /&gt;&lt;text  x="19.67" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklWrite (88 samples, 2.16%)&lt;/title&gt;&lt;rect x="19.3" y="629" width="25.5" height="15.0" fill="rgb(213,207,23)" rx="2" ry="2" /&gt;&lt;text  x="22.28" y="639.5" &gt;k..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kfk_submit_io (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="341" width="0.3" height="15.0" fill="rgb(250,44,32)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="351.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolttcr (10 samples, 0.25%)&lt;/title&gt;&lt;rect x="44.8" y="645" width="2.9" height="15.0" fill="rgb(245,49,6)" rx="2" ry="2" /&gt;&lt;text  x="47.81" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohedu (33 samples, 0.81%)&lt;/title&gt;&lt;rect x="1178.4" y="1173" width="9.6" height="15.0" fill="rgb(209,217,49)" rx="2" ry="2" /&gt;&lt;text  x="1181.40" y="1183.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrihtab (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="53.2" y="677" width="0.3" height="15.0" fill="rgb(214,145,6)" rx="2" ry="2" /&gt;&lt;text  x="56.22" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;lxhasc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="63.1" y="885" width="0.3" height="15.0" fill="rgb(231,187,11)" rx="2" ry="2" /&gt;&lt;text  x="66.08" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfnd (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="57.0" y="581" width="0.6" height="15.0" fill="rgb(254,122,14)" rx="2" ry="2" /&gt;&lt;text  x="59.99" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kolrddc (3 samples, 0.07%)&lt;/title&gt;&lt;rect x="12.0" y="885" width="0.9" height="15.0" fill="rgb(248,149,24)" rx="2" ry="2" /&gt;&lt;text  x="15.03" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qxuagtag (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="901" width="0.3" height="15.0" fill="rgb(242,169,18)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__intel_ssse3_rep_memcpy (13 samples, 0.32%)&lt;/title&gt;&lt;rect x="27.4" y="453" width="3.8" height="15.0" fill="rgb(240,85,9)" rx="2" ry="2" /&gt;&lt;text  x="30.40" y="463.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;rcu_process_callbacks (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="59.6" y="677" width="0.3" height="15.0" fill="rgb(217,164,29)" rx="2" ry="2" /&gt;&lt;text  x="62.60" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pdy1F01_Driver (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="645" width="0.3" height="15.0" fill="rgb(237,42,23)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;blk_mq_sched_insert_requests (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="37" width="0.3" height="15.0" fill="rgb(207,93,34)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="47.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlf_write (83 samples, 2.04%)&lt;/title&gt;&lt;rect x="19.6" y="613" width="24.0" height="15.0" fill="rgb(239,217,46)" rx="2" ry="2" /&gt;&lt;text  x="22.57" y="623.5" &gt;k..&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kohalc (10 samples, 0.25%)&lt;/title&gt;&lt;rect x="55.8" y="725" width="2.9" height="15.0" fill="rgb(243,217,39)" rx="2" ry="2" /&gt;&lt;text  x="58.83" y="735.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;prepare_exit_to_usermode (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="599.1" y="613" width="0.3" height="15.0" fill="rgb(221,33,16)" rx="2" ry="2" /&gt;&lt;text  x="602.13" y="623.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksfd_io (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="20.4" y="469" width="0.3" height="15.0" fill="rgb(236,147,27)" rx="2" ry="2" /&gt;&lt;text  x="23.44" y="479.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qctcopn (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="869" width="0.3" height="15.0" fill="rgb(229,62,49)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;qximcom (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="885" width="0.3" height="15.0" fill="rgb(211,201,17)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="895.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalf (9 samples, 0.22%)&lt;/title&gt;&lt;rect x="50.3" y="661" width="2.6" height="15.0" fill="rgb(254,143,5)" rx="2" ry="2" /&gt;&lt;text  x="53.32" y="671.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;pdy4M63_Layout_Record (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="581" width="0.3" height="15.0" fill="rgb(240,166,17)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="591.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="52.9" y="645" width="0.3" height="15.0" fill="rgb(238,161,47)" rx="2" ry="2" /&gt;&lt;text  x="55.93" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kksLoadChild (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="229" width="0.3" height="15.0" fill="rgb(218,48,11)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="239.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdlt_filltid (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.7" y="981" width="0.3" height="15.0" fill="rgb(230,149,48)" rx="2" ry="2" /&gt;&lt;text  x="1181.69" y="991.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ksmust (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="10.3" y="1205" width="0.3" height="15.0" fill="rgb(205,92,42)" rx="2" ry="2" /&gt;&lt;text  x="13.29" y="1215.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kkxpinbd (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="62.2" y="917" width="0.6" height="15.0" fill="rgb(244,40,15)" rx="2" ry="2" /&gt;&lt;text  x="65.21" y="927.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghufrheap (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="64.8" y="869" width="0.3" height="15.0" fill="rgb(251,45,9)" rx="2" ry="2" /&gt;&lt;text  x="67.82" y="879.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghfre (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="10.0" y="1205" width="0.3" height="15.0" fill="rgb(211,42,47)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1215.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kollasg (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="10.9" y="949" width="0.6" height="15.0" fill="rgb(225,173,0)" rx="2" ry="2" /&gt;&lt;text  x="13.87" y="959.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kdltfinddur (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="893.8" y="645" width="0.3" height="15.0" fill="rgb(206,100,25)" rx="2" ry="2" /&gt;&lt;text  x="896.84" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgmatim (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="60.5" y="901" width="0.6" height="15.0" fill="rgb(221,72,35)" rx="2" ry="2" /&gt;&lt;text  x="63.47" y="911.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbzfb (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="25.7" y="517" width="0.5" height="15.0" fill="rgb(249,56,32)" rx="2" ry="2" /&gt;&lt;text  x="28.66" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kghalf (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="56.4" y="677" width="1.2" height="15.0" fill="rgb(216,25,20)" rx="2" ry="2" /&gt;&lt;text  x="59.41" y="687.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbhfho (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="24.2" y="533" width="0.6" height="15.0" fill="rgb(235,169,54)" rx="2" ry="2" /&gt;&lt;text  x="27.21" y="543.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kokacmc (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="213" width="0.3" height="15.0" fill="rgb(211,124,16)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="223.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghash (4 samples, 0.10%)&lt;/title&gt;&lt;rect x="48.9" y="645" width="1.1" height="15.0" fill="rgb(251,190,1)" rx="2" ry="2" /&gt;&lt;text  x="51.87" y="655.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;get_page_from_freelist (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="58.2" y="517" width="0.2" height="15.0" fill="rgb(231,35,7)" rx="2" ry="2" /&gt;&lt;text  x="61.15" y="527.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;ssthrdmain (4,061 samples, 99.83%)&lt;/title&gt;&lt;rect x="10.0" y="1493" width="1178.0" height="15.0" fill="rgb(243,68,40)" rx="2" ry="2" /&gt;&lt;text  x="13.00" y="1503.5" &gt;ssthrdmain&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kglsim_pin_simhp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="1178.1" y="85" width="0.3" height="15.0" fill="rgb(218,229,13)" rx="2" ry="2" /&gt;&lt;text  x="1181.11" y="95.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kcbgcur (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="899.6" y="565" width="0.6" height="15.0" fill="rgb(232,96,16)" rx="2" ry="2" /&gt;&lt;text  x="902.64" y="575.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;kgghstfel_wfp (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="48.0" y="693" width="0.3" height="15.0" fill="rgb(219,43,19)" rx="2" ry="2" /&gt;&lt;text  x="51.00" y="703.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;koklNeedSurrChk (2 samples, 0.05%)&lt;/title&gt;&lt;rect x="43.6" y="597" width="0.6" height="15.0" fill="rgb(247,103,14)" rx="2" ry="2" /&gt;&lt;text  x="46.65" y="607.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;g &gt;&lt;title&gt;__alloc_pages_nodemask (1 samples, 0.02%)&lt;/title&gt;&lt;rect x="56.7" y="485" width="0.3" height="15.0" fill="rgb(228,126,34)" rx="2" ry="2" /&gt;&lt;text  x="59.70" y="495.5" &gt;&lt;/text&gt;&lt;/g&gt;&lt;/g&gt;&lt;/svg&gt;All of those kksumc, kxsFreeExecutionHeap, kxsFreeWorkArea, kxsdmc and others are memory free/releasing cursor routines. As you might guess, the nature of this issue is related to that user-defined type from the query. Here's the code that I used for that demo: &lt;pre class="brush:sql;highlight:[45,46]"&gt;CREATE OR REPLACE TYPE user_agg_t as object(&lt;br /&gt;  v_clob       clob,&lt;br /&gt;&lt;br /&gt;  static function ODCIAggregateInitialize(sctx IN OUT NOCOPY user_agg_t)&lt;br /&gt;    return number,&lt;br /&gt;&lt;br /&gt;  member function ODCIAggregateIterate(self IN OUT NOCOPY user_agg_t,&lt;br /&gt;                                       value IN varchar2)&lt;br /&gt;    return number,&lt;br /&gt;&lt;br /&gt;  member function ODCIAggregateTerminate(self IN OUT NOCOPY user_agg_t,&lt;br /&gt;                                         returnValue OUT NOCOPY clob,&lt;br /&gt;                                         flags IN number)&lt;br /&gt;    return number,&lt;br /&gt;&lt;br /&gt;  member function ODCIAggregateMerge(self IN OUT NOCOPY user_agg_t,&lt;br /&gt;                                     ctx2 IN OUT NOCOPY user_agg_t)&lt;br /&gt;    return number&lt;br /&gt;);&lt;br /&gt;/&lt;br /&gt;&lt;br /&gt;CREATE OR REPLACE TYPE BODY user_agg_t&lt;br /&gt;is&lt;br /&gt;&lt;br /&gt;  static function ODCIAggregateInitialize(sctx IN OUT NOCOPY user_agg_t)&lt;br /&gt;    return number is&lt;br /&gt;  begin&lt;br /&gt;    sctx := user_agg_t(null);&lt;br /&gt;    return ODCIConst.Success;&lt;br /&gt;  end;&lt;br /&gt;&lt;br /&gt;  member function ODCIAggregateIterate(self   IN OUT NOCOPY user_agg_t,&lt;br /&gt;                                       value  IN varchar2)&lt;br /&gt;    return number&lt;br /&gt;  is&lt;br /&gt;  begin&lt;br /&gt;    return ODCIConst.Success;&lt;br /&gt;  end;&lt;br /&gt;&lt;br /&gt;  member function ODCIAggregateTerminate(self IN OUT NOCOPY user_agg_t,&lt;br /&gt;                                         returnValue OUT NOCOPY clob,&lt;br /&gt;                                         flags IN number)&lt;br /&gt;    return number is&lt;br /&gt;  begin&lt;br /&gt;    self.v_clob := 'finished';&lt;br /&gt;    returnValue := self.v_clob;&lt;br /&gt;    return ODCIConst.Success;&lt;br /&gt;  end;&lt;br /&gt;&lt;br /&gt;  member function ODCIAggregateMerge(self IN OUT NOCOPY user_agg_t,&lt;br /&gt;                                     ctx2 IN OUT NOCOPY user_agg_t)&lt;br /&gt;    return number is&lt;br /&gt;  begin&lt;br /&gt;    return ODCIConst.Success;&lt;br /&gt;  end;&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;&lt;br /&gt;CREATE OR REPLACE FUNCTION user_agg_function (input varchar2) RETURN clob PARALLEL_ENABLE AGGREGATE USING user_agg_t;&lt;br /&gt;/&lt;br /&gt;&lt;/pre&gt;There is an abstract LOB created in the highlighted line. While the anonymous block is running, it creates a lot of those abstract LOBs, upto 30,000 which is the number of rows that I fetch from that cursor (I am checking it through V$TEMPORARY_LOBS). When I call the close cursor line, the server process decides that it is time to free up all of those resources back and that is what is taking so much time; here is the relevant output: &lt;pre class="brush:sql"&gt;SQL&gt; select to_char(sysdate, 'hh24:mi:ss') current_time, l.* from v$temporary_lobs l;&lt;br /&gt;&lt;br /&gt;-- The session is executing&lt;br /&gt;CURRENT_        SID CACHE_LOBS NOCACHE_LOBS ABSTRACT_LOBS     CON_ID&lt;br /&gt;-------- ---------- ---------- ------------ ------------- ----------&lt;br /&gt;21:32:23         47          0            0             0          3&lt;br /&gt;21:32:23         58      23921            0         23922          3&lt;br /&gt;&lt;br /&gt;SQL&gt; /&lt;br /&gt;&lt;br /&gt;-- It created upto 30K abstract LOBs&lt;br /&gt;CURRENT_        SID CACHE_LOBS NOCACHE_LOBS ABSTRACT_LOBS     CON_ID&lt;br /&gt;-------- ---------- ---------- ------------ ------------- ----------&lt;br /&gt;21:32:24         47          0            0             0          3&lt;br /&gt;21:32:24         58      29737            0         29738          3&lt;br /&gt;&lt;br /&gt;SQL&gt; /&lt;br /&gt;&lt;br /&gt;-- Now it is steadily deallocating them&lt;br /&gt;CURRENT_        SID CACHE_LOBS NOCACHE_LOBS ABSTRACT_LOBS     CON_ID&lt;br /&gt;-------- ---------- ---------- ------------ ------------- ----------&lt;br /&gt;21:32:25         47          0            0             0          3&lt;br /&gt;21:32:25         58      29507            0         29508          3&lt;br /&gt;&lt;br /&gt;SQL&gt; /&lt;br /&gt;&lt;br /&gt;CURRENT_        SID CACHE_LOBS NOCACHE_LOBS ABSTRACT_LOBS     CON_ID&lt;br /&gt;-------- ---------- ---------- ------------ ------------- ----------&lt;br /&gt;21:32:26         47          0            0             0          3&lt;br /&gt;21:32:26         58      29269            0         29269          3&lt;br /&gt;&lt;br /&gt;SQL&gt; /&lt;br /&gt;&lt;br /&gt;CURRENT_        SID CACHE_LOBS NOCACHE_LOBS ABSTRACT_LOBS     CON_ID&lt;br /&gt;-------- ---------- ---------- ------------ ------------- ----------&lt;br /&gt;21:32:28         47          0            0             0          3&lt;br /&gt;21:32:28         58      28626            0         28626          3&lt;br /&gt;&lt;br /&gt;SQL&gt; /&lt;br /&gt;&lt;br /&gt;CURRENT_        SID CACHE_LOBS NOCACHE_LOBS ABSTRACT_LOBS     CON_ID&lt;br /&gt;-------- ---------- ---------- ------------ ------------- ----------&lt;br /&gt;21:32:30         47          0            0             0          3&lt;br /&gt;21:32:30         58      28017            0         28018          3&lt;br /&gt;&lt;br /&gt;SQL&gt; /&lt;br /&gt;&lt;br /&gt;CURRENT_        SID CACHE_LOBS NOCACHE_LOBS ABSTRACT_LOBS     CON_ID&lt;br /&gt;-------- ---------- ---------- ------------ ------------- ----------&lt;br /&gt;21:32:31         47          0            0             0          3&lt;br /&gt;21:32:31         58      27551            0         27552          3&lt;br /&gt;&lt;br /&gt;SQL&gt; /&lt;br /&gt;&lt;br /&gt;CURRENT_        SID CACHE_LOBS NOCACHE_LOBS ABSTRACT_LOBS     CON_ID&lt;br /&gt;-------- ---------- ---------- ------------ ------------- ----------&lt;br /&gt;21:32:33         47          0            0             0          3&lt;br /&gt;21:32:33         58      27093            0         27093          3&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Why did I put 30,001 in that cursor? If I had not done this, Oracle would have performed that deallocation stage at the time of the last fetch. It closely emulates what my APEX application is doing by using row-limiting clause instead.  Initially, I was not able to reproduce my test case in the vanilla 12.2.0.1.190416 database that I used for that demo. Here's how that anonymous block was executing there: &lt;pre class="brush:sql;highlight:[37,46]"&gt;SQL&gt; declare&lt;br /&gt;  2    cursor test_csr is&lt;br /&gt;  3      select t1.*, user_agg_function(to_char(l)) c1&lt;br /&gt;  4        from (select level l from dual connect by level&lt;=30001) t1&lt;br /&gt;  5       group by t1.l;&lt;br /&gt;  6    type test_tbl_type is table of test_csr%rowtype;&lt;br /&gt;  7    v_test_tbl test_tbl_type;&lt;br /&gt;  8  begin&lt;br /&gt;  9    open test_csr;&lt;br /&gt; 10&lt;br /&gt; 11    dbms_output.put_line(systimestamp||' After open');&lt;br /&gt; 12&lt;br /&gt; 13    for i in 1..6&lt;br /&gt; 14    loop&lt;br /&gt; 15      fetch test_csr bulk collect into v_test_tbl limit 5000;&lt;br /&gt; 16      dbms_output.put_line(systimestamp||' After fetch');&lt;br /&gt; 17    end loop;&lt;br /&gt; 18&lt;br /&gt; 19    dbms_output.put_line(systimestamp||' After all fetches');&lt;br /&gt; 20&lt;br /&gt; 21    close test_csr;&lt;br /&gt; 22    dbms_output.put_line(systimestamp||' After close');&lt;br /&gt; 23  end;&lt;br /&gt; 24  /&lt;br /&gt;30-JUL-19 08.38.01.599807000 PM +01:00 After open&lt;br /&gt;30-JUL-19 08.38.01.709834000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 08.38.01.831769000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 08.38.01.974946000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 08.38.02.137070000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 08.38.02.321525000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 08.38.02.540002000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 08.38.02.540024000 PM +01:00 After all fetches&lt;br /&gt;30-JUL-19 08.38.02.604546000 PM +01:00 After close&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:01.02&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select p.pga_used_mem, p.pga_alloc_mem&lt;br /&gt;  2    from v$session s, v$process p&lt;br /&gt;  3   where s.sid = sys_context('userenv', 'sid')&lt;br /&gt;  4     and p.addr = s.paddr;&lt;br /&gt;&lt;br /&gt;PGA_USED_MEM PGA_ALLOC_MEM&lt;br /&gt;------------ -------------&lt;br /&gt;   446703652     450742580&lt;br /&gt;&lt;/pre&gt;It's blazingly fast, isn't it? However, notice that PGA is not freed back and my session consumes 450MB! While wading through OS/Oracle traces, I finally came across the &lt;b&gt;&lt;i&gt;trace[LOB_REFCOUNT]&lt;/i&gt;&lt;/b&gt; event that gave some clues: &lt;pre class="brush:sql;highlight:[2]"&gt;kolradc :  0xe7 0x69 0xb7 0x01 0x00 0x00 0x00 0x63  : 2 (24)&lt;br /&gt;PGA usage percent: 4829 percent, isMaxHeap reached?: 1, Mem check freq: 25 &lt;br /&gt;kolrarfc:  0xe7 0x69 0xb7 0x01 0x00 0x00 0x00 0x64  : 1&lt;br /&gt;kolrarfc: kolaCreateClob()+123&lt;-kolaslCreateClob()+144&lt;-kole_templob_init()+428&lt;-kole_ba2l()+170&lt;-pfrcvfc_format_conversion()+2369&lt;-pevm_CNVMSC()+49&lt;-pfrinstr_CNVMSC()+52&lt;-pfrrun_no_tool()+60&lt;-pfrrun()+917&lt;-plsql_run()+756&lt;-peidxr_run()+265&lt;-peidxexe()+76&lt;-kkxdexe()+625&lt;-kkxmpexe()+288&lt;-kgmexwi()+592&lt;br /&gt;kolrarfc: number of lobs = 100&lt;br /&gt;kolrDmpTables_uts: Called from :  at every 100th lob added &lt;br /&gt;kolrDmpDurs_uts: Called from :  at every 100th lob added &lt;br /&gt;-----  kolr Durations Dump Begin ----&lt;br /&gt;-------------------------------------&lt;br /&gt;DUR     LOB COUNT     TOTAL RFC&lt;br /&gt;-------------------------------------&lt;br /&gt; 24            99           100&lt;br /&gt; 28             1             1&lt;br /&gt; 29            99            99&lt;br /&gt;------  kolr Durations Dump End -----&lt;br /&gt;-----------------  kolr Dur Hash Table Dump Begin:  24 --------------&lt;br /&gt; Lob Locator                                          count  (dur in loc)&lt;br /&gt;------------------------------------------------------------------------&lt;br /&gt; 0xe7 0x69 0xb7 0x01 0x00 0x00 0x00 0x5f        1    (29)&lt;br /&gt; 0xe7 0x69 0xb7 0x01 0x00 0x00 0x00 0x0b        1    (29)&lt;br /&gt; 0xe7 0x69 0xb7 0x01 0x00 0x00 0x00 0x06        1    (29)&lt;br /&gt; 0xe7 0x69 0xb7 0x01 0x00 0x00 0x00 0x5a        1    (29)&lt;br /&gt;&lt;/pre&gt;That was from a database that had a plenty of PGA available that was far more below PGA_AGGREGATE_TARGET (PAT). Yet, that database was suffering from that issue. Then I was able to reproduce that slow close cursor step by occupying a lot of PGA first. I wrote a simple package to help me in this task: &lt;pre class="brush:sql"&gt;create or replace package fill_memory&lt;br /&gt;is&lt;br /&gt;  type t is table of varchar2(32767);&lt;br /&gt;  v t := t();&lt;br /&gt;  procedure extend(i_size pls_integer := 10000);&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;create or replace package body fill_memory&lt;br /&gt;is&lt;br /&gt;  procedure extend(i_size pls_integer := 10000)&lt;br /&gt;  is&lt;br /&gt;    v_current_size pls_integer;&lt;br /&gt;  begin&lt;br /&gt;    v_current_size := v.count();&lt;br /&gt;    v.extend(i_size);&lt;br /&gt;    for i in v_current_size + 1..v_current_size + i_size&lt;br /&gt;    loop&lt;br /&gt;      v(i) := lpad('x', 32767, 'x');&lt;br /&gt;    end loop;&lt;br /&gt;  end extend;&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;&lt;/pre&gt;I found that in the demo database with PAT set to 512M, it is enough to call fill_memory.extend(25000) to make all subsequent executions of the anonymous block in question slow (bigger values resulted in the &lt;b&gt;&lt;i&gt;acknowledge over PGA limit&lt;/i&gt;&lt;/b&gt; event, which I tried to avoid for this demo as I did not observe them in my database initially and those would be a clear indication of the problem area): &lt;pre class="brush:sql"&gt;SQL&gt; exec fill_memory.extend(25000)&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;Although I was able to reproduce that issue in a clean database, I have been able to do that &lt;b&gt;&lt;i&gt;only if&lt;/i&gt;&lt;/b&gt; I consumed a lot of PGA first. Still, I observe that issue now in one of my development database where there is a bunch of free PGA and I have raised an SR with Oracle support to further investigate it (I believe I have already done my homework, so that it shouldb't be so hard for them to tackle this problem now).   Another remarkable thing that I discovered while I was working on this issue, is that 19c consumes far more memory on the same test case and performance does not suffer (it's 450M in 12.2 versus 1450M in 19c - I would probably raise another SR when I start using 19c for that application): &lt;pre class="brush:sql"&gt;SQL&gt; declare&lt;br /&gt;  2    cursor test_csr is&lt;br /&gt;  3      select t1.*, user_agg_function(to_char(l)) c1&lt;br /&gt;  4        from (select level l from dual connect by level&lt;=30001) t1&lt;br /&gt;  5       group by t1.l;&lt;br /&gt;  6    type test_tbl_type is table of test_csr%rowtype;&lt;br /&gt;  7    v_test_tbl test_tbl_type;&lt;br /&gt;  8  begin&lt;br /&gt;  9    open test_csr;&lt;br /&gt; 10&lt;br /&gt; 11    dbms_output.put_line(systimestamp||' After open');&lt;br /&gt; 12&lt;br /&gt; 13    for i in 1..6&lt;br /&gt; 14    loop&lt;br /&gt; 15      fetch test_csr bulk collect into v_test_tbl limit 5000;&lt;br /&gt; 16      dbms_output.put_line(systimestamp||' After fetch');&lt;br /&gt; 17    end loop;&lt;br /&gt; 18&lt;br /&gt; 19    dbms_output.put_line(systimestamp||' After all fetches');&lt;br /&gt; 20&lt;br /&gt; 21    close test_csr;&lt;br /&gt; 22    dbms_output.put_line(systimestamp||' After close');&lt;br /&gt; 23  end;&lt;br /&gt; 24  /&lt;br /&gt;30-JUL-19 09.51.59.629103000 PM +01:00 After open&lt;br /&gt;30-JUL-19 09.51.59.809768000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 09.51.59.916143000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 09.52.00.016790000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 09.52.00.116655000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 09.52.00.217287000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 09.52.00.317115000 PM +01:00 After fetch&lt;br /&gt;30-JUL-19 09.52.00.317137000 PM +01:00 After all fetches&lt;br /&gt;30-JUL-19 09.52.00.324701000 PM +01:00 After close&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;Elapsed: 00:00:00.70&lt;br /&gt;&lt;/pre&gt;There is difference how those memory allocations are made in 12.2 and 19c: &lt;pre class="brush:sql"&gt;[oracle@db-122 trace]$ grep 'PGA memory operation' orcl_ora_3519.trc | grep -v p1=0 | awk '{print $8}' | sort | uniq -c&lt;br /&gt;      4 p1=131072&lt;br /&gt;   4910 p1=65536&lt;br /&gt;&lt;br /&gt;[oracle@db-19-siha trace]$ grep 'PGA memory operation' orcl_ora_15055.trc | grep -v 'p1=0' | awk '{print $8}' | sort -t= -n -k2| uniq -c&lt;br /&gt;    165 p1=65536&lt;br /&gt;    108 p1=131072&lt;br /&gt;    100 p1=262144&lt;br /&gt;    100 p1=524288&lt;br /&gt;    100 p1=1048576&lt;br /&gt;    100 p1=2097152&lt;br /&gt;     52 p1=4194304&lt;br /&gt;     50 p1=8388608&lt;br /&gt;     14 p1=16777216&lt;br /&gt;&lt;/pre&gt;12.2 uses 64K allocations whereas 19c seems to be allocating 150 64K allocations, 100/128K, 100/256K, 100/512K, 100/1M, 100, 2M, 50/4M, 50/8M, X/16M. There is an obvious pattern in those allocations in 19c - they are just doubling in size. Still, even with those allocations I expected to see some slowdowns in 19c, however, I have not found any. I guess that some memory management code has been redone in 19c because both 12.2 and 19c were provisioned in my home lab from the same Virtual Box machine image. &lt;br/&gt;&lt;br/&gt;&lt;h3&gt;Update Apr 2020&lt;/h3&gt;&lt;br/&gt;A service request which I raised for that issue finally has led to an officially published bug:&lt;br/&gt; &lt;a href="https://support.oracle.com/rs?type=bug&amp;id=30213404"&gt;Bug 30213404 : CLOSE OF CURSORS IS VERY SLOW WITH LARGE PGA ALLOCATIONS&lt;/a&gt;. &lt;br/&gt;I got it in this morning's My Oracle Support Hot Topics E-Mail.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/8650676224511024835/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/07/session-spending-its-time-incursorclose.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8650676224511024835'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8650676224511024835'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/07/session-spending-its-time-incursorclose.html' title='Session spending its time IN_CURSOR_CLOSE'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-5927580525849202312</id><published>2019-07-21T18:03:00.000+06:00</published><updated>2019-07-21T18:03:00.901+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='re'/><title type='text'>v$db_pipes: Unveiling the Truth of Oracle Hash Value</title><content type='html'>A question about optimizing access to &lt;b&gt;&lt;i&gt;v$db_pipes&lt;/i&gt;&lt;/b&gt; just came up recently on &lt;a href="https://www.sql.ru/forum/actualutils.aspx?action=gotomsg&amp;tid=1314456&amp;msg=21921329"&gt;the SQL.RU Oracle database forum&lt;/a&gt;. The Topic Starter wanted to find out if there is a way to speed up the query against &lt;b&gt;&lt;i&gt;v$db_pipes&lt;/i&gt;&lt;/b&gt; or there are any other options to see if a named pipe exists.&lt;br /&gt;So here is the query that was run and its plan:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[19]"&gt;SQL&gt; explain plan for&lt;br /&gt;  2  select count(*)&lt;br /&gt;  3    from v$db_pipes&lt;br /&gt;  4   where name = 'MY_PIPE';&lt;br /&gt;&lt;br /&gt;Explained.&lt;br /&gt;&lt;br /&gt;SQL&gt; select * from table(dbms_xplan.display);&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 2656999297&lt;br /&gt;&lt;br /&gt;-----------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation         | Name    | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;-----------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT  |         |     1 |   148 |     1 (100)| 00:00:01 |&lt;br /&gt;|   1 |  SORT AGGREGATE   |         |     1 |   148 |            |          |&lt;br /&gt;|*  2 |   FIXED TABLE FULL| X$KGLOB |     1 |   148 |     1 (100)| 00:00:01 |&lt;br /&gt;-----------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   2 - filter("KGLNAOBJ"='MY_PIPE' AND "KGLHDNSP"=7 AND "KGLOBSTA"&lt;&gt;0&lt;br /&gt;              AND "INST_ID"=USERENV('INSTANCE'))&lt;br /&gt;&lt;/pre&gt;It is seen that &lt;b&gt;&lt;i&gt;v$db_pipes&lt;/i&gt;&lt;/b&gt; is built on top of &lt;b&gt;&lt;i&gt;x$kglob&lt;/i&gt;&lt;/b&gt;, which is a fixed table.&lt;br /&gt;Obviously, doing a &lt;tt&gt;FULL TABLE SCAN&lt;/tt&gt; against it is not the best thing to do, especially when we work with a large enough shared pool.&lt;br /&gt;Fixed tables can have Oracle provided indexes and &lt;b&gt;&lt;i&gt;x$kglob&lt;/i&gt;&lt;/b&gt; has the following ones:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; select index_number, column_name from v$indexed_fixed_column where table_name='X$KGLOB';&lt;br /&gt;&lt;br /&gt;INDEX_NUMBER COLUMN_NAME&lt;br /&gt;------------ ------------&lt;br /&gt;           1 KGLNAHSH&lt;br /&gt;           2 KGLOBT03&lt;br /&gt;&lt;/pre&gt;&lt;tt&gt;KGLOBT03&lt;/tt&gt; is not populated for pipes and it stores the &lt;tt&gt;SQL_ID&lt;/tt&gt; of a statement being executed.&lt;br /&gt;&lt;tt&gt;KGLNAHSH&lt;/tt&gt; is a hash value and it seems to store last 4 bytes of &lt;tt&gt;KGLNAHSV&lt;/tt&gt; which is a full hash value:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; select kglnaobj, kglnahsv, kglnahsh, to_char(kglnahsh, 'fm0xxxxxxx') hex_hash, kglhdnsp from x$kglob where kglnaobj in ('MY_PIPE',  'MY_PIPE1', 'MY_PIPE2');&lt;br /&gt;&lt;br /&gt;KGLNAOBJ                       KGLNAHSV                           KGLNAHSH HEX_HASH    KGLHDNSP&lt;br /&gt;------------------------------ -------------------------------- ---------- --------- ----------&lt;br /&gt;MY_PIPE2                       53e58fa645a35847070108600b3043ce  187712462 0b3043ce           7&lt;br /&gt;MY_PIPE1                       1bb0749b381c19f0dd4d47413a125cc1  974281921 3a125cc1           7&lt;br /&gt;MY_PIPE                        cdff652a7449f169da313e5685b962d8 2243519192 85b962d8           7&lt;br /&gt;&lt;/pre&gt;If I knew a way to calculate the hash value upfront, then I could query &lt;b&gt;&lt;i&gt;x$kglob&lt;/i&gt;&lt;/b&gt; passing the hash value as a filter to get an indexed access path:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[8,24]"&gt;SQL&gt; explain plan for&lt;br /&gt;  2  select count(*)&lt;br /&gt;  3    from x$kglob&lt;br /&gt;  4   where kglnaobj = 'MY_PIPE'&lt;br /&gt;  5     and kglhdnsp = 7&lt;br /&gt;  6     and kglobsta &lt;&gt; 0&lt;br /&gt;  7     and inst_id = userenv('instance')&lt;br /&gt;  8     and kglnahsh = 2243519192;&lt;br /&gt;&lt;br /&gt;Explained.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from table(dbms_xplan.display);&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;----------------------------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 2109255596&lt;br /&gt;&lt;br /&gt;--------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                | Name            | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;--------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT         |                 |     1 |   155 |     0   (0)| 00:00:01 |&lt;br /&gt;|   1 |  SORT AGGREGATE          |                 |     1 |   155 |            |          |&lt;br /&gt;|*  2 |   FIXED TABLE FIXED INDEX| X$KGLOB (ind:1) |     1 |   155 |     0   (0)| 00:00:01 |&lt;br /&gt;--------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;----------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;   2 - filter("KGLNAHSH"=2243519192 AND "KGLNAOBJ"='MY_PIPE' AND "KGLHDNSP"=7 AND&lt;br /&gt;              "KGLOBSTA"&lt;&gt;0 AND "INST_ID"=USERENV('INSTANCE'))&lt;br /&gt;&lt;/pre&gt;I decided to try to find out how the hash value is calculated.&lt;br /&gt;Firstly, I took the library cache dump:&lt;br /&gt;&lt;pre class="brush:sql"&gt;Bucket: #=90840 Mutex=0x6cb2aa60(283467841536, 2, 0, 6)&lt;br /&gt;  LibraryHandle:  Address=0x654cc068 Hash=85b962d8 LockMode=0 PinMode=0 LoadLockMode=0 Status=VALD&lt;br /&gt;    ObjectName:  Name=CDB$ROOT.MY_PIPE&lt;br /&gt;      FullHashValue=cdff652a7449f169da313e5685b962d8 Namespace=PIPE(07) Type=PIPE(18) ContainerId=1 ContainerUid=1 Identifier=0 OwnerIdn=2147483644&lt;br /&gt;    Statistics:  InvalidationCount=0 ExecutionCount=0 LoadCount=1 ActiveLocks=0 TotalLockCount=1 TotalPinCount=1&lt;br /&gt;    Counters:  BrokenCount=1 RevocablePointer=1 KeepDependency=0 Version=0 BucketInUse=0 HandleInUse=0 HandleReferenceCount=0&lt;br /&gt;    Concurrency:  DependencyMutex=0x654cc118(0, 0, 0, 0) Mutex=0x654cc1b8(66, 8, 0, 6)&lt;br /&gt;    Flags=RON/PN0/[10012001] Flags2=[0000]&lt;br /&gt;    WaitersLists:&lt;br /&gt;      Lock=0x654cc0f8[0x654cc0f8,0x654cc0f8]&lt;br /&gt;      Pin=0x654cc0d8[0x654cc0d8,0x654cc0d8]&lt;br /&gt;      LoadLock=0x654cc150[0x654cc150,0x654cc150]&lt;br /&gt;    Timestamp:&lt;br /&gt;    LibraryObject:  Address=0x65f9cb98 HeapMask=0000-0001-0001-0000 Flags=EXS/NRC[0400] Flags2=[0000] Flags3=[0000] PublicFlags=[0000]&lt;br /&gt;&lt;/pre&gt;Based on my knowledge of Oracle internals, I supposed that the hash value should be somehow derived from the name of the object and possibly other attributes of it.&lt;br /&gt;Unfortunately, I was not able to find a proper formula looking into the library cache dump (I was close, in fact, as I was combined the object name with the namespace, however, a proper formula is hard or even near to impossible to come by).&lt;br /&gt;When my first attempts to solve this conundrum failed miserably, I took a break and returned to that task later on.&lt;br /&gt;&lt;br /&gt;That time I took more systematic approach and started by unwrapping the &lt;b&gt;&lt;i&gt;DBMS_PIPE&lt;/i&gt;&lt;/b&gt; package. I found out that the &lt;b&gt;&lt;i&gt;DBMS_PIPE.CREATE_PIPE&lt;/i&gt;&lt;/b&gt; function calls the &lt;b&gt;&lt;i&gt;CREATEPIPE &lt;/i&gt;&lt;/b&gt; function that has a widely used &lt;b&gt;&lt;i&gt;INTERFACE&lt;/i&gt;&lt;/b&gt; pragma, which roughly means that the function is mapped to another C function within the Oracle kernel. The function to which &lt;b&gt;&lt;i&gt;CREATEPIPE&lt;/i&gt;&lt;/b&gt; should be mapped should probably be called &lt;b&gt;&lt;i&gt;kkxpcre&lt;/i&gt;&lt;/b&gt; based on &lt;a href="https://yurichev.com/blog/50/"&gt;the excellent Dennis Yurichev blog post&lt;/a&gt; (of course, Dennis' post was written a while ago but Oracle has not given much attention to pipes for a while and I seriously doubt that they have changed that mapping since then). All of this knowledge appears to be useless at a glance, however, it laid the groundwork for the next step.&lt;br /&gt;&lt;br /&gt;The next step of my research started when I was using the DebugTrace program from &lt;a href="https://software.intel.com/en-us/articles/pin-a-dynamic-binary-instrumentation-tool"&gt;Intel Pintools&lt;/a&gt;. I ran DebugTrace against the server process in which I created a new pipe named &lt;tt&gt;MY_PIPE&lt;/tt&gt; that has the hash value 2243519192 which is &lt;b&gt;&lt;i&gt;0x85b962d8&lt;/b&gt;&lt;/i&gt; in hex.&lt;br /&gt;Here is the relevant output of DebugTrace which I reformatted for brevity (this is the output that I obtained from Oracle 19c, I also got a 12.2 output initially that had a few minor differencies):&lt;br /&gt;&lt;pre class="brush:sql;highlight:[46]"&gt;Call 0x000000000f7775db $ORACLE_HOME/bin/oracle:kkxpcre+0x0000000002db -&gt; 0x000000000b032100 $ORACLE_HOME/bin/oracle:kkxpcrep(0x7f0fd3e6fe80, 0x7, ...)&lt;br /&gt;| Call 0x000000000b03225b $ORACLE_HOME/bin/oracle:kkxpcrep+0x00000000015b -&gt; 0x000000001280c720 $ORACLE_HOME/bin/oracle:kglget(0x7f0fd3f889a0, 0x7fff3aea4d50, ...)&lt;br /&gt;| | Call 0x000000001280c844 $ORACLE_HOME/bin/oracle:kglget+0x000000000124 -&gt; 0x00000000128119f0 $ORACLE_HOME/bin/oracle:kglLock(0x7f0fd3f889a0, 0x7fff3aea4d50, ...)&lt;br /&gt;| | | Call 0x0000000012811b4b $ORACLE_HOME/bin/oracle:kglLock+0x00000000015b -&gt; 0x0000000012815280 $ORACLE_HOME/bin/oracle:kglComputeHash(0x7f0fd3f889a0, 0x7fff3aea4dd0, ...)&lt;br /&gt;| | | Tailcall 0x000000001281528d $ORACLE_HOME/bin/oracle:kglComputeHash+0x00000000000d -&gt; 0x00000000128152b0 $ORACLE_HOME/bin/oracle:kglComputeHash0(0x7f0fd3f889a0, 0x7fff3aea4dd0, ...)&lt;br /&gt;| | | | Call 0x0000000012815399 $ORACLE_HOME/bin/oracle:kglComputeHash0+0x0000000000e9 -&gt; 0x00000000127dca20 $ORACLE_HOME/bin/oracle:kggmd5Update(0x7fff3aea4580, 0x7f0fd3e6fe80, ...)&lt;br /&gt;| | | | | Call 0x00000000127dcad5 $ORACLE_HOME/bin/oracle:kggmd5Update+0x0000000000b5 -&gt; 0x0000000006b74060 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy(0x7fff3aea4588, 0x7f0fd3e6fe80, ...)&lt;br /&gt;| | | | | Tailcall 0x0000000006b740bc $ORACLE_HOME/bin/oracle:_intel_fast_memcpy+0x00000000005c -&gt; 0x0000000006b74030 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy.P(0x7fff3aea4588, 0x7f0fd3e6fe80, ...)&lt;br /&gt;| | | | | Tailcall 0x0000000006b74030 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy.P -&gt; 0x0000000006b814e0 $ORACLE_HOME/bin/oracle:__intel_ssse3_rep_memcpy(0x7fff3aea4588, 0x7f0fd3e6fe80, ...)&lt;br /&gt;| | | | | Return 0x0000000006b83cfa $ORACLE_HOME/bin/oracle:__intel_ssse3_rep_memcpy+0x00000000281a returns: 0x7fff3aea4588&lt;br /&gt;| | | | Return 0x00000000127dcae8 $ORACLE_HOME/bin/oracle:kggmd5Update+0x0000000000c8 returns: 0x7fff3aea4588&lt;br /&gt;| | | | Call 0x000000001281545e $ORACLE_HOME/bin/oracle:kglComputeHash0+0x0000000001ae -&gt; 0x00000000127dca20 $ORACLE_HOME/bin/oracle:kggmd5Update(0x7fff3aea4580, 0x12976914, ...)&lt;br /&gt;| | | | | Call 0x00000000127dcad5 $ORACLE_HOME/bin/oracle:kggmd5Update+0x0000000000b5 -&gt; 0x0000000006b74060 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy(0x7fff3aea458f, 0x12976914, ...)&lt;br /&gt;| | | | | Tailcall 0x0000000006b740bc $ORACLE_HOME/bin/oracle:_intel_fast_memcpy+0x00000000005c -&gt; 0x0000000006b74030 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy.P(0x7fff3aea458f, 0x12976914, ...)&lt;br /&gt;| | | | | Tailcall 0x0000000006b74030 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy.P -&gt; 0x0000000006b814e0 $ORACLE_HOME/bin/oracle:__intel_ssse3_rep_memcpy(0x7fff3aea458f, 0x12976914, ...)&lt;br /&gt;| | | | | Return 0x0000000006b83f95 $ORACLE_HOME/bin/oracle:__intel_ssse3_rep_memcpy+0x000000002ab5 returns: 0x7fff3aea458f&lt;br /&gt;| | | | Return 0x00000000127dcae8 $ORACLE_HOME/bin/oracle:kggmd5Update+0x0000000000c8 returns: 0x7fff3aea458f&lt;br /&gt;| | | | Call 0x000000001281546f $ORACLE_HOME/bin/oracle:kglComputeHash0+0x0000000001bf -&gt; 0x00000000127dca20 $ORACLE_HOME/bin/oracle:kggmd5Update(0x7fff3aea4580, 0x7580764c, ...)&lt;br /&gt;| | | | | Call 0x00000000127dcad5 $ORACLE_HOME/bin/oracle:kggmd5Update+0x0000000000b5 -&gt; 0x0000000006b74060 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy(0x7fff3aea4590, 0x7580764c, ...)&lt;br /&gt;| | | | | Tailcall 0x0000000006b740bc $ORACLE_HOME/bin/oracle:_intel_fast_memcpy+0x00000000005c -&gt; 0x0000000006b74030 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy.P(0x7fff3aea4590, 0x7580764c, ...)&lt;br /&gt;| | | | | Tailcall 0x0000000006b74030 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy.P -&gt; 0x0000000006b814e0 $ORACLE_HOME/bin/oracle:__intel_ssse3_rep_memcpy(0x7fff3aea4590, 0x7580764c, ...)&lt;br /&gt;| | | | | Return 0x0000000006b83c86 $ORACLE_HOME/bin/oracle:__intel_ssse3_rep_memcpy+0x0000000027a6 returns: 0x7fff3aea4590&lt;br /&gt;| | | | Return 0x00000000127dcae8 $ORACLE_HOME/bin/oracle:kggmd5Update+0x0000000000c8 returns: 0x7fff3aea4590&lt;br /&gt;| | | | Call 0x0000000012815415 $ORACLE_HOME/bin/oracle:kglComputeHash0+0x000000000165 -&gt; 0x00000000127dca20 $ORACLE_HOME/bin/oracle:kggmd5Update(0x7fff3aea4580, 0x7fff3aea45f0, ...)&lt;br /&gt;| | | | | Call 0x00000000127dcad5 $ORACLE_HOME/bin/oracle:kggmd5Update+0x0000000000b5 -&gt; 0x0000000006b74060 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy(0x7fff3aea4598, 0x7fff3aea45f0, ...)&lt;br /&gt;| | | | | Tailcall 0x0000000006b740bc $ORACLE_HOME/bin/oracle:_intel_fast_memcpy+0x00000000005c -&gt; 0x0000000006b74030 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy.P(0x7fff3aea4598, 0x7fff3aea45f0, ...)&lt;br /&gt;| | | | | Tailcall 0x0000000006b74030 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy.P -&gt; 0x0000000006b814e0 $ORACLE_HOME/bin/oracle:__intel_ssse3_rep_memcpy(0x7fff3aea4598, 0x7fff3aea45f0, ...)&lt;br /&gt;| | | | | Return 0x0000000006b83726 $ORACLE_HOME/bin/oracle:__intel_ssse3_rep_memcpy+0x000000002246 returns: 0x7fff3aea4598&lt;br /&gt;| | | | Return 0x00000000127dcae8 $ORACLE_HOME/bin/oracle:kggmd5Update+0x0000000000c8 returns: 0x7fff3aea4598&lt;br /&gt;| | | | Call 0x0000000012815423 $ORACLE_HOME/bin/oracle:kglComputeHash0+0x000000000173 -&gt; 0x00000000127dc8b0 $ORACLE_HOME/bin/oracle:kggmd5Finish(0x7fff3aea4580, 0, ...)&lt;br /&gt;| | | | | Call 0x00000000127dc927 $ORACLE_HOME/bin/oracle:kggmd5Finish+0x000000000077 -&gt; 0x00000000127dca20 $ORACLE_HOME/bin/oracle:kggmd5Update(0x7fff3aea4580, 0x14aa6460, ...)&lt;br /&gt;| | | | | | Call 0x00000000127dcad5 $ORACLE_HOME/bin/oracle:kggmd5Update+0x0000000000b5 -&gt; 0x0000000006b74060 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy(0x7fff3aea459c, 0x14aa6460, ...)&lt;br /&gt;| | | | | | Tailcall 0x0000000006b740bc $ORACLE_HOME/bin/oracle:_intel_fast_memcpy+0x00000000005c -&gt; 0x0000000006b74030 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy.P(0x7fff3aea459c, 0x14aa6460, ...)&lt;br /&gt;| | | | | | Tailcall 0x0000000006b74030 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy.P -&gt; 0x0000000006b814e0 $ORACLE_HOME/bin/oracle:__intel_ssse3_rep_memcpy(0x7fff3aea459c, 0x14aa6460, ...)&lt;br /&gt;| | | | | | Return 0x0000000006b83e38 $ORACLE_HOME/bin/oracle:__intel_ssse3_rep_memcpy+0x000000002958 returns: 0x7fff3aea459c&lt;br /&gt;| | | | | Return 0x00000000127dcae8 $ORACLE_HOME/bin/oracle:kggmd5Update+0x0000000000c8 returns: 0x7fff3aea459c&lt;br /&gt;| | | | | Call 0x00000000127dc938 $ORACLE_HOME/bin/oracle:kggmd5Finish+0x000000000088 -&gt; 0x00000000127dca20 $ORACLE_HOME/bin/oracle:kggmd5Update(0x7fff3aea4580, 0x7fff3aea4550, ...)&lt;br /&gt;| | | | | | Call 0x00000000127dcaa4 $ORACLE_HOME/bin/oracle:kggmd5Update+0x000000000084 -&gt; 0x0000000006b74060 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy(0x7fff3aea45c0, 0x7fff3aea4550, ...)&lt;br /&gt;| | | | | | Tailcall 0x0000000006b740bc $ORACLE_HOME/bin/oracle:_intel_fast_memcpy+0x00000000005c -&gt; 0x0000000006b74030 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy.P(0x7fff3aea45c0, 0x7fff3aea4550, ...)&lt;br /&gt;| | | | | | Tailcall 0x0000000006b74030 $ORACLE_HOME/bin/oracle:_intel_fast_memcpy.P -&gt; 0x0000000006b814e0 $ORACLE_HOME/bin/oracle:__intel_ssse3_rep_memcpy(0x7fff3aea45c0, 0x7fff3aea4550, ...)&lt;br /&gt;| | | | | | Return 0x0000000006b83c86 $ORACLE_HOME/bin/oracle:__intel_ssse3_rep_memcpy+0x0000000027a6 returns: 0x7fff3aea45c0&lt;br /&gt;| | | | | | Call 0x00000000127dcab1 $ORACLE_HOME/bin/oracle:kggmd5Update+0x000000000091 -&gt; 0x00000000127dcba0 $ORACLE_HOME/bin/oracle:kggmd5Process(0x7fff3aea4a70, 0x7fff3aea4588, ...)&lt;br /&gt;| | | | | | Return 0x00000000127dd68d $ORACLE_HOME/bin/oracle:kggmd5Process+0x000000000aed returns: 0x66ba4229&lt;br /&gt;| | | | | Return 0x00000000127dcae8 $ORACLE_HOME/bin/oracle:kggmd5Update+0x0000000000c8 returns: 0x66ba4229&lt;br /&gt;| | | | Return 0x00000000127dc94a $ORACLE_HOME/bin/oracle:kggmd5Finish+0x00000000009a returns: 0x66ba4229&lt;br /&gt;| | | Return 0x000000001281543b $ORACLE_HOME/bin/oracle:kglComputeHash0+0x00000000018b returns: 0x85b962d8&lt;br /&gt;&lt;/pre&gt;There are several important observations that can be made about this output:&lt;br /&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;kkxpcre&lt;/i&gt;&lt;/b&gt; is a C function mapped to dbms_pipe.createpipe through the INTERFACE pragma which is called by dbms_pipe.create_pipe, which is the only function exposed to the public&lt;/li&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;kglComputeHash0&lt;/b&gt;&lt;/i&gt; returns that hash value &lt;b&gt;&lt;i&gt;0x85b962d8&lt;/i&gt;&lt;/b&gt; that I am looking for, hence I need to look carefully at what is going on between &lt;b&gt;&lt;i&gt;kkxpcre&lt;/i&gt;&lt;/b&gt; and &lt;b&gt;&lt;i&gt;kglComputeHash0&lt;/i&gt;&lt;/b&gt; as the hash value is somewhere between&lt;/li&gt;&lt;li&gt;The call stack is: &lt;b&gt;&lt;i&gt;kkxpcre&lt;/i&gt;&lt;/b&gt;-&amp;gt;&lt;b&gt;&lt;i&gt;kkxpcrep&lt;/i&gt;&lt;/b&gt;-&amp;gt;&lt;b&gt;&lt;i&gt;kglget&lt;/i&gt;&lt;/b&gt;-&amp;gt;&lt;b&gt;&lt;i&gt;kglLock&lt;/i&gt;&lt;/b&gt;-&amp;gt;&lt;b&gt;&lt;i&gt;kglComputeHash&lt;/i&gt;&lt;/b&gt;-&amp;gt;&lt;b&gt;&lt;i&gt;kglComputeHash0&lt;/i&gt;&lt;/b&gt;, the latter calls &lt;b&gt;&lt;i&gt;kggmdUpdate&lt;/i&gt;&lt;/b&gt; multiple times, then it calls &lt;b&gt;&lt;i&gt;kggmd5Finish&lt;/i&gt;&lt;/b&gt;, which calls &lt;b&gt;&lt;i&gt;kggmd5Update&lt;/i&gt;&lt;/b&gt; twice. The last call to &lt;b&gt;&lt;i&gt;kggmd5Update&lt;/i&gt;&lt;/b&gt; also invokes &lt;b&gt;&lt;i&gt;kggmd5Process&lt;/i&gt;&lt;/b&gt;. In terms of Oracle code layers, the code can be split in the following ones: &lt;br /&gt;&lt;b&gt;&lt;i&gt;KKX&lt;/i&gt;&lt;/b&gt;(Programmatic interfaces to/from PL/SQL)-&amp;gt;&lt;b&gt;&lt;i&gt;KGL&lt;/i&gt;&lt;/b&gt;(Library Cache)-&amp;gt;&lt;b&gt;&lt;i&gt;KGG&lt;/i&gt;&lt;/b&gt;(Generic Routines)&lt;/li&gt;&lt;li&gt;Based on the fact that we call MD5 functions, the underlying alrorithm is used MD5 somehow.&lt;/li&gt;&lt;/ul&gt;I have also disassembled &lt;b&gt;&lt;i&gt;kglComputeHash0&lt;/i&gt;&lt;/b&gt; to find out how exactly &lt;b&gt;&lt;i&gt;kggmd5Update&lt;/i&gt;&lt;/b&gt; functions are called (this is the first call):&lt;br /&gt;&lt;pre class="brush:sql;highlight:[2,4,6,8]"&gt;   0x0000000012815365 &lt;+181&gt;:   mov    %rax,-0x58(%rbp)&lt;br /&gt;   0x0000000012815369 &lt;+185&gt;:   movl   $0x67452301,(%rax)&lt;br /&gt;   0x000000001281536f &lt;+191&gt;:   mov    -0x58(%rbp),%rcx&lt;br /&gt;   0x0000000012815373 &lt;+195&gt;:   movl   $0xefcdab89,0x4(%rcx)&lt;br /&gt;   0x000000001281537a &lt;+202&gt;:   mov    -0x58(%rbp),%r8&lt;br /&gt;   0x000000001281537e &lt;+206&gt;:   movl   $0x98badcfe,0x8(%r8)&lt;br /&gt;   0x0000000012815386 &lt;+214&gt;:   mov    -0x58(%rbp),%r9&lt;br /&gt;   0x000000001281538a &lt;+218&gt;:   movl   $0x10325476,0xc(%r9)&lt;br /&gt;   0x0000000012815392 &lt;+226&gt;:   mov    0x10(%r14),%rsi&lt;br /&gt;   0x0000000012815396 &lt;+230&gt;:   mov    (%r14),%edx&lt;br /&gt;   0x0000000012815399 &lt;+233&gt;:   callq  0x127dca20 &amp;lt;kggmd5Update&gt;&lt;br /&gt;&lt;/pre&gt;All of those constants: 0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476 - are &lt;a href="https://tools.ietf.org/html/rfc1321"&gt;magic initialization constants&lt;/a&gt; in the MD5 algorithm.&lt;br /&gt;&lt;br /&gt;Since the algorithm is known, in order to calculate a hash value, I need to know the input values to the MD5 functions.&lt;br /&gt;Thus, I setup a few breakpoints in &lt;a href="https://www.gnu.org/s/gdb/"&gt;GDB&lt;/a&gt; and spent a while reviewing the register values.&lt;br /&gt;Finally, I came up with the following GDB breakpoints:&lt;br /&gt;&lt;pre class="brush:sql"&gt;set pagination off&lt;br /&gt;&lt;br /&gt;break kggmd5Update&lt;br /&gt;  commands&lt;br /&gt;    printf "Length: %d\n",$rdx&lt;br /&gt;    x/8xc $rsi&lt;br /&gt;    c&lt;br /&gt;  end&lt;br /&gt;&lt;br /&gt;break kglComputeHash&lt;br /&gt;  commands&lt;br /&gt;    c&lt;br /&gt;  end&lt;br /&gt;&lt;br /&gt;break kggmd5Process&lt;br /&gt;  commands&lt;br /&gt;    c&lt;br /&gt;  end&lt;br /&gt;&lt;br /&gt;break kggmd5Finish&lt;br /&gt;  commands&lt;br /&gt;    c&lt;br /&gt;  end&lt;br /&gt;&lt;/pre&gt;I attached to the server process through GDB and ran the following command in SQL*Plus:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; var n number&lt;br /&gt;SQL&gt; exec :n:=dbms_pipe.create_pipe('MY_PIPE')&lt;br /&gt;&lt;/pre&gt;The debugger output showed this (comments are inline):&lt;br /&gt;&lt;pre class="brush:sql;highlight:[5,10,15,20]"&gt;Breakpoint 5, 0x0000000012815280 in kglComputeHash ()&lt;br /&gt;&lt;br /&gt;Breakpoint 4, 0x00000000127dca20 in kggmd5Update ()&lt;br /&gt;Length: 7&lt;br /&gt;0x7f7b9304ffe0: 77 'M'  89 'Y'  95 '_'  80 'P'  73 'I'  80 'P'  69 'E'  0 '\000'&lt;br /&gt;-- MY_PIPE&lt;br /&gt;&lt;br /&gt;Breakpoint 4, 0x00000000127dca20 in kggmd5Update ()&lt;br /&gt;Length: 1&lt;br /&gt;0x12976914:     46 '.'  0 '\000'        0 '\000'        0 '\000'        113 'q' 109 'm' 120 'x' 113 'q'&lt;br /&gt;-- "." (just a dot)&lt;br /&gt;&lt;br /&gt;Breakpoint 4, 0x00000000127dca20 in kggmd5Update ()&lt;br /&gt;Length: 8&lt;br /&gt;0x7580c61c:     67 'C'  68 'D'  66 'B'  36 '$'  82 'R'  79 'O'  79 'O'  84 'T'&lt;br /&gt;-- CDB$ROOT&lt;br /&gt;&lt;br /&gt;Breakpoint 4, 0x00000000127dca20 in kggmd5Update ()&lt;br /&gt;Length: 4&lt;br /&gt;0x7ffd3203e070: 7 '\a'  0 '\000'        0 '\000'        0 '\000'        0 '\000'        0 '\000'        0 '\000'  0 '\000'&lt;br /&gt;-- 0x07000000 or chr(7)||chr(0)||chr(0)||chr(0)&lt;br /&gt;&lt;br /&gt;Breakpoint 7, 0x00000000127dc8b0 in kggmd5Finish ()&lt;br /&gt;&lt;br /&gt;Breakpoint 4, 0x00000000127dca20 in kggmd5Update ()&lt;br /&gt;Length: 36&lt;br /&gt;0x14aa6460 &amp;lt;kggmd5padding&gt;:     -128 '\200'     0 '\000'        0 '\000'        0 '\000'        0 '\000'        0 '\000'   0 '\000'        0 '\000'&lt;br /&gt;&lt;br /&gt;Breakpoint 4, 0x00000000127dca20 in kggmd5Update ()&lt;br /&gt;Length: 8&lt;br /&gt;0x7ffd3203dfd0: -96 '\240'      0 '\000'        0 '\000'        0 '\000'        0 '\000'        0 '\000'        0 '\000'   0 '\000'&lt;br /&gt;&lt;br /&gt;Breakpoint 6, 0x00000000127dcba0 in kggmd5Process ()&lt;br /&gt;&lt;/pre&gt;Let me explain what this output means. In accordance with: &lt;a href="http://refspecs.linuxfoundation.org/elf/x86_64-abi-0.99.pdf"&gt;System V ABI AMD64&lt;/a&gt;, the function parameters passed as follows (page 21):&lt;br /&gt;&lt;ul&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;%rdi&lt;/i&gt;&lt;/b&gt; - first argument to functions&lt;/li&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;%rsi&lt;/i&gt;&lt;/b&gt; - second argument to functions&lt;/li&gt;&lt;li&gt;&lt;b&gt;&lt;i&gt;%rdx&lt;/i&gt;&lt;/b&gt; - third argument to functions&lt;/li&gt;&lt;/ul&gt;While I was looking at those registers, I produced a hypothesis that &lt;b&gt;&lt;i&gt;kggmd5Update&lt;/i&gt;&lt;/b&gt; has the signature similar to the one mentioned in &lt;a href="https://tools.ietf.org/html/rfc1321"&gt;RFC-1321: The MD5 Message-Digest Algorithm&lt;/a&gt;:&lt;br /&gt;&lt;pre class="brush:sql"&gt;/* MD5 block update operation. Continues an MD5 message-digest&lt;br /&gt;  operation, processing another message block, and updating the&lt;br /&gt;  context.&lt;br /&gt; */&lt;br /&gt;void MD5Update (context, input, inputLen)&lt;br /&gt;MD5_CTX *context;                                        /* context */&lt;br /&gt;unsigned char *input;                                /* input block */&lt;br /&gt;unsigned int inputLen;                     /* length of input block */&lt;br /&gt;&lt;/pre&gt;As such, I was not really interested in the context variable - it holds the address of the context structure.&lt;br /&gt;The second and third parameters, though, should hold the input string and its length, that is what I was getting in my GDB breakpoint (remember, that &lt;b&gt;&lt;i&gt;rsi&lt;/i&gt;&lt;/b&gt; and &lt;b&gt;&lt;i&gt;rdx&lt;/i&gt;&lt;/b&gt; are second and third parameters correspondingly):&lt;br /&gt;&lt;pre class="brush:sql"&gt;break kggmd5Update&lt;br /&gt;  commands&lt;br /&gt;    printf "Length: %d\n",$rdx&lt;br /&gt;    x/8xc $rsi&lt;br /&gt;    c&lt;br /&gt;  end&lt;br /&gt;&lt;/pre&gt;First three calls in the GDB output are self-explanatory: it is a string 'MY_PIPE.CDB$ROOT'. The last call requires a bit of explanation, though: what is &lt;b&gt;&lt;i&gt;0x07000000&lt;/i&gt;&lt;/b&gt;? It seems to be the namespace, which is 7 for pipes (&lt;b&gt;&lt;i&gt;X$KGLOB.KGLHDNSP&lt;/i&gt;&lt;/b&gt;), with 3 trailing zero bytes.&lt;br /&gt;I calculated MD5 hashes based on that formula and got this:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; select dbms_crypto.hash(rawtohex('MY_PIPE1.CDB$ROOT'||chr(7)||chr(0)||chr(0)||chr(0)), 2) md5 from dual;&lt;br /&gt;&lt;br /&gt;MD5&lt;br /&gt;--------------------------------&lt;br /&gt;9B74B01BF0191C3841474DDDC15C123A&lt;br /&gt;&lt;br /&gt;SQL&gt; select dbms_crypto.hash(rawtohex('MY_PIPE2.CDB$ROOT'||chr(7)||chr(0)||chr(0)||chr(0)), 2) md5 from dual;&lt;br /&gt;&lt;br /&gt;MD5&lt;br /&gt;--------------------------------&lt;br /&gt;A68FE5534758A34560080107CE43300B&lt;br /&gt;&lt;br /&gt;SQL&gt; select dbms_crypto.hash(rawtohex('MY_PIPE.CDB$ROOT'||chr(7)||chr(0)||chr(0)||chr(0)), 2) md5 from dual;&lt;br /&gt;&lt;br /&gt;MD5&lt;br /&gt;--------------------------------&lt;br /&gt;2A65FFCD69F14974563E31DAD862B985&lt;br /&gt;&lt;/pre&gt;Whereas the actual hashes were these:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; select kglnaobj, kglnahsv, kglnahsh, to_char(kglnahsh, 'fm0xxxxxxx') hex_hash, kglhdnsp from x$kglob where kglnaobj in ('MY_PIPE',  'MY_PIPE1', 'MY_PIPE2');&lt;br /&gt;&lt;br /&gt;KGLNAOBJ                       KGLNAHSV                           KGLNAHSH HEX_HASH    KGLHDNSP&lt;br /&gt;------------------------------ -------------------------------- ---------- --------- ----------&lt;br /&gt;MY_PIPE2                       53e58fa645a35847070108600b3043ce  187712462 0b3043ce           7&lt;br /&gt;MY_PIPE1                       1bb0749b381c19f0dd4d47413a125cc1  974281921 3a125cc1           7&lt;br /&gt;MY_PIPE                        cdff652a7449f169da313e5685b962d8 2243519192 85b962d8           7&lt;br /&gt;&lt;/pre&gt;Then it dawned on me that Oracle uses the same technique for these hashes as it uses for SQL_ID: &lt;a href="https://carlos-sierra.net/2013/09/12/function-to-compute-sql_id-out-of-sql_text/"&gt;Function to compute SQL_ID out of SQL_TEXT&lt;/a&gt; - it reverses the order of each 4 bytes. Look:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[20,21,22]"&gt;SQL&gt; with pipes(pipe_name) as (&lt;br /&gt;  2    select 'MY_PIPE' from dual union all&lt;br /&gt;  3    select 'MY_PIPE1' from dual union all&lt;br /&gt;  4    select 'MY_PIPE2' from dual&lt;br /&gt;  5  )&lt;br /&gt;  6  select pipe_name,&lt;br /&gt;  7         utl_raw.concat(&lt;br /&gt;  8           utl_raw.reverse(utl_raw.substr(hv, 1, 4)),&lt;br /&gt;  9           utl_raw.reverse(utl_raw.substr(hv, 5, 4)),&lt;br /&gt; 10           utl_raw.reverse(utl_raw.substr(hv, 9, 4)),&lt;br /&gt; 11           utl_raw.reverse(utl_raw.substr(hv, 13, 4))&lt;br /&gt; 12         ) ora_hash_value&lt;br /&gt; 13    from (select pipe_name,&lt;br /&gt; 14                 dbms_crypto.hash(rawtohex(pipe_name||'.CDB$ROOT'||chr(7)||chr(0)||chr(0)||chr(0)), 2) hv&lt;br /&gt; 15            from pipes)&lt;br /&gt; 16   order by pipe_name;&lt;br /&gt;&lt;br /&gt;PIPE_NAM ORA_HASH_VALUE&lt;br /&gt;-------- --------------------------------&lt;br /&gt;MY_PIPE  CDFF652A7449F169DA313E5685B962D8&lt;br /&gt;MY_PIPE1 1BB0749B381C19F0DD4D47413A125CC1&lt;br /&gt;MY_PIPE2 53E58FA645A35847070108600B3043CE&lt;br /&gt;&lt;/pre&gt;These are exactly the values I was looking for!&lt;br /&gt;&lt;h3&gt;tl;dr&lt;/h3&gt;&lt;ul&gt;&lt;li&gt;The pipe &lt;b&gt;&lt;i&gt;full hash value&lt;/i&gt;&lt;/b&gt; can be calculated as below (where ORA_HASH_VALUE is the hash that I calculated based on the research made in this article):&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; select lower(rawtohex(utl_raw.concat(&lt;br /&gt;  2           utl_raw.reverse(utl_raw.substr(hv, 1, 4)),&lt;br /&gt;  3           utl_raw.reverse(utl_raw.substr(hv, 5, 4)),&lt;br /&gt;  4           utl_raw.reverse(utl_raw.substr(hv, 9, 4)),&lt;br /&gt;  5           utl_raw.reverse(utl_raw.substr(hv, 13, 4))&lt;br /&gt;  6         ))) ora_hash_value,&lt;br /&gt;  7         kglnahsv, kglnahsh, hex_hash, kglhdnsp, kglhdnsd, kglnacon, kglnaown, kglnaobj&lt;br /&gt;  8    from (select dbms_crypto.hash(rawtohex(kglnaobj||'.'||kglnacon||chr(kglhdnsp)||chr(0)||chr(0)||chr(0)), 2) hv,&lt;br /&gt;  9                 kglnahsv, kglnahsh, to_char(kglnahsh, 'fm0xxxxxxx') hex_hash,&lt;br /&gt; 10                 kglhdnsp, kglhdnsd, kglnacon, kglnaown, kglnaobj&lt;br /&gt; 11            from x$kglob t&lt;br /&gt; 12           where kglhdnsp = 7)&lt;br /&gt; 13   order by kglnaobj&lt;br /&gt; 14  /&lt;br /&gt;&lt;br /&gt;ORA_HASH_VALUE                   KGLNAHSV                           KGLNAHSH HEX_HASH    KGLHDNSP KGLHDNSD KGLNACON KGLNAOWN KGLNAOBJ&lt;br /&gt;-------------------------------- -------------------------------- ---------- --------- ---------- -------- -------- -------- --------&lt;br /&gt;cdff652a7449f169da313e5685b962d8 cdff652a7449f169da313e5685b962d8 2243519192 85b962d8           7 PIPE     CDB$ROOT          MY_PIPE&lt;br /&gt;1bb0749b381c19f0dd4d47413a125cc1 1bb0749b381c19f0dd4d47413a125cc1  974281921 3a125cc1           7 PIPE     CDB$ROOT          MY_PIPE1&lt;br /&gt;53e58fa645a35847070108600b3043ce 53e58fa645a35847070108600b3043ce  187712462 0b3043ce           7 PIPE     CDB$ROOT          MY_PIPE2&lt;br /&gt;&lt;/pre&gt;1. We take: "&amp;lt;PIPE_NAME&gt;.&amp;lt;CONTAINER_NAME&gt;&lt;i&gt;chr&lt;/i&gt;(7)&lt;i&gt;chr&lt;/i&gt;(0)&lt;i&gt;chr&lt;/i&gt;(0)&lt;i&gt;chr&lt;/i&gt;(0)".&lt;br /&gt;2. Compute an MD5 hash of it.&lt;br /&gt;3. Then the order of each 4 bytes is reversed and the final output is assembled.&lt;br /&gt;4. If you are interested in the numeric hash value, which is &lt;b&gt;&lt;i&gt;X$KGLOB.KGLNAHSH&lt;/i&gt;&lt;/b&gt;, you need to take last 4 bytes of &lt;b&gt;&lt;i&gt;the full hash value&lt;/i&gt;&lt;/b&gt;, which is &lt;b&gt;&lt;i&gt;X$KGLOB.KGLNAHSV&lt;/i&gt;&lt;/b&gt;.&lt;br /&gt;5. I do not consider the non-CDB architecture due to its deprecation but the general pattern should be applicable to it as well.&lt;br /&gt;&lt;/li&gt;&lt;li&gt;Due to the fact that &lt;b&gt;&lt;i&gt;v$db_pipes&lt;/i&gt;&lt;/b&gt; does not expose the hash value, it's a good idea to create an extended version of that view including the hash value, since we now know how to calculate it (legal disclaimer: that's just my opinion). After all, Oracle has provided functions to calculate the &lt;tt&gt;SQL_ID&lt;/tt&gt;. They might provide similar functions to calculate hash values one day.&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/5927580525849202312/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/07/vdbpipes-unveiling-truth-of-oracle-hash.html#comment-form' title='Комментарии: 6'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5927580525849202312'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5927580525849202312'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/07/vdbpipes-unveiling-truth-of-oracle-hash.html' title='v$db_pipes: Unveiling the Truth of Oracle Hash Value'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>6</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-1978817069960185663</id><published>2019-07-15T15:29:00.001+06:00</published><updated>2019-07-15T15:29:19.612+06:00</updated><app:control xmlns:app='http://purl.org/atom/app#'><app:draft>yes</app:draft></app:control><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='nvme'/><title type='text'>Identifying NVMe instance store volumes on Nitro-based instances</title><content type='html'>I use &lt;a href="https://docs.aws.amazon.com/en_us/AWSEC2/latest/UserGuide/InstanceStorage.html"&gt;Amazon EC2 instance store&lt;/a&gt; for &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/admin/managing-memory.html#GUID-31E0885D-53DB-442D-BC5F-DDE0588C915A"&gt;Oracle Database Smart Flash Cache&lt;/a&gt;. It can also be safely used to store temporary files. Datafiles can be placed on that kind of storage as well as long as the REDO stream is synchronously transferred to the second site (DataGuard operating in Maximum Availability or Maximum Protection modes is a way to go, a FarSync standby is another option).&lt;br /&gt;Instance store volumes has a &lt;a href="https://docs.aws.amazon.com/en_us/AWSEC2/latest/UserGuide/InstanceStorage.html#instance-store-lifetime"&gt;limited lifetime&lt;/a&gt;. Hence, some actions should be taken to make those volumes usable for the database. I use ASM, so that I have to first partition those devices and then add them to an ASM diskgroup. &lt;br /&gt;</content><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/07/identifying-nvme-instance-store-volumes.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/1978817069960185663'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/1978817069960185663'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-7229504241509854539</id><published>2019-07-14T23:40:00.000+06:00</published><updated>2019-07-15T01:43:39.570+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-04036'/><title type='text'>ORA-04036 Troubleshooting: Error Stack Based Approach</title><content type='html'>A developer came to me the other day to ask me about an ORA-4036 error he encountered.&lt;br /&gt;The trace file was as follows:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[9,15,21]"&gt;=======================================&lt;br /&gt;PRIVATE MEMORY SUMMARY FOR THIS PROCESS&lt;br /&gt;---------------------------------------&lt;br /&gt;******************************************************&lt;br /&gt;PRIVATE HEAP SUMMARY DUMP&lt;br /&gt;1666 MB total:&lt;br /&gt;  1665 MB commented, 296 KB permanent&lt;br /&gt;   260 KB free (0 KB in empty extents),&lt;br /&gt;    1664 MB,   1 heap:    "session heap   "            64 KB free held&lt;br /&gt;------------------------------------------------------&lt;br /&gt;Summary of subheaps at depth 1&lt;br /&gt;1665 MB total:&lt;br /&gt;  1662 MB commented, 76 KB permanent&lt;br /&gt;  2973 KB free (0 KB in empty extents),&lt;br /&gt;    1664 MB,   7 heaps:   "koh-kghu sessi "            2956 KB free held&lt;br /&gt;------------------------------------------------------&lt;br /&gt;Summary of subheaps at depth 2&lt;br /&gt;1661 MB total:&lt;br /&gt;  1615 MB commented, 15 KB permanent&lt;br /&gt;    46 MB free (0 KB in empty extents),&lt;br /&gt;    1661 MB, 41455 chunks:  "pl/sql vc2                " 46 MB free held&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;That is quite common and a conclusion can easily be drawn that most memory is allocated to PL/SQL collections.&lt;br /&gt;The relevant incident file contained the following lines:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[3,9]"&gt;[TOC00004]&lt;br /&gt;----- Current SQL Statement for this session (sql_id=fr9uqhy2xzj6n) -----&lt;br /&gt;BEGIN pkg.fill_memory; END;&lt;br /&gt;[TOC00005]&lt;br /&gt;----- PL/SQL Stack -----&lt;br /&gt;----- PL/SQL Call Stack -----&lt;br /&gt;  object      line  object&lt;br /&gt;  handle    number  name&lt;br /&gt;0x6a6b4250        43  package body TC.PKG.SMALL_ALLOCATION&lt;br /&gt;0x6a6b4250         8  package body TC.PKG.FILL_MEMORY&lt;br /&gt;0x68f1f108         1  anonymous block&lt;br /&gt;[TOC00005-END]&lt;br /&gt;&lt;/pre&gt;It can be depicted from that PL/SQL Call Stack that the actual error happened in the SMALL_ALLOCATION procedure. As you might guess, it does not allocate a lot of memory. Therefore, there is just not enough information in the trace file and the corresponding incident file to figure out those PL/SQL units that allocated the most memory. The developer was not very helpful and had no clue where the memory could be allocated from in his own code. Thankfully, he was able to provide the code that reproduced the error.&lt;br /&gt;&lt;br /&gt;The goal of this blog post is to provide steps to troubleshoot an ORA-04036 error without modifying the source code.&lt;br /&gt;Initially I tried to troubleshoot this issue dumping Error Stacks for the session running the problem code. I settled on Error Stacks because those included PL/SQL Call Stacks and I do not know any other ways to get them.&lt;br /&gt;Here comes the first challenge: when do I need to gather the Error Stack? I decided to gather it when the V$PROCESS.PGA_USED_MEM goes above a certain value.&lt;br /&gt;A sample script to dump the Error Stack when PGA_USED_MEM goes above 1G is below:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[22]"&gt;SQL&gt; col paddr new_v paddr&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select value from v$diag_info where name = 'Default Trace File';&lt;br /&gt;&lt;br /&gt;VALUE&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;/u01/app/oracle/diag/rdbms/orcl/orcl/trace/orcl_ora_13014.trc&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select '0x'||paddr paddr&lt;br /&gt;  2    from v$session&lt;br /&gt;  3   where sid = sys_context('userenv', 'sid');&lt;br /&gt;&lt;br /&gt;PADDR&lt;br /&gt;------------------&lt;br /&gt;0x0000000075558A80&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter session set events -&lt;br /&gt;&gt;   'wait_event["PGA memory operation"] {gt:refn(&amp;paddr., 8, 3728), 0x40000000}{occurence:1,1} trace("pga_used_mem=%\n", refn(&amp;paddr., 8, 3728)) errorstack(1)';&lt;br /&gt;old   1: alter session set events    'wait_event["PGA memory operation"] {gt:refn(&amp;paddr., 8, 3728), 0x40000000}{occurence:1,1} trace("pga_used_mem=%\n", refn(&amp;paddr., 8, 3728)) errorstack(1)'&lt;br /&gt;new   1: alter session set events    'wait_event["PGA memory operation"] {gt:refn(0x0000000075558A80, 8, 3728), 0x40000000}{occurence:1,1} trace("pga_used_mem=%\n", refn(0x0000000075558A80, 8, 3728)) errorstack(1)'&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;/pre&gt;The highlighted line requires a bit of explanation:&lt;br /&gt;&lt;pre class="brush:sql"&gt;alter session set events -&lt;br /&gt;  'wait_event["PGA memory operation"] -&lt;br /&gt;   {gt:refn(0x0000000075558A80, 8, 3728), 0x40000000} -&lt;br /&gt;   {occurence:1,1} -&lt;br /&gt;   trace("pga_used_mem=%\n", refn(0x0000000075558A80, 8, 3728)) -&lt;br /&gt;   errorstack(1)';&lt;br /&gt;&lt;/pre&gt;&lt;ul&gt;&lt;li&gt;&lt;tt&gt;wait_event["PGA memory operation"]&lt;/tt&gt; - I would like to execute some actions when the session wait event is &lt;tt&gt;PGA memory operation&lt;/tt&gt;&lt;/li&gt;&lt;li&gt;&lt;tt&gt;refn(0x0000000075558A80, 8, 3728)&lt;/tt&gt;: refn can be used to peek into a memory location and dereference the value under it. Here is an excerpt from the &lt;tt&gt;oradebug doc event action&lt;/tt&gt; output:&lt;br /&gt;&lt;pre&gt;refn&lt;br /&gt;         - Dereference ptr-to-number: *(ub&amp;lt;numsize&gt;*)(((ub1*)&lt;ptr&gt;)) + &amp;lt;offset&gt;)&lt;br /&gt;&lt;/pre&gt;I use the &lt;tt&gt;refn(v$process.addr, 8, 3728)&lt;/tt&gt; call where 3728 is the offset of PGA_USED_MEM within the X$KSUPR structure that is behind V$PROCESS:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SQL&gt; select c.kqfconam, c.kqfcosiz, c.kqfcooff&lt;br /&gt;  2    from x$kqfta t,&lt;br /&gt;  3         x$kqfco c&lt;br /&gt;  4   where t.kqftanam = 'X$KSUPR'&lt;br /&gt;  5     and c.kqfcotab = t.indx&lt;br /&gt;  6     and c.kqfconam = 'KSUPRPUM';&lt;br /&gt;&lt;br /&gt;KQFCONAM       KQFCOSIZ     KQFCOOFF&lt;br /&gt;---------- ------------ ------------&lt;br /&gt;KSUPRPUM              8         3728&lt;br /&gt;&lt;/pre&gt;As you might guess, 8 is the size of the value which is the second parameter in the REFN call.&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;tt&gt;0x40000000&lt;/tt&gt; is 1G in hex.&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;tt&gt;{gt:refn(0x0000000075558A80, 8, 3728), 0x40000000}&lt;/tt&gt; - that is an event filter. Here is an excerpt from the &lt;tt&gt;oradebug doc event filter&lt;/tt&gt; output:&lt;br /&gt;&lt;pre&gt;gt                   filter to only fire an event when a &gt; b&lt;br /&gt;&lt;/pre&gt;Hence, I would like to fire my event action only when PGA_USED_MEM is above 1G.&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;tt&gt;{occurence:1,1}&lt;/tt&gt; I would like to fire it only once to minimize overhead.&lt;br /&gt;&lt;/li&gt;&lt;li&gt;&lt;tt&gt;trace("pga_used_mem=%\n", refn(0x0000000075558A80, 8, 3728)) errorstack(1)&lt;/tt&gt; - these are the actions that should be executed.&lt;br /&gt;Firstly, I am tracing the PGA_USED_MEM value. Then I am dumping the Error Stack.&lt;br /&gt;&lt;/li&gt;&lt;/ul&gt;&lt;br /&gt;After running this code, I executed the procedure causing ORA-4036 and got the following lines in the trace file:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[1,8,13]"&gt;pga_used_mem=1092512013&lt;br /&gt;&lt;br /&gt;*** 2019-07-14T18:22:04.499962+01:00 (PDB(3))&lt;br /&gt;dbkedDefDump(): Starting a non-incident diagnostic dump (flags=0x0, level=1, mask=0x0)&lt;br /&gt;----- Error Stack Dump -----&lt;br /&gt;&amp;lt;error barrier&gt; at 0x7fff83740dd0 placed dbkda.c@296&lt;br /&gt;----- Current SQL Statement for this session (sql_id=fr9uqhy2xzj6n) -----&lt;br /&gt;BEGIN pkg.fill_memory; END;&lt;br /&gt;----- PL/SQL Stack -----&lt;br /&gt;----- PL/SQL Call Stack -----&lt;br /&gt;  object      line  object&lt;br /&gt;  handle    number  name&lt;br /&gt;0x6a6b4250        31  package body TC.PKG.HUGE_ALLOCATION&lt;br /&gt;0x6a6b4250         7  package body TC.PKG.FILL_MEMORY&lt;br /&gt;0x68f1f108         1  anonymous block&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Following the Error Stack dump, there was a dump for ORA-4036.&lt;br /&gt;Still, there can be the case that HUGE_ALLOCATION procedure just allocated 100M out of 1G, so that the main shortcoming of this method - its granularity. For instance, I was not able to find out how to setup several Error Stacks triggering at 500M and 1G.&lt;br /&gt;The package that I used in these tests is provided below:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[25,37,49]"&gt;create or replace package pkg&lt;br /&gt;is&lt;br /&gt;  MAX_VC_LEN constant binary_integer := 32767;&lt;br /&gt;  type char_tbl_type is table of varchar2(MAX_VC_LEN);&lt;br /&gt;  v_tbl char_tbl_type := char_tbl_type();&lt;br /&gt;  procedure fill_memory;&lt;br /&gt;  procedure tiny_allocation;&lt;br /&gt;  procedure huge_allocation;&lt;br /&gt;  procedure small_allocation;&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;create or replace package body pkg&lt;br /&gt;is&lt;br /&gt;  procedure fill_memory&lt;br /&gt;  is&lt;br /&gt;  begin&lt;br /&gt;    tiny_allocation;&lt;br /&gt;    huge_allocation;&lt;br /&gt;    small_allocation;&lt;br /&gt;  end fill_memory;&lt;br /&gt;&lt;br /&gt;  procedure tiny_allocation&lt;br /&gt;  is&lt;br /&gt;    v_start_size pls_integer := v_tbl.count;&lt;br /&gt;    v_extend_size constant pls_integer := 1000;&lt;br /&gt;  begin&lt;br /&gt;    v_tbl.extend(v_extend_size);&lt;br /&gt;    for i in 1..v_extend_size&lt;br /&gt;    loop&lt;br /&gt;      v_tbl(v_start_size + i) := lpad('x', MAX_VC_LEN, 'x');&lt;br /&gt;    end loop;&lt;br /&gt;  end tiny_allocation;&lt;br /&gt;&lt;br /&gt;  procedure huge_allocation&lt;br /&gt;  is&lt;br /&gt;    v_start_size pls_integer := v_tbl.count;&lt;br /&gt;    v_extend_size constant pls_integer := 38500;&lt;br /&gt;  begin&lt;br /&gt;    v_tbl.extend(v_extend_size);&lt;br /&gt;    for i in 1..v_extend_size&lt;br /&gt;    loop&lt;br /&gt;      v_tbl(v_start_size + i) := lpad('x', MAX_VC_LEN, 'x');&lt;br /&gt;    end loop;&lt;br /&gt;  end huge_allocation;&lt;br /&gt;&lt;br /&gt;  procedure small_allocation&lt;br /&gt;  is&lt;br /&gt;    v_start_size pls_integer := v_tbl.count;&lt;br /&gt;    v_extend_size constant pls_integer := 3000;&lt;br /&gt;  begin&lt;br /&gt;    v_tbl.extend(v_extend_size);&lt;br /&gt;    for i in 1..v_extend_size&lt;br /&gt;    loop&lt;br /&gt;      v_tbl(v_start_size + i) := lpad('x', MAX_VC_LEN, 'x');&lt;br /&gt;    end loop;&lt;br /&gt;  end small_allocation;&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;&lt;/pre&gt;I specifically setup those collection values to make the SMALL_ALLOCATION call produce the ORA-4036 error in my 19c instance with PGA_AGGREGATE_LIMIT=2G.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/7229504241509854539/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/07/ora-04036-troubleshooting-error-stack.html#comment-form' title='Комментарии: 1'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7229504241509854539'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7229504241509854539'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/07/ora-04036-troubleshooting-error-stack.html' title='ORA-04036 Troubleshooting: Error Stack Based Approach'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>1</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-6447402462146132263</id><published>2019-07-07T01:05:00.001+06:00</published><updated>2019-07-07T01:10:33.470+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='CBO'/><title type='text'>Lateral views and filter predicate pushdown</title><content type='html'>That's another optimizer issue I came across this week while working with developers on tuning application queries.&lt;br /&gt;Let's create two tables for this demo:&lt;br /&gt;&lt;pre class="brush:sql;"&gt;SQL&gt; create table t_parent&lt;br /&gt;  2  as&lt;br /&gt;  3  select level id&lt;br /&gt;  4    from dual&lt;br /&gt;  5    connect by level&lt;=10;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter table t_parent&lt;br /&gt;  2    add constraint t_parent_pk primary key(id);&lt;br /&gt;&lt;br /&gt;Table altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create table t_child&lt;br /&gt;  2  as&lt;br /&gt;  3  select level parent_id, dummy a, dummy b&lt;br /&gt;  4    from dual&lt;br /&gt;  5    connect by level&lt;=10;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter table t_child&lt;br /&gt;  2    add constraint t_child_parent_fk foreign key(parent_id) references t_parent;&lt;br /&gt;&lt;br /&gt;Table altered.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create index t_child_parent_fk_i on t_child(parent_id);&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;The following query was run by the application (it's an oversimplified version of the actual query):&lt;br /&gt;&lt;pre class="brush:sql"&gt;select id,&lt;br /&gt;       (select count(a) from t_child where parent_id = id) a_count,&lt;br /&gt;       (select count(b) from t_child where parent_id = id) b_count&lt;br /&gt;  from t_parent&lt;br /&gt; where 1 = :need_to_run;&lt;br /&gt;&lt;/pre&gt;The variable &lt;tt&gt;NEED_TO_RUN&lt;/tt&gt; is to define whether the actual query should be executed. The query was coming from an APEX application.&lt;br /&gt;When the APEX page loads, it sets that &lt;tt&gt;NEED_TO_RUN&lt;/tt&gt; variable to 0 or NULL and fires the query - it is supposed not to return anything.&lt;br /&gt;Only after the user clicks on a certain tab, it leads to setting that &lt;tt&gt;NEED_TO_RUN&lt;/tt&gt; variable to 1 and the query is reexecuted - this time it might return some rows.&lt;br /&gt;Let's see how it works:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[36,45]"&gt;SQL&gt; var need_to_run number&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select /*+ gather_plan_statistics*/&lt;br /&gt;  2         id,&lt;br /&gt;  3         (select count(a) from t_child where parent_id = id) a_count,&lt;br /&gt;  4         (select count(b) from t_child where parent_id = id) b_count&lt;br /&gt;  5    from t_parent&lt;br /&gt;  6   where 1 = :need_to_run;&lt;br /&gt;&lt;br /&gt;no rows selected&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from table(dbms_xplan.display_cursor( format=&gt; 'allstats last'));&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;-------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL_ID  bk2mgzbdury0m, child number 0&lt;br /&gt;-------------------------------------&lt;br /&gt;select /*+ gather_plan_statistics*/        id,        (select count(a)&lt;br /&gt;from t_child where parent_id = id) a_count,        (select count(b)&lt;br /&gt;from t_child where parent_id = id) b_count   from t_parent  where 1 =&lt;br /&gt;:need_to_run&lt;br /&gt;&lt;br /&gt;Plan hash value: 2339616900&lt;br /&gt;&lt;br /&gt;------------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                            | Name                | Starts | E-Rows | A-Rows |   A-Time   |&lt;br /&gt;------------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT                     |                     |      1 |        |      0 |00:00:00.01 |&lt;br /&gt;|   1 |  SORT AGGREGATE                      |                     |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;|   2 |   TABLE ACCESS BY INDEX ROWID BATCHED| T_CHILD             |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;|*  3 |    INDEX RANGE SCAN                  | T_CHILD_PARENT_FK_I |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;|   4 |  SORT AGGREGATE                      |                     |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;|   5 |   TABLE ACCESS BY INDEX ROWID BATCHED| T_CHILD             |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;|*  6 |    INDEX RANGE SCAN                  | T_CHILD_PARENT_FK_I |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;|*  7 |  FILTER                              |                     |      1 |        |      0 |00:00:00.01 |&lt;br /&gt;|   8 |   INDEX FULL SCAN                    | T_PARENT_PK         |      0 |     10 |      0 |00:00:00.01 |&lt;br /&gt;------------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   3 - access("PARENT_ID"=:B1)&lt;br /&gt;   6 - access("PARENT_ID"=:B1)&lt;br /&gt;   7 - filter(1=:NEED_TO_RUN)&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;30 rows selected.&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Oracle just evaluates the filter condition in line 7 and does not go any further.&lt;br /&gt;The query is in fact accesses &lt;tt&gt;T_CHILD&lt;/tt&gt; table twice using the same access method, so that I suggested instead of querying it twice to query it just once.&lt;br /&gt;The whole query was a little bit complex with several outer joins and a lateral view seemed to be a good fit.&lt;br /&gt;The same query rewritten for using a lateral view is below:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[36,45]"&gt;SQL&gt; select /*+ gather_plan_statistics*/p.id,&lt;br /&gt;  2         c.a_count,&lt;br /&gt;  3         c.b_count&lt;br /&gt;  4    from t_parent p,&lt;br /&gt;  5         lateral(&lt;br /&gt;  6           select count(a) a_count,&lt;br /&gt;  7                  count(b) b_count&lt;br /&gt;  8             from t_child&lt;br /&gt;  9            where parent_id = p.id&lt;br /&gt; 10         ) c&lt;br /&gt; 11   where 1 = :need_to_run;&lt;br /&gt;&lt;br /&gt;no rows selected&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from table(dbms_xplan.display_cursor( format=&gt; 'allstats last'));&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;---------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL_ID  g6pqun59pf178, child number 0&lt;br /&gt;-------------------------------------&lt;br /&gt;select /*+ gather_plan_statistics*/p.id,        c.a_count,&lt;br /&gt;c.b_count   from t_parent p,        lateral(          select count(a)&lt;br /&gt;a_count,                 count(b) b_count            from t_child&lt;br /&gt;    where parent_id = p.id        ) c  where 1 = :need_to_run&lt;br /&gt;&lt;br /&gt;Plan hash value: 1581593935&lt;br /&gt;&lt;br /&gt;-------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                               | Name                | Starts | E-Rows | A-Rows |   A-Time   | Buffers |&lt;br /&gt;-------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT                        |                     |      1 |        |      0 |00:00:00.01 |       5 |&lt;br /&gt;|   1 |  NESTED LOOPS                           |                     |      1 |     10 |      0 |00:00:00.01 |       5 |&lt;br /&gt;|   2 |   INDEX FULL SCAN                       | T_PARENT_PK         |      1 |     10 |     10 |00:00:00.01 |       1 |&lt;br /&gt;|   3 |   VIEW                                  | VW_LAT_A18161FF     |     10 |      1 |      0 |00:00:00.01 |       4 |&lt;br /&gt;|*  4 |    FILTER                               |                     |     10 |        |      0 |00:00:00.01 |       4 |&lt;br /&gt;|   5 |     SORT AGGREGATE                      |                     |     10 |      1 |     10 |00:00:00.01 |       4 |&lt;br /&gt;|   6 |      TABLE ACCESS BY INDEX ROWID BATCHED| T_CHILD             |     10 |      1 |     10 |00:00:00.01 |       4 |&lt;br /&gt;|*  7 |       INDEX RANGE SCAN                  | T_CHILD_PARENT_FK_I |     10 |      1 |     10 |00:00:00.01 |       3 |&lt;br /&gt;-------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   4 - filter(1=:NEED_TO_RUN)&lt;br /&gt;   7 - access("PARENT_ID"="P"."ID")&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;28 rows selected.&lt;br /&gt;&lt;/pre&gt;There are a few remarkable things happened here:&lt;br /&gt;&lt;ul&gt;&lt;li&gt;The filter is pushed down to the lateral view&lt;/li&gt;&lt;li&gt;Both the &lt;tt&gt;T_PARENT_TABLE&lt;/tt&gt; and &lt;tt&gt;T_CHILD&lt;/tt&gt; table are accessed first, then the filter is evaluated&lt;/li&gt;&lt;li&gt;Even when we have that filter in line 4, why bother to run any rowsources beneath it?&lt;/li&gt;&lt;/ul&gt;In case of my real query, that was a drastic change causing a severe performance impact.&lt;br /&gt;&lt;br /&gt;The query with a lateral view was transformed into this:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[8]"&gt;Final query after transformations:******* UNPARSED QUERY IS *******&lt;br /&gt;SELECT "P"."ID" "ID","VW_LAT_A18161FF"."A_COUNT_0" "A_COUNT","VW_LAT_A18161FF"."B_COUNT_1" "B_COUNT" &lt;br /&gt;  FROM "TC"."T_PARENT" "P",&lt;br /&gt;       LATERAL( (&lt;br /&gt;         SELECT COUNT("T_CHILD"."A") "A_COUNT_0",COUNT("T_CHILD"."B") "B_COUNT_1" &lt;br /&gt;           FROM "TC"."T_CHILD" "T_CHILD" &lt;br /&gt;          WHERE "T_CHILD"."PARENT_ID"="P"."ID"&lt;br /&gt;         HAVING 1=:B1)) "VW_LAT_A18161FF"&lt;br /&gt;&lt;/pre&gt;Hence, that filter &lt;tt&gt;1 = :NEED_TO_RUN&lt;/tt&gt; has been pushed down to that lateral view and became the &lt;tt&gt;HAVING 1=:B1&lt;/tt&gt; condition.&lt;br /&gt;The solution is quite simple. The query has been rewritten like this:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[10]"&gt;select /*+ gather_plan_statistics*/p.id,&lt;br /&gt;       c.a_count,&lt;br /&gt;       c.b_count&lt;br /&gt;  from t_parent p,&lt;br /&gt;       lateral(&lt;br /&gt;         select count(a) a_count,&lt;br /&gt;                count(b) b_count&lt;br /&gt;           from t_child&lt;br /&gt;          where parent_id = p.id&lt;br /&gt;       )(+) c&lt;br /&gt; where 1 = :need_to_run;&lt;br /&gt;&lt;/pre&gt;It has the following execution plan in which the filter predicate is evaluated as early as possible:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[5,18];"&gt;----------------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                                | Name                | Starts | E-Rows | A-Rows |   A-Time   |&lt;br /&gt;----------------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT                         |                     |      1 |        |      0 |00:00:00.01 |&lt;br /&gt;|*  1 |  FILTER                                  |                     |      1 |        |      0 |00:00:00.01 |&lt;br /&gt;|   2 |   MERGE JOIN OUTER                       |                     |      0 |     10 |      0 |00:00:00.01 |&lt;br /&gt;|   3 |    INDEX FULL SCAN                       | T_PARENT_PK         |      0 |     10 |      0 |00:00:00.01 |&lt;br /&gt;|   4 |    BUFFER SORT                           |                     |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;|   5 |     VIEW                                 | VW_LAT_A18161FF     |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;|   6 |      SORT AGGREGATE                      |                     |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;|   7 |       TABLE ACCESS BY INDEX ROWID BATCHED| T_CHILD             |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;|*  8 |        INDEX RANGE SCAN                  | T_CHILD_PARENT_FK_I |      0 |      1 |      0 |00:00:00.01 |&lt;br /&gt;----------------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   1 - filter(1=:NEED_TO_RUN)&lt;br /&gt;   8 - access("PARENT_ID"="P"."ID")&lt;br /&gt;&lt;/pre&gt;There is also an option to set &lt;tt&gt;_optimizer_filter_pushdown&lt;/tt&gt; to false, however, we went for the first solution and replaced &lt;tt&gt;LATERAL(query)&lt;/tt&gt; with &lt;tt&gt;LATERAL(query)(+)&lt;/tt&gt;.&lt;br /&gt;That's another example when the optimizer gets overly aggressive in rewritting a query, so that in this particular case it outsmarted itself.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/6447402462146132263/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/07/lateral-views-and-filter-predicate.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6447402462146132263'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6447402462146132263'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/07/lateral-views-and-filter-predicate.html' title='Lateral views and filter predicate pushdown'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-320486866863667864</id><published>2019-06-13T02:19:00.000+06:00</published><updated>2019-06-13T02:22:09.745+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='srvctl'/><title type='text'>srvctl config database OSDBA and OSOPER groups not defined </title><content type='html'>I have recently investigated why there are some databases in my environment which are shown with empty OSDBA or OSOPER groups:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[15,16]"&gt;$ srvctl config database -d orcl&lt;br /&gt;Database unique name: orcl&lt;br /&gt;Database name: orcl&lt;br /&gt;Oracle home: /u01/app/oracle/product/db_19&lt;br /&gt;Oracle user: oracle&lt;br /&gt;Spfile: +DATA/ORCL/PARAMETERFILE/spfile.270.1010270597&lt;br /&gt;Password file:&lt;br /&gt;Domain:&lt;br /&gt;Start options: open&lt;br /&gt;Stop options: immediate&lt;br /&gt;Database role: PRIMARY&lt;br /&gt;Management policy: AUTOMATIC&lt;br /&gt;Disk Groups: DATA,FRA&lt;br /&gt;Services:&lt;br /&gt;OSDBA group:&lt;br /&gt;OSOPER group:&lt;br /&gt;Database instance: orcl&lt;br /&gt;&lt;/pre&gt;srvctl is a usual shell script that calls the following:&lt;br /&gt;&lt;pre class="brush:sql"&gt;# JRE Executable and Class File Variables&lt;br /&gt;JRE=${JREDIR}/bin/java&lt;br /&gt;..skip..&lt;br /&gt;# Run srvctl&lt;br /&gt;${JRE} ${JRE_OPTIONS} -DORACLE_HOME=${ORACLE_HOME} -classpath ${CLASSPATH} ${SRVM_PROPERTY_DEFS} oracle.ops.opsctl.OPSCTLDriver "$@"&lt;br /&gt;&lt;/pre&gt;That's just a Java class call. We call oracle.ops.opsctl.OPSCTLDriver passing command-line arguments. CLASSPATH is defined as follows:&lt;br /&gt;&lt;pre&gt;CLASSPATH=${NETCFGJAR}:${LDAPJAR}:${JREJAR}:${SRVMJAR}:${SRVMHASJAR}:${SRVMASMJAR}:\&lt;br /&gt;${EONSJAR}:${SRVCTLJAR}:${GNSJAR}:${ANTLRJAR}:${CLSCEJAR}:${CHACONFIGJAR}:${JDBCJAR}:\&lt;br /&gt;${MAILJAR}:${ACTIVATIONJAR}:${JWCCREDJAR}&lt;br /&gt;&lt;/pre&gt;Those jar-variables are set in the script so it's trivial to find out all classes that are used there.&lt;br /&gt;I used to use JAD to decompile them but it appears to be not in vogue and not developed anymore.&lt;br /&gt;Thankfully, there are a bunch of free sites that can be used as a replacement. I personally have used &lt;a href="http://www.javadecompilers.com/"&gt;this one&lt;/a&gt;.&lt;br /&gt;It is usually advised to identify the entry jar first by looking into the jar files so as to figure out where exactly OPSCTLDriver is coming from.&lt;br /&gt;Not surprisingly, it is coming from ${SRVCTLJAR} which is set to ${ORACLE_HOME}/srvm/jlib/srvctl.jar.&lt;br /&gt;OPSCTLDriver calls oracle.ops.opsctl.ConfigAction that does the following:&lt;br /&gt;&lt;pre class="brush:sql;"&gt;for (Database db : dblist) {&lt;br /&gt;..skip..&lt;br /&gt;  if ((isUnixSystem) &amp;&amp; (!isMgmtDB)) {&lt;br /&gt;    groups = db.getGroups();&lt;br /&gt;    dbaGrp = groups.get("OSDBA") == null ? "" : (String)groups.get("OSDBA");&lt;br /&gt;    operGrp = groups.get("OSOPER") == null ? "" : (String)groups.get("OSOPER");&lt;br /&gt;  }&lt;br /&gt;&lt;/pre&gt;Hence, the groups I am interested in are from the Database class which is set in the import section: import oracle.cluster.database.Database;&lt;br /&gt;That's just an interface from srvm.jar:&lt;br /&gt;&lt;pre class="brush:sql"&gt;public abstract interface Database&lt;br /&gt;  extends SoftwareModule&lt;br /&gt;{&lt;br /&gt;&lt;/pre&gt;The actual implementation is this: oracle.cluster.impl.database.DatabaseImpl.&lt;br /&gt;Here are how those groups are determined:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[16,17]"&gt;String oracleBin = getOracleHome() + File.separator + "bin";&lt;br /&gt;      Trace.out("Creating OSDBAGRPUtil with path: " + oracleBin);&lt;br /&gt;      OSDBAGRPUtil grpUtil = new OSDBAGRPUtil(oracleBin);&lt;br /&gt;      Map&amp;lt;String, String&gt; groups = grpUtil.getAdminGroups(version());&lt;br /&gt;      &lt;br /&gt;&lt;br /&gt;      ResourcePermissionsImpl perm = (ResourcePermissionsImpl)m_crsResource.getPermissions();&lt;br /&gt;      String acl = perm.getAclString();&lt;br /&gt;      Map&amp;lt;String, List&amp;lt;string&gt;&gt; aclMap = splitACL(acl);&lt;br /&gt;      &lt;br /&gt;      List&amp;lt;String&gt; acl_groups = (List)aclMap.get(ResourceType.ACL.GROUP.toString());&lt;br /&gt;      &lt;br /&gt;&lt;br /&gt;      String dba = (String)groups.get("SYSDBA");&lt;br /&gt;      String oper = (String)groups.get("SYSOPER");&lt;br /&gt;      if ((!dba.isEmpty()) &amp;&amp; (acl_groups.contains(dba.toLowerCase()))) {&lt;br /&gt;        groupMap.put("OSDBA", dba);&lt;br /&gt;      }&lt;br /&gt;      if ((!oper.isEmpty()) &amp;&amp; (acl_groups.contains(oper.toLowerCase()))) {&lt;br /&gt;        groupMap.put("OSOPER", oper);&lt;br /&gt;      }&lt;br /&gt;      return groupMap;&lt;br /&gt;&lt;/pre&gt;Having applied the same technique, it's easy to find out that OSDBAGRPUtil calls ${ORACLE_HOME}/bin/osdbagrp passing either "-d" or "-o" flags depending on what group we are interested in.&lt;br /&gt;In my case, those commands returned dba and oper for OSDBA and OSOPER respectively:&lt;br /&gt;&lt;pre class="brush:sql"&gt;$ osdbagrp -d&lt;br /&gt;dba&lt;br /&gt;$ osdbagrp -o&lt;br /&gt;oper&lt;br /&gt;&lt;/pre&gt;Hence, this part of the if statement is true: "(!dba.isEmpty())" and the dba group is not set because of: "(acl_groups.contains(dba.toLowerCase()))".&lt;br /&gt;So that is something related to ACLs which is coming from "ResourcePermissionsImpl perm = (ResourcePermissionsImpl)m_crsResource.getPermissions();".&lt;br /&gt;Let's use &lt;a href="https://docs.oracle.com/database/121/CWADD/GUID-F7DBDD74-6D13-4471-9A92-C2577B04798B.htm#CWADD91543"&gt;the crsctl getperm command&lt;/a&gt; passing the database resource to it:&lt;br /&gt;&lt;pre class="brush:sql"&gt;$ crsctl getperm resource ora.orcl.db&lt;br /&gt;Name: ora.orcl.db&lt;br /&gt;owner:oracle:rwx,pgrp:asmdba:r-x,other::r--,group:oinstall:r-x,user:oracle:rwx&lt;br /&gt;&lt;/pre&gt;That looks promising - neither dba nor oper groups are set. I ran the command below to set dba group:&lt;br /&gt;&lt;pre class="brush:sql"&gt;$ crsctl setperm resource ora.orcl.db -u group:dba:r-x&lt;br /&gt;CRS-4995:  The command 'Setperm  resource' is invalid in crsctl. Use srvctl for this command.&lt;br /&gt;$ crsctl setperm resource ora.orcl.db -u group:dba:r-x -unsupported&lt;br /&gt;&lt;/pre&gt;Well, that is an Oracle Restart environment, so that I added the unsupported flag.&lt;br /&gt;Once it was done, the OSDBA group was properly coming back:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[15]"&gt;$ srvctl config database -d orcl&lt;br /&gt;Database unique name: orcl&lt;br /&gt;Database name: orcl&lt;br /&gt;Oracle home: /u01/app/oracle/product/db_19&lt;br /&gt;Oracle user: oracle&lt;br /&gt;Spfile: +DATA/ORCL/PARAMETERFILE/spfile.270.1010270597&lt;br /&gt;Password file:&lt;br /&gt;Domain:&lt;br /&gt;Start options: open&lt;br /&gt;Stop options: immediate&lt;br /&gt;Database role: PRIMARY&lt;br /&gt;Management policy: AUTOMATIC&lt;br /&gt;Disk Groups: DATA,FRA&lt;br /&gt;Services:&lt;br /&gt;OSDBA group: dba&lt;br /&gt;OSOPER group:&lt;br /&gt;Database instance: orcl&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/320486866863667864/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/06/srvctl-config-database-osdba-and-osoper.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/320486866863667864'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/320486866863667864'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/06/srvctl-config-database-osdba-and-osoper.html' title='srvctl config database OSDBA and OSOPER groups not defined '/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-2952599466201852851</id><published>2019-06-11T03:00:00.000+06:00</published><updated>2019-06-11T23:23:24.508+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='rman'/><title type='text'>A case for DATAFILECOPY FORMAT</title><content type='html'>I was migrating several databases from AWS EC2 non-Nitro based instances to the &lt;a href="https://docs.aws.amazon.com/en_us/AWSEC2/latest/UserGuide/instance-types.html#ec2-nitro-instances"&gt;Nitro-based&lt;/a&gt; ones when I came across one issue with Oracle Recovery Manager (RMAN). This blog post is about it.&lt;br /&gt;The high-level process of the migration was as follows:&lt;br /&gt;&lt;ol type="1"&gt;&lt;li&gt;Attach a new ASM diskgroup to the host that is to be migrated&lt;/li&gt;&lt;li&gt;Make an initial level 0 copy of the database&lt;/li&gt;&lt;li&gt;Roll forward the copy as many times as needed using an incremental level 1 backup&lt;/li&gt;&lt;li&gt;When it's time to switch to the new server, roll forward the copy once again, switch logfile, backup all archivelogs covering the last backup, dismount the ASM diskgroup, mount it on the new server, and open the database (there are also controlfile and spfile copies as well as some extra steps specific to that environment)&lt;/li&gt;&lt;/ol&gt;I would rather use a physical standby or Golden Gate than that meticulously designed process I developed, albeit those alternatives were ruled out since they would require additional licenses.&lt;br /&gt;At the end of the day, the final downtime was less than 30 minutes as almost everything was automated using Ansible.&lt;br /&gt;&lt;br /&gt;I ran that procedure several times in non-Production instances without any issues, however, I got a missing file when I performed the same steps in the Production instance.&lt;br /&gt;Here is how that happened.&lt;br /&gt;The diskgroup configuration is the following:&lt;br /&gt;&lt;br /&gt;&lt;b&gt;DATA&lt;/b&gt; - db_create_file_dest&lt;br /&gt;&lt;b&gt;FRA&lt;/b&gt; - db_recovery_file_dest&lt;br /&gt;&lt;b&gt;MIGR&lt;/b&gt; - the transient ASM diskgroup to keep image copies&lt;br /&gt;&lt;br /&gt;Let's setup a test tablespace:&lt;br /&gt;&lt;pre class="brush:sql;"&gt;SQL&gt; create tablespace test_ts;&lt;br /&gt;&lt;br /&gt;Tablespace created.&lt;br /&gt;&lt;/pre&gt;Make a copy of it:&lt;br /&gt;&lt;pre class="brush:sql;"&gt;RMAN&gt; backup as copy incremental level 0 format '+MIGR' tablespace pdb:test_ts tag migr;&lt;br /&gt;&lt;br /&gt;Starting backup at 10.06.2019 21:14:51&lt;br /&gt;using channel ORA_DISK_1&lt;br /&gt;channel ORA_DISK_1: starting datafile copy&lt;br /&gt;input datafile file number=00016 name=+DATA/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/DATAFILE/test_ts.276.1010610875&lt;br /&gt;output file name=+MIGR/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/DATAFILE/test_ts.256.1010610893 tag=MIGR RECID=6 STAMP=1010610895&lt;br /&gt;channel ORA_DISK_1: datafile copy complete, elapsed time: 00:00:07&lt;br /&gt;Finished backup at 10.06.2019 21:14:59&lt;br /&gt;&lt;/pre&gt;Then add a datafile to that tablespace:&lt;br /&gt;&lt;pre class="brush:sql;"&gt;SQL&gt; alter tablespace test_ts add datafile;&lt;br /&gt;&lt;br /&gt;Tablespace altered.&lt;br /&gt;&lt;/pre&gt;The final backup/recover block:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[8,18];"&gt;RMAN&gt; run {&lt;br /&gt;  backup incremental level 1 format '+MIGR' for recover of copy with tag migr tablespace pdb:test_ts;&lt;br /&gt;  recover copy of tablespace pdb:test_ts with tag migr;&lt;br /&gt;}2&gt; 3&gt; 4&gt;&lt;br /&gt;&lt;br /&gt;Starting backup at 10.06.2019 21:16:42&lt;br /&gt;using channel ORA_DISK_1&lt;br /&gt;no parent backup or copy of datafile 17 found&lt;br /&gt;channel ORA_DISK_1: starting incremental level 1 datafile backup set&lt;br /&gt;channel ORA_DISK_1: specifying datafile(s) in backup set&lt;br /&gt;input datafile file number=00016 name=+DATA/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/DATAFILE/test_ts.276.1010610875&lt;br /&gt;channel ORA_DISK_1: starting piece 1 at 10.06.2019 21:16:42&lt;br /&gt;channel ORA_DISK_1: finished piece 1 at 10.06.2019 21:16:43&lt;br /&gt;piece handle=+MIGR/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/BACKUPSET/2019_06_10/nnndn1_migr_0.258.1010611003 tag=MIGR comment=NONE&lt;br /&gt;channel ORA_DISK_1: backup set complete, elapsed time: 00:00:01&lt;br /&gt;channel ORA_DISK_1: starting datafile copy&lt;br /&gt;input datafile file number=00017 name=+DATA/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/DATAFILE/test_ts.277.1010610945&lt;br /&gt;output file name=+FRA/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/DATAFILE/test_ts.265.1010611003 tag=MIGR RECID=7 STAMP=1010611006&lt;br /&gt;channel ORA_DISK_1: datafile copy complete, elapsed time: 00:00:03&lt;br /&gt;Finished backup at 10.06.2019 21:16:46&lt;br /&gt;&lt;/pre&gt;Despite the fact that the format was set to '+MIGR', the copy of the new added datafile was put to the FRA:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[16]"&gt;RMAN&gt; list copy tag migr;&lt;br /&gt;&lt;br /&gt;specification does not match any control file copy in the repository&lt;br /&gt;specification does not match any archived log in the repository&lt;br /&gt;List of Datafile Copies&lt;br /&gt;=======================&lt;br /&gt;&lt;br /&gt;Key     File S Completion Time     Ckp SCN    Ckp Time            Sparse&lt;br /&gt;------- ---- - ------------------- ---------- ------------------- ------&lt;br /&gt;8       16   A 10.06.2019 21:16:47 1468031    10.06.2019 21:16:42 NO&lt;br /&gt;        Name: +MIGR/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/DATAFILE/test_ts.256.1010610893&lt;br /&gt;        Tag: MIGR&lt;br /&gt;        Container ID: 3, PDB Name: PDB&lt;br /&gt;&lt;br /&gt;7       17   A 10.06.2019 21:16:46 1468032    10.06.2019 21:16:43 NO&lt;br /&gt;        Name: +FRA/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/DATAFILE/test_ts.265.1010611003&lt;br /&gt;        Tag: MIGR&lt;br /&gt;        Container ID: 3, PDB Name: PDB&lt;br /&gt;&lt;/pre&gt;That is pretty much the same issue that I encountered while doing a test migration of that multi-terabyte database in the Production system - a few datafiles have been added between the initial level 0 and the subsequent level 1 copies.&lt;br /&gt;It is the case when the &lt;a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/rcmrf/BACKUP.html#GUID-73642FF2-43C5-48B2-9969-99001C52EB50"&gt;DATAFILECOPY FORMAT&lt;/a&gt; clause can be used:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[4,11,21]"&gt;RMAN&gt; run {&lt;br /&gt;  backup incremental level 1 &lt;br /&gt;    format '+MIGR' for recover of copy with tag migr &lt;br /&gt;    datafilecopy format '+MIGR'&lt;br /&gt;    tablespace pdb:test_ts;&lt;br /&gt;  recover copy of tablespace pdb:test_ts with tag migr;&lt;br /&gt;}2&gt; 3&gt; 4&gt;&lt;br /&gt;&lt;br /&gt;Starting backup at 10.06.2019 21:21:57&lt;br /&gt;using channel ORA_DISK_1&lt;br /&gt;no parent backup or copy of datafile 19 found&lt;br /&gt;channel ORA_DISK_1: starting incremental level 1 datafile backup set&lt;br /&gt;channel ORA_DISK_1: specifying datafile(s) in backup set&lt;br /&gt;input datafile file number=00018 name=+DATA/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/DATAFILE/test_ts.277.1010611243&lt;br /&gt;channel ORA_DISK_1: starting piece 1 at 10.06.2019 21:21:57&lt;br /&gt;channel ORA_DISK_1: finished piece 1 at 10.06.2019 21:21:58&lt;br /&gt;piece handle=+MIGR/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/BACKUPSET/2019_06_10/nnndn1_migr_0.259.1010611317 tag=MIGR comment=NONE&lt;br /&gt;channel ORA_DISK_1: backup set complete, elapsed time: 00:00:01&lt;br /&gt;channel ORA_DISK_1: starting datafile copy&lt;br /&gt;input datafile file number=00019 name=+DATA/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/DATAFILE/test_ts.276.1010611299&lt;br /&gt;output file name=+MIGR/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/DATAFILE/test_ts.260.1010611319 tag=MIGR RECID=10 STAMP=1010611321&lt;br /&gt;channel ORA_DISK_1: datafile copy complete, elapsed time: 00:00:03&lt;br /&gt;Finished backup at 10.06.2019 21:22:01&lt;br /&gt;&lt;/pre&gt;That's just another flexibility that Oracle provides. If you think about it, it makes complete sense - image copies and backupsets can be stored separately.&lt;br /&gt;Another way to specify location for image copies in that case is an explicit channel configuration:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[3,13,23,31];"&gt;RMAN&gt; run {&lt;br /&gt;  # allocate as many channels as needed&lt;br /&gt;  allocate channel c1 device type disk format '+MIGR';&lt;br /&gt;  backup incremental level 1 for recover of copy with tag migr tablespace pdb:test_ts;&lt;br /&gt;  recover copy of tablespace pdb:test_ts with tag migr;&lt;br /&gt;}2&gt; 3&gt; 4&gt; 5&gt;&lt;br /&gt;&lt;br /&gt;released channel: ORA_DISK_1&lt;br /&gt;allocated channel: c1&lt;br /&gt;channel c1: SID=94 device type=DISK&lt;br /&gt;&lt;br /&gt;Starting backup at 10.06.2019 21:33:43&lt;br /&gt;no parent backup or copy of datafile 21 found&lt;br /&gt;channel c1: starting incremental level 1 datafile backup set&lt;br /&gt;channel c1: specifying datafile(s) in backup set&lt;br /&gt;input datafile file number=00020 name=+DATA/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/DATAFILE/test_ts.276.1010611951&lt;br /&gt;channel c1: starting piece 1 at 10.06.2019 21:33:44&lt;br /&gt;channel c1: finished piece 1 at 10.06.2019 21:33:45&lt;br /&gt;piece handle=+MIGR/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/BACKUPSET/2019_06_10/nnndn1_migr_0.256.1010612025 tag=MIGR comment=NONE&lt;br /&gt;channel c1: backup set complete, elapsed time: 00:00:01&lt;br /&gt;channel c1: starting datafile copy&lt;br /&gt;input datafile file number=00021 name=+DATA/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/DATAFILE/test_ts.277.1010612011&lt;br /&gt;output file name=+MIGR/ORCL/8AAFC31944116B0CE0554A7F9DE2B2FD/DATAFILE/test_ts.261.1010612025 tag=MIGR RECID=13 STAMP=1010612028&lt;br /&gt;channel c1: datafile copy complete, elapsed time: 00:00:03&lt;br /&gt;Finished backup at 10.06.2019 21:33:48&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/2952599466201852851/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/06/a-case-for-datafilecopy-format.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/2952599466201852851'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/2952599466201852851'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/06/a-case-for-datafilecopy-format.html' title='A case for DATAFILECOPY FORMAT'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-4117473004590919493</id><published>2019-06-05T03:12:00.000+06:00</published><updated>2019-06-05T03:13:23.968+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-01031'/><category scheme='http://www.blogger.com/atom/ns#' term='18c'/><title type='text'>ORA-01031 select V$RESTORE_POINT in PL/SQL</title><content type='html'>It is a well known &lt;a href="https://oraganism.wordpress.com/2012/10/28/access-to-vrestore_point/"&gt;fact&lt;/a&gt; that V$RESTORE_POINT requires special handling, namely the SELECT_CATALOG_ROLE should be granted to a low-privileged user trying to access this view.&lt;br /&gt;I had several PL/SQL units working with V$RESTORE_POINT in a 12.1 database. Those units were owned by a user that has SELECT_CATALOG_ROLE.&lt;br /&gt;Once I upgraded the database to 12.2, those units stopped working and I started getting an infamous ORA-1031 error.&lt;br /&gt;This blog post is about how I fixed that issue for definer rights program units.&lt;br /&gt;&lt;br /&gt;Here is a simple test case demonstrating the initial ORA-1031 error:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[42]"&gt;SYS@CDB$ROOT&gt; create restore point rp_test;&lt;br /&gt;&lt;br /&gt;Restore point created.&lt;br /&gt;&lt;br /&gt;SYS@CDB$ROOT&gt; alter session set container=pdb;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SYS@PDB&gt; grant connect, create procedure to tc identified by tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SYS@PDB&gt; grant read on v_$restore_point to tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SYS@PDB&gt; conn tc/tc@localhost/pdb&lt;br /&gt;Connected.&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; create or replace procedure p_test&lt;br /&gt;  2  is&lt;br /&gt;  3  begin&lt;br /&gt;  4    for test_rec in (&lt;br /&gt;  5      select *&lt;br /&gt;  6        from v$restore_point)&lt;br /&gt;  7    loop&lt;br /&gt;  8      dbms_output.put_line(test_rec.name);&lt;br /&gt;  9    end loop;&lt;br /&gt; 10  end;&lt;br /&gt; 11  /&lt;br /&gt;&lt;br /&gt;Procedure created.&lt;br /&gt;&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; set serverout on&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; exec p_test&lt;br /&gt;BEGIN p_test; END;&lt;br /&gt;&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-01031: insufficient privileges&lt;br /&gt;ORA-06512: at "TC.P_TEST", line 4&lt;br /&gt;ORA-06512: at line 1&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Despite the fact that the user TC does have the READ privilege on V_$RESTORE_POINT, it still is not able to access it.&lt;br /&gt;Till 12.2 it was enough to grant SELECT_CATALOG_ROLE to the owner of a program unit to avoid the error:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[1,11,13]"&gt;SYS@PDB&gt; grant select_catalog_role to tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SYS@PDB&gt; conn tc/tc@localhost/pdb&lt;br /&gt;Connected.&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; set serverout on&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; exec p_test&lt;br /&gt;RP_TEST&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;It is not the case anymore in 12.2 and subsequent versions which I tested: 18c and 19c.&lt;br /&gt;The output from 19c is below:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[1,15]"&gt;SYS@PDB&gt; grant select_catalog_role to tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SYS@PDB&gt; conn tc/tc@localhost/pdb&lt;br /&gt;Connected.&lt;br /&gt;SYS@PDB&gt;&lt;br /&gt;TC@PDB&gt; set serverout on&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; exec p_test&lt;br /&gt;BEGIN p_test; END;&lt;br /&gt;&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-01031: insufficient privileges&lt;br /&gt;ORA-06512: at "TC.P_TEST", line 5&lt;br /&gt;ORA-06512: at "TC.P_TEST", line 5&lt;br /&gt;ORA-06512: at line 1&lt;br /&gt;&lt;/pre&gt;BTW, the line 'ORA-06512: at "TC.P_TEST", line 5' is reported twice, and 19c shows a slightly different errorstack than 12.1.&lt;br /&gt;The following solution works in 12.2 on:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[1,12,14]"&gt;SYS@PDB&gt; grant select_catalog_role to procedure tc.p_test;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SYS@PDB&gt;&lt;br /&gt;SYS@PDB&gt; conn tc/tc@localhost/pdb&lt;br /&gt;Connected.&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; set serverout on&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; exec p_test&lt;br /&gt;RP_TEST&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;The need for having the SELECT_CATALOG_ROLE granted to the user in 12.1 does not make much sense as roles do not work in named PL/SQL &lt;b&gt;definer rights&lt;/b&gt; program units. I am not talking about roles granted to PL/SQL units here.&lt;br /&gt;Therefore, the "new" behavior requiring the role to be granted to PL/SQL units appears to be more proper and logical.&lt;br /&gt;&lt;br /&gt;While working on this issue, I was tinkering with gdb a little bit in an attempt to find an explanation to that SELECT_CATALOG_ROLE requirement - that role is not coming from V$-views as it was said in &lt;a href="https://oraganism.wordpress.com/2012/10/28/access-to-vrestore_point/"&gt;the blogpost&lt;/a&gt; which I referred before.&lt;br /&gt;It turns out that role is used in Oracle code:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[1,10,12,16]"&gt;(gdb) disassemble kccxrsp&lt;br /&gt;Dump of assembler code for function kccxrsp:&lt;br /&gt;   0x000000000a225740 &lt;+0&gt;:     xchg   %ax,%ax&lt;br /&gt;   0x000000000a225742 &lt;+2&gt;:     push   %rbp&lt;br /&gt;   0x000000000a225743 &lt;+3&gt;:     mov    %rsp,%rbp&lt;br /&gt;   0x000000000a225746 &lt;+6&gt;:     sub    $0x60,%rsp&lt;br /&gt;   0x000000000a22574a &lt;+10&gt;:    mov    %rbx,-0x58(%rbp)&lt;br /&gt;   0x000000000a22574e &lt;+14&gt;:    mov    %rdx,%rbx&lt;br /&gt;..skip..&lt;br /&gt;   0x000000000a2257e5 &lt;+165&gt;:   mov    $0xdda7b48,%edi&lt;br /&gt;   0x000000000a2257ea &lt;+170&gt;:   mov    $0x13,%esi&lt;br /&gt;   0x000000000a2257ef &lt;+175&gt;:   callq  0x859bd90 &lt;kzsrol&gt;&lt;br /&gt;..skip..&lt;br /&gt;---Type &amp;lt;return&gt; to continue, or q &amp;lt;return&gt; to quit---q&lt;br /&gt;Quit&lt;br /&gt;(gdb) x/s 0xdda7b48&lt;br /&gt;0xdda7b48:      "SELECT_CATALOG_ROLE"&lt;br /&gt;&lt;/pre&gt;GV$RESTORE_POINT is based on x$kccrsp and x$kccnrs. The former is seems to be accessed through the kccxrsp function.&lt;br /&gt;kccxrsp calls kzsrol to perform extra security checks and passes SELECT_CATALOG_ROLE to it.&lt;br /&gt;&lt;br /&gt;TL;DR: V$-views are really special views (i.e. no read consistency) and V$RESTORE_POINT has its own little peculiarity among them. &lt;br /&gt;Not only does it require to have the SELECT_CATALOG_ROLE granted to a non-administrative user but also the definer rights PL/SQL unit owned by such a user should have that role granted as well.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/4117473004590919493/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/06/ora-01031-select-vrestorepoint-in-plsql.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4117473004590919493'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4117473004590919493'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/06/ora-01031-select-vrestorepoint-in-plsql.html' title='ORA-01031 select V$RESTORE_POINT in PL/SQL'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-4370691437318574748</id><published>2019-06-01T22:32:00.000+06:00</published><updated>2019-06-01T22:32:00.790+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='OEM'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><title type='text'>OEM Target Version not updated after applying RU patch</title><content type='html'>After applying the 12.2.0.1.190416 Release Update (RU) patch, I noticed that the target version had not been updated:&lt;br /&gt;&lt;a href="https://4.bp.blogspot.com/-CR38CfvqxIU/XPKi6nhyEpI/AAAAAAAAGso/zh9UZTyv70URwOkRQsIwa87Y8NXKxCI7ACLcBGAs/s1600/oem_wrong_version_initial_highlight.png" imageanchor="1" &gt;&lt;img border="0" src="https://4.bp.blogspot.com/-CR38CfvqxIU/XPKi6nhyEpI/AAAAAAAAGso/zh9UZTyv70URwOkRQsIwa87Y8NXKxCI7ACLcBGAs/s1600/oem_wrong_version_initial_highlight.png" width="756" height="243" data-original-width="1513" data-original-height="486" /&gt;&lt;/a&gt;&lt;br /&gt;I searched through My Oracle Support (MOS) and found a few similar issues where it was recommended to refresh the configuration of the host in question.&lt;br /&gt;Thus, I performed the refresh operation for both the host configuration and the database configuration, yet the version was still the old one.&lt;br /&gt;&lt;br /&gt;Here are the targets that are registered on the problem host:&lt;br /&gt;&lt;pre class="brush:bash;highlight:[12]"&gt;[oraagent@oracle-sandbox bin]$ ./emctl config agent listtargets&lt;br /&gt;Oracle Enterprise Manager Cloud Control 13c Release 3&lt;br /&gt;Copyright (c) 1996, 2018 Oracle Corporation.  All rights reserved.&lt;br /&gt;[oracle-sandbox.domain, host]&lt;br /&gt;[oracle-sandbox.domain:3872, oracle_emd]&lt;br /&gt;[+ASM_oracle-sandbox.domain, osm_instance]&lt;br /&gt;[OraDB12Home1_2_oracle-sandbox.domain_3696, oracle_home]&lt;br /&gt;[OraHome1Grid_1_oracle-sandbox.domain_6710, oracle_home]&lt;br /&gt;[agent13c1_3_oracle-sandbox.domain_5948, oracle_home]&lt;br /&gt;[has_oracle-sandbox.domain, has]&lt;br /&gt;[OraGI12Home1_4_oracle-sandbox.domain_67, oracle_home]&lt;br /&gt;[BOXCDB_oracle-sandbox.domain, oracle_database]&lt;br /&gt;[BOXCDB_oracle-sandbox.domain_CDB$ROOT, oracle_pdb]&lt;br /&gt;[BOXCDB_oracle-sandbox.domain_BOXPDB, oracle_pdb]&lt;br /&gt;&lt;/pre&gt;I ran the following command after which the issue was resolved:&lt;br /&gt;&lt;pre class="brush:bash"&gt;[oraagent@oracle-sandbox bin]$ ./emctl reload agent dynamicproperties BOXCDB_oracle-sandbox.domain:oracle_database&lt;br /&gt;Oracle Enterprise Manager Cloud Control 13c Release 3&lt;br /&gt;Copyright (c) 1996, 2018 Oracle Corporation.  All rights reserved.&lt;br /&gt;---------------------------------------------------------------&lt;br /&gt;EMD recompute dynprops completed successfully&lt;br /&gt;&lt;/pre&gt;The correct version finally appeared on the database page:&lt;br /&gt;&lt;a href="https://4.bp.blogspot.com/-8EWuYwvX9lA/XPKk93WY8qI/AAAAAAAAGs0/69e6dFuQTE0cs4LBo7PJCl9PQaTsY1ZNACLcBGAs/s1600/oem_wrong_version_final_highlight.png" imageanchor="1" &gt;&lt;img border="0" src="https://4.bp.blogspot.com/-8EWuYwvX9lA/XPKk93WY8qI/AAAAAAAAGs0/69e6dFuQTE0cs4LBo7PJCl9PQaTsY1ZNACLcBGAs/s1600/oem_wrong_version_final_highlight.png" width="756" height="243" data-original-width="1517" data-original-height="515" /&gt;&lt;/a&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/4370691437318574748/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/06/oem-target-version-not-updated-after.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4370691437318574748'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4370691437318574748'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/06/oem-target-version-not-updated-after.html' title='OEM Target Version not updated after applying RU patch'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><media:thumbnail xmlns:media='http://search.yahoo.com/mrss/' url='https://4.bp.blogspot.com/-CR38CfvqxIU/XPKi6nhyEpI/AAAAAAAAGso/zh9UZTyv70URwOkRQsIwa87Y8NXKxCI7ACLcBGAs/s72-c/oem_wrong_version_initial_highlight.png' height='72' width='72'/><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-410010138444606110</id><published>2019-05-11T22:32:00.000+06:00</published><updated>2019-05-11T22:32:12.890+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='19c'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><category scheme='http://www.blogger.com/atom/ns#' term='CBO'/><category scheme='http://www.blogger.com/atom/ns#' term='18c'/><title type='text'>Concatenation and filter subqueries oddity</title><content type='html'>While investigating a poor query performance issue, I came across the following Real-Time SQL Monitoring report from a 12.1 database:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[23]"&gt;Global Stats&lt;br /&gt;========================================================================================&lt;br /&gt;| Elapsed |   Cpu   |    IO    | Concurrency | PL/SQL  | Fetch | Buffer | Read | Read  |&lt;br /&gt;| Time(s) | Time(s) | Waits(s) |  Waits(s)   | Time(s) | Calls |  Gets  | Reqs | Bytes |&lt;br /&gt;========================================================================================&lt;br /&gt;|    3041 |     299 |     2742 |        0.00 |      29 |    21 |    27M |  10M |  79GB |&lt;br /&gt;========================================================================================&lt;br /&gt;&lt;br /&gt;SQL Plan Monitoring Details (Plan Hash Value=511311330)&lt;br /&gt;========================================================================================================================================================================================================&lt;br /&gt;| Id |                    Operation                     |      Name       |  Rows   | Cost  |   Time    | Start  | Execs |   Rows   | Read  | Read  |  Mem  | Activity |        Activity Detail        |&lt;br /&gt;|    |                                                  |                 | (Estim) |       | Active(s) | Active |       | (Actual) | Reqs  | Bytes | (Max) |   (%)    |          (# samples)          |&lt;br /&gt;========================================================================================================================================================================================================&lt;br /&gt;|  0 | SELECT STATEMENT                                 |                 |         |       |      2822 |    +93 |     1 |     2044 |       |       |       |     1.65 | Cpu (39)                      |&lt;br /&gt;|    |                                                  |                 |         |       |           |        |       |          |       |       |       |          | db file sequential read (9)   |&lt;br /&gt;|  1 |   HASH GROUP BY                                  |                 |       1 |       |         1 |  +2914 |     1 |     2044 |       |       |    1M |          |                               |&lt;br /&gt;|  2 |    CONCATENATION                                 |                 |         |       |      2911 |     +4 |     1 |        0 |       |       |       |          |                               |&lt;br /&gt;|  3 |     FILTER                                       |                 |         |       |           |        |     1 |          |       |       |       |          |                               |&lt;br /&gt;|  4 |      FILTER                                      |                 |         |       |           |        |     1 |          |       |       |       |          |                               |&lt;br /&gt;|  5 |       PARTITION LIST SINGLE                      |                 |       1 |   34M |           |        |       |          |       |       |       |          |                               |&lt;br /&gt;|  6 |        TABLE ACCESS BY LOCAL INDEX ROWID BATCHED | DRIVING_TAB     |       1 |   34M |           |        |       |          |       |       |       |          |                               |&lt;br /&gt;|  7 |         INDEX RANGE SCAN                         | DRIVING_TAB_I   |     36M |  368K |           |        |       |          |       |       |       |          |                               |&lt;br /&gt;|  8 |      INDEX RANGE SCAN                            | DICT_PK         |       1 |     3 |      2911 |     +4 |  334K |     304K |  1169 |   9MB |       |     0.24 | Cpu (5)                       |&lt;br /&gt;|    |                                                  |                 |         |       |           |        |       |          |       |       |       |          | db file sequential read (2)   |&lt;br /&gt;|  9 |     FILTER                                       |                 |         |       |      2911 |     +4 |     1 |    42816 |       |       |       |     0.03 | Cpu (1)                       |&lt;br /&gt;| 10 |      FILTER                                      |                 |         |       |      2911 |     +4 |     1 |     450K |       |       |       |          |                               |&lt;br /&gt;| 11 |       PARTITION LIST SINGLE                      |                 |       1 |   19M |      2911 |     +4 |     1 |     450K |       |       |       |          |                               |&lt;br /&gt;| 12 |        TABLE ACCESS BY LOCAL INDEX ROWID BATCHED | DRIVING_TAB     |       1 |   19M |      2915 |     +0 |     1 |     450K |   10M |  79GB |       |    88.71 | Cpu (72)                      |&lt;br /&gt;|    |                                                  |                 |         |       |           |        |       |          |       |       |       |          | db file parallel read (2453)  |&lt;br /&gt;|    |                                                  |                 |         |       |           |        |       |          |       |       |       |          | db file scattered read (5)    |&lt;br /&gt;|    |                                                  |                 |         |       |           |        |       |          |       |       |       |          | db file sequential read (55)  |&lt;br /&gt;| 13 |         INDEX RANGE SCAN                         | DRIVING_TAB_I   |     20M | 63566 |      2911 |     +4 |     1 |      25M | 78518 | 613MB |       |     8.30 | Cpu (5)                       |&lt;br /&gt;|    |                                                  |                 |         |       |           |        |       |          |       |       |       |          | db file sequential read (237) |&lt;br /&gt;| 14 |      INDEX RANGE SCAN                            | DICT_PK         |       1 |     3 |      2911 |     +4 |  334K |     304K |       |       |       |          |                               |&lt;br /&gt;========================================================================================================================================================================================================&lt;br /&gt;&lt;/pre&gt;It is quite unusual that line 8 has any number of executions and rows at all as there are no rows returned from line 4-7.&lt;br /&gt;It is also suspicious that the certain activity columns precisely matches line 14.&lt;br /&gt;I decided to take a look at that query using row source executions statistics:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[12];"&gt;----------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                                      | Name            | Starts | E-Rows | A-Rows |   A-Time   | Buffers | Reads  |  OMem |  1Mem | Used-Mem |&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT                               |                 |      1 |        |   2044 |00:48:34.11 |      26M|     10M|       |       |          |&lt;br /&gt;|   1 |  HASH GROUP BY                                 |                 |      1 |      1 |   2044 |00:48:34.11 |      26M|     10M|  1553K|   956K| 1364K (0)|&lt;br /&gt;|   2 |   CONCATENATION                                |                 |      1 |        |  42816 |00:44:40.63 |      26M|     10M|       |       |          |&lt;br /&gt;|*  3 |    FILTER                                      |                 |      1 |        |      0 |00:00:00.01 |       0 |      0 |       |       |          |&lt;br /&gt;|*  4 |     FILTER                                     |                 |      1 |        |      0 |00:00:00.01 |       0 |      0 |       |       |          |&lt;br /&gt;|   5 |      PARTITION LIST SINGLE                     |                 |      0 |      1 |      0 |00:00:00.01 |       0 |      0 |       |       |          |&lt;br /&gt;|*  6 |       TABLE ACCESS BY LOCAL INDEX ROWID BATCHED| DRIVING_TAB     |      0 |      1 |      0 |00:00:00.01 |       0 |      0 |       |       |          |&lt;br /&gt;|*  7 |        INDEX RANGE SCAN                        | DRIVING_TAB_I   |      0 |     35M|      0 |00:00:00.01 |       0 |      0 |       |       |          |&lt;br /&gt;|*  8 |     INDEX RANGE SCAN                           | DICT_PK         |    333K|      1 |    304K|00:00:18.49 |    1610K|   1173 |       |       |          |&lt;br /&gt;|*  9 |    FILTER                                      |                 |      1 |        |  42816 |00:44:40.57 |      26M|     10M|       |       |          |&lt;br /&gt;|* 10 |     FILTER                                     |                 |      1 |        |    449K|00:47:48.59 |      25M|     10M|       |       |          |&lt;br /&gt;|  11 |      PARTITION LIST SINGLE                     |                 |      1 |      1 |    449K|00:47:47.97 |      25M|     10M|       |       |          |&lt;br /&gt;|* 12 |       TABLE ACCESS BY LOCAL INDEX ROWID BATCHED| DRIVING_TAB     |      1 |      1 |    449K|00:47:47.34 |      25M|     10M|       |       |          |&lt;br /&gt;|* 13 |        INDEX RANGE SCAN                        | DRIVING_TAB_I   |      1 |     19M|     24M|00:03:59.62 |   79436 |  78518 |       |       |          |&lt;br /&gt;|* 14 |     INDEX RANGE SCAN                           | DICT_PK         |    333K|      1 |    304K|00:00:18.49 |    1610K|   1173 |       |       |          |&lt;br /&gt;----------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;/pre&gt;Again, it does not make any sense that line 8 is reported as being executed. The number of logical reads does not add up either.&lt;br /&gt;A-Time of INDEX RANGE SCAN DICT_PK is the same in lines 8 and 14, so that I would chalk it up to a statistics reporting bug.&lt;br /&gt;&lt;br /&gt;I constructed the following test case used to reproduce the issue and tested it in 12.2, 18.3, 19.2 with the same results:&lt;br /&gt;&lt;pre class="brush:sql;"&gt;create table t_driving (status char(1), driving_to_inner_id int);&lt;br /&gt;insert into t_driving values ('A', 1);&lt;br /&gt;insert into t_driving values ('B', 2);&lt;br /&gt;create table t_inner(id int);&lt;br /&gt;insert into t_inner select 1 from dual connect by level&lt;=10;&lt;br /&gt;&lt;br /&gt;var status varchar2(1)='B'&lt;br /&gt;&lt;br /&gt;begin&lt;br /&gt;  for test_rec in (&lt;br /&gt;    select /*+ use_concat(or_predicates(1)) gather_plan_statistics no_unnest(@inner)*/&lt;br /&gt;           *&lt;br /&gt;      from t_driving&lt;br /&gt;     where (:status='B' and status = 'B' or :status='A' and status = 'A')&lt;br /&gt;       and not exists (&lt;br /&gt;             select /*+ qb_name(inner) */&lt;br /&gt;                    null&lt;br /&gt;               from t_inner&lt;br /&gt;              where id = driving_to_inner_id&lt;br /&gt;           )&lt;br /&gt;  )&lt;br /&gt;  loop &lt;br /&gt;    null;&lt;br /&gt;  end loop;&lt;br /&gt;  for plan_rec in (select * from table(dbms_xplan.display_cursor( format=&gt; 'allstats last')))&lt;br /&gt;  loop&lt;br /&gt;    dbms_output.put_line(plan_rec.plan_table_output);&lt;br /&gt;  end loop;&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;&lt;/pre&gt;Here is the output of the last block highlighting the plan execution details:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[16]"&gt;SQL_ID  4n8swkt3cv3sh, child number 0&lt;br /&gt;-------------------------------------&lt;br /&gt;SELECT /*+ use_concat(or_predicates(1)) gather_plan_statistics&lt;br /&gt;no_unnest(@inner)*/ * FROM T_DRIVING WHERE (:B1 ='B' AND STATUS = 'B'&lt;br /&gt;OR :B1 ='A' AND STATUS = 'A') AND NOT EXISTS ( SELECT /*+&lt;br /&gt;qb_name(inner) */ NULL FROM T_INNER WHERE ID = DRIVING_TO_INNER_ID )&lt;br /&gt;Plan hash value: 3020335025&lt;br /&gt;--------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation            | Name      | Starts | E-Rows | A-Rows |   A-Time   | Buffers |&lt;br /&gt;--------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT     |           |      1 |        |      1 |00:00:00.01 |      14 |&lt;br /&gt;|   1 |  CONCATENATION       |           |      1 |        |      1 |00:00:00.01 |      14 |&lt;br /&gt;|*  2 |   FILTER             |           |      1 |        |      0 |00:00:00.01 |       0 |&lt;br /&gt;|*  3 |    FILTER            |           |      1 |        |      0 |00:00:00.01 |       0 |&lt;br /&gt;|*  4 |     TABLE ACCESS FULL| T_DRIVING |      0 |      1 |      0 |00:00:00.01 |       0 |&lt;br /&gt;|*  5 |    TABLE ACCESS FULL | T_INNER   |      1 |      1 |      0 |00:00:00.01 |       7 |&lt;br /&gt;|*  6 |   FILTER             |           |      1 |        |      1 |00:00:00.01 |      14 |&lt;br /&gt;|*  7 |    FILTER            |           |      1 |        |      1 |00:00:00.01 |       7 |&lt;br /&gt;|*  8 |     TABLE ACCESS FULL| T_DRIVING |      1 |      1 |      1 |00:00:00.01 |       7 |&lt;br /&gt;|*  9 |    TABLE ACCESS FULL | T_INNER   |      1 |      1 |      0 |00:00:00.01 |       7 |&lt;br /&gt;--------------------------------------------------------------------------------------------&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;2 - filter( IS NULL)&lt;br /&gt;3 - filter(:B1='A')&lt;br /&gt;4 - filter("STATUS"='A')&lt;br /&gt;5 - filter("ID"=:B1)&lt;br /&gt;6 - filter( IS NULL)&lt;br /&gt;7 - filter(:B1='B')&lt;br /&gt;8 - filter(("STATUS"='B' AND (LNNVL(:B1='A') OR LNNVL("STATUS"='A'))))&lt;br /&gt;9 - filter("ID"=:B1)&lt;br /&gt;&lt;/pre&gt;The total number of buffers is 14, which is correct. However, line 5 has also contributed to 7 buffers somehow. Thus there should have been 21 buffers overall.&lt;br /&gt;If line 4 is not executed, as it has starts 0, how come that line 5 is being executed?&lt;br /&gt;I rechecked all the numbers against V$SQL_PLAN_STATISTICS_ALL, V$SQLAREA_PLAN_HASH and other views. The total executions details, such as buffers, were fine - they were all reported as 14.&lt;br /&gt;The only issue was with line 5 - it should have not been reported as being executed or generating any number of logical I/O.&lt;br /&gt;I believe that is a reporting bug - there should be no starts for line 5 at all.&lt;br /&gt;&lt;br /&gt;I was curious how new 12.2 OR-Expansion transformation would behave.&lt;br /&gt;Although I knew it could be forced by using an OR_EXPAND hint, I was struggling to get it work, so that I had to resort to optimizer traces to find out why my hints were not honored by the optimizer.&lt;br /&gt;I found the following lines in the trace file that helped solve that issue:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[5];"&gt;ORE: Predicate chain after QB validity check - SEL$1&lt;br /&gt;(:B1='B' AND "T_DRIVING"."STATUS"='B' OR :B2='A' AND "T_DRIVING"."STATUS"='A') AND  NOT EXISTS (SELECT /*+ NO_UNNES&lt;br /&gt;T QB_NAME ("INNER") */ 0 FROM "T_INNER" "T_INNER")&lt;br /&gt;ORE: Checking validity of disjunct chain&lt;br /&gt;ORE: Bypassed for disjunct chain: No Index or Partition driver found.&lt;br /&gt;ORE: # conjunction chain - 1&lt;br /&gt;ORE: No state generated.&lt;br /&gt;&lt;/pre&gt;So there is 'No Index or Partition driver found' - that is something that I can work with. It is interesting enough that the Concatenation transformation does not have those restrictions as far as I am aware. At least, it can be forced for the same query with the same objects.&lt;br /&gt;&lt;br /&gt;I recreated the driving table using the following commands:&lt;br /&gt;&lt;pre class="brush:sql;"&gt;drop table t_driving;&lt;br /&gt;create table t_driving (&lt;br /&gt;  status char(1), &lt;br /&gt;  driving_to_inner_id int)&lt;br /&gt;partition by list(status) (&lt;br /&gt;  partition values ('A'), &lt;br /&gt;  partition values ('B'));&lt;br /&gt;insert into t_driving values ('A', 1);&lt;br /&gt;insert into t_driving values ('B', 2);&lt;br /&gt;&lt;/pre&gt;Then I ran the query below:&lt;br /&gt;&lt;pre class="brush:sql;"&gt;begin&lt;br /&gt;  for test_rec in (&lt;br /&gt;    select /*+ or_expand gather_plan_statistics no_unnest(@inner)*/&lt;br /&gt;           *&lt;br /&gt;      from t_driving&lt;br /&gt;     where (:status='B' and status = 'B' or :status='A' and status = 'A')&lt;br /&gt;       and not exists (&lt;br /&gt;             select /*+ qb_name(inner) */&lt;br /&gt;                    null&lt;br /&gt;               from t_inner&lt;br /&gt;              where id = driving_to_inner_id&lt;br /&gt;           )&lt;br /&gt;  )&lt;br /&gt;  loop &lt;br /&gt;    null;&lt;br /&gt;  end loop;&lt;br /&gt;  for plan_rec in (select * from table(dbms_xplan.display_cursor( format=&gt; 'allstats last')))&lt;br /&gt;  loop&lt;br /&gt;    dbms_output.put_line(plan_rec.plan_table_output);&lt;br /&gt;  end loop;&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;&lt;/pre&gt;That had the following execution plan:&lt;br /&gt;&lt;pre class="brush:sql;"&gt;SQL_ID  16q8nc7mcy3b0, child number 0&lt;br /&gt;-------------------------------------&lt;br /&gt;SELECT /*+ or_expand gather_plan_statistics no_unnest(@inner)*/ * FROM&lt;br /&gt;T_DRIVING WHERE (:B1 ='B' AND STATUS = 'B' OR :B1 ='A' AND STATUS =&lt;br /&gt;'A') AND NOT EXISTS ( SELECT /*+ qb_name(inner) */ NULL FROM T_INNER&lt;br /&gt;WHERE ID = DRIVING_TO_INNER_ID )&lt;br /&gt;Plan hash value: 1055582790&lt;br /&gt;-------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                 | Name            | Starts | E-Rows | A-Rows |   A-Time   | Buffers |&lt;br /&gt;-------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT          |                 |      1 |        |      1 |00:00:00.01 |      44 |&lt;br /&gt;|   1 |  VIEW                     | VW_ORE_95B37148 |      1 |      2 |      1 |00:00:00.01 |      44 |&lt;br /&gt;|   2 |   UNION-ALL               |                 |      1 |        |      1 |00:00:00.01 |      44 |&lt;br /&gt;|*  3 |    FILTER                 |                 |      1 |        |      1 |00:00:00.01 |      44 |&lt;br /&gt;|*  4 |     FILTER                |                 |      1 |        |      1 |00:00:00.01 |      37 |&lt;br /&gt;|   5 |      PARTITION LIST SINGLE|                 |      1 |      1 |      1 |00:00:00.01 |      37 |&lt;br /&gt;|   6 |       TABLE ACCESS FULL   | T_DRIVING       |      1 |      1 |      1 |00:00:00.01 |      37 |&lt;br /&gt;|*  7 |     TABLE ACCESS FULL     | T_INNER         |      1 |      1 |      0 |00:00:00.01 |       7 |&lt;br /&gt;|*  8 |    FILTER                 |                 |      1 |        |      0 |00:00:00.01 |       0 |&lt;br /&gt;|*  9 |     FILTER                |                 |      1 |        |      0 |00:00:00.01 |       0 |&lt;br /&gt;|  10 |      PARTITION LIST SINGLE|                 |      0 |      1 |      0 |00:00:00.01 |       0 |&lt;br /&gt;|* 11 |       TABLE ACCESS FULL   | T_DRIVING       |      0 |      1 |      0 |00:00:00.01 |       0 |&lt;br /&gt;|* 12 |     TABLE ACCESS FULL     | T_INNER         |      0 |      1 |      0 |00:00:00.01 |       0 |&lt;br /&gt;-------------------------------------------------------------------------------------------------------&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;3 - filter( IS NULL)&lt;br /&gt;4 - filter(:B1='B')&lt;br /&gt;7 - filter("ID"=:B1)&lt;br /&gt;8 - filter( IS NULL)&lt;br /&gt;9 - filter(:B1='A')&lt;br /&gt;11 - filter((LNNVL(:B1='B') OR LNNVL("STATUS"='B')))&lt;br /&gt;12 - filter("ID"=:B1)&lt;br /&gt;&lt;/pre&gt;Notice that there are no executions in line 10 to 12 - that is how it should be.&lt;br /&gt;&lt;br /&gt;TL;DR: a Concatenation transformation with filter subqueries may over-report actual execution statistics, so that the totals, such as Buffers, are fine, however, the plan lines related to filter sub-queries are reported as being executed and having the same execution statistics as their corresponding lines in other concatenation branches.&lt;br /&gt;Those subqueries are not really executed but just are reported as being so.&lt;br /&gt;Thankfully, the 12.2 OR-Expansion transformation is not susceptible to that issue - the execution statistics are reported back as zero for those subqueries which are not actually executed because they are eliminated in the parent filter branches.&lt;br /&gt;The code is this article has been tested against 12.2, 18.3, and 19.2.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/410010138444606110/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/05/concatenation-and-filter-subqueries.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/410010138444606110'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/410010138444606110'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/05/concatenation-and-filter-subqueries.html' title='Concatenation and filter subqueries oddity'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-7235095628687946467</id><published>2019-04-08T03:22:00.003+06:00</published><updated>2019-04-08T23:48:24.584+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-10523'/><title type='text'>PL/SQL Create or Replace Optimization</title><content type='html'>Oracle said in their Student Guide for 12c that a local user cannot utilize system privileges on a common user's schema.&lt;br /&gt;When I initially checked that preposition, I was a little bit puzzled by the following behavior:&lt;br /&gt;&lt;pre class="brush:sql;"&gt;TC@PDB&gt; create or replace procedure c##tc.p&lt;br /&gt;  2  is&lt;br /&gt;  3  begin&lt;br /&gt;  4    null;&lt;br /&gt;  5  end;&lt;br /&gt;  6  /&lt;br /&gt;&lt;br /&gt;Procedure created.&lt;br /&gt;&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; create or replace procedure c##tc.p&lt;br /&gt;  2  is&lt;br /&gt;  3  begin&lt;br /&gt;  4    null;&lt;br /&gt;  5    null; -- second null&lt;br /&gt;  6  end;&lt;br /&gt;  7  /&lt;br /&gt;create or replace procedure c##tc.p&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-01031: insufficient privileges&lt;br /&gt;&lt;/pre&gt;I drew a proper conclusion back then that Oracle generally tries to be as lazy as possible, so that if it could not do something, it would probably would not do it.&lt;br /&gt;Like in the example above, if Oracle knows that the source code is the same and all PL/SQL settings are the same, why bother? It just reports back as if the code had been compiled when actually Oracle compared the stored source and its PL/SQL settings with whatever a user supplied.&lt;br /&gt;Although it seems a sound approach, I did not have enough proves that Oracle definitely works in such a way with PL/SQL units.&lt;br /&gt;However, last week I listened to an excellent &lt;a href="https://twitter.com/brynlite?lang=en"&gt;Bryn Llewellyn&lt;/a&gt;'s one day seminar where we were discussing Edition-Based Redefinition (EBR) topics and Bryn said exactly the same thing - PL/SQL does have an optimization to not recompile stored units when the supplied code is the same (it was roughly something like that).&lt;br /&gt;It rang a bell and made me return to that issue discovered a few years ago.&lt;br /&gt;&lt;br /&gt;Let's make an initial setup and reproduce the error:&lt;br /&gt;&lt;pre class="brush:sql"&gt;SYS@CDB$ROOT&gt; conn / as sysdba&lt;br /&gt;Connected.&lt;br /&gt;&lt;br /&gt;SYS@CDB$ROOT&gt; create user c##tc identified by oracle;&lt;br /&gt;&lt;br /&gt;User created.&lt;br /&gt;&lt;br /&gt;SYS@CDB$ROOT&gt; grant connect, create procedure to c##tc container=all;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SYS@CDB$ROOT&gt;&lt;br /&gt;SYS@CDB$ROOT&gt; conn c##tc/oracle@pdb&lt;br /&gt;Connected.&lt;br /&gt;C##TC@PDB&gt;&lt;br /&gt;C##TC@PDB&gt; create or replace procedure c##tc.p&lt;br /&gt;  2  is&lt;br /&gt;  3  begin&lt;br /&gt;  4    null;&lt;br /&gt;  5  end;&lt;br /&gt;  6  /&lt;br /&gt;&lt;br /&gt;Procedure created.&lt;br /&gt;&lt;br /&gt;C##TC@PDB&gt;&lt;br /&gt;C##TC@PDB&gt; conn sys/oracle@pdb as sysdba&lt;br /&gt;Connected.&lt;br /&gt;SYS@PDB&gt;&lt;br /&gt;SYS@PDB&gt; grant alter session, connect, create any procedure to tc identified by tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SYS@PDB&gt; conn tc/tc@pdb&lt;br /&gt;Connected.&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; create or replace procedure c##tc.p&lt;br /&gt;  2  is&lt;br /&gt;  3  begin&lt;br /&gt;  4    null;&lt;br /&gt;  5  end;&lt;br /&gt;  6  /&lt;br /&gt;&lt;br /&gt;Procedure created.&lt;br /&gt;&lt;br /&gt;TC@PDB&gt;&lt;br /&gt;TC@PDB&gt; create or replace procedure c##tc.p&lt;br /&gt;  2  is&lt;br /&gt;  3  begin&lt;br /&gt;  4    null;&lt;br /&gt;  5    null; -- second null&lt;br /&gt;  6  end;&lt;br /&gt;  7  /&lt;br /&gt;create or replace procedure c##tc.p&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-01031: insufficient privileges&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;I reexecute the same create or replace statement with sql trace enabled so as to confirm that it is effectively a noop operation - Oracle does not really recompile that procedure.&lt;br /&gt;While looking into the trace file, the last executed statement is this:&lt;br /&gt;&lt;pre class="brush:sql"&gt;PARSING IN CURSOR #140098350838112 len=54 dep=1 uid=0 oct=3 lid=0 tim=228489468158 hv=696375357 ad='c49fffc0' sqlid='9gq78x8ns3q1x'&lt;br /&gt;select source from source$ where obj#=:1 order by line&lt;br /&gt;END OF STMT&lt;br /&gt;&lt;/pre&gt;Once I got this, I decided to obtain a short stack of Oracle functions to see what function in Oracle kernel causes that SQL to be executed:&lt;br /&gt;&lt;pre class="brush:sql"&gt;TC@PDB&gt; alter session set events 'sql_trace[sql:9gq78x8ns3q1x] trace("%s\n", shortstack())';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;TC@PDB&gt; create or replace procedure c##tc.p&lt;br /&gt;  2  is&lt;br /&gt;  3  begin&lt;br /&gt;  4    null;&lt;br /&gt;  5  end;&lt;br /&gt;  6  /&lt;br /&gt;&lt;br /&gt;Procedure created.&lt;br /&gt;&lt;/pre&gt;The interesting part in the trace file is below:&lt;br /&gt;&lt;pre class="brush:sql"&gt;kkscsCheckCriteria&lt;-kkscsCheckCursor&lt;-kkscsSearchChildList&lt;-kksfbc&lt;-kkspsc0&lt;-kksParseCursor&lt;-opiosq0&lt;-opiall0&lt;-opikpr&lt;-opiodr&lt;-rpidrus&lt;-skgmstack&lt;-rpiswu2&lt;-kprball&lt;-kqlsrclod&lt;-kqllod_new&lt;-kqllod&lt;-kglobld&lt;-kglobpn&lt;-kglpim&lt;-kglpin&lt;-kkx_same_src&lt;-kkpcrt&lt;-opies&lt;br /&gt;kxstGetSqlTraceLevel&lt;-kkscsCheckCriteria&lt;-kkscsCheckCursor&lt;-kkscsSearchChildList&lt;-kksfbc&lt;-kkspsc0&lt;-kksParseCursor&lt;-opiosq0&lt;-opiall0&lt;-opikpr&lt;-opiodr&lt;-rpidrus&lt;-skgmstack&lt;-rpiswu2&lt;-kprball&lt;-kqlsrclod&lt;-kqllod_new&lt;-kqllod&lt;-kglobld&lt;-kglobpn&lt;-kglpim&lt;-kglpin&lt;-kkx_s&lt;br /&gt;opiexe&lt;-opiall0&lt;-opikpr&lt;-opiodr&lt;-rpidrus&lt;-skgmstack&lt;-rpiswu2&lt;-kprball&lt;-kqlsrclod&lt;-kqllod_new&lt;-kqllod&lt;-kglobld&lt;-kglobpn&lt;-kglpim&lt;-kglpin&lt;-kkx_same_src&lt;-kkpcrt&lt;-opiexe&lt;-opiosq0&lt;-kpoal8&lt;-opiodr&lt;-ttcpip&lt;-opitsk&lt;-opiino&lt;-opiodr&lt;-opidrv&lt;-sou2o&lt;-opimai_real&lt;-ssthrs&lt;br /&gt;kxstGetSqlTraceLevel&lt;-opiexe&lt;-opiall0&lt;-opikpr&lt;-opiodr&lt;-rpidrus&lt;-skgmstack&lt;-rpiswu2&lt;-kprball&lt;-kqlsrclod&lt;-kqllod_new&lt;-kqllod&lt;-kglobld&lt;-kglobpn&lt;-kglpim&lt;-kglpin&lt;-kkx_same_src&lt;-kkpcrt&lt;-opiexe&lt;-opiosq0&lt;-kpoal8&lt;-opiodr&lt;-ttcpip&lt;-opitsk&lt;-opiino&lt;-opiodr&lt;-opidrv&lt;-sous&lt;br /&gt;&lt;/pre&gt;Notice that sequence: kkpcrt -&gt; kkx_same_src I was quite curious about that kkx_same_src as it looked like an explanation of that fictional compilation, so I just disassembled it and found these two assembler instructions below in the output: &lt;pre class="brush:sql"&gt;gdb $ORACLE_HOME/bin/oracle&lt;br /&gt;GNU gdb (GDB) Red Hat Enterprise Linux 7.6.1-114.el7&lt;br /&gt;Copyright (C) 2013 Free Software Foundation, Inc.&lt;br /&gt;License GPLv3+: GNU GPL version 3 or later &amp;lt;http://gnu.org/licenses/gpl.html&amp;gt;&lt;br /&gt;This is free software: you are free to change and redistribute it.&lt;br /&gt;There is NO WARRANTY, to the extent permitted by law.  Type "show copying"&lt;br /&gt;and "show warranty" for details.&lt;br /&gt;This GDB was configured as "x86_64-redhat-linux-gnu".&lt;br /&gt;For bug reporting instructions, please see:&lt;br /&gt;&amp;lt;http://www.gnu.org/software/gdb/bugs/&amp;gt;...&lt;br /&gt;Reading symbols from /u01/app/oracle/product/12.1.0/dbhome_1/bin/oracle...(no debugging symbols found)...done.&lt;br /&gt;(gdb) disassemble kkx_same_src&lt;br /&gt;Dump of assembler code for function kkx_same_src:&lt;br /&gt;... skip ...&lt;br /&gt;   0x0000000002b8703f &lt;+479&gt;:   mov    $0x291b,%edi&lt;br /&gt;   0x0000000002b87044 &lt;+484&gt;:   callq  0xceafa20 &amp;lt;dbkdchkeventrdbmserr&amp;gt;&lt;br /&gt;&lt;/pre&gt;There is an event 0x291b that can influence that function! Let's try this out: &lt;pre class="brush:sql"&gt;TC@PDB&gt; alter session set events '0x291b level 1';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;TC@PDB&gt; create or replace procedure c##tc.p&lt;br /&gt;  2  is&lt;br /&gt;  3  begin&lt;br /&gt;  4    null;&lt;br /&gt;  5  end;&lt;br /&gt;  6  /&lt;br /&gt;create or replace procedure c##tc.p&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-01031: insufficient privileges&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;TC@PDB&gt; alter session set events '0x291b off';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;TC@PDB&gt; create or replace procedure c##tc.p&lt;br /&gt;  2  is&lt;br /&gt;  3  begin&lt;br /&gt;  4    null;&lt;br /&gt;  5  end;&lt;br /&gt;  6  /&lt;br /&gt;&lt;br /&gt;Procedure created.&lt;br /&gt;&lt;/pre&gt;Indeed, it does effect the execution. The next step is to find out what this event is: &lt;pre class="brush:sql"&gt;[oracle@localhost ~]$ echo 'ibase=16;291B' | bc&lt;br /&gt;10523&lt;br /&gt;[oracle@localhost ~]$ oerr ora 10523&lt;br /&gt;10523, 00000, "force recreate package even if definition is unchanged"&lt;br /&gt;// *Cause:&lt;br /&gt;// *Action:  Set this event only under the supervision of Oracle development&lt;br /&gt;// *Comment: Changes behaviour of create or replace package, procedure,&lt;br /&gt;//           function or type to force recreation of the object even if its new&lt;br /&gt;//           definition exactly matches the old definition.&lt;br /&gt;//           No level number required.&lt;br /&gt;&lt;/pre&gt;That event was the last missing piece in this puzzle.&lt;br /&gt;&lt;br /&gt;TL;DR: as any good software, Oracle tries to do as little work as possible - this is a laziness in its good sense.&lt;br /&gt;After all, the fastest way to do something is to not do it at all.&lt;br /&gt;That what happens here - if there is no need to compile a PL/SQL unit, Oracle can identify it and report back to the user that the PL/SQL has been compiled when really it was not. That optimization is controlled by event 10523.&lt;br /&gt;However, it kicks in early, before other Multitenant related checks, namely Oracle does not check whether a local user actually can compile a stored PL/SQL unit in a common schema.&lt;br /&gt;I believe that is a bug as there should be an ORA-1031 error in the first place, even when the source is the same.&lt;br /&gt;Everything said is applicable only to 12.1.0.2 on which it has been tested.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/7235095628687946467/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/04/plsql-create-or-replace-optimization.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7235095628687946467'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7235095628687946467'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/04/plsql-create-or-replace-optimization.html' title='PL/SQL Create or Replace Optimization'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-5636302189807888335</id><published>2019-03-30T23:40:00.000+06:00</published><updated>2019-03-30T23:40:36.707+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='wget'/><title type='text'>wget one liners to download data from *.oracle.com without human intervention</title><content type='html'>When the topic of downloading Oracle software comes up, there is a common misconception that it requires a human intervention to accept the license terms.&lt;br /&gt;Here are wget commands that I use to download data from Oracle sites, such as edelivery.oracle.com, download.oracle.com, and support.oracle.com:&lt;br /&gt;&lt;pre class="brush:bash"&gt;wget \&lt;br /&gt;  --user "&amp;lt;oracleaccount&amp;gt;" \&lt;br /&gt;  --ask-password \&lt;br /&gt;  --load-cookies &amp;lt;(printf '.oracle.com\tTRUE\t/\tFALSE\t0\toraclelicense\taccept-securebackup-cookie') \&lt;br /&gt;  "&amp;lt;https_downloadlink&gt;"&lt;br /&gt;&lt;/pre&gt;Or its fully automatic version:&lt;br /&gt;&lt;pre class="brush:bash"&gt;wget \&lt;br /&gt;  --user "&amp;lt;oracleaccount&amp;gt;" \&lt;br /&gt;  --password "&amp;lt;password&gt;" \&lt;br /&gt;  --load-cookies &amp;lt;(printf '.oracle.com\tTRUE\t/\tFALSE\t0\toraclelicense\taccept-securebackup-cookie') \&lt;br /&gt;  "&amp;lt;https_downloadlink&gt;"&lt;br /&gt;&lt;/pre&gt;It has been tested against all of those sites and works fine as of now.&lt;br /&gt;A few examples are below.&lt;br /&gt;edelivery.oracle.com:&lt;br /&gt;&lt;pre class="brush:bash"&gt;wget \&lt;br /&gt;  --user "&amp;lt;oracleaccount&gt;" \&lt;br /&gt;  --ask-password \&lt;br /&gt;  --load-cookies &lt;(printf '.oracle.com\tTRUE\t/\tFALSE\t0\toraclelicense\taccept-securebackup-cookie') \&lt;br /&gt;  "https://edelivery.oracle.com/akam/otn/linux/oracle18c/xe/oracle-database-xe-18c-1.0-1.x86_64.rpm"&lt;br /&gt;&lt;/pre&gt;download.oracle.com: &lt;pre class="brush:bash"&gt;wget \&lt;br /&gt;  --user "&amp;lt;oracleaccount&gt;" \&lt;br /&gt;  --ask-password \&lt;br /&gt;  --load-cookies &lt;(printf '.oracle.com\tTRUE\t/\tFALSE\t0\toraclelicense\taccept-securebackup-cookie') \&lt;br /&gt;  "https://download.oracle.com/otn/linux/oracle18c/xe/oracle-database-xe-18c-1.0-1.x86_64.rpm"&lt;br /&gt;&lt;/pre&gt;support.oracle.com - this one does not require the cookie: &lt;pre class="brush:bash"&gt;wget \&lt;br /&gt;  --user "&amp;lt;oracleaccount" \&lt;br /&gt;  --ask-password \&lt;br /&gt;  "https://updates.oracle.com/Orion/Services/download/p6880880_180000_Linux-x86-64.zip?aru=22569537&amp;patch_file=p6880880_180000_Linux-x86-64.zip"&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/5636302189807888335/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/03/wget-one-liners-to-download-data-from.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5636302189807888335'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5636302189807888335'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/03/wget-one-liners-to-download-data-from.html' title='wget one liners to download data from *.oracle.com without human intervention'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-7040878769413542272</id><published>2019-03-17T23:55:00.000+06:00</published><updated>2019-03-17T23:55:45.051+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><title type='text'>Bitmap Conversion to Rowids with Global Indexes</title><content type='html'>While working with developers on optimizing a query, I discovered a limitation of the "BITMAP AND" operation.&lt;br /&gt;Here is an example demonstrating the issue:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[28]"&gt;SQL&gt; create table t(&lt;br /&gt;  2    part_col int,&lt;br /&gt;  3    a int,&lt;br /&gt;  4    b int)&lt;br /&gt;  5  partition by list(part_col) (&lt;br /&gt;  6    partition values (0)&lt;br /&gt;  7  )&lt;br /&gt;  8  ;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; exec dbms_stats.gather_table_stats('', 't')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create index t_a_i on t(a);&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;br /&gt;SQL&gt; create index t_b_i on t(b) local;&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; explain plan for&lt;br /&gt;  2  select /*+ bitmap_tree(t and((a) (b)))*/&lt;br /&gt;  3         *&lt;br /&gt;  4    from t&lt;br /&gt;  5   where a = :1&lt;br /&gt;  6     and b = :2;&lt;br /&gt;&lt;br /&gt;Explained.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from table(dbms_xplan.display);&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;-----------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 1636314338&lt;br /&gt;&lt;br /&gt;--------------------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                                  | Name  | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |&lt;br /&gt;--------------------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT                           |       |     1 |    39 |     1   (0)| 00:00:01 |       |       |&lt;br /&gt;|*  1 |  TABLE ACCESS BY GLOBAL INDEX ROWID BATCHED| T     |     1 |    39 |     1   (0)| 00:00:01 |     1 |     1 |&lt;br /&gt;|*  2 |   INDEX RANGE SCAN                         | T_A_I |     1 |       |     1   (0)| 00:00:01 |       |       |&lt;br /&gt;--------------------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   1 - filter("B"=TO_NUMBER(:2))&lt;br /&gt;   2 - access("A"=TO_NUMBER(:1))&lt;br /&gt;&lt;br /&gt;15 rows selected.&lt;br /&gt;&lt;/pre&gt;Surprisingly, the plan shows just one INDEX RANGE SCAN operation and the expected BITMAP AND did not happen.&lt;br /&gt;Let us see what we get once we make both indexes local:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[41]"&gt;SQL&gt; drop index t_a_i;&lt;br /&gt;&lt;br /&gt;Index dropped.&lt;br /&gt;&lt;br /&gt;SQL&gt; drop index t_b_i;&lt;br /&gt;&lt;br /&gt;Index dropped.&lt;br /&gt;&lt;br /&gt;SQL&gt; create index t_a_i on t(a) local;&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;br /&gt;SQL&gt; create index t_b_i on t(b) local;&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; explain plan for&lt;br /&gt;  2  select /*+ bitmap_tree(t and((a) (b)))*/&lt;br /&gt;  3         *&lt;br /&gt;  4    from t&lt;br /&gt;  5   where a = :1&lt;br /&gt;  6     and b = :2;&lt;br /&gt;&lt;br /&gt;Explained.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from table(dbms_xplan.display);&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;-----------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 3534803727&lt;br /&gt;&lt;br /&gt;--------------------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                                  | Name  | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |&lt;br /&gt;--------------------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT                           |       |     1 |    39 |     3   (0)| 00:00:01 |       |       |&lt;br /&gt;|   1 |  PARTITION LIST SINGLE                     |       |     1 |    39 |     3   (0)| 00:00:01 |     1 |     1 |&lt;br /&gt;|   2 |   TABLE ACCESS BY LOCAL INDEX ROWID BATCHED| T     |     1 |    39 |     3   (0)| 00:00:01 |     1 |     1 |&lt;br /&gt;|   3 |    BITMAP CONVERSION TO ROWIDS             |       |       |       |            |          |       |       |&lt;br /&gt;|   4 |     BITMAP AND                             |       |       |       |            |          |       |       |&lt;br /&gt;|   5 |      BITMAP CONVERSION FROM ROWIDS         |       |       |       |            |          |       |       |&lt;br /&gt;|*  6 |       INDEX RANGE SCAN                     | T_A_I |       |       |     1   (0)| 00:00:01 |     1 |     1 |&lt;br /&gt;|   7 |      BITMAP CONVERSION FROM ROWIDS         |       |       |       |            |          |       |       |&lt;br /&gt;|*  8 |       INDEX RANGE SCAN                     | T_B_I |       |       |     1   (0)| 00:00:01 |     1 |     1 |&lt;br /&gt;--------------------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   6 - access("A"=TO_NUMBER(:1))&lt;br /&gt;   8 - access("B"=TO_NUMBER(:2))&lt;br /&gt;&lt;br /&gt;21 rows selected.&lt;br /&gt;&lt;/pre&gt;Here it is. Once I made both indexes local, the "BITMAP AND" operation showed up.&lt;br /&gt;Initially, I thought that it might have been related to different rowid's formats used for global and local indexes.&lt;br /&gt;I just inserted one row to the table and dumped the leaf block for the global and local indexes:&lt;br /&gt;&lt;pre class="brush:sql"&gt;$ grep 'col ' global.trc local.trc&lt;br /&gt;global.trc:col 0; len 2; (2):  c1 02&lt;br /&gt;global.trc:col 1; len 10; (10):  00 01 67 82 02 80 13 69 00 00&lt;br /&gt;local.trc:col 0; len 2; (2):  c1 02&lt;br /&gt;local.trc:col 1; len 6; (6):  02 80 13 69 00 00&lt;br /&gt;&lt;/pre&gt;You see that 'col 1' for the local index has a rowid in it: "len 6; (6):  &lt;b&gt;02 80 13 69 00 00&lt;/b&gt;", &lt;br /&gt;whereas the corresponding column for the global index has 10 bytes in length: "len 10; (10):  00 01 67 82 &lt;b&gt;02 80 13 69 00 00&lt;/b&gt;"&lt;br /&gt;In which the leading 4 bytes refer to the object id.&lt;br /&gt;I also performed additional tests trying all possible combinations of indexes T_A_I and T_B_I making them global or local.&lt;br /&gt;The only case when I was getting a "BITMAP AND" was the case when both indexes were local.&lt;br /&gt;Changing the hint to INDEX_COMBINE has not changed anything.&lt;br /&gt;&lt;br /&gt;Having gathered all of those results, I searched My Oracle Support (MOS) and found the explanation:&lt;br /&gt;&lt;a href="support.oracle.com/rs?type=bug&amp;id=8787683"&gt;Bug 8787683 : SUPPORT GLOBAL BITMAP INDEXES AND BITMAP CONVERSION ON GLOBAL BTREE INDEXES&lt;/a&gt;&lt;br /&gt;There is, indeed, the enhancement request raised in 2009.&lt;br /&gt;&lt;br /&gt;The source query was rewritten to combine both indexes early and use filtered rowids to access the base table:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[35]"&gt;SQL&gt; explain plan for&lt;br /&gt;  2  select /*+ unnest(@subq) no_use_hash_aggregation(@subq)*/&lt;br /&gt;  3         *&lt;br /&gt;  4    from t&lt;br /&gt;  5   where rowid in (&lt;br /&gt;  6           select /*+ qb_name(subq)*/&lt;br /&gt;  7                  rid&lt;br /&gt;  8             from (select rowid rid&lt;br /&gt;  9                     from t&lt;br /&gt; 10                    where a = :1&lt;br /&gt; 11                    union all&lt;br /&gt; 12                   select rowid&lt;br /&gt; 13                     from t&lt;br /&gt; 14                    where b = :2)&lt;br /&gt; 15            group by rid&lt;br /&gt; 16            having count(*)=2)&lt;br /&gt; 17  ;&lt;br /&gt;&lt;br /&gt;Explained.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select * from table(dbms_xplan.display);&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;-----------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 4066617294&lt;br /&gt;&lt;br /&gt;--------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                   | Name     | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |&lt;br /&gt;--------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT            |          |     1 |    63 |     5  (40)| 00:00:01 |       |       |&lt;br /&gt;|   1 |  NESTED LOOPS               |          |     1 |    63 |     5  (40)| 00:00:01 |       |       |&lt;br /&gt;|   2 |   VIEW                      | VW_NSO_1 |     2 |    24 |     3  (34)| 00:00:01 |       |       |&lt;br /&gt;|*  3 |    FILTER                   |          |       |       |            |          |       |       |&lt;br /&gt;|   4 |     SORT GROUP BY           |          |     1 |    24 |     3  (34)| 00:00:01 |       |       |&lt;br /&gt;|   5 |      VIEW                   |          |     2 |    24 |     2   (0)| 00:00:01 |       |       |&lt;br /&gt;|   6 |       UNION-ALL             |          |       |       |            |          |       |       |&lt;br /&gt;|*  7 |        INDEX RANGE SCAN     | T_A_I    |     1 |    25 |     1   (0)| 00:00:01 |       |       |&lt;br /&gt;|   8 |        PARTITION LIST SINGLE|          |     1 |    25 |     1   (0)| 00:00:01 |     1 |     1 |&lt;br /&gt;|*  9 |         INDEX RANGE SCAN    | T_B_I    |     1 |    25 |     1   (0)| 00:00:01 |     1 |     1 |&lt;br /&gt;|  10 |   TABLE ACCESS BY USER ROWID| T        |     1 |    51 |     1   (0)| 00:00:01 |     1 |     1 |&lt;br /&gt;--------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   3 - filter(COUNT(*)=2)&lt;br /&gt;   7 - access("A"=TO_NUMBER(:1))&lt;br /&gt;   9 - access("B"=TO_NUMBER(:2))&lt;br /&gt;&lt;/pre&gt;Notice the "SORT GROUP BY" operation in line 4 - it guarantees that the set of ROWIDs will be sorted, so that we will never return to a block that was previously visited once we switched to another.&lt;br /&gt;&lt;br /&gt;&lt;b&gt;TL;DR&lt;/b&gt;: the "BITMAP AND" operation has some restrictions when Global indexes are involved: &lt;a href="support.oracle.com/rs?type=bug&amp;id=8787683"&gt;Bug 8787683 : SUPPORT GLOBAL BITMAP INDEXES AND BITMAP CONVERSION ON GLOBAL BTREE INDEXES&lt;/a&gt;&lt;br /&gt;The code was tested against 12.1.0.2 and 19c available on &lt;a href="https://livesql.oracle.com"&gt;https://livesql.oracle.com&lt;/a&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/7040878769413542272/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/03/bitmap-conversion-to-rowids-with-global.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7040878769413542272'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7040878769413542272'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/03/bitmap-conversion-to-rowids-with-global.html' title='Bitmap Conversion to Rowids with Global Indexes'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-837180508101854492</id><published>2019-02-25T04:25:00.000+06:00</published><updated>2019-02-25T04:27:38.586+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><category scheme='http://www.blogger.com/atom/ns#' term='wrong_results'/><title type='text'>Index full scan min/max scans returning wrong results on partitioned tables</title><content type='html'>A developer has recently shown me an interesting wrong results issue in one of our 12.1.0.2 databases.&lt;br /&gt;Having investigated it, I identified the root cause of that issue and constructed a simple test case that can be used to reproduce it.&lt;br /&gt;Let's setup some sample data - a list-partitioned table with just two rows and a global index:&lt;br /&gt;&lt;pre class="brush:sql;"&gt;SQL&gt; create table t (&lt;br /&gt;  2    id,&lt;br /&gt;  3    part_key,&lt;br /&gt;  4    constraint t_pk primary key(id))&lt;br /&gt;  5  partition by list(part_key) (&lt;br /&gt;  6    partition values ('KEY1'),&lt;br /&gt;  7    partition values ('KEY2'))&lt;br /&gt;  8  as&lt;br /&gt;  9  select 1, 'KEY1' from dual union all&lt;br /&gt; 10  select 2, 'KEY2' from dual;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; col part_key for a8&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from t;&lt;br /&gt;&lt;br /&gt;        ID PART_KEY&lt;br /&gt;---------- --------&lt;br /&gt;         1 KEY1&lt;br /&gt;         2 KEY2&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Here are queries returning wrong results:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[7,15];"&gt;SQL&gt; select max(id)&lt;br /&gt;  2    from t&lt;br /&gt;  3   where part_key = 'KEY1';&lt;br /&gt;&lt;br /&gt;   MAX(ID)&lt;br /&gt;----------&lt;br /&gt;         2&lt;br /&gt;&lt;br /&gt;SQL&gt; select min(id)&lt;br /&gt;  2    from t&lt;br /&gt;  3   where part_key = 'KEY2';&lt;br /&gt;&lt;br /&gt;   MIN(ID)&lt;br /&gt;----------&lt;br /&gt;         1&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;They should have returned 1 and 2 correspondingly. Things definitely went awry.&lt;br /&gt;In such a scenario, I always try to figure out how exactly the optimizer comes up with the result.&lt;br /&gt;The execution plan is a good place to start:&lt;br /&gt;&lt;pre class="brush:sql;"&gt;SQL&gt; select * from table(dbms_xplan.display);&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;-----------------------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 2094033419&lt;br /&gt;&lt;br /&gt;-----------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                  | Name | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;-----------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT           |      |     1 |    19 |     2   (0)| 00:00:01 |&lt;br /&gt;|   1 |  SORT AGGREGATE            |      |     1 |    19 |            |          |&lt;br /&gt;|   2 |   INDEX FULL SCAN (MIN/MAX)| T_PK |     1 |    19 |            |          |&lt;br /&gt;-----------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Note&lt;br /&gt;-----&lt;br /&gt;   - dynamic statistics used: dynamic sampling (level=2)&lt;br /&gt;&lt;br /&gt;13 rows selected.&lt;br /&gt;&lt;/pre&gt;Aha! There is no way for the optimizer to answer that query by using that execution plan.&lt;br /&gt;Where is the PART_KEY predicate? It seems to have been completely lost there.&lt;br /&gt;A quick search on MOS got me a candidate issue: &lt;a href="support.oracle.com/rs?type=doc&amp;id=22913528.8"&gt;Bug 22913528 - wrong results with partition pruning and min/max scans (Doc ID 22913528.8)&lt;/a&gt;&lt;br /&gt;That document mentions a workaround which I successfully implemented:&lt;br /&gt;&lt;pre class="brush:sql;"&gt;SQL&gt; select /*+ opt_param('_fix_control' '16346018:0')*/&lt;br /&gt;  2         max(id)&lt;br /&gt;  3    from t&lt;br /&gt;  4   where part_key = 'KEY1';&lt;br /&gt;&lt;br /&gt;   MAX(ID)&lt;br /&gt;----------&lt;br /&gt;         1&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;&lt;/pre&gt;The plan of that query is below:&lt;br /&gt;&lt;pre class="brush:sql;highlight:[12,13];"&gt;SQL&gt; select * from table(dbms_xplan.display);&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;-----------------------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 2831600127&lt;br /&gt;&lt;br /&gt;-----------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation              | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |&lt;br /&gt;-----------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT       |      |     1 |    19 |     2   (0)| 00:00:01 |       |       |&lt;br /&gt;|   1 |  SORT AGGREGATE        |      |     1 |    19 |            |          |       |       |&lt;br /&gt;|   2 |   PARTITION LIST SINGLE|      |     1 |    19 |     2   (0)| 00:00:01 |     1 |     1 |&lt;br /&gt;|   3 |    TABLE ACCESS FULL   | T    |     1 |    19 |     2   (0)| 00:00:01 |     1 |     1 |&lt;br /&gt;-----------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Note&lt;br /&gt;-----&lt;br /&gt;   - dynamic statistics used: dynamic sampling (level=2)&lt;br /&gt;&lt;br /&gt;14 rows selected.&lt;br /&gt;&lt;/pre&gt;The MOS document says that this issue has been fixed in the 12.1.0.2.190115 (Jan 2019) Database Proactive Bundle Patch.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/837180508101854492/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2019/02/a-developer-has-recently-shown-me.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/837180508101854492'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/837180508101854492'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2019/02/a-developer-has-recently-shown-me.html' title='Index full scan min/max scans returning wrong results on partitioned tables'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8852348693025227991</id><published>2017-04-30T17:43:00.001+06:00</published><updated>2017-04-30T17:43:36.088+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-38301'/><title type='text'>Asynchronous Global Index Maintenance and Recycle Bin</title><content type='html'>Got Oracle error ORA-38301: "can not perform DDL/DML over objects in Recycle Bin" in an alert.log: &lt;pre class="brush:sql;highlight:[2];"&gt;&lt;br /&gt;ORCL(3):Errors in file /u01/app/oracle/diag/rdbms/orcl12c/orcl12c/trace/orcl12c_j000_10274.trc:&lt;br /&gt;ORA-12012: error on auto execute of job "SYS"."PMO_DEFERRED_GIDX_MAINT_JOB"&lt;br /&gt;ORA-38301: can not perform DDL/DML over objects in Recycle Bin&lt;br /&gt;ORA-06512: at "SYS.DBMS_PART", line 131&lt;br /&gt;ORA-06512: at "SYS.DBMS_PART", line 131&lt;br /&gt;ORA-06512: at "SYS.DBMS_PART", line 120&lt;br /&gt;ORA-06512: at line 1&lt;br /&gt;&lt;/pre&gt;The highlighted line indicates that the error relates to the automatic scheduler job SYS.PMO_DEFERRED_GIDX_MAINT_JOB, which was introduced in the Oracle database 12.1 release.&lt;br/&gt;It is responsible for cleaning up indexes after drop/truncate operations: &lt;a href="http://docs.oracle.com/database/122/VLDBG/maintenance-partition-can-be-performed.htm#VLDBG1192"&gt;link&lt;/a&gt;.&lt;br/&gt;I delved into the issue and found that the job SYS.PMO_DEFERRED_GIDX_MAINT_JOB did not ignore objects in the Recycle Bin.&lt;br/&gt;Here is a short test case to demonstrate that: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt; select banner from v$version;&lt;br /&gt;&lt;br /&gt;BANNER&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Oracle Database 12c Enterprise Edition Release 12.2.0.1.0 - 64bit Production&lt;br /&gt;PL/SQL Release 12.2.0.1.0 - Production&lt;br /&gt;CORE    12.2.0.1.0      Production&lt;br /&gt;TNS for Linux: Version 12.2.0.1.0 - Production&lt;br /&gt;NLSRTL Version 12.2.0.1.0 - Production&lt;br /&gt;&lt;br /&gt;SQL&gt; create table t(x)&lt;br /&gt;  2  partition by range(x)&lt;br /&gt;  3  (&lt;br /&gt;  4    partition values less than(maxvalue)&lt;br /&gt;  5  )&lt;br /&gt;  6  as&lt;br /&gt;  7  select 1&lt;br /&gt;  8    from dual;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; create index t_i on t(x);&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; alter table t truncate partition for(1) update indexes;&lt;br /&gt;&lt;br /&gt;Table truncated.&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; select status, orphaned_entries&lt;br /&gt;  2    from ind&lt;br /&gt;  3   where index_name = 'T_I';&lt;br /&gt;&lt;br /&gt;STATUS   ORP&lt;br /&gt;-------- ---&lt;br /&gt;VALID    YES&lt;br /&gt;&lt;br /&gt;SQL&gt;&lt;br /&gt;SQL&gt; drop table t;&lt;br /&gt;&lt;br /&gt;Table dropped.&lt;br /&gt;&lt;/pre&gt;Now I run the job SYS.PMO_DEFERRED_GIDX_MAINT_JOB manually as if it was running automatically: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt; select run_count, failure_count, state from user_scheduler_jobs where job_name='PMO_DEFERRED_GIDX_MAINT_JOB';&lt;br /&gt;&lt;br /&gt; RUN_COUNT FAILURE_COUNT STATE&lt;br /&gt;---------- ------------- --------------------&lt;br /&gt;         4             0 SCHEDULED&lt;br /&gt;&lt;br /&gt;SQL&gt;  exec dbms_scheduler.run_job( 'PMO_DEFERRED_GIDX_MAINT_JOB', false)&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt;  select run_count, failure_count, state from user_scheduler_jobs where job_name='PMO_DEFERRED_GIDX_MAINT_JOB';&lt;br /&gt;&lt;br /&gt; RUN_COUNT FAILURE_COUNT STATE&lt;br /&gt;---------- ------------- --------------------&lt;br /&gt;         5             1 SCHEDULED&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;The job SYS.PMO_DEFERRED_GIDX_MAINT_JOB calls the DBMS_PART.CLEANUP_GIDX_INTERNAL procedure.&lt;br/&gt;  The same ORA-38301 error can be raised if I call the DBMS_PART.CLEANUP_GIDX procedure: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt; exec DBMS_PART.CLEANUP_GIDX (user)&lt;br /&gt;BEGIN DBMS_PART.CLEANUP_GIDX (user); END;&lt;br /&gt;&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-38301: can not perform DDL/DML over objects in Recycle Bin&lt;br /&gt;ORA-06512: at "SYS.DBMS_PART", line 131&lt;br /&gt;ORA-06512: at "SYS.DBMS_PART", line 131&lt;br /&gt;ORA-06512: at "SYS.DBMS_PART", line 120&lt;br /&gt;ORA-06512: at "SYS.DBMS_PART", line 193&lt;br /&gt;ORA-06512: at line 1&lt;br /&gt;&lt;/pre&gt;The problem here is that the automatic job stops further processing on any error.&lt;br/&gt;It means that we may end up having lots of indexes requiring cleanup that are not processed automatically and have to undergone manual actions to reset their state.&lt;br/&gt;&lt;br/&gt; &lt;b&gt;tl;dr.&lt;/b&gt; Although the Asynchronous Global Index Maintenance feature is quite useful and can greatly speedup the partition maintenance operations TRUNCATE PARTITION and DROP PARTITION, it still does not ignore objects in the Recycle Bin.&lt;br/&gt;Therefore, the automatic maintenance job PMO_DEFERRED_GIDX_MAINT_JOB may fail and does not process all of the indexes that require cleanup.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/8852348693025227991/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2017/04/asynchronous-global-index-maintenance.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8852348693025227991'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8852348693025227991'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2017/04/asynchronous-global-index-maintenance.html' title='Asynchronous Global Index Maintenance and Recycle Bin'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-4058094666631398452</id><published>2017-03-15T09:08:00.000+06:00</published><updated>2017-03-15T09:10:37.990+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><title type='text'>SQL*Plus 12.2 and searching path of login.sql</title><content type='html'>Having installed Oracle Database 12.2 on a client, I have noticed that the login.sql script, which is placed in a custom directory specified by SQLPATH, is not invoked anymore.&lt;br/&gt;Here is my login.sql: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;[oracle@localhost]$ cat /tmp/sqlpath/login.sql &lt;br /&gt;select 'login.sql invoked' output &lt;br /&gt;  from dual;&lt;br /&gt;&lt;/pre&gt;The login.sql script is not invoked when I connect through SQL*Plus 12.2 despite the fact the SQLPATH environment variable is set: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;[oracle@localhost]$ export SQLPATH=/tmp/sqlpath&lt;br /&gt;[oracle@localhost]$ sqlplus tc/tc@ora12&lt;br /&gt;&lt;br /&gt;SQL*Plus: Release 12.2.0.1.0 Production on Wed Mar 15 09:20:52 2017&lt;br /&gt;&lt;br /&gt;Copyright (c) 1982, 2016, Oracle.  All rights reserved.&lt;br /&gt;&lt;br /&gt;Last Successful login time: Wed Mar 15 2017 09:16:06 +07:00&lt;br /&gt;&lt;br /&gt;Connected to:&lt;br /&gt;Oracle Database 12c Enterprise Edition Release 12.1.0.2.0 - 64bit Production&lt;br /&gt;With the Partitioning, Automatic Storage Management, OLAP, Advanced Analytics,&lt;br /&gt;Real Application Testing and Unified Auditing options&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;This issue is documented in &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=2241021.1"&gt;SQL*Plus 12.2.0.1.0 Change in Behavior for Search Path of Login.sql (SQL*Plus User Profile Script) (Doc ID 2241021.1)&lt;/a&gt;.&lt;br/&gt;Unsurprisignly, if I set ORACLE_PATH, then login.sql is invoked: &lt;pre class="brush:sql;highlight:[1,17,18,19];"&gt;&lt;br /&gt;[oracle@localhost]$ export ORACLE_PATH=$SQLPATH&lt;br /&gt;[oracle@localhost]$ unset SQLPATH&lt;br /&gt;[oracle@localhost]$ sqlplus tc/tc@ora12&lt;br /&gt;&lt;br /&gt;SQL*Plus: Release 12.2.0.1.0 Production on Wed Mar 15 09:21:13 2017&lt;br /&gt;&lt;br /&gt;Copyright (c) 1982, 2016, Oracle.  All rights reserved.&lt;br /&gt;&lt;br /&gt;Last Successful login time: Wed Mar 15 2017 09:20:52 +07:00&lt;br /&gt;&lt;br /&gt;Connected to:&lt;br /&gt;Oracle Database 12c Enterprise Edition Release 12.1.0.2.0 - 64bit Production&lt;br /&gt;With the Partitioning, Automatic Storage Management, OLAP, Advanced Analytics,&lt;br /&gt;Real Application Testing and Unified Auditing options&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;OUTPUT&lt;br /&gt;---------------------------------------------------&lt;br /&gt;login.sql invoked&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;The MOS note also contains information that this new behaviour may influence earlier releases when the PSU or CI are released for them.&lt;br/&gt;I have no idea why Oracle has changed the existing functionality with login.sql, but that is definitely something to keep in mind in case you are going to upgrade to a new release.&lt;br/&gt;Interestingly, SQLcl still honor SQLPATH even when both SQLPATH and ORACLE_PATH are set: &lt;pre class="brush:sql;highlight:[7,8,21,23];"&gt;&lt;br /&gt;[oracle@localhost]$ cat /tmp/sqlpath/login.sql&lt;br /&gt;select 'login.sql invoked' output &lt;br /&gt;  from dual;&lt;br /&gt;[oracle@localhost]$ cat /tmp/oracle_path/login.sql&lt;br /&gt;select 'oracle_path invoked'&lt;br /&gt;  from dual;&lt;br /&gt;[oracle@localhost]$ export ORACLE_PATH=/tmp/oracle_path&lt;br /&gt;[oracle@localhost]$ export SQLPATH=/tmp/sqlpath&lt;br /&gt;[oracle@localhost]$ ./sql tc/tc@ora12&lt;br /&gt;&lt;br /&gt;SQLcl: Release 12.2.0.1.0 RC on Ср мар 15 09:42:08 2017&lt;br /&gt;&lt;br /&gt;Copyright (c) 1982, 2017, Oracle.  All rights reserved.&lt;br /&gt;&lt;br /&gt;Connected to:&lt;br /&gt;Oracle Database 12c Enterprise Edition Release 12.1.0.2.0 - 64bit Production&lt;br /&gt;With the Partitioning, Automatic Storage Management, OLAP, Advanced Analytics,&lt;br /&gt;Real Application Testing and Unified Auditing options&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;OUTPUT           &lt;br /&gt;-----------------&lt;br /&gt;login.sql invoked&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/4058094666631398452/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2017/03/sqlplus-122-and-searching-path-of.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4058094666631398452'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4058094666631398452'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2017/03/sqlplus-122-and-searching-path-of.html' title='SQL*Plus 12.2 and searching path of login.sql'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-3462818420315692756</id><published>2017-02-16T11:03:00.000+06:00</published><updated>2017-02-16T11:03:08.805+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='ADG'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><title type='text'>ORA-3180 on Active Data Guard standby database</title><content type='html'>Got a call asking me to provide advice on the cause of ORA-3180 error on an Active Data Guard standby database instance: &lt;pre class="brush:sql;highlight:[6];"&gt;&lt;br /&gt;SQL&gt; explain plan for select * from dual;&lt;br /&gt;explain plan for select * from dual&lt;br /&gt;                        *&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-00604: error occurred at recursive SQL level 1&lt;br /&gt;ORA-03180: Sequence values cannot be allocated for Oracle Active Data Guard standby.&lt;br /&gt;&lt;/pre&gt;It is a documented fact that sequences can be used within an Oracle Active Data Guard physical standby database: &lt;a href="http://docs.oracle.com/database/121/SBYDB/manage_ps.htm#SBYDB5164"&gt;Using Sequences in Oracle Active Data Guard&lt;/a&gt;.&lt;br/&gt;I have not found whether the algorithm used to identify the primary database is documented either on MOS or in the documentation.&lt;br/&gt;I have been tinkering around with the issue for a while, so this blog post is about my findings.&lt;br/&gt;First, the most useful source of information about this error is the server process trace file. Here is an excerpt from it: &lt;pre class="brush:sql;highlight:[9];"&gt;&lt;br /&gt;*** 2017-02-09 13:12:59.339&lt;br /&gt;*** SESSION ID:(51.12274) 2017-02-09 13:12:59.339&lt;br /&gt;*** CLIENT ID:() 2017-02-09 13:12:59.339&lt;br /&gt;*** SERVICE NAME:(SYS$USERS) 2017-02-09 13:12:59.339&lt;br /&gt;*** MODULE NAME:(sqlplus@misha2 (TNS V1-V3)) 2017-02-09 13:12:59.339&lt;br /&gt;*** CLIENT DRIVER:(SQL*PLUS) 2017-02-09 13:12:59.339&lt;br /&gt;*** ACTION NAME:() 2017-02-09 13:12:59.339&lt;br /&gt;&lt;br /&gt;krsd_get_primary_connect_string: found pcs 'adg3' by reverse lookup&lt;br /&gt;Connected to primary database target adg3&lt;br /&gt;*** 2017-02-09 13:12:59.372643 3981 krsb.c&lt;br /&gt;krsb_stream_dispatch: Error 604 during streaming operation to destination 1&lt;br /&gt;*** 2017-02-09 13:12:59.372842 2178 krsu.c&lt;br /&gt;krsu_rmi_send_recv: Encountered error 604 sending message to connection 1&lt;br /&gt;*** 2017-02-09 13:12:59.372867 2023 krsu.c&lt;br /&gt;krsu_rmi_lwc_send_recv: Encountered error status 604 sending RMI message to adg3&lt;br /&gt;kdn_sseq_so_primary: Encountered send recv exception 604&lt;br /&gt;&lt;/pre&gt;I was curious about what "by reverse lookup" meant. I speculate that it means that the primary database TNS alias (or the fully-formed TNS descriptor) is obtained from one of LOG_ARCHIVE_DEST_n parameters (let it call LADn for the sake of shortness).&lt;br/&gt;And conversely, there is a forward lookup by the FAL_SERVER parameter: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;krsd_get_primary_connect_string: found pcs 'adg1' by FAL_SERVER lookup&lt;br /&gt;Connected to primary database target adg1&lt;br /&gt;krsd_get_primary_connect_string: found pcs 'adg1' by FAL_SERVER lookup&lt;br /&gt;Connected to primary database target adg1&lt;br /&gt;&lt;/pre&gt;It seems that Oracle is considering either the LADn or FAL_SERVER parameter when it tries to identify the primary database connect identifier to request a sequence cache.&lt;br/&gt;I have done several tests in my sandbox Data Guard environment and I think that the LADn take precedence over the FAL_SERVER.&lt;br/&gt;All of the tests were performed on the following Data Guard configuration: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;DGMGRL&gt; show configuration;&lt;br /&gt;&lt;br /&gt;Configuration - adg&lt;br /&gt;&lt;br /&gt;  Protection Mode: MaxAvailability&lt;br /&gt;  Members:&lt;br /&gt;  adg1 - Primary database&lt;br /&gt;    adg2 - Physical standby database &lt;br /&gt;    adg3 - Physical standby database &lt;br /&gt;&lt;br /&gt;Fast-Start Failover: DISABLED&lt;br /&gt;&lt;br /&gt;Configuration Status:&lt;br /&gt;SUCCESS   (status updated 10 seconds ago)&lt;br /&gt;&lt;/pre&gt;I ran my scripts in adg2, which is a physical standby database, and the databases have DBBP 12.1.0.2.161018 applied.&lt;br/&gt;Here is what I was observing while doing my experiments:&lt;br/&gt;&lt;b&gt;1. the first LADn with db_unique_name=&lt;primary_db&gt; is selected. The corresponding LOG_ARCHIVE_DEST_STATE_N, VALID_FOR parameters are ignored.&lt;/b&gt;&lt;br/&gt;Here is an example where I set VALID_FOR=(ALL_LOGFILES,STANDBY_ROLE), LOG_ARCHIVE_DEST_STATE_4=DEFER and, still, the LADn was used to identify the primary database TNS: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt; alter system set fal_server='adg1' log_archive_dest_4='service=non_existent valid_for=(all_logfiles,standby_role) db_unique_name=adg1' log_archive_dest_state_4=defer;&lt;br /&gt;&lt;br /&gt;System altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; conn / as sysdba&lt;br /&gt;Connected.&lt;br /&gt;SQL&gt; explain plan for select * from dual;&lt;br /&gt;explain plan for select * from dual&lt;br /&gt;                        *&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-00604: error occurred at recursive SQL level 1&lt;br /&gt;ORA-03180: Sequence values cannot be allocated for Oracle Active Data Guard standby.&lt;br /&gt;&lt;br /&gt;-- trace file&lt;br /&gt;krsd_get_primary_connect_string: found pcs 'non_existent' by reverse lookup&lt;br /&gt;OCIServerAttach failed -1&lt;br /&gt;.. Detailed OCI error val is 12154 and errmsg is 'ORA-12154: TNS:could not resolve the connect identifier specified&lt;br /&gt;'&lt;br /&gt;OCIServerAttach failed -1&lt;br /&gt;.. Detailed OCI error val is 12154 and errmsg is 'ORA-12154: TNS:could not resolve the connect identifier specified&lt;br /&gt;'&lt;br /&gt;OCIServerAttach failed -1&lt;br /&gt;.. Detailed OCI error val is 12154 and errmsg is 'ORA-12154: TNS:could not resolve the connect identifier specified&lt;br /&gt;'&lt;br /&gt;OCIServerAttach failed -1&lt;br /&gt;.. Detailed OCI error val is 12154 and errmsg is 'ORA-12154: TNS:could not resolve the connect identifier specified&lt;br /&gt;'&lt;br /&gt;*** 2017-02-09 14:05:22.153950 4929 krsh.c&lt;br /&gt;Error 12154 received logging on to the standby&lt;br /&gt;*** 2017-02-09 14:05:22.153969 1460 krsu.c&lt;br /&gt;krsu_rmi_lwc_connect: Encountered error status 12154 attempting connection to non_existent&lt;br /&gt;non_existent: Encountered connect exception 12154&lt;br /&gt;&lt;/pre&gt;&lt;b&gt;2. when there is no LADn with db_unique_name=&amp;lt;primary_db&amp;gt; is present then the FAL_SERVER parameter is used. It is sequentially traversed left-to-right:&lt;/b&gt;&lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt; alter system set fal_server='x','adg1','y';&lt;br /&gt;&lt;br /&gt;System altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; explain plan for select * from dual;&lt;br /&gt;&lt;br /&gt;Explained.&lt;br /&gt;&lt;br /&gt;-- trace file&lt;br /&gt;*** 2017-02-09 14:42:50.944&lt;br /&gt;*** SESSION ID:(47.31048) 2017-02-09 14:42:50.944&lt;br /&gt;*** CLIENT ID:() 2017-02-09 14:42:50.944&lt;br /&gt;*** SERVICE NAME:(SYS$USERS) 2017-02-09 14:42:50.944&lt;br /&gt;*** MODULE NAME:(sqlplus@userhost (TNS V1-V3)) 2017-02-09 14:42:50.944&lt;br /&gt;*** CLIENT DRIVER:(SQL*PLUS) 2017-02-09 14:42:50.944&lt;br /&gt;*** ACTION NAME:() 2017-02-09 14:42:50.944&lt;br /&gt; &lt;br /&gt;OCIServerAttach failed -1&lt;br /&gt;.. Detailed OCI error val is 12154 and errmsg is 'ORA-12154: TNS:could not resolve the connect identifier specified&lt;br /&gt;'&lt;br /&gt;OCIServerAttach failed -1&lt;br /&gt;.. Detailed OCI error val is 12154 and errmsg is 'ORA-12154: TNS:could not resolve the connect identifier specified&lt;br /&gt;'&lt;br /&gt;OCIServerAttach failed -1&lt;br /&gt;.. Detailed OCI error val is 12154 and errmsg is 'ORA-12154: TNS:could not resolve the connect identifier specified&lt;br /&gt;'&lt;br /&gt;OCIServerAttach failed -1&lt;br /&gt;.. Detailed OCI error val is 12154 and errmsg is 'ORA-12154: TNS:could not resolve the connect identifier specified&lt;br /&gt;'&lt;br /&gt;*** 2017-02-09 14:42:50.960591 4929 krsh.c&lt;br /&gt;Error 12154 received logging on to the standby&lt;br /&gt;*** 2017-02-09 14:42:50.960676 4929 krsh.c&lt;br /&gt;FAL[client, USER]: Error 12154 connecting to x for fetching gap sequence&lt;br /&gt;ORA-12154: TNS:could not resolve the connect identifier specified&lt;br /&gt;krsd_get_primary_connect_string: found pcs 'adg1' by FAL_SERVER lookup&lt;br /&gt;Connected to primary database target adg1 &lt;br /&gt;OCIServerAttach failed -1&lt;br /&gt;.. Detailed OCI error val is 12154 and errmsg is 'ORA-12154: TNS:could not resolve the connect identifier specified&lt;br /&gt;'&lt;br /&gt;OCIServerAttach failed -1&lt;br /&gt;.. Detailed OCI error val is 12154 and errmsg is 'ORA-12154: TNS:could not resolve the connect identifier specified&lt;br /&gt;'&lt;br /&gt;OCIServerAttach failed -1&lt;br /&gt;.. Detailed OCI error val is 12154 and errmsg is 'ORA-12154: TNS:could not resolve the connect identifier specified&lt;br /&gt;'&lt;br /&gt;OCIServerAttach failed -1&lt;br /&gt;.. Detailed OCI error val is 12154 and errmsg is 'ORA-12154: TNS:could not resolve the connect identifier specified&lt;br /&gt;'&lt;br /&gt;*** 2017-02-09 14:42:51.071116 4929 krsh.c&lt;br /&gt;Error 12154 received logging on to the standby&lt;br /&gt;*** 2017-02-09 14:42:51.071188 4929 krsh.c&lt;br /&gt;FAL[client, USER]: Error 12154 connecting to x for fetching gap sequence&lt;br /&gt;ORA-12154: TNS:could not resolve the connect identifier specified&lt;br /&gt;krsd_get_primary_connect_string: found pcs 'adg1' by FAL_SERVER lookup&lt;br /&gt;Connected to primary database target adg1&lt;br /&gt;&lt;/pre&gt;How could one come across this issue:&lt;br/&gt;1. Have incorrect parameter settings and do not use Data Guard Broker. That is what the problem was when my client came upon it. &lt;br/&gt;2. Actually, we can face this issue using Data Guard Broker. Data Guard Broker does not change the FAL_SERVER parameters on switchover, at least, it is how it is working now. See, for example, &lt;a href="https://community.oracle.com/thread/3970711"&gt;this link&lt;/a&gt;.&lt;br/&gt;One possible workaround - it is to manually invoke the DGMGRL "enable configuration" command each time when the switchover takes place.&lt;br/&gt; I raised a SR with Oracle about this problem but I decided not to progress towards the permanent solution. </content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/3462818420315692756/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2017/02/ora-3180-on-active-data-guard-standby.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3462818420315692756'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3462818420315692756'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2017/02/ora-3180-on-active-data-guard-standby.html' title='ORA-3180 on Active Data Guard standby database'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-7483431421887459964</id><published>2017-01-30T09:15:00.000+06:00</published><updated>2017-01-30T09:15:28.935+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='11g'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='EBR'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><title type='text'>DBMS_METADATA.GET_SXML_DDL may produce incorrect DDL for trigger in EBR environment</title><content type='html'>I have recently discovered a case when DBMS_METADATA.GET_SXML_DDL returns incorrect DDL for the trigger in an EBR environment.&lt;br/&gt;Here is a test case to reproduce the issue that is present in 12.1.0.2.170117 and 11.2.0.4.161018: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt; grant connect, create table, create view, create trigger to tc identified by tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; alter user tc enable editions for view,trigger;&lt;br /&gt;&lt;br /&gt;User altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; conn tc/tc&lt;br /&gt;Connected.&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; create table t (&lt;br /&gt;  2    x int)&lt;br /&gt;  3  /&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; create or replace editioning view ev&lt;br /&gt;  2  as&lt;br /&gt;  3  select *&lt;br /&gt;  4    from t&lt;br /&gt;  5  /&lt;br /&gt;&lt;br /&gt;View created.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; create or replace trigger trg&lt;br /&gt;  2  before update of x on ev&lt;br /&gt;  3  declare&lt;br /&gt;  4  begin&lt;br /&gt;  5    null;&lt;br /&gt;  6  end;&lt;br /&gt;  7  /&lt;br /&gt;&lt;br /&gt;Trigger created.&lt;br /&gt;&lt;/pre&gt;Let us look at the DDL of the trigger returning by DBMS_METADATA.GET_DDL and DBMS_METADATA.GET_SXML_DDL functions. &lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt; select dbms_metadata.get_ddl( 'TRIGGER', 'TRG') from dual;&lt;br /&gt;&lt;br /&gt;DBMS_METADATA.GET_DDL('TRIGGER','TRG')&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;  CREATE OR REPLACE EDITIONABLE TRIGGER "TC"."TRG"&lt;br /&gt;before update of x on ev&lt;br /&gt;declare&lt;br /&gt;begin&lt;br /&gt;  null;&lt;br /&gt;end;&lt;br /&gt;ALTER TRIGGER "TC"."TRG" ENABLE&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt; select dbms_metadata.get_sxml_ddl( 'TRIGGER', 'TRG') from dual;&lt;br /&gt;&lt;br /&gt;DBMS_METADATA.GET_SXML_DDL('TRIGGER','TRG')&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;  CREATE OR REPLACE TRIGGER "TC"."TRG"&lt;br /&gt;  BEFORE UPDATE OF X ON "TC"."EV"&lt;br /&gt;  declare&lt;br /&gt;begin&lt;br /&gt;  null;&lt;br /&gt;end;&lt;br /&gt;&lt;/pre&gt;They are pretty much the same. Now I change the status of my trigger. Please note the highlighted lines showing the differences: &lt;pre class="brush:sql;highlight:[12,25];"&gt;&lt;br /&gt;SQL&gt; alter trigger trg enable;&lt;br /&gt;&lt;br /&gt;Trigger altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select dbms_metadata.get_ddl( 'TRIGGER', 'TRG') from dual;&lt;br /&gt;&lt;br /&gt;DBMS_METADATA.GET_DDL('TRIGGER','TRG')&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;  CREATE OR REPLACE EDITIONABLE TRIGGER "TC"."TRG"&lt;br /&gt;before update of x on ev&lt;br /&gt;declare&lt;br /&gt;begin&lt;br /&gt;  null;&lt;br /&gt;end;&lt;br /&gt;ALTER TRIGGER "TC"."TRG" ENABLE&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt; select dbms_metadata.get_sxml_ddl( 'TRIGGER', 'TRG') from dual;&lt;br /&gt;&lt;br /&gt;DBMS_METADATA.GET_SXML_DDL('TRIGGER','TRG')&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;  CREATE OR REPLACE TRIGGER "TC"."TRG"&lt;br /&gt;  BEFORE UPDATE OF X, X ON "TC"."EV"&lt;br /&gt;  declare&lt;br /&gt;begin&lt;br /&gt;  null;&lt;br /&gt;end;&lt;br /&gt;&lt;/pre&gt;I have ended up with two X columns in the output of DBMS_METADATA.GET_SXML_DDL, which is, in fact, a non-working DDL statement.&lt;br/&gt;I played more with this issue and I have eventually obtained four X columns and it is not a limit: &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql;highlight:[12,25,45,58];"&gt;&lt;br /&gt;SQL&gt; alter trigger trg disable;&lt;br /&gt;&lt;br /&gt;Trigger altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select dbms_metadata.get_ddl( 'TRIGGER', 'TRG') from dual;&lt;br /&gt;&lt;br /&gt;DBMS_METADATA.GET_DDL('TRIGGER','TRG')&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;  CREATE OR REPLACE EDITIONABLE TRIGGER "TC"."TRG"&lt;br /&gt;before update of x on ev&lt;br /&gt;declare&lt;br /&gt;begin&lt;br /&gt;  null;&lt;br /&gt;end;&lt;br /&gt;ALTER TRIGGER "TC"."TRG" DISABLE&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt; select dbms_metadata.get_sxml_ddl( 'TRIGGER', 'TRG') from dual;&lt;br /&gt;&lt;br /&gt;DBMS_METADATA.GET_SXML_DDL('TRIGGER','TRG')&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;  CREATE OR REPLACE TRIGGER "TC"."TRG"&lt;br /&gt;  BEFORE UPDATE OF X, X, X ON "TC"."EV"&lt;br /&gt;  declare&lt;br /&gt;begin&lt;br /&gt;  null;&lt;br /&gt;end;&lt;br /&gt;  ALTER TRIGGER "TC"."TRG" DISABLE&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; alter trigger trg enable;&lt;br /&gt;&lt;br /&gt;Trigger altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select dbms_metadata.get_ddl( 'TRIGGER', 'TRG') from dual;&lt;br /&gt;&lt;br /&gt;DBMS_METADATA.GET_DDL('TRIGGER','TRG')&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;  CREATE OR REPLACE EDITIONABLE TRIGGER "TC"."TRG"&lt;br /&gt;before update of x on ev&lt;br /&gt;declare&lt;br /&gt;begin&lt;br /&gt;  null;&lt;br /&gt;end;&lt;br /&gt;ALTER TRIGGER "TC"."TRG" ENABLE&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&gt; select dbms_metadata.get_sxml_ddl( 'TRIGGER', 'TRG') from dual;&lt;br /&gt;&lt;br /&gt;DBMS_METADATA.GET_SXML_DDL('TRIGGER','TRG')&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;  CREATE OR REPLACE TRIGGER "TC"."TRG"&lt;br /&gt;  BEFORE UPDATE OF X, X, X, X ON "TC"."EV"&lt;br /&gt;  declare&lt;br /&gt;begin&lt;br /&gt;  null;&lt;br /&gt;end;&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;The DBMS_METADATA.GET_SXML_DDL procedure uses a SELECT statement similar to the above to obtain the DDL: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SELECT /*+all_rows*/ &lt;br /&gt;       SYS_XMLGEN(&lt;br /&gt;         VALUE(KU$), &lt;br /&gt;         XMLFORMAT.createFormat2('TRIGGER_T', '7')), &lt;br /&gt;       KU$.OBJ_NUM &lt;br /&gt;  FROM SYS.KU$_TRIGGER_VIEW KU$ &lt;br /&gt; WHERE NOT (KU$.BASE_OBJ IS NOT NULL AND BITAND(KU$.BASE_OBJ.FLAGS,128)!=0) &lt;br /&gt;   AND KU$.SCHEMA_OBJ.NAME = 'TRG' &lt;br /&gt;   AND KU$.SCHEMA_OBJ.OWNER_NAME = 'TC';&lt;br /&gt;&lt;/pre&gt;The column list for the trigger comes from this part of the SYS.KU$_TRIGGER_VIEW view: &lt;pre class="brush:sql"&gt;&lt;br /&gt;          cast(multiset(select * from ku$_triggercol_view tv&lt;br /&gt;                        where tv.obj_num=t.obj#&lt;br /&gt;                      ) as ku$_triggercol_list_t&lt;br /&gt;             ),&lt;br /&gt;&lt;/pre&gt;The code of the KU$_TRIGGERCOL_VIEW view is: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;CREATE OR REPLACE FORCE NONEDITIONABLE VIEW "SYS"."KU$_TRIGGERCOL_VIEW" OF "SYS"."KU$_TRIGGERCOL_T"&lt;br /&gt;  WITH OBJECT IDENTIFIER (obj_num,intcol_num,type_num) AS&lt;br /&gt;  select '1','0',&lt;br /&gt;         tc.obj#, tc.col#, tc.type#, tc.position#, tc.intcol#, c.name,&lt;br /&gt;         (select a.name from attrcol$ a where&lt;br /&gt;                        a.obj#=tc.obj# and a.intcol#=tc.intcol#)&lt;br /&gt;  from col$ c, triggercol$ tc, trigger$ t&lt;br /&gt;  where tc.obj#=t.obj#&lt;br /&gt;    and c.obj#=t.baseobject&lt;br /&gt;    and c.intcol#=tc.intcol#&lt;br /&gt;&lt;/pre&gt;And the final part of the puzzle is the TRIGGERCOL$ table: &lt;pre class="brush:sql;highlight:[9];"&gt;&lt;br /&gt;SQL&gt; select * from sys.triggercol$ where obj#=(select object_id from dba_objects where owner='TC' and object_name='TRG');&lt;br /&gt;&lt;br /&gt;      OBJ#       COL#      TYPE#  POSITION#    INTCOL#&lt;br /&gt;---------- ---------- ---------- ---------- ----------&lt;br /&gt;    214352          1          0          0          1&lt;br /&gt;    214352          1          0          0          1&lt;br /&gt;    214352          1          0          0          1&lt;br /&gt;    214352          1          0          0          1&lt;br /&gt;    214352          1       1024          0          1&lt;br /&gt;&lt;/pre&gt;It gets one row each time I execute the "ALTER TRIGGER ENABLE/DISABLE" statement. I think Oracle Developers should filter the rows because there is only one row with TYPE#=1024.&lt;br/&gt;DBMS_METADATA.GET_DDL returns correct DDL and it seems to be come from the DDL passed by a user.&lt;br/&gt;Conversely, DBMS_METADATA.GET_SXML_DDL tries to reconstruct the user's DDL and it messes things up.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/7483431421887459964/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2017/01/dbmsmetadatagetsxmlddl-may-produce.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7483431421887459964'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7483431421887459964'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2017/01/dbmsmetadatagetsxmlddl-may-produce.html' title='DBMS_METADATA.GET_SXML_DDL may produce incorrect DDL for trigger in EBR environment'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-4762801394728982338</id><published>2016-11-29T12:52:00.000+06:00</published><updated>2016-11-29T12:56:45.658+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='OGG'/><title type='text'>A lot of log.* files in dirbdb directory</title><content type='html'>Since I had added ENABLEMONITORING in the GLOBALS file, I noticed that $OGG_HOME/dirbdb directory started growing.&lt;br/&gt;That was OGG version 12.2.0.1.160517. &lt;br/&gt;The size of this directory was 23G in the test environment and the ENABLEMONITORING option was set 3 weeks ago: &lt;pre class="brush:bash;"&gt;&lt;br /&gt;-bash-4.1$ du -sh dirbdb&lt;br /&gt; 23.8G   dirbdb&lt;br /&gt;&lt;/pre&gt;From that 23.8G , 23.5G was occupied by the log.* files like below: &lt;pre class="brush:bash;"&gt;&lt;br /&gt;-rw-r-----   1 oracle dba      10485760 Nov 16 18:16 log.0000015971&lt;br /&gt;-rw-r-----   1 oracle dba      10485760 Nov 16 18:28 log.0000015972&lt;br /&gt;-rw-r-----   1 oracle dba      10485760 Nov 16 18:41 log.0000015973&lt;br /&gt;-rw-r-----   1 oracle dba      10485760 Nov 16 18:55 log.0000015974&lt;br /&gt;-rw-r-----   1 oracle dba      10485760 Nov 16 19:08 log.0000015975&lt;br /&gt;-rw-r-----   1 oracle dba      10485760 Nov 16 19:20 log.0000015976&lt;br /&gt;-rw-r-----   1 oracle dba      10485760 Nov 16 19:32 log.0000015977&lt;br /&gt;-rw-r-----   1 oracle dba      10485760 Nov 16 19:43 log.0000015978&lt;br /&gt;-rw-r-----   1 oracle dba      10485760 Nov 16 19:55 log.0000015979&lt;br /&gt;-rw-r-----   1 oracle dba      10485760 Nov 16 20:07 log.0000015980&lt;br /&gt;-rw-r-----   1 oracle dba      10485760 Nov 16 20:19 log.0000015981&lt;br /&gt;-rw-r-----   1 oracle dba      10485760 Nov 16 20:31 log.0000015982&lt;br /&gt;&lt;/pre&gt;These files were generated approximately every ten minutes and each of them was 10M in size that made up 1.4G daily.&lt;br/&gt;Having searched through MOS and Internet search engines, I stumbled across this &lt;a href="https://community.oracle.com/message/11857042#11857042"&gt;MOSC Thread: Monitoring - Berkeley Database&lt;/a&gt;.&lt;br/&gt;So I created a new DB_CONFIG file within the dirbdb directory and put this line into it: &lt;pre class="brush:bash;"&gt;&lt;br /&gt;-bash-4.1$ cat dirbdb/DB_CONFIG &lt;br /&gt;set_flags DB_LOG_AUTOREMOVE &lt;br /&gt;&lt;/pre&gt;Then I restarted my OGG processes and discovered that these log files were gone. &lt;br/&gt;Now there are only two log files that are kept: &lt;pre class="brush:bash;"&gt;&lt;br /&gt;[oracle@host ggs]$ ls -ltr dirbdb/log*&lt;br /&gt;-rw-r-----   1 oracle   dba      10485760 Nov 28 13:31 dirbdb/log.0000017532&lt;br /&gt;-rw-r-----   1 oracle   dba      10485760 Nov 28 13:41 dirbdb/log.0000017533&lt;br /&gt;[oracle@host ggs]$ ls -ltr dirbdb/log*&lt;br /&gt;-rw-r-----   1 oracle   dba      10485760 Nov 28 13:42 dirbdb/log.0000017533&lt;br /&gt;-rw-r-----   1 oracle   dba      10485760 Nov 28 13:51 dirbdb/log.0000017534&lt;br /&gt;[oracle@host ggs]$ ls -ltr dirbdb/log*&lt;br /&gt;-rw-r-----   1 oracle   dba      10485760 Nov 29 07:21 dirbdb/log.0000017625&lt;br /&gt;-rw-r-----   1 oracle   dba      10485760 Nov 29 07:22 dirbdb/log.0000017626&lt;br /&gt;&lt;/pre&gt;Looks like another option that should be added in the environments in which ENABLEMONITORING is set. &lt;br/&gt;Yet, MOS returns no hits apart from the aforementioned MOSC thread. </content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/4762801394728982338/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2016/11/a-lot-of-log-files-in-dirbdb-directory.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4762801394728982338'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4762801394728982338'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2016/11/a-lot-of-log-files-in-dirbdb-directory.html' title='A lot of log.* files in dirbdb directory'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-4299595982348942511</id><published>2016-10-31T13:27:00.000+06:00</published><updated>2016-10-31T13:31:46.407+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='OGG'/><title type='text'>Excluding DDL in IE (Integrated Extract) using DBMS_STREAMS_ADM.SET_TAG</title><content type='html'>A couple of months ago I had to configure OGG IE (Oracle GoldenGate Integrated Extract) to exclude specific DDL from replication.&lt;br/&gt;Having worked a lot with Oracle Streams, I decided to utilize DBMS_STREAMS_ADM.SET_TAG for that task.&lt;br/&gt;I found a relevant MOS document &lt;a href="https://support.oracle.com/epmos/faces/ui/km/DocContentDisplay.jspx?id=2107293.1"&gt;How to exclude ddl in IE (integrated extract) issued from a specific user? (Doc ID 2107293.1)&lt;/a&gt; pretty fast.&lt;br/&gt;The document suggested putting TRANLOGOPTIONS EXCLUDETAG into an extract parameter file and than all DDL statements preceeding with DBMS_STREAMS_SET.TAG should not be replicated.&lt;br/&gt;Unfortunately the provided solution did not work for me.&lt;br/&gt;I used OGG Server 12.2.0.1.160823 on Linux x86-64 (which means that I applied the latest bundle patch available at the moment).&lt;br/&gt;The issue can be easily reproduced.&lt;br/&gt;The database version used in this test was 12.1.0.2.160719.&lt;br/&gt;Here are my extract and replicat parameter files: &lt;pre class="brush:sql;highlight:[6];"&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_replicat@db2) 112&gt; view params etag&lt;br /&gt;&lt;br /&gt;EXTRACT ETAG&lt;br /&gt;&lt;br /&gt;USERIDALIAS db1_tc_ogg_extract&lt;br /&gt;TRANLOGOPTIONS EXCLUDETAG 34&lt;br /&gt;LOGALLSUPCOLS&lt;br /&gt;EXTTRAIL ./dirdat/tc&lt;br /&gt;DDL INCLUDE ALL&lt;br /&gt;&lt;br /&gt;TABLE TC.*;&lt;br /&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_replicat@db2) 113&gt; view params rtag&lt;br /&gt;&lt;br /&gt;REPLICAT RTAG&lt;br /&gt;&lt;br /&gt;USERIDALIAS db2_tc_ogg_replicat&lt;br /&gt;&lt;br /&gt;MAP TC.*, TARGET TC.*;&lt;br /&gt;&lt;/pre&gt;Test schema TC will be used for demonstration and I setup the extract to exclude any LCRs with tag 34.&lt;br/&gt;Then I am going to create and start the OGG processes with the following script: &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql;"&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_replicat@db2) 138&gt; alter credentialstore add user tc_ogg_extract@db1 password tc_ogg_extract alias db1_tc_ogg_extract&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Credential store in ./dircrd/ altered.&lt;br /&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_replicat@db2) 139&gt; alter credentialstore add user tc_ogg_replicat@db2 password tc_ogg_replicat alias db2_tc_ogg_replicat&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Credential store in ./dircrd/ altered.&lt;br /&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_replicat@db2) 140&gt; &lt;br /&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_replicat@db2) 140&gt; dblogin useridalias db1_tc_ogg_extract&lt;br /&gt;&lt;br /&gt;Successfully logged into database.&lt;br /&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_extract@db1) 141&gt; add extract etag integrated tranlog begin now&lt;br /&gt;&lt;br /&gt;EXTRACT (Integrated) added.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_extract@db1) 142&gt; add exttrail ./dirdat/tc extract etag&lt;br /&gt;&lt;br /&gt;EXTTRAIL added.&lt;br /&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_extract@db1) 143&gt; register extract etag database&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;2016-10-31 12:46:49  INFO    OGG-02003  Extract ETAG successfully registered with database at SCN 39029510.&lt;br /&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_extract@db1) 144&gt; &lt;br /&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_extract@db1) 146&gt; dblogin useridalias db2_tc_ogg_replicat&lt;br /&gt;&lt;br /&gt;Successfully logged into database.&lt;br /&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_replicat@db2) 147&gt; add replicat rtag , integrated, exttrail ./dirdat/tc&lt;br /&gt;&lt;br /&gt;REPLICAT (Integrated) added.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_replicat@db2) 148&gt; start extract etag&lt;br /&gt;&lt;br /&gt;Sending START request to MANAGER ...&lt;br /&gt;EXTRACT ETAG starting&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_replicat@db2) 149&gt; start replicat rtag&lt;br /&gt;&lt;br /&gt;Sending START request to MANAGER ...&lt;br /&gt;REPLICAT RTAG starting&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;I used two databases in my setup - db1 and db2 that I named SOURCE and TARGET in the rest of this blog post for the sake of clarity.&lt;br/&gt;  The extract configured to capture the changes from db1 database and write data to trail files.&lt;br/&gt;The replicat reads the trail files and applies the changes into db2 database.&lt;br/&gt;Next I am about to run the following code in the source database from which the extract captures changes: &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql;"&gt;&lt;br /&gt;TC@SOURCE&gt; create sequence t_seq;&lt;br /&gt;&lt;br /&gt;Sequence created.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; &lt;br /&gt;TC@SOURCE&gt; create table t(&lt;br /&gt;  2    id  int default t_seq.nextval,&lt;br /&gt;  3    msg varchar2(10))&lt;br /&gt;  4  /&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; &lt;br /&gt;TC@SOURCE&gt; insert into t(msg) values ('NO TAG');&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; &lt;br /&gt;TC@SOURCE&gt; exec dbms_streams_adm.set_tag( hextoraw('12'))&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; &lt;br /&gt;TC@SOURCE&gt; insert into t(msg) values ('TAG '||rawtohex(dbms_streams_adm.get_tag));&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; &lt;br /&gt;TC@SOURCE&gt; exec dbms_streams_adm.set_tag( hextoraw('34'))&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; &lt;br /&gt;TC@SOURCE&gt; insert into t(msg) values ('TAG '||rawtohex(dbms_streams_adm.get_tag));&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; &lt;br /&gt;TC@SOURCE&gt; exec dbms_streams_adm.set_tag( hextoraw('56'))&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; &lt;br /&gt;TC@SOURCE&gt; insert into t(msg) values ('TAG '||rawtohex(dbms_streams_adm.get_tag));&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;Havind done that, I got next results in SOURCE database: &lt;pre class="brush:sql;highlight:[7];"&gt;&lt;br /&gt;TC@SOURCE&gt; select * from t;&lt;br /&gt;&lt;br /&gt;        ID MSG&lt;br /&gt;---------- ----------&lt;br /&gt;         1 NO TAG&lt;br /&gt;         2 TAG 12&lt;br /&gt;         3 TAG 34&lt;br /&gt;         4 TAG 56&lt;br /&gt;&lt;/pre&gt;And that in TARGET: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;TC@TARGET&gt; select * from t order by id;&lt;br /&gt;&lt;br /&gt;        ID MSG&lt;br /&gt;---------- ----------&lt;br /&gt;         1 NO TAG&lt;br /&gt;         2 TAG 12&lt;br /&gt;         4 TAG 56&lt;br /&gt;&lt;/pre&gt;Notice that an insert of a record with ID=3, MSG="TAG 34" was not replicated because we have filtered out that record on the extract.&lt;br/&gt;That works flawlessly being executed for DML, but it does not work for DDL: &lt;pre class="brush:sql;highlight:[25,26];"&gt;&lt;br /&gt;TC@SOURCE&gt; exec dbms_streams_adm.set_tag( hextoraw('12'))&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; &lt;br /&gt;TC@SOURCE&gt; alter table t add tag12 int;&lt;br /&gt;&lt;br /&gt;Table altered.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; &lt;br /&gt;TC@SOURCE&gt; exec dbms_streams_adm.set_tag( hextoraw('34'))&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; &lt;br /&gt;TC@SOURCE&gt; alter table t add tag34 int;&lt;br /&gt;&lt;br /&gt;Table altered.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; describe t&lt;br /&gt; Name                                      Null?    Type&lt;br /&gt; ----------------------------------------- -------- ----------------------------&lt;br /&gt; ID                                                 NUMBER(38)&lt;br /&gt; MSG                                                VARCHAR2(10)&lt;br /&gt; TAG12                                              NUMBER(38)&lt;br /&gt; TAG34                                              NUMBER(38)&lt;br /&gt;&lt;/pre&gt;I have added two columns to the table and the second one, TAG34, should not have been replicated.&lt;br/&gt;But in fact, both of the commands were replicated: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;TC@TARGET&gt; describe t&lt;br /&gt; Name                                      Null?    Type&lt;br /&gt; ----------------------------------------- -------- ----------------------------&lt;br /&gt; ID                                                 NUMBER(38)&lt;br /&gt; MSG                                                VARCHAR2(10)&lt;br /&gt; TAG12                                              NUMBER(38)&lt;br /&gt; TAG34                                              NUMBER(38)&lt;br /&gt;&lt;/pre&gt;It means that aforementioned MOS document &lt;a href="https://support.oracle.com/epmos/faces/ui/km/DocContentDisplay.jspx?id=2107293.1"&gt;How to exclude ddl in IE (integrated extract) issued from a specific user? (Doc ID 2107293.1)&lt;/a&gt; does not work in that configuration which, by the way, I think is quite typical.&lt;br/&gt;Luckily, Oracle Support published another note after we concluded our work on the SR: &lt;a href="https://support.oracle.com/epmos/faces/ui/km/DocContentDisplay.jspx?id=2185538.1"&gt;EXCLUDETAG Issue With Integrated Extract While Excluding DDL For Specific User (Doc ID 2185538.1)&lt;/a&gt;.&lt;br/&gt;We need to put the following line into an extract parameter file to get it working: tranlogoptions _dbfilterddl &lt;pre class="brush:sql;highlight:[7];"&gt;&lt;br /&gt;GGSCI (misha2 as tc_ogg_replicat@db2) 168&gt; view params etag&lt;br /&gt;&lt;br /&gt;EXTRACT ETAG&lt;br /&gt;&lt;br /&gt;USERIDALIAS db1_tc_ogg_extract&lt;br /&gt;TRANLOGOPTIONS EXCLUDETAG 34&lt;br /&gt;TRANLOGOPTIONS _dbfilterddl&lt;br /&gt;LOGALLSUPCOLS&lt;br /&gt;EXTTRAIL ./dirdat/tc&lt;br /&gt;DDL INCLUDE ALL&lt;br /&gt;&lt;br /&gt;TABLE TC.*;&lt;br /&gt;&lt;/pre&gt;Having added that, the same code adding two columns worked as it should: &lt;pre class="brush:sql;highlight:[7];"&gt;&lt;br /&gt;TC@SOURCE&gt; describe t&lt;br /&gt; Name                                      Null?    Type&lt;br /&gt; ----------------------------------------- -------- ----------------------------&lt;br /&gt; ID                                                 NUMBER(38)&lt;br /&gt; MSG                                                VARCHAR2(10)&lt;br /&gt; TAG12                                              NUMBER(38)&lt;br /&gt; TAG34                                              NUMBER(38)&lt;br /&gt;&lt;br /&gt;TC@TARGET&gt; describe t&lt;br /&gt; Name                                      Null?    Type&lt;br /&gt; ----------------------------------------- -------- ----------------------------&lt;br /&gt; ID                                                 NUMBER(38)&lt;br /&gt; MSG                                                VARCHAR2(10)&lt;br /&gt; TAG12                                              NUMBER(38)&lt;br /&gt;&lt;/pre&gt;It means that TAG34 column, being added with tag 34, was not replicated.&lt;br/&gt;There is also a new line in a ggserr.log file that was not present when I started the extract without _dbfilterddl:&lt;br/&gt;Logmining server DDL filtering enabled. &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql;highlight:[21];"&gt;&lt;br /&gt;2016-10-31 13:54:33  INFO    OGG-00963  Oracle GoldenGate Manager for Oracle, mgr.prm:  Command received from GGSCI on host [172.16.113.245]:57437 (START EXTRACT ETAG ).&lt;br /&gt;2016-10-31 13:54:33  INFO    OGG-00960  Oracle GoldenGate Manager for Oracle, mgr.prm:  Access granted (rule #6).&lt;br /&gt;2016-10-31 13:54:34  INFO    OGG-00992  Oracle GoldenGate Capture for Oracle, etag.prm:  EXTRACT ETAG starting.&lt;br /&gt;2016-10-31 13:54:34  INFO    OGG-03059  Oracle GoldenGate Capture for Oracle, etag.prm:  Operating system character set identified as UTF-8.&lt;br /&gt;2016-10-31 13:54:34  INFO    OGG-02695  Oracle GoldenGate Capture for Oracle, etag.prm:  ANSI SQL parameter syntax is used for parameter parsing.&lt;br /&gt;2016-10-31 13:54:38  INFO    OGG-03522  Oracle GoldenGate Capture for Oracle, etag.prm:  Setting session time zone to source database time zone 'GMT'.&lt;br /&gt;2016-10-31 13:54:38  WARNING OGG-04033  Oracle GoldenGate Capture for Oracle, etag.prm:   LOGALLSUPCOLS has set the NOCOMPRESSDELETES and GETUPDATEBEFORES parameters on.&lt;br /&gt;2016-10-31 13:54:38  INFO    OGG-01815  Oracle GoldenGate Capture for Oracle, etag.prm:  Virtual Memory Facilities for: BR&lt;br /&gt;    anon alloc: mmap(MAP_ANON)  anon free: munmap&lt;br /&gt;    file alloc: mmap(MAP_SHARED)  file free: munmap&lt;br /&gt;    target directories:&lt;br /&gt;    /u01/app/oracle/12.2.0.1/ggs/BR/ETAG.&lt;br /&gt;2016-10-31 13:54:38  INFO    OGG-01851  Oracle GoldenGate Capture for Oracle, etag.prm:  filecaching started: thread ID: 140594853938944.&lt;br /&gt;2016-10-31 13:54:38  INFO    OGG-00975  Oracle GoldenGate Manager for Oracle, mgr.prm:  EXTRACT ETAG starting.&lt;br /&gt;2016-10-31 13:54:38  INFO    OGG-01815  Oracle GoldenGate Capture for Oracle, etag.prm:  Virtual Memory Facilities for: COM&lt;br /&gt;    anon alloc: mmap(MAP_ANON)  anon free: munmap&lt;br /&gt;    file alloc: mmap(MAP_SHARED)  file free: munmap&lt;br /&gt;    target directories:&lt;br /&gt;    /u01/app/oracle/12.2.0.1/ggs/dirtmp.&lt;br /&gt;2016-10-31 13:54:58  WARNING OGG-02045  Oracle GoldenGate Capture for Oracle, etag.prm:  Database does not have streams_pool_size initialization parameter configured.&lt;br /&gt;2016-10-31 13:54:59  INFO    OGG-02248  Oracle GoldenGate Capture for Oracle, etag.prm:  Logmining server DDL filtering enabled.&lt;br /&gt;2016-10-31 13:55:08  INFO    OGG-02068  Oracle GoldenGate Capture for Oracle, etag.prm:  Integrated capture successfully attached to logmining server OGG$CAP_ETAG using OGGCapture API.&lt;br /&gt;2016-10-31 13:55:08  INFO    OGG-02089  Oracle GoldenGate Capture for Oracle, etag.prm:  Source redo compatibility version is: 12.1.0.2.0.&lt;br /&gt;2016-10-31 13:55:08  INFO    OGG-02086  Oracle GoldenGate Capture for Oracle, etag.prm:  Integrated Dictionary will be used.&lt;br /&gt;2016-10-31 13:55:09  WARNING OGG-02905  Oracle GoldenGate Capture for Oracle, etag.prm:  Replication of OID column in object tables may diverge.&lt;br /&gt;2016-10-31 13:55:09  INFO    OGG-00993  Oracle GoldenGate Capture for Oracle, etag.prm:  EXTRACT ETAG started.&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;h3&gt;tl;dr&lt;/h3&gt;&lt;a href="http://docs.oracle.com/goldengate/c1221/gg-winux/GWURF/GUID-FEC2FCA4-127D-4A67-A66D-0203BA2DCE2E.htm#GWURF1197"&gt;EXCLUDETAG&lt;/a&gt; parameter does not work when a tag is set using DBMS_STREAMS_ADM.SET_TAG in OGG 12.2.0.1.160823&lt;br/&gt;. It prevents replicating only DML commands and does not restrict DDL commands from being replicated.&lt;br/&gt;We could use underscope parameter _dbfilterddl in the extract parameter file like in the following line: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;TRANLOGOPTIONS _dbfilterddl&lt;br /&gt;&lt;/pre&gt;This way we may restrict both DDL and DML commands from being replicated when the appropriate tag is set (or any in case we use "EXCLUDETAG +" in the extract parameter file). </content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/4299595982348942511/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2016/10/excluding-ddl-in-ie-integrated-extract.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4299595982348942511'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4299595982348942511'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2016/10/excluding-ddl-in-ie-integrated-extract.html' title='Excluding DDL in IE (Integrated Extract) using DBMS_STREAMS_ADM.SET_TAG'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-3967118916042372993</id><published>2016-09-01T12:18:00.000+06:00</published><updated>2016-09-01T12:18:39.610+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='OGG'/><title type='text'>Incorrect handling of unused columns during GoldenGate initial load using Direct Bulk Load to SQL*Loader</title><content type='html'>Today I have faced an interesting issue performing GoldenGate initial-load with a Direct Bulk Load to SQL*Loader.&lt;br/&gt;The issue was related to incorrect handling of unused columns during such loads and can cause incorrect data getting loaded into a database under certain conditions.&lt;br/&gt;I tried to reproduce the issue using one database in my setup but wasn't able to do that and stuck with two databases.&lt;br/&gt;I used Oracle Database 12.1.0.2 with DBBP 12.1.0.2.160419 applied and GoldenGate 12.2.0.1.160419 Patch Set.&lt;br/&gt;I'm going to use two database in my test case, let it be &lt;b&gt;SOURCE&lt;/b&gt; and &lt;b&gt;TARGET&lt;/b&gt;. Firstly, let's create a test schema with a single table populating it with some data: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;DBA@SOURCE&gt; grant create session, create table, unlimited tablespace to tc identified by tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;DBA@SOURCE&gt; conn tc/tc@source&lt;br /&gt;Connected.&lt;br /&gt;TC@SOURCE&gt; &lt;br /&gt;SQL&gt; create table direct_load(&lt;br /&gt;  2    column1 int,&lt;br /&gt;  3    unused1 int,&lt;br /&gt;  4    column2 int,&lt;br /&gt;  5    column3 int);&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; &lt;br /&gt;TC@SOURCE&gt; insert into direct_load values (1, 0, 2, 3);&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;TC@SOURCE&gt; select *&lt;br /&gt;  2    from direct_load;&lt;br /&gt;&lt;br /&gt;   COLUMN1    UNUSED1    COLUMN2    COLUMN3&lt;br /&gt;---------- ---------- ---------- ----------&lt;br /&gt;         1          0          2          3&lt;br /&gt;&lt;/pre&gt;Secondly, we are making column "unused1" unused: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;TC@SOURCE&gt; alter table direct_load set unused column unused1;&lt;br /&gt;&lt;br /&gt;Table altered.&lt;br /&gt;&lt;/pre&gt;Now I will execute the same DDL commands into TARGET database, which is obviously what GoldenGate server will do if we setup DDL replication: &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql;"&gt;&lt;br /&gt;DBA@TARGET&gt; grant create session, create table, unlimited tablespace to tc identified by tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;DBA@TARGET&gt; conn tc/tc@target&lt;br /&gt;Connected.&lt;br /&gt;TC@TARGET&gt; create table direct_load(&lt;br /&gt;  2    column1 int,&lt;br /&gt;  3    unused1 int,&lt;br /&gt;  4    column2 int,&lt;br /&gt;  5    column3 int);&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;TC@TARGET&gt; &lt;br /&gt;TC@TARGET&gt; insert into direct_load values (1, 0, 2, 3);&lt;br /&gt;&lt;br /&gt;1 row created.&lt;br /&gt;&lt;br /&gt;TC@TARGET&gt; commit;&lt;br /&gt;&lt;br /&gt;Commit complete.&lt;br /&gt;&lt;br /&gt;TC@TARGET&gt; select *&lt;br /&gt;  2    from direct_load;&lt;br /&gt;&lt;br /&gt;   COLUMN1    UNUSED1    COLUMN2    COLUMN3&lt;br /&gt;---------- ---------- ---------- ----------&lt;br /&gt;         1          0          2          3&lt;br /&gt;&lt;br /&gt;TC@TARGET&gt;&lt;br /&gt;TC@TARGET&gt;  alter table direct_load set unused column unused1;&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;Consider the scenario when we have decided to resynchronize data in TARGET database from SOURCE database.&lt;br/&gt;I'm going to remove all rows from the table in TARGET database first: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;TC@TARGET&gt; truncate table direct_load;&lt;br /&gt;&lt;br /&gt;Table truncated.&lt;br /&gt;&lt;/pre&gt;Proceed with GoldenGate setup. I want to use GoldenGate Direct Bulk Load to SQL*Loader capability to move the data from SOURCE database to TARGET database.&lt;br/&gt;Let's use IRTC - as a name of the initial load replicat and IETC - as a name of the initial load extract: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;-- setup initial load replicat&lt;br /&gt;GGSCI (ogg-test) 2&gt; edit params irtc&lt;br /&gt;-- UserIdAlias may be customized accordingly to your environment or simply use a username/password pair&lt;br /&gt;Replicat irtc&lt;br /&gt;AssumeTargetDefs&lt;br /&gt;UserIdAlias target_ogg_replicat&lt;br /&gt;DiscardFile ./dirrpt/irtc.dsc, Purge&lt;br /&gt;-- I want to use Direct Bulk Load&lt;br /&gt;BulkLoad&lt;br /&gt;-- I used PDB "orcl" for my experiments:&lt;br /&gt;Map orcl.tc.*, target orcl.tc.*;&lt;br /&gt;&lt;br /&gt;-- setup initial load extract&lt;br /&gt;GGSCI (ogg-test) 149&gt; edit params ietc&lt;br /&gt;Extract ietc&lt;br /&gt;RmtHost ogg-test, MgrPort 7809&lt;br /&gt;RmtTask Replicat, Group irtc&lt;br /&gt;UserIdAlias source_ogg_extract&lt;br /&gt;Table orcl.tc.direct_load;&lt;br /&gt;&lt;br /&gt;-- let's create GoldenGate processes&lt;br /&gt;GGSCI (ogg-test) 116&gt; add replicat irtc SpecialRun&lt;br /&gt;&lt;br /&gt;REPLICAT added.&lt;br /&gt;&lt;br /&gt;GGSCI (ogg-test) 117&gt; add extract ietc SourceIsTable&lt;br /&gt;&lt;br /&gt;EXTRACT added.&lt;br /&gt;&lt;/pre&gt;The setup has been finished. Right now we can try to perform initial load: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;GGSCI (ogg-test) 15&gt; info i*tc, tasks&lt;br /&gt;&lt;br /&gt;EXTRACT    IETC      Initialized   2016-09-01 08:54   Status STOPPED&lt;br /&gt;Checkpoint Lag       Not Available&lt;br /&gt;Log Read Checkpoint  Not Available&lt;br /&gt;                     First Record         Record 0&lt;br /&gt;Task                 SOURCEISTABLE&lt;br /&gt;&lt;br /&gt;REPLICAT   IRTC      Initialized   2016-09-01 08:54   Status STOPPED&lt;br /&gt;Checkpoint Lag       00:00:00 (updated 00:00:28 ago)&lt;br /&gt;Log Read Checkpoint  Not Available&lt;br /&gt;Task                 SPECIALRUN&lt;br /&gt;&lt;br /&gt;GGSCI (ogg-test) 16&gt; start extract ietc&lt;br /&gt;&lt;br /&gt;Sending START request to MANAGER ...&lt;br /&gt;EXTRACT IETC starting&lt;br /&gt;&lt;/pre&gt;The load has completed pretty soon: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;GGSCI (ogg-test) 17&gt; info i*tc, tasks&lt;br /&gt;&lt;br /&gt;EXTRACT    IETC      Last Started 2016-09-01 08:55   Status STOPPED&lt;br /&gt;Checkpoint Lag       Not Available&lt;br /&gt;Log Read Checkpoint  Table ORCL.TC.DIRECT_LOAD&lt;br /&gt;                     2016-09-01 08:55:27  Record 1&lt;br /&gt;Task                 SOURCEISTABLE&lt;br /&gt;&lt;br /&gt;REPLICAT   IRTC      Initialized   2016-09-01 08:54   Status STOPPED&lt;br /&gt;Checkpoint Lag       00:00:00 (updated 00:02:09 ago)&lt;br /&gt;Log Read Checkpoint  Not Available&lt;br /&gt;Task                 SPECIALRUN&lt;br /&gt;&lt;/pre&gt;ggserr.log file doesn't raise any concerns: &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql;"&gt;&lt;br /&gt;2016-09-01 08:55:11  INFO    OGG-00987  Oracle GoldenGate Command Interpreter for Oracle:  GGSCI command (velikikh): start extract ietc.&lt;br /&gt;2016-09-01 08:55:11  INFO    OGG-00963  Oracle GoldenGate Manager for Oracle, mgr.prm:  Command received from GGSCI on host [127.0.0.1]:54562 (START EXTRACT IETC ).&lt;br /&gt;2016-09-01 08:55:11  INFO    OGG-00960  Oracle GoldenGate Manager for Oracle, mgr.prm:  Access granted (rule #8).&lt;br /&gt;2016-09-01 08:55:11  INFO    OGG-01017  Oracle GoldenGate Capture for Oracle, ietc.prm:  Wildcard resolution set to IMMEDIATE because SOURCEISTABLE is used.&lt;br /&gt;2016-09-01 08:55:11  INFO    OGG-00992  Oracle GoldenGate Capture for Oracle, ietc.prm:  EXTRACT IETC starting.&lt;br /&gt;2016-09-01 08:55:11  INFO    OGG-03059  Oracle GoldenGate Capture for Oracle, ietc.prm:  Operating system character set identified as ISO-8859-1.&lt;br /&gt;2016-09-01 08:55:11  INFO    OGG-02695  Oracle GoldenGate Capture for Oracle, ietc.prm:  ANSI SQL parameter syntax is used for parameter parsing.&lt;br /&gt;2016-09-01 08:55:12  INFO    OGG-03522  Oracle GoldenGate Capture for Oracle, ietc.prm:  Setting session time zone to source database time zone 'GMT'.&lt;br /&gt;2016-09-01 08:55:12  WARNING OGG-00752  Oracle GoldenGate Capture for Oracle, ietc.prm:  Failed to validate table ORCL.TC.DIRECT_LOAD. Likely due to existence of unused column. Please make sure you use sourcedefs in downstream Replicat, or the target table has exactly the same unused columns when using ASSUMETARGETDEFS or DDL replication.&lt;br /&gt;2016-09-01 08:55:12  WARNING OGG-06439  Oracle GoldenGate Capture for Oracle, ietc.prm:  No unique key is defined for table DIRECT_LOAD. All viable columns will be used to represent the key, but may not guarantee uniqueness. KEYCOLS may be used to define the key.&lt;br /&gt;2016-09-01 08:55:12  INFO    OGG-06509  Oracle GoldenGate Capture for Oracle, ietc.prm:  Using the following key columns for source table ORCL.TC.DIRECT_LOAD: COLUMN1, COLUMN2, COLUMN3.&lt;br /&gt;2016-09-01 08:55:12  INFO    OGG-01851  Oracle GoldenGate Capture for Oracle, ietc.prm:  filecaching started: thread ID: 7.&lt;br /&gt;2016-09-01 08:55:12  INFO    OGG-01815  Oracle GoldenGate Capture for Oracle, ietc.prm:  Virtual Memory Facilities for: COM&lt;br /&gt;    anon alloc: mmap(MAP_ANON)  anon free: munmap&lt;br /&gt;    file alloc: mmap(MAP_SHARED)  file free: munmap&lt;br /&gt;    target directories:&lt;br /&gt;    /export/home/velikikh/oracle/12.2.0.1/ggs/dirtmp.&lt;br /&gt;2016-09-01 08:55:16  INFO    OGG-00975  Oracle GoldenGate Manager for Oracle, mgr.prm:  EXTRACT IETC starting.&lt;br /&gt;2016-09-01 08:55:16  INFO    OGG-00993  Oracle GoldenGate Capture for Oracle, ietc.prm:  EXTRACT IETC started.&lt;br /&gt;2016-09-01 08:55:16  INFO    OGG-00963  Oracle GoldenGate Manager for Oracle, mgr.prm:  Command received from EXTRACT on host [127.0.0.1]:58728 (START REPLICAT IRTC CPU -1 PRI -1 PARAMS ).&lt;br /&gt;2016-09-01 08:55:16  INFO    OGG-00960  Oracle GoldenGate Manager for Oracle, mgr.prm:  Access granted (rule #8).&lt;br /&gt;2016-09-01 08:55:16  INFO    OGG-01025  Oracle GoldenGate Delivery for Oracle:  REPLICAT task started by manager (port 7810).&lt;br /&gt;2016-09-01 08:55:21  INFO    OGG-00963  Oracle GoldenGate Manager for Oracle, mgr.prm:  Command received from RMTTASK on host [::1]:59974 (REPORT 3871 7810).&lt;br /&gt;2016-09-01 08:55:21  INFO    OGG-00960  Oracle GoldenGate Manager for Oracle, mgr.prm:  Access granted (rule #1).&lt;br /&gt;2016-09-01 08:55:21  INFO    OGG-00973  Oracle GoldenGate Manager for Oracle, mgr.prm:  Manager started replicat task process (Port 7810).&lt;br /&gt;2016-09-01 08:55:26  INFO    OGG-01229  Oracle GoldenGate Delivery for Oracle:  Connected to ogg-test:50783.&lt;br /&gt;2016-09-01 08:55:26  INFO    OGG-00995  Oracle GoldenGate Delivery for Oracle, irtc.prm:  REPLICAT IRTC starting.&lt;br /&gt;2016-09-01 08:55:26  INFO    OGG-03059  Oracle GoldenGate Delivery for Oracle, irtc.prm:  Operating system character set identified as ISO-8859-1.&lt;br /&gt;2016-09-01 08:55:26  INFO    OGG-02695  Oracle GoldenGate Delivery for Oracle, irtc.prm:  ANSI SQL parameter syntax is used for parameter parsing.&lt;br /&gt;2016-09-01 08:55:27  INFO    OGG-02679  Oracle GoldenGate Delivery for Oracle, irtc.prm:  The Replicat process logged on to database ORCL and can only apply to that database.&lt;br /&gt;2016-09-01 08:55:27  INFO    OGG-06451  Oracle GoldenGate Delivery for Oracle, irtc.prm:  Triggers will be suppressed by default.&lt;br /&gt;2016-09-01 08:55:27  INFO    OGG-01815  Oracle GoldenGate Delivery for Oracle, irtc.prm:  Virtual Memory Facilities for: COM&lt;br /&gt;    anon alloc: mmap(MAP_ANON)  anon free: munmap&lt;br /&gt;    file alloc: mmap(MAP_SHARED)  file free: munmap&lt;br /&gt;    target directories:&lt;br /&gt;    /export/home/velikikh/oracle/12.2.0.1/ggs/dirtmp.&lt;br /&gt;2016-09-01 08:55:27  INFO    OGG-00996  Oracle GoldenGate Delivery for Oracle, irtc.prm:  REPLICAT IRTC started.&lt;br /&gt;2016-09-01 08:55:27  INFO    OGG-03522  Oracle GoldenGate Delivery for Oracle, irtc.prm:  Setting session time zone to source database time zone 'GMT'.&lt;br /&gt;2016-09-01 08:55:27  INFO    OGG-02911  Oracle GoldenGate Capture for Oracle, ietc.prm:  Processing table ORCL.TC.DIRECT_LOAD.&lt;br /&gt;2016-09-01 08:55:27  INFO    OGG-06495  Oracle GoldenGate Capture for Oracle, ietc.prm:  OGG created a session pool with SESSIONPOOLMAX 10, SESSIONPOOLMIN 2 and SESSIONPOOLINCR 2.&lt;br /&gt;2016-09-01 08:55:27  WARNING OGG-02760  Oracle GoldenGate Delivery for Oracle, irtc.prm:  ASSUMETARGETDEFS is ignored because trail file  contains table definitions.&lt;br /&gt;2016-09-01 08:55:27  INFO    OGG-06506  Oracle GoldenGate Delivery for Oracle, irtc.prm:  Wildcard MAP resolved (entry orcl.tc.*): Map "ORCL"."TC"."DIRECT_LOAD", target orcl.tc."DIRECT_LOAD".&lt;br /&gt;2016-09-01 08:55:28  WARNING OGG-06439  Oracle GoldenGate Delivery for Oracle, irtc.prm:  No unique key is defined for table DIRECT_LOAD. All viable columns will be used to represent the key, but may not guarantee uniqueness. KEYCOLS may be used to define the key.&lt;br /&gt;2016-09-01 08:55:28  INFO    OGG-02756  Oracle GoldenGate Delivery for Oracle, irtc.prm:  The definition for table ORCL.TC.DIRECT_LOAD is obtained from the trail file.&lt;br /&gt;2016-09-01 08:55:28  INFO    OGG-06511  Oracle GoldenGate Delivery for Oracle, irtc.prm:  Using following columns in default map by name: COLUMN1, COLUMN2, COLUMN3.&lt;br /&gt;2016-09-01 08:55:28  INFO    OGG-06510  Oracle GoldenGate Delivery for Oracle, irtc.prm:  Using the following key columns for target table ORCL.TC.DIRECT_LOAD: COLUMN1, COLUMN2, COLUMN3.&lt;br /&gt;2016-09-01 08:55:28  INFO    OGG-00178  Oracle GoldenGate Delivery for Oracle, irtc.prm:  owner = "TC", table = "DIRECT_LOAD".&lt;br /&gt;2016-09-01 08:55:28  INFO    OGG-00991  Oracle GoldenGate Capture for Oracle, ietc.prm:  EXTRACT IETC stopped normally.&lt;br /&gt;2016-09-01 08:55:33  INFO    OGG-00994  Oracle GoldenGate Delivery for Oracle, irtc.prm:  REPLICAT IRTC stopped normally.&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;Yes, I had a warning like this: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;2016-09-01 08:55:12  WARNING OGG-00752  Oracle GoldenGate Capture for Oracle, ietc.prm:  Failed to validate table ORCL.TC.DIRECT_LOAD. Likely due to existence of unused column. Please make sure you use sourcedefs in downstream Replicat, or the target table has exactly the same unused columns when using ASSUMETARGETDEFS or DDL replication.&lt;br /&gt;&lt;/pre&gt;But I obviously didn't violate it as the source and the target table has the same unused columns.&lt;br/&gt;Let's see what has loaded into TARGET database: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;TC@TARGET&gt; select * from direct_load;&lt;br /&gt;&lt;br /&gt;   COLUMN1    COLUMN2    COLUMN3&lt;br /&gt;---------- ---------- ----------&lt;br /&gt;         1                     2&lt;br /&gt;&lt;/pre&gt;That's not I wanted to load and that differs from the original table in SOURCE database: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;TC@SOURCE&gt; select * from direct_load;&lt;br /&gt;&lt;br /&gt;   COLUMN1    COLUMN2    COLUMN3&lt;br /&gt;---------- ---------- ----------&lt;br /&gt;         1          2          3&lt;br /&gt;&lt;/pre&gt;Clearly the data from COLUMN2 got loaded into COLUMN3 and I didn't get any errors afterwards leaving my database with "wrong" data.&lt;br/&gt;That's the worst scenario. Originally I faced the issue while I was moving a bunch of data from one database to another using GoldenGate.&lt;br/&gt;The load got ABENDED with ORA-01840 as in my case COLUMN3 had a DATE datatype which may be easily reproduced by the following code: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt; select to_date('2', 'yyyy-mm-dd hh24:mi:ss') from dual;&lt;br /&gt;select to_date('2', 'yyyy-mm-dd hh24:mi:ss') from dual&lt;br /&gt;               *&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-01840: input value not long enough for date format&lt;br /&gt;&lt;/pre&gt;Of course, if you are lucky, you may get some other datatype conversion errors. If you are not, you may end with wrong data in your database and it may take a while before you find the problem.&lt;br/&gt;A few words about workarounds.&lt;br/&gt;In this simple scenario, which I have written just for demonstration purposes, it was enough to drop unused columns in TARGET database: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;TC@TARGET&gt; alter table direct_load drop unused columns;&lt;br /&gt;&lt;br /&gt;Table altered.&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/3967118916042372993/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2016/09/incorrect-handling-of-unused-columns.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3967118916042372993'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3967118916042372993'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2016/09/incorrect-handling-of-unused-columns.html' title='Incorrect handling of unused columns during GoldenGate initial load using Direct Bulk Load to SQL*Loader'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-2341028443213888621</id><published>2016-06-09T08:50:00.001+06:00</published><updated>2016-06-09T08:50:17.875+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12.1.0.2'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><title type='text'>opatch and libpicl on Solaris SPARC</title><content type='html'>This morning while applying recent DBBP (Database Bundle Patch) the datapatch invocation finished with an error: &lt;pre class="brush:sql;highlight:[9-14];"&gt;&lt;br /&gt;SQL Patching tool version 12.1.0.2.0 on Thu Jun  2 10:58:41 2016&lt;br /&gt;Copyright (c) 2015, Oracle.  All rights reserved.&lt;br /&gt;&lt;br /&gt;Log file for this invocation: /export/home/velikikh/oracle/cfgtoollogs/sqlpatch/sqlpatch_12392_2016_06_02_10_58_41/sqlpatch_invocation.log&lt;br /&gt;&lt;br /&gt;Connecting to database...OK&lt;br /&gt;Bootstrapping registry and package to current versions...done&lt;br /&gt;&lt;br /&gt;Queryable inventory could not determine the current opatch status.&lt;br /&gt;Execute 'select dbms_sqlpatch.verify_queryable_inventory from dual'&lt;br /&gt;and/or check the invocation log&lt;br /&gt;/export/home/velikikh/oracle/cfgtoollogs/sqlpatch/sqlpatch_12392_2016_06_02_10_58_41/sqlpatch_invocation.log&lt;br /&gt;for the complete error.&lt;br /&gt;Prereq check failed, exiting without installing any patches.&lt;br /&gt;&lt;br /&gt;Please refer to MOS Note 1609718.1 and/or the invocation log&lt;br /&gt;/export/home/velikikh/oracle/cfgtoollogs/sqlpatch/sqlpatch_12392_2016_06_02_10_58_41/sqlpatch_invocation.log&lt;br /&gt;for information on how to resolve the above errors.&lt;br /&gt;&lt;br /&gt;SQL Patching tool complete on Thu Jun  2 10:58:50 2016&lt;br /&gt;&lt;/pre&gt;Here are the contents of sqlpatch_invocation.log file: &lt;pre class="brush:sql;highlight:[24,26,27];"&gt;&lt;br /&gt;SQL Patching tool version 12.1.0.2.0 on Thu Jun  2 10:58:41 2016&lt;br /&gt;Copyright (c) 2015, Oracle.  All rights reserved.&lt;br /&gt;&lt;br /&gt;Log file for this invocation: /export/home/velikikh/oracle/cfgtoollogs/sqlpatch/sqlpatch_12392_2016_06_02_10_58_41/sqlpatch_invocation.log&lt;br /&gt;&lt;br /&gt;SQL Patching arguments:&lt;br /&gt;  verbose: 1&lt;br /&gt;  force: 0&lt;br /&gt;  prereq: 0&lt;br /&gt;  upgrade_mode_only: &lt;br /&gt;  oh: &lt;br /&gt;  bundle_series: &lt;br /&gt;  ignorable_errors: &lt;br /&gt;  bootstrap: &lt;br /&gt;  skip_upgrade_check: &lt;br /&gt;  userid: &lt;br /&gt;  pdbs: &lt;br /&gt;&lt;br /&gt;Connecting to database...OK&lt;br /&gt;catcon: ALL catcon-related output will be written to /export/home/velikikh/oracle/cfgtoollogs/sqlpatch/sqlpatch_12392_2016_06_02_10_58_41/sqlpatch_catcon__catcon_12392.lst&lt;br /&gt;catcon: See /export/home/velikikh/oracle/cfgtoollogs/sqlpatch/sqlpatch_12392_2016_06_02_10_58_41/sqlpatch_catcon_*.log files for output generated by scripts&lt;br /&gt;catcon: See /export/home/velikikh/oracle/cfgtoollogs/sqlpatch/sqlpatch_12392_2016_06_02_10_58_41/sqlpatch_catcon__*.lst files for spool files, if any&lt;br /&gt;Bootstrapping registry and package to current versions...done&lt;br /&gt;verify_queryable_inventory returned ORA-20001: Latest xml inventory is not loaded into table&lt;br /&gt;&lt;br /&gt;Queryable inventory could not determine the current opatch status.&lt;br /&gt;Execute 'select dbms_sqlpatch.verify_queryable_inventory from dual'&lt;br /&gt;and/or check the invocation log&lt;br /&gt;/export/home/velikikh/oracle/cfgtoollogs/sqlpatch/sqlpatch_12392_2016_06_02_10_58_41/sqlpatch_invocation.log&lt;br /&gt;for the complete error.&lt;br /&gt;Prereq check failed, exiting without installing any patches.&lt;br /&gt;&lt;br /&gt;Please refer to MOS Note 1609718.1 and/or the invocation log&lt;br /&gt;/export/home/velikikh/oracle/cfgtoollogs/sqlpatch/sqlpatch_12392_2016_06_02_10_58_41/sqlpatch_invocation.log&lt;br /&gt;for information on how to resolve the above errors.&lt;br /&gt;&lt;br /&gt;SQL Patching tool complete on Thu Jun  2 10:58:50 2016&lt;br /&gt;&lt;/pre&gt;The famous "ORA-20001: Latest xml inventory is not loaded into table" error even has a dedicated article on MOS: &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1602089.1"&gt;Queryable Patch Inventory - Issues/Solutions for ORA-20001: Latest xml inventory is not loaded into table (Doc ID 1602089.1)&lt;/a&gt;.&lt;br/&gt;I tried all of the provided solutions but no one helped me.&lt;br/&gt;As the sqlpatch_invocation.log suggested, I executed the dbms_sqlpatch.verify_queryable_inventory function: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt;select dbms_sqlpatch.verify_queryable_inventory from dual;&lt;br /&gt;&lt;br /&gt;VERIFY_QUERYABLE_INVENTORY&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;ORA-20001: Latest xml inventory is not loaded into table&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Well, it was nothing new. Then I queried OPATCH_XML_INV external table because it is used internally by the aforementioned function: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt;select * from OPATCH_XML_INV ;&lt;br /&gt;ERROR:&lt;br /&gt;ORA-29913: error in executing ODCIEXTTABLEFETCH callout&lt;br /&gt;ORA-29400: data cartridge error&lt;br /&gt;KUP-04004: error while reading file&lt;br /&gt;/export/home/velikikh/oracle/12.1.0.2/home1/QOpatch/qopiprep.bat&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;no rows selected&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Ok, at least I got some steps for further investigation. qopiprep.bat script simply executes opatch command with some additional processing: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;$ORACLE_HOME/OPatch/opatch lsinventory -xml  $ORACLE_HOME/QOpatch/xml_file.xml -retry 0 -invPtrLoc $ORACLE_HOME/oraInst.loc &gt;&gt; $ORACLE_HOME/QOpatch/stout.txt&lt;br /&gt;&lt;/pre&gt;I decided to try executing it manually: &lt;pre class="brush:sql;highlight:[2,3]"&gt;&lt;br /&gt;SQL&gt;!opatch lsinv&lt;br /&gt;Java HotSpot(TM) 64-Bit Server VM warning: PICL (libpicl.so.1) is missing. Performance will not be optimal.&lt;br /&gt;Java HotSpot(TM) 64-Bit Server VM warning: PICL (libpicl.so.1) is missing. Performance will not be optimal.&lt;br /&gt;Oracle Interim Patch Installer version 12.1.0.1.12&lt;br /&gt;Copyright (c) 2016, Oracle Corporation.  All rights reserved.&lt;br /&gt;..skipped...&lt;br /&gt;&lt;/pre&gt;These lines with JVM warning were rather unusual for me and I did not know why they occured.&lt;br/&gt;As I had a feeling that they were related to my problem, I searched through the MOS knowledge base and found an article: &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=2093623.1"&gt;VM Warning "PICL (libpicl.so.1) is missing" After Upgrading to Java SE 8u40+ or 7u80+ (Doc ID 2093623.1)&lt;/a&gt;.&lt;br/&gt;That had a reference to &lt;a href="https://blogs.oracle.com/poonam/entry/vm_warning_picl_libpicl_so"&gt;Poonam Bajaj's blog&lt;/a&gt;: &lt;pre&gt;&lt;br /&gt; Please note that this warning just indicates that the JVM could not load the PICL library so it won't be able to turn on some of the JIT Compiler optimizations that require the cache line data size information. &lt;br /&gt;It does not stop the Java process, or impact the process in any other way. &lt;br /&gt;Also, note that this is not a Java bug. The warning message is just intended to inform the user that the platform it is running on does not have the PICL library.&lt;br /&gt;&lt;/pre&gt;Well, nothing critical was in those messages but Queryable Opatch Inventory (hereinafter QOpatch) was not working.&lt;br/&gt;To verify my assumption about the negative effect of libpicl message on QOpatch, I made a quick and dirty correction to qopiprep.bat file - I redirected the stderr to /dev/null :): &lt;pre class="brush:sql;"&gt;&lt;br /&gt;$ORACLE_HOME/OPatch/opatch lsinventory -xml  $ORACLE_HOME/QOpatch/xml_file.xml -retry 0 -invPtrLoc $ORACLE_HOME/oraInst.loc &gt;&gt; $ORACLE_HOME/QOpatch/stout.txt 2&gt;/dev/null&lt;br /&gt;&lt;/pre&gt;Having done that, I executed select against OPATCH_XML_INV table: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt;select * from opatch_xml_inv;&lt;br /&gt;&lt;br /&gt;XML_INVENTORY&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt; &lt;Inv&lt;br /&gt;entoryInstance&gt; &amp;lt;ora&lt;br /&gt;&lt;/pre&gt;Allright, at least it started working. I didn't try executing other commands but instead asked the SA (System Administrator) team to install the libpicl.so library.&lt;br/&gt;They installed pkg:/system/libpicl and I finally got datapatch working: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;[velikikh@gsmcat OPatch]$ ./datapatch -verbose&lt;br /&gt;SQL Patching tool version 12.1.0.2.0 on Thu Jun  2 13:26:15 2016&lt;br /&gt;Copyright (c) 2015, Oracle.  All rights reserved.&lt;br /&gt;&lt;br /&gt;Log file for this invocation: /export/home/velikikh/oracle/cfgtoollogs/sqlpatch/sqlpatch_6653_2016_06_02_13_26_15/sqlpatch_invocation.log&lt;br /&gt;&lt;br /&gt;Connecting to database...OK&lt;br /&gt;Bootstrapping registry and package to current versions...done&lt;br /&gt;Determining current state...done&lt;br /&gt;&lt;br /&gt;Current state of SQL patches:&lt;br /&gt;Bundle series DBBP:&lt;br /&gt;  ID 160419 in the binary registry and not installed in the SQL registry&lt;br /&gt;&lt;br /&gt;Adding patches to installation queue and performing prereq checks...&lt;br /&gt;Installation queue:&lt;br /&gt;  Nothing to roll back&lt;br /&gt;  The following patches will be applied:&lt;br /&gt;    22806133 (DATABASE BUNDLE PATCH: 12.1.0.2.160419 (22806133))&lt;br /&gt;&lt;br /&gt;Installing patches...&lt;br /&gt;Patch installation complete.  Total patches installed: 1&lt;br /&gt;&lt;br /&gt;Validating logfiles...&lt;br /&gt;Patch 22806133 apply: SUCCESS&lt;br /&gt;  logfile: /export/home/velikikh/oracle/cfgtoollogs/sqlpatch/22806133/20067756/22806133_apply_GSMCAT_2016Jun02_13_28_31.log (no errors)&lt;br /&gt;SQL Patching tool complete on Thu Jun  2 13:32:19 2016&lt;br /&gt;&lt;/pre&gt;So the conclusion is, while using Oracle Database 12c on Solaris 11 SPARC64, you will definitely need to install the libpicl. This requirement has not mentioned either in Oracle Database documentation or MOS articles (at least I have missed something) but it is present.&lt;br/&gt;From &lt;a href="https://docs.oracle.com/database/121/SSDBI/pre_install.htm#SSDBI7565"&gt;Oracle Database Installation Guide for Oracle Solaris&lt;/a&gt;: &lt;pre&gt;&lt;br /&gt;The following packages must be installed:&lt;br /&gt;    pkg://solaris/system/dtrace&lt;br /&gt;    pkg://solaris/developer/assembler&lt;br /&gt;    pkg://solaris/developer/build/make&lt;br /&gt;    pkg://solaris/system/xopen/xcu4 (if not already installed as part of standard Oracle Solaris 11 installation)&lt;br /&gt;    pkg://solaris/x11/diagnostic/x11-info-clients&lt;br /&gt;    pkg://solaris/compress/unzip&lt;br /&gt;&lt;/pre&gt;Although I'd had these packages installed, the datapatch execution completed with the errors till I installed system/picl: &lt;pre class="brush:sql;highlight:[11];"&gt;&lt;br /&gt;-bash-4.1$ pkg list dtrace assembler make xcu4 x11-info-clients unzip&lt;br /&gt;NAME (PUBLISHER)                                  VERSION                    IFO&lt;br /&gt;compress/unzip                                    6.0-0.175.2.10.0.4.0       i--&lt;br /&gt;developer/assembler                               0.5.11-0.175.2.13.0.2.0    i--&lt;br /&gt;developer/build/make                              0.5.11-0.175.2.0.0.34.0    i--&lt;br /&gt;system/dtrace                                     0.5.11-0.175.2.12.0.4.2    i--&lt;br /&gt;system/xopen/xcu4                                 0.5.11-0.175.2.13.0.1.2    i--&lt;br /&gt;x11/diagnostic/x11-info-clients                   7.7-0.175.2.0.0.42.1406    i--&lt;br /&gt;-bash-4.1$ pkg list picl&lt;br /&gt;NAME (PUBLISHER)                                  VERSION                    IFO&lt;br /&gt;system/picl                                       0.5.11-0.175.2.9.0.3.2     i--&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/2341028443213888621/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2016/06/opatch-and-libpicl-on-solaris-sparc.html#comment-form' title='Комментарии: 5'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/2341028443213888621'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/2341028443213888621'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2016/06/opatch-and-libpicl-on-solaris-sparc.html' title='opatch and libpicl on Solaris SPARC'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>5</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-5421528511975155879</id><published>2016-05-14T12:31:00.000+06:00</published><updated>2016-05-14T12:31:24.968+06:00</updated><app:control xmlns:app='http://purl.org/atom/app#'><app:draft>yes</app:draft></app:control><category scheme='http://www.blogger.com/atom/ns#' term='11g'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-02289'/><category scheme='http://www.blogger.com/atom/ns#' term='EBR'/><category scheme='http://www.blogger.com/atom/ns#' term='11.2.0.3'/><title type='text'>Edition-Based redefinition: adjunct schemas and stub objects</title><content type='html'>EBR (Edition-Based Redefinition) - one of the killer feature of Oracle Database 11g R2, as &lt;a href="http://www.oracle.com/au/products/database/o30asktom-082672.html"&gt;said Tom Kyte at the 2010&lt;/a&gt;. &lt;br/&gt;But I don't think that this feature widely used by Oracle community. &lt;br/&gt;Why? Probably, because application must be "edition-aware", as described by Tom Kyte in his excellent articles. &lt;br/&gt;I have been using EBR (Edition-Based Redefinition) since 2012. &lt;br/&gt;In this blog post I would like to describe one of the basic components of EBR: adjunct schemas and stub objects. &lt;br/&gt;All of this information is a pure speculations based on blog posts and Oracle whitepapers, and my experience with EBR feature. &lt;br/&gt;All tests are run in Oracle Database version 11.2.0.3 under Solaris SPARC. &lt;br/&gt;Here is a code that I have used for this demo: &lt;pre class="brush:sql"&gt;&lt;br /&gt;def tns_alias="orcl"&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  connect as DBA user&lt;br /&gt;#&lt;br /&gt;conn /@&amp;tns_alias.&lt;br /&gt;&lt;br /&gt;set echo on timi off ti off sqlp "SQL&gt; "&lt;br /&gt;&lt;br /&gt;drop edition e1 cascade;&lt;br /&gt;drop user tc cascade;&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  Create editions-enabled schema&lt;br /&gt;#&lt;br /&gt;grant create procedure, create session to tc identified by tc;&lt;br /&gt;&lt;br /&gt;alter user tc enable editions;&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  Create sample procedure&lt;br /&gt;#&lt;br /&gt;&lt;br /&gt;create procedure tc.p&lt;br /&gt;is&lt;br /&gt;begin&lt;br /&gt;  null;&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  Create new edition&lt;br /&gt;#&lt;br /&gt;&lt;br /&gt;alter session set events 'sql_trace bind=true';&lt;br /&gt;create edition e1;&lt;br /&gt;alter session set events 'sql_trace off';&lt;br /&gt;&lt;br /&gt;select value from v$diag_info where name='Default Trace File';&lt;br /&gt;&lt;/pre&gt;We will trace "CREATE EDITION" statement to spot recursive SQL that executed internally. Here is some interesting lines from a trace file. &lt;br/&gt;INSERT INTO USER$ (SQL formatted for beauty): &lt;pre class="brush:sql"&gt;&lt;br /&gt;PARSING IN CURSOR #18446744071527995816 len=278 dep=1 uid=0 oct=2 lid=0 tim=33974283247243 hv=2368283555 ad='4098ba608' sqlid='3jahzuu6kk8x3'&lt;br /&gt;insert into user$(&lt;br /&gt;  user#, &lt;br /&gt;  name, &lt;br /&gt;  password, &lt;br /&gt;  ctime, &lt;br /&gt;  ptime,                      &lt;br /&gt;  datats#, &lt;br /&gt;  tempts#, &lt;br /&gt;  type#, &lt;br /&gt;  defrole, &lt;br /&gt;  resource$, &lt;br /&gt;  ltime,                      &lt;br /&gt;  astatus, &lt;br /&gt;  lcount, &lt;br /&gt;  spare1, &lt;br /&gt;  spare2, &lt;br /&gt;  ext_username)    &lt;br /&gt;values(&lt;br /&gt;  :1, &lt;br /&gt;  :2, &lt;br /&gt;  NULL, &lt;br /&gt;  sysdate, &lt;br /&gt;  null, &lt;br /&gt;  :3, &lt;br /&gt;  :4, &lt;br /&gt;  2, &lt;br /&gt;  :5, &lt;br /&gt;  :6, &lt;br /&gt;  null, &lt;br /&gt;  :7, &lt;br /&gt;  0, &lt;br /&gt;  16, &lt;br /&gt;  :8, &lt;br /&gt;  :9)&lt;br /&gt;END OF STMT&lt;br /&gt;PARSE #18446744071527995816:c=0,e=284,p=0,cr=0,cu=0,mis=0,r=0,dep=1,og=4,plh=0,tim=33974283247239&lt;br /&gt;BINDS #18446744071527995816:&lt;br /&gt; Bind#0&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=0001 frm=00 csi=00 siz=24 off=0&lt;br /&gt;  kxsbbbfp=ffffffff7df72110  bln=22  avl=03  flg=05&lt;br /&gt;  value=1502&lt;br /&gt; Bind#1&lt;br /&gt;  oacdty=01 mxl=32(30) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=10 fl2=0001 frm=01 csi=35 siz=32 off=0&lt;br /&gt;  kxsbbbfp=ffffffff7fff9548  bln=32  avl=30  flg=09&lt;br /&gt;  value="SYS_9Q3#8CWX#34C47T2ECCT4NJC0Z"&lt;br /&gt; Bind#2&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=0001 frm=00 csi=00 siz=144 off=0&lt;br /&gt;  kxsbbbfp=ffffffff7df72068  bln=22  avl=02  flg=05&lt;br /&gt;  value=21&lt;br /&gt; Bind#3&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=0001 frm=00 csi=00 siz=0 off=24&lt;br /&gt;  kxsbbbfp=ffffffff7df72080  bln=22  avl=02  flg=01&lt;br /&gt;  value=3&lt;br /&gt; Bind#4&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=0001 frm=00 csi=00 siz=0 off=48&lt;br /&gt;  kxsbbbfp=ffffffff7df72098  bln=22  avl=01  flg=01&lt;br /&gt;  value=0&lt;br /&gt; Bind#5&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=0001 frm=00 csi=00 siz=0 off=72&lt;br /&gt;  kxsbbbfp=ffffffff7df720b0  bln=22  avl=02  flg=01&lt;br /&gt;  value=1&lt;br /&gt; Bind#6&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=0001 frm=00 csi=00 siz=0 off=96&lt;br /&gt;  kxsbbbfp=ffffffff7df720c8  bln=22  avl=01  flg=01&lt;br /&gt;  value=0&lt;br /&gt; Bind#7&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=0001 frm=00 csi=00 siz=0 off=120&lt;br /&gt;  kxsbbbfp=ffffffff7df720e0  bln=22  avl=04  flg=01&lt;br /&gt;  value=349694&lt;br /&gt; Bind#8&lt;br /&gt;  oacdty=01 mxl=32(02) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=10 fl2=0001 frm=01 csi=35 siz=32 off=0&lt;br /&gt;  kxsbbbfp=ffffffff7fff9584  bln=32  avl=02  flg=09&lt;br /&gt;  value="TC"&lt;br /&gt;EXEC #18446744071527995816:c=10000,e=7218,p=0,cr=1,cu=5,mis=0,r=1,dep=1,og=4,plh=0,tim=33974283255344&lt;br /&gt;&lt;/pre&gt;Using Tom Kyte print_table procedure: &lt;pre class="brush:sql"&gt;&lt;br /&gt;14:54:38 SYS@dpdba AS SYSDBA/11.2.0.3&gt; exec print_table( 'select * from sys.user$ where user#=1502')&lt;br /&gt;USER#                         : 1502&lt;br /&gt;NAME                          : SYS_9Q3#8CWX#34C47T2ECCT4NJC0Z&lt;br /&gt;TYPE#                         : 2&lt;br /&gt;PASSWORD                      :&lt;br /&gt;DATATS#                       : 21&lt;br /&gt;TEMPTS#                       : 3&lt;br /&gt;CTIME                         : 09.02.2015 14:05:51&lt;br /&gt;PTIME                         :&lt;br /&gt;EXPTIME                       :&lt;br /&gt;LTIME                         :&lt;br /&gt;RESOURCE$                     : 1&lt;br /&gt;AUDIT$                        :&lt;br /&gt;DEFROLE                       : 0&lt;br /&gt;DEFGRP#                       :&lt;br /&gt;DEFGRP_SEQ#                   :&lt;br /&gt;ASTATUS                       : 0&lt;br /&gt;LCOUNT                        : 0&lt;br /&gt;DEFSCHCLASS                   :&lt;br /&gt;EXT_USERNAME                  : TC&lt;br /&gt;SPARE1                        : 16&lt;br /&gt;SPARE2                        : 349694&lt;br /&gt;SPARE3                        :&lt;br /&gt;SPARE4                        :&lt;br /&gt;SPARE5                        :&lt;br /&gt;SPARE6                        :&lt;br /&gt;&lt;/pre&gt;We can see that USER$ was populated with new row with obscure "NAME" SYS_%. New row has "TYPE#"=2. &lt;br/&gt;According to a definition of SYS.USER$ table from @?/rdbms/admin/dcore.bsq this's "adjunct" schema: &lt;pre class="brush:sql"&gt;&lt;br /&gt;create table user$                                             /* user table */&lt;br /&gt;( user#         number not null,                   /* user identifier number */&lt;br /&gt;  name          varchar2("M_IDEN") not null,                 /* name of user */&lt;br /&gt;               /* 0 = role, 1 = user, 2 = adjunct schema, 3 = schema synonym */&lt;br /&gt;&lt;/pre&gt;Row has EXT_USERNAME same as original schema: &lt;pre class="brush:sql"&gt;&lt;br /&gt;EXT_USERNAME                  : TC&lt;br /&gt;&lt;/pre&gt;SPARE2 - references to edition object: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SPARE2                        : 349694&lt;br /&gt;&lt;br /&gt;SQL&gt; exec print_table( 'select * from dba_objects where object_id=349694')&lt;br /&gt;OWNER                         : SYS&lt;br /&gt;OBJECT_NAME                   : E1&lt;br /&gt;SUBOBJECT_NAME                :&lt;br /&gt;OBJECT_ID                     : 349694&lt;br /&gt;DATA_OBJECT_ID                :&lt;br /&gt;OBJECT_TYPE                   : EDITION&lt;br /&gt;CREATED                       : 09.02.2015 14:05:51&lt;br /&gt;LAST_DDL_TIME                 : 09.02.2015 14:05:51&lt;br /&gt;TIMESTAMP                     : 2015-02-09:14:05:51&lt;br /&gt;STATUS                        : VALID&lt;br /&gt;TEMPORARY                     : N&lt;br /&gt;GENERATED                     : N&lt;br /&gt;SECONDARY                     : N&lt;br /&gt;NAMESPACE                     : 64&lt;br /&gt;EDITION_NAME                  :&lt;br /&gt;&lt;/pre&gt;All objects in a new editions owned by this adjunct schema. If we have many editions - we have many adjunct schemas. &lt;br/&gt;This's not clear how to get information about to which edition particular library cache object belongs. But such information visible in library cache dump: &lt;pre class="brush:sql;highlight: [1];"&gt;&lt;br /&gt;-- objects in edition&lt;br /&gt;ObjectName: Name=EDITION_NAME.OWNER.MYPROC&lt;br /&gt;-- objects in ORA$BASE edition&lt;br /&gt;ObjectName: Name=OWNER.MYPROC&lt;br /&gt;&lt;/pre&gt;I asked &lt;a href="http://www.igormelnikov.com/2014/06/markhot-edition-base-redefinition.html"&gt;Igor Melnikov&lt;/a&gt; about it in his blog, but still didn't receive response from him. &lt;br/&gt;I can determine to which edition library cache object belongs from the library cache dump, but I don't know which X$-fixed table holds such information. &lt;br/&gt;Why does it matter? Because recently I faced with unpublished &lt;a href="https://bug.oraclecorp.com/pls/bug/webbug_edit.edit_info_top?rptno=18842528"&gt;Bug 18842528: CACHED SELECT STATEMENT INCORRECTLY THROWS ORA-02289&lt;/a&gt; which has been closed as duplicate of: &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=17912217.8"&gt;Bug 17912217: COMPILATION FAILS WHEN NAME RESOLUTION IS DONE IN A NON-EXISTENT EDITION&lt;/a&gt;&lt;br/&gt;In short, statement fails with ORA-2289 error after we retired old editions (dropped): &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; alter session set optimizer_mode=all_rows;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; SELECT SEQ.NEXTVAL FROM DUAL;&lt;br /&gt;SELECT SEQ.NEXTVAL FROM DUAL&lt;br /&gt;       *&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-02289: sequence does not exist&lt;br /&gt;&lt;br /&gt;SQL&gt; alter session set optimizer_mode=first_rows_100;&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; SELECT SEQ.NEXTVAL FROM DUAL;&lt;br /&gt;&lt;br /&gt;   NEXTVAL&lt;br /&gt;----------&lt;br /&gt; 522982683&lt;br /&gt;&lt;/pre&gt;This issue was hard to reproduce and diagnose, but didn't reproduce after we applied a patch. &lt;br/&gt;DD (data dictionary) views was extended to support new feature, as described by &lt;a href="http://afatkulin.blogspot.ru/2009/01/edition-based-redifinition-speculation.html"&gt;Alex Fatkulin&lt;/a&gt;. &lt;br/&gt;Further in a trace file I see 2 INSERTs into OBJ$. &lt;br/&gt;First insert is below: &lt;pre class="brush:sql;highlight: [1];"&gt;&lt;br /&gt;PARSING IN CURSOR #18446744071463117240 len=780 dep=1 uid=0 oct=2 lid=0 tim=33974283256417 hv=2667627462 ad='4098b2d68' sqlid='a85xw8qgh1hy6'&lt;br /&gt;insert into obj$(&lt;br /&gt;  obj#, &lt;br /&gt;  dataobj#, &lt;br /&gt;  owner#, &lt;br /&gt;  name, &lt;br /&gt;  namespace,              &lt;br /&gt;  subname, &lt;br /&gt;  type#, &lt;br /&gt;  ctime, &lt;br /&gt;  mtime, &lt;br /&gt;  stime,              &lt;br /&gt;  status, &lt;br /&gt;  remoteowner,              &lt;br /&gt;  linkname, &lt;br /&gt;  flags, &lt;br /&gt;  oid$,              &lt;br /&gt;  spare1, &lt;br /&gt;  spare2, &lt;br /&gt;  spare3, &lt;br /&gt;  spare4, &lt;br /&gt;  spare5, &lt;br /&gt;  spare6)    &lt;br /&gt;select dbms_ddl_internal.gen_new_object_id,             &lt;br /&gt;       decode(type#, 88, dataobj#, obj#), &lt;br /&gt;       :1, &lt;br /&gt;       name, &lt;br /&gt;       namespace,             &lt;br /&gt;       subname, &lt;br /&gt;       :2, &lt;br /&gt;       sysdate, &lt;br /&gt;       sysdate, &lt;br /&gt;       :3,              &lt;br /&gt;       decode(status, 1, 1, 2, 1, 3, 1, 5),              &lt;br /&gt;       remoteowner, &lt;br /&gt;       linkname, &lt;br /&gt;       0, &lt;br /&gt;       oid$,              &lt;br /&gt;       spare1, &lt;br /&gt;       spare2, &lt;br /&gt;       spare3, &lt;br /&gt;       spare4, &lt;br /&gt;       spare5, &lt;br /&gt;       spare6      &lt;br /&gt;  from obj$     &lt;br /&gt; where owner#=:4       &lt;br /&gt;   and type# in (4,5,7,8,9,10,11,12,13,14,22,87,88)       &lt;br /&gt;   and obj# not in (&lt;br /&gt;         select obj#                          &lt;br /&gt;           from trigger$                         &lt;br /&gt;          where bitand(property, 8192) = 8192)&lt;br /&gt;END OF STMT&lt;br /&gt;PARSE #18446744071463117240:c=0,e=373,p=0,cr=0,cu=0,mis=0,r=0,dep=1,og=4,plh=452778131,tim=33974283256413&lt;br /&gt;BINDS #18446744071463117240:&lt;br /&gt; Bind#0&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=0001 frm=00 csi=00 siz=48 off=0&lt;br /&gt;  kxsbbbfp=ffffffff7df720f8  bln=22  avl=03  flg=05&lt;br /&gt;  value=1502&lt;br /&gt; Bind#1&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=0001 frm=00 csi=00 siz=0 off=24&lt;br /&gt;  kxsbbbfp=ffffffff7df72110  bln=22  avl=02  flg=01&lt;br /&gt;  value=88&lt;br /&gt; Bind#2&lt;br /&gt;  oacdty=12 mxl=07(07) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=10 fl2=0001 frm=00 csi=00 siz=8 off=0&lt;br /&gt;  kxsbbbfp=ffffffff7fff940c  bln=07  avl=07  flg=09&lt;br /&gt;  value="0/0/-10100 -1:-1:-1"&lt;br /&gt; Bind#3&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=0001 frm=00 csi=00 siz=24 off=0&lt;br /&gt;  kxsbbbfp=ffffffff7df720c8  bln=22  avl=03  flg=05&lt;br /&gt;  value=1501&lt;br /&gt;EXEC #18446744071463117240:c=60000,e=62922,p=0,cr=304,cu=11,mis=0,r=1,dep=1,og=4,plh=452778131,tim=33974283320247&lt;br /&gt;&lt;/pre&gt;Second insert is below: &lt;pre class="brush:sql;highlight: [1];"&gt;&lt;br /&gt;PARSING IN CURSOR #18446744071469117216 len=622 dep=1 uid=0 oct=2 lid=0 tim=33974283322722 hv=1588609275 ad='4098b1518' sqlid='3hjqkbpgb0h7v'&lt;br /&gt;insert into obj$(&lt;br /&gt;  obj#, &lt;br /&gt;  owner#, &lt;br /&gt;  name, &lt;br /&gt;  namespace,              &lt;br /&gt;  subname, &lt;br /&gt;  type#, &lt;br /&gt;  ctime, &lt;br /&gt;  mtime, &lt;br /&gt;  stime,              &lt;br /&gt;  status, &lt;br /&gt;  remoteowner, &lt;br /&gt;  linkname, &lt;br /&gt;  flags, &lt;br /&gt;  oid$,              &lt;br /&gt;  spare1, &lt;br /&gt;  spare2, &lt;br /&gt;  spare3, &lt;br /&gt;  spare4, &lt;br /&gt;  spare5, &lt;br /&gt;  spare6)    &lt;br /&gt;select dbms_ddl_internal.gen_new_object_id, &lt;br /&gt;       :1, &lt;br /&gt;       name, &lt;br /&gt;       namespace,             &lt;br /&gt;       subname, &lt;br /&gt;       10, &lt;br /&gt;       sysdate, &lt;br /&gt;       sysdate, &lt;br /&gt;       :2,              &lt;br /&gt;       1, &lt;br /&gt;       remoteowner, &lt;br /&gt;       linkname, &lt;br /&gt;       0, &lt;br /&gt;       oid$,              &lt;br /&gt;       spare1, &lt;br /&gt;       spare2, &lt;br /&gt;       spare3, &lt;br /&gt;       spare4, &lt;br /&gt;       spare5, &lt;br /&gt;       spare6      &lt;br /&gt;  from obj$     &lt;br /&gt; where owner#=:3       &lt;br /&gt;   and type#=12       &lt;br /&gt;   and obj# in (&lt;br /&gt;         select obj#                         &lt;br /&gt;           from trigger$                         &lt;br /&gt;          where bitand(property, 8192) = 8192)&lt;br /&gt;END OF STMT&lt;br /&gt;PARSE #18446744071469117216:c=0,e=329,p=0,cr=0,cu=0,mis=0,r=0,dep=1,og=4,plh=2258873412,tim=33974283322718&lt;br /&gt;BINDS #18446744071469117216:&lt;br /&gt; Bind#0&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=0001 frm=00 csi=00 siz=24 off=0&lt;br /&gt;  kxsbbbfp=ffffffff7a6e7798  bln=22  avl=03  flg=05&lt;br /&gt;  value=1502&lt;br /&gt; Bind#1&lt;br /&gt;  oacdty=12 mxl=07(07) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=10 fl2=0001 frm=00 csi=00 siz=8 off=0&lt;br /&gt;  kxsbbbfp=ffffffff7fff940c  bln=07  avl=07  flg=09&lt;br /&gt;  value="0/0/-10100 -1:-1:-1"&lt;br /&gt; Bind#2&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=0001 frm=00 csi=00 siz=24 off=0&lt;br /&gt;  kxsbbbfp=ffffffff7a6e7768  bln=22  avl=03  flg=05&lt;br /&gt;  value=1501&lt;br /&gt;EXEC #18446744071469117216:c=10000,e=4412,p=0,cr=98,cu=0,mis=0,r=0,dep=1,og=4,plh=2258873412,tim=33974283327961&lt;br /&gt;&lt;/pre&gt;This's my speculation: As we can see from @?/rdbms/admin/dcore.bsq, first INSERT statement for editioned-objects, second something trigger special.  &lt;pre class="brush:sql;"&gt;&lt;br /&gt;create table obj$                                            /* object table */&lt;br /&gt;( obj#          number not null,                            /* object number */&lt;br /&gt;  dataobj#      number,                          /* data layer object number */&lt;br /&gt;  owner#        number not null,                        /* owner user number */&lt;br /&gt;  name          varchar2("M_IDEN") not null,                  /* object name */&lt;br /&gt;  namespace     number not null,         /* namespace of object (see KQD.H): */&lt;br /&gt; /* 1 = TABLE/PROCEDURE/TYPE, 2 = BODY, 3 = TRIGGER, 4 = INDEX, 5 = CLUSTER, */&lt;br /&gt;                                                  /* 8 = LOB, 9 = DIRECTORY, */&lt;br /&gt;  /* 10 = QUEUE, 11 = REPLICATION OBJECT GROUP, 12 = REPLICATION PROPAGATOR, */&lt;br /&gt;                                     /* 13 = JAVA SOURCE, 14 = JAVA RESOURCE */&lt;br /&gt;                                                 /* 58 = (Data Mining) MODEL */&lt;br /&gt;  subname       varchar2("M_IDEN"),               /* subordinate to the name */&lt;br /&gt;  type#         number not null,                 /* object type (see KQD.H): */&lt;br /&gt;  /* 1 = INDEX, 2 = TABLE, 3 = CLUSTER, 4 = VIEW, 5 = SYNONYM, 6 = SEQUENCE, */&lt;br /&gt;             /* 7 = PROCEDURE, 8 = FUNCTION, 9 = PACKAGE, 10 = NON-EXISTENT, */&lt;br /&gt;              /* 11 = PACKAGE BODY, 12 = TRIGGER, 13 = TYPE, 14 = TYPE BODY, */&lt;br /&gt;      /* 19 = TABLE PARTITION, 20 = INDEX PARTITION, 21 = LOB, 22 = LIBRARY, */&lt;br /&gt;                                             /* 23 = DIRECTORY , 24 = QUEUE, */&lt;br /&gt;    /* 25 = IOT, 26 = REPLICATION OBJECT GROUP, 27 = REPLICATION PROPAGATOR, */&lt;br /&gt;    /* 28 = JAVA SOURCE, 29 = JAVA CLASS, 30 = JAVA RESOURCE, 31 = JAVA JAR, */&lt;br /&gt;                 /* 32 = INDEXTYPE, 33 = OPERATOR , 34 = TABLE SUBPARTITION, */&lt;br /&gt;                                                  /* 35 = INDEX SUBPARTITION */&lt;br /&gt;                                                 /* 82 = (Data Mining) MODEL */&lt;br /&gt;                                /* 92 = OLAP CUBE DIMENSION,  93 = OLAP CUBE */&lt;br /&gt;                   /* 94 = OLAP MEASURE FOLDER, 95 = OLAP CUBE BUILD PROCESS */&lt;br /&gt;&lt;/pre&gt;In both cases we insert rows with "TYPE#"=88. This's something special, so called stub (inherited) objects that will be used for deferred actualization. &lt;br/&gt;DD views was changed with support for these objects in 11g: &lt;a href="http://afatkulin.blogspot.ru/2009/01/edition-based-redifinition-speculation.html"&gt;as written in Alex Fatkulin blog&lt;/a&gt;. &lt;br/&gt;Please note, funny stime column value: &lt;pre class="brush:sql;"&gt;&lt;br /&gt; Bind#2&lt;br /&gt;  oacdty=12 mxl=07(07) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=10 fl2=0001 frm=00 csi=00 siz=8 off=0&lt;br /&gt;  kxsbbbfp=ffffffff7fff940c  bln=07  avl=07  flg=09&lt;br /&gt;  value="0/0/-10100 -1:-1:-1"&lt;br /&gt;&lt;/pre&gt;Date with all bytes set to zero: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt; select stime from sys.obj$ where owner#=1502/*1502 - sys.user$.user# of adjunct schema*/;&lt;br /&gt;ERROR:&lt;br /&gt;ORA-01801: date format is too long for internal buffer&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;no rows selected&lt;br /&gt;&lt;br /&gt;SQL&gt; select dump(stime, 16) dump from sys.obj$ where owner#=1502;&lt;br /&gt;&lt;br /&gt;DUMP&lt;br /&gt;------------------------------&lt;br /&gt;Typ=12 Len=7: 0,0,0,0,0,0,0&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2016/05/edition-based-redefinition-adjunct.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5421528511975155879'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5421528511975155879'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-3807085085024841596</id><published>2016-05-14T12:29:00.000+06:00</published><updated>2016-05-14T12:35:23.000+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12.1.0.2'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><title type='text'>Asynchronous Global Index Maintenance effects</title><content type='html'>I think Asynchronous Global Index Maintenance is one of the most exciting features in Oracle Database 12c.&lt;br/&gt;I would like to blog about one particular case when that feature can cause performance problems.&lt;br/&gt;Let's create some test data: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt; create table t&lt;br /&gt;  2  partition by range(owner)&lt;br /&gt;  3  (&lt;br /&gt;  4    partition values less than ('SYS'),&lt;br /&gt;  5    partition values less than (maxvalue)&lt;br /&gt;  6  )&lt;br /&gt;  7  as&lt;br /&gt;  8  select *&lt;br /&gt;  9    from dba_objects;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; create index t_name_i on t(object_name);&lt;br /&gt;&lt;/pre&gt;Consider the following query: &lt;pre class="brush:sql;highlight:[17];"&gt;&lt;br /&gt;SQL&gt; explain plan for&lt;br /&gt;  2  select max(object_name)&lt;br /&gt;  3    from t;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from table(dbms_xplan.display);&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 2886567490&lt;br /&gt;&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                  | Name     | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT           |          |     1 |    25 |     3   (0)| 00:00:01 |&lt;br /&gt;|   1 |  SORT AGGREGATE            |          |     1 |    25 |            |          |&lt;br /&gt;|   2 |   INDEX FULL SCAN (MIN/MAX)| T_NAME_I |     1 |    25 |     3   (0)| 00:00:01 |&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;&lt;/pre&gt;It's quite simple and the queries like that are common in my environment. For instance, they are used to monitor application activities: "select max(date_column) from some_table" and the stuff alike.&lt;br/&gt;Now I'm going to drop a partition of that table: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt; alter table t drop partition for ('X') update indexes;&lt;br /&gt;&lt;/pre&gt;The index is marked as having orphaned entries after that: &lt;pre class="brush:sql;"&gt;&lt;br /&gt;SQL&gt; select index_name, orphaned_entries&lt;br /&gt;  2    from ind&lt;br /&gt;  3   where table_name='T';&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;INDEX_NAME                     ORPHANED_&lt;br /&gt;------------------------------ ---------&lt;br /&gt;T_NAME_I                       YES&lt;br /&gt;&lt;/pre&gt;Causing some important changes in the plan: &lt;pre class="brush:sql;highlight:[17,23];"&gt;&lt;br /&gt;SQL&gt; explain plan for&lt;br /&gt;  2  select max(object_name)&lt;br /&gt;  3    from t;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from table(dbms_xplan.display);&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;-----------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 3249307143&lt;br /&gt;&lt;br /&gt;----------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation             | Name     | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;----------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT      |          |     1 |    25 |   148   (1)| 00:00:01 |&lt;br /&gt;|   1 |  SORT AGGREGATE       |          |     1 |    25 |            |          |&lt;br /&gt;|*  2 |   INDEX FAST FULL SCAN| T_NAME_I | 96566 |  2357K|   148   (1)| 00:00:01 |&lt;br /&gt;----------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   2 - filter(TBL$OR$IDX$PART$NUM("T",0,8,0,"T".ROWID)=1)&lt;br /&gt;&lt;/pre&gt;The filter clearly was occured due to orphaned index entries which is confirmed by looking into the CBO traces (event 10053): &lt;pre class="brush:sql;"&gt;&lt;br /&gt;Added Filter for Orphaned Entries of Index T_NAME_I:&lt;br /&gt;TBL$OR$IDX$PART$NUM("T",0,8,0,"T".ROWID)=1&lt;br /&gt;&lt;/pre&gt;The IFFS (INDEX FAST FULL SCAN) would cause a huge amount of I/O being executed against large indexes.&lt;br/&gt;For instance, some queries started scanning multi-gigabyte indexes in my database after I had dropped a single small partition while executing periodic maintenance tasks.&lt;br/&gt;Of course, in such case Global Index Maintenance can't be delayed and an index synchronization procedure must be executed ASAP: &lt;pre class="brush:sql;highlight:[25];"&gt;&lt;br /&gt;SQL&gt; alter index t_name_i coalesce cleanup;&lt;br /&gt;SQL&gt; select index_name, orphaned_entries&lt;br /&gt;  2    from ind&lt;br /&gt;  3   where table_name='T';&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;INDEX_NAME                     ORPHANED_&lt;br /&gt;------------------------------ ---------&lt;br /&gt;T_NAME_I                       NO&lt;br /&gt;SQL&gt; explain plan for&lt;br /&gt;  2  select max(object_name)&lt;br /&gt;  3    from t;&lt;br /&gt;SQL&gt; select * from table(dbms_xplan.display);&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 2886567490&lt;br /&gt;&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                  | Name     | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT           |          |     1 |    25 |     3   (0)| 00:00:01 |&lt;br /&gt;|   1 |  SORT AGGREGATE            |          |     1 |    25 |            |          |&lt;br /&gt;|   2 |   INDEX FULL SCAN (MIN/MAX)| T_NAME_I |     1 |    25 |     3   (0)| 00:00:01 |&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/3807085085024841596/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2016/05/asynchronous-global-index-maintenance.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3807085085024841596'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3807085085024841596'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2016/05/asynchronous-global-index-maintenance.html' title='Asynchronous Global Index Maintenance effects'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-6883749671428926709</id><published>2015-12-30T13:42:00.001+06:00</published><updated>2015-12-30T13:48:34.979+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='11g'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-08102'/><title type='text'>ORA-8102 on ALTER TABLE SHRINK SPACE with default column optimization</title><content type='html'>We have been using centralized AWR repository since 2013.&lt;br/&gt;I developed some PL/SQL procedures for that using original awrextr.sql/awrload.sql scripts as a template.&lt;br/&gt;That solution have some drawbacks, for example, an AWR retention for foreign databases always set to 40150 years after each load:&lt;br/&gt;&lt;pre class="brush:sql;highlight:[6,7]"&gt;&lt;br /&gt;SQL&gt; select dbid, retention from dba_hist_wr_control;&lt;br /&gt;&lt;br /&gt;      DBID RETENTION&lt;br /&gt;---------- --------------------&lt;br /&gt;1110059808 +00366 00:00:00.0&lt;br /&gt;1917063347 +40150 00:00:00.0&lt;br /&gt;1996649024 +40150 00:00:00.0&lt;br /&gt;&lt;/pre&gt;We could change the retention but that would always be reset on the next AWR load.&lt;br/&gt;To prevent the excessive AWR data growth, I executed &lt;a href="https://docs.oracle.com/database/121/ARPLS/d_workload_repos.htm#ARPLS69138"&gt;DBMS_WORKLOAD_REPOSITORY.DROP_SNAPSHOT_RANGE&lt;/a&gt; procedure once a year.&lt;br/&gt;The 2015 year was no exception.&lt;br/&gt;I also executed ALTER TABLE SHRINK SPACE command after I had executed DBMS_WORKLOAD_REPOSITORY.DROP_SNAPSHOT_RANGE procedures.&lt;br/&gt;Usually that command takes a while to execute, because the some of AWR tables are more than 50G in size, for example, WRH$_ACTIVE_SESSION_HISTORY.&lt;br/&gt;It's a base table for DBA_HIST_ACTIVE_SESS_HISTORY view and contains an ASH data that's huge.&lt;br/&gt;This year things went wrong:&lt;br/&gt;&lt;pre class="brush:sql;highlight:[2]"&gt;&lt;br /&gt;SQL&gt; alter table SYS.WRH$_ACTIVE_SESSION_HISTORY shrink space;&lt;br /&gt;-- AFTER 4-8 hours&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-03113: end-of-file on communication channel&lt;br /&gt;Process ID: 635&lt;br /&gt;Session ID: 281 Serial number: 54363&lt;br /&gt;&lt;/pre&gt;alert.log was not very helpful: &lt;pre class="brush:sql"&gt;&lt;br /&gt;Mon Dec 21 14:37:31 2015&lt;br /&gt;Process 0x3cd728e40 appears to be hung while dumping&lt;br /&gt;Current time = 1689592362, process death time = 1689530965 interval = 60000&lt;br /&gt;Called from location UNKNOWN:UNKNOWN&lt;br /&gt;Attempting to kill process 0x3cd728e40 with OS pid = 17740&lt;br /&gt;OSD kill succeeded for process 3cd728e40&lt;br /&gt;Mon Dec 21 14:39:46 2015&lt;br /&gt;Errors in file /oracle/diag/rdbms/orcl/orcl/trace/orcl_ora_25447.trc:&lt;br /&gt;&lt;/pre&gt;But a relevant trace file (which was more than 4G in size) spotted a light on a problem: &lt;pre class="brush:sql;highlight:[3]"&gt;&lt;br /&gt;*** ACTION NAME:() 2015-12-21 14:39:46.890&lt;br /&gt; &lt;br /&gt;oer 8102.2 - obj# 1021709, rdba: 0x086ad43c(afn 33, blk# 2806844)&lt;br /&gt;kdk key 8102.2:&lt;br /&gt;  ncol: 6, len: 26&lt;br /&gt;  key: (26): &lt;br /&gt; 06 c5 0c 0b 06 63 09 04 c3 08 0e 3e 02 c1 02 05 c4 62 46 05 3b 03 c2 02 3d&lt;br /&gt; ff&lt;br /&gt;  mask: (4096): &lt;br /&gt; 81 90 20 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00&lt;br /&gt;&lt;/pre&gt;Well, string "oer 8102.2" it's a sign of famous ORA-8102 error: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@localhost ~]$ oerr ora 8102&lt;br /&gt;08102, 00000, "index key not found, obj# %s, file %s, block %s (%s)"&lt;br /&gt;// *Cause:  Internal error: possible inconsistency in index&lt;br /&gt;// *Action:  Send trace file to your customer support representative, along&lt;br /&gt;//      with information on reproducing the error&lt;br /&gt;&lt;/pre&gt;obj# 1021709 in the trace file easily shows to us where the problem is: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select xmltype(cursor(select * from dba_objects where object_id=1021709)) xml_rec from dual;&lt;br /&gt;&lt;br /&gt;XML_REC&lt;br /&gt;----------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;?xml version="1.0"?&gt;&lt;br /&gt;&lt;ROWSET&gt;&lt;br /&gt;  &lt;ROW&gt;&lt;br /&gt;    &lt;OWNER&gt;SYS&lt;/OWNER&gt;&lt;br /&gt;    &lt;OBJECT_NAME&gt;WRH$_ACTIVE_SESSION_HISTORY_PK&lt;/OBJECT_NAME&gt;&lt;br /&gt;    &lt;SUBOBJECT_NAME&gt;WRH$_ACTIVE_1110059808_66853&lt;/SUBOBJECT_NAME&gt;&lt;br /&gt;    &lt;OBJECT_ID&gt;1021709&lt;/OBJECT_ID&gt;&lt;br /&gt;    &lt;DATA_OBJECT_ID&gt;1080082&lt;/DATA_OBJECT_ID&gt;&lt;br /&gt;    &lt;OBJECT_TYPE&gt;INDEX PARTITION&lt;/OBJECT_TYPE&gt;&lt;br /&gt;    &lt;CREATED&gt;27.10.2015 01:28:05&lt;/CREATED&gt;&lt;br /&gt;    &lt;LAST_DDL_TIME&gt;22.12.2015 09:11:22&lt;/LAST_DDL_TIME&gt;&lt;br /&gt;    &lt;TIMESTAMP&gt;2015-10-27:01:28:05&lt;/TIMESTAMP&gt;&lt;br /&gt;    &lt;STATUS&gt;VALID&lt;/STATUS&gt;&lt;br /&gt;    &lt;TEMPORARY&gt;N&lt;/TEMPORARY&gt;&lt;br /&gt;    &lt;GENERATED&gt;N&lt;/GENERATED&gt;&lt;br /&gt;    &lt;SECONDARY&gt;N&lt;/SECONDARY&gt;&lt;br /&gt;    &lt;NAMESPACE&gt;4&lt;/NAMESPACE&gt;&lt;br /&gt;    &lt;SHARING&gt;NONE&lt;/SHARING&gt;&lt;br /&gt;    &lt;ORACLE_MAINTAINED&gt;Y&lt;/ORACLE_MAINTAINED&gt;&lt;br /&gt;  &lt;/ROW&gt;&lt;br /&gt;&lt;/ROWSET&gt;&lt;br /&gt;&lt;/pre&gt;The index WRH$_ACTIVE_SESSION_HISTORY_PK is local partitioned on next columns: &lt;pre class="brush:sql"&gt;&lt;br /&gt;CREATE UNIQUE INDEX "SYS"."WRH$_ACTIVE_SESSION_HISTORY_PK" ON "SYS"."WRH$_ACTIVE_SESSION_HISTORY" ("DBID", "SNAP_ID", "INSTANCE_NUMBER", "SAMPLE_ID", "SESSION_ID", "CON_DBID")&lt;br /&gt;&lt;/pre&gt;The all of the above columns are numbers.&lt;br/&gt;The index key: &lt;pre class="brush:sql"&gt;&lt;br /&gt;  key: (26): &lt;br /&gt; 06 c5 0c 0b 06 63 09 04 c3 08 0e 3e 02 c1 02 05 c4 62 46 05 3b 03 c2 02 3d&lt;br /&gt; ff&lt;br /&gt;&lt;/pre&gt; can be decrypted easily: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; with input as (&lt;br /&gt;  2    -- index key&lt;br /&gt;  3    select '06 c5 0c 0b 06 63 09 04 c3 08 0e 3e 02 c1 02 05 c4 62 46 05 3b 03 c2 02 3d ff' c from dual),&lt;br /&gt;  4    t(pos, num,c) as (&lt;br /&gt;  5    -- traverse the index key recursively&lt;br /&gt;  6    select 0 pos, 0, replace(c, ' ') c from input union all&lt;br /&gt;  7    select pos+1,&lt;br /&gt;  8           utl_raw.cast_to_number(hextoraw(substr(c, 3, to_number(substr(c,1,2), 'xx')*2))),&lt;br /&gt;  9           substr(c, (to_number(substr(c, 1, 2), 'xx')+1)*2+1)&lt;br /&gt; 10      from t&lt;br /&gt; 11     where c&lt;&gt;'ff')&lt;br /&gt; 12  select pos, num&lt;br /&gt; 13    from t&lt;br /&gt; 14   where pos&gt;0&lt;br /&gt; 15   order by pos&lt;br /&gt; 16  /&lt;br /&gt;&lt;br /&gt;       POS        NUM&lt;br /&gt;---------- ----------&lt;br /&gt;         1 1110059808&lt;br /&gt;         2      71361&lt;br /&gt;         3          1&lt;br /&gt;         4   97690458&lt;br /&gt;         5        160&lt;br /&gt;&lt;/pre&gt;Ok, now we've known that: dbid=1110059808, snap_id=71361, instance_number=1, sample_id=97690458, session_id=160.&lt;br/&gt;But the index was built on six columns when the problem key contains only five.&lt;br/&gt;What is the CON_DBID for the problem key? That's where the trouble lies!&lt;br/&gt;CON_DBID was introduced in Oracle 12.1 and added as a "DEFAULT NOT NULL" column, i.e. that column addition was a metadata-only operation without updating the table blocks (unless _add_col_optim_enabled was not set to FALSE).&lt;br/&gt;&lt;pre class="brush:sql;highlight:[8]"&gt;&lt;br /&gt;SQL&gt; select to_char(property, 'fm0xxxxxxx')&lt;br /&gt;  2    from sys.col$&lt;br /&gt;  3   where obj# = 22800&lt;br /&gt;  4     and name = 'CON_DBID';&lt;br /&gt;&lt;br /&gt;TO_CHAR(PROPERTY,'FM0XXXXXX&lt;br /&gt;---------------------------&lt;br /&gt;40000000&lt;br /&gt;&lt;/pre&gt;Notice that property was 0x40000000 - I speculated that such property was set to columns which were added with default column optimization. &lt;br/&gt;Some MOS notes prove that, i.e. &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1602994.1"&gt;Table Columns Have Wrong Default Value After Transporting Tablespaces (Doc ID 1602994.1)&lt;/a&gt;.&lt;br/&gt;I dumped the relevant table block and found that CON_DBID column was not present in it.&lt;br/&gt;The pieces of that puzzle started to fit together.&lt;br/&gt;I had constructed a simple test case which reproduced an ORA-8102 error: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; create table t(x int, pad varchar2(100)) enable row movement;&lt;br /&gt;SQL&gt; insert /*+ append*/&lt;br /&gt;  2    into t&lt;br /&gt;  3  select level, lpad('x', 100, 'x')&lt;br /&gt;  4    from dual&lt;br /&gt;  5    connect by level&lt;=1e5;&lt;br /&gt;SQL&gt; commit;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; alter table t add y int default 10 not null;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; create index t_xy_i on t(x,y);&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; delete t where x&lt;=1e5/2;&lt;br /&gt;SQL&gt; commit;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; alter table t shrink space;&lt;br /&gt;alter table t shrink space&lt;br /&gt;*&lt;br /&gt;ERROR at line 1:&lt;br /&gt;ORA-08102: index key not found, obj# 91957, file 10, block 3990 (2)&lt;br /&gt;&lt;/pre&gt;The problem is present in Oracle 11.2.0.4 and more newest versions. I didn't test in earlier 11g patchsets.&lt;br/&gt;Oracle Support raised a new bug: &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=BUG&amp;&amp;productFamily=Oracle&amp;id=22473983"&gt;ORA-8102 ON ALTER TABLE SHRINK SPACE WITH ADD COL OPTIMIZATION (unpublished)&lt;/a&gt;, which is still under investigation.&lt;br/&gt;The tables suspected to an ORA-8102 error can be identified easily by bitand(col$.property, 1073741824)=1073741824 (0x40000000 in hex): &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select o.object_name&lt;br /&gt;  2    from sys.col$ c,&lt;br /&gt;  3         dba_objects o&lt;br /&gt;  4   where bitand(c.property, 1073741824)=1073741824&lt;br /&gt;  5     and o.object_id=c.obj#&lt;br /&gt;  6     and o.owner='SYS'&lt;br /&gt;  7   order by o.object_name;&lt;br /&gt;&lt;/pre&gt;I restricted above query to SYS schema.  Below is the output of that query in one of database which was upgraded from 11.2.0.4 to 12.1.0.2 in the 2015: &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select o.object_name&lt;br /&gt;  2    from sys.col$ c,&lt;br /&gt;  3         dba_objects o&lt;br /&gt;  4   where bitand(c.property, 1073741824)=1073741824&lt;br /&gt;  5     and o.object_id=c.obj#&lt;br /&gt;  6     and o.owner='SYS'&lt;br /&gt;  7   order by o.object_name;&lt;br /&gt;&lt;br /&gt;OBJECT_NAME&lt;br /&gt;-------------------------------------------------------------------&lt;br /&gt;CDB_LOCAL_ADMINAUTH$&lt;br /&gt;HISTGRM$&lt;br /&gt;PROFNAME$&lt;br /&gt;WRH$_ACTIVE_SESSION_HISTORY&lt;br /&gt;WRH$_BG_EVENT_SUMMARY&lt;br /&gt;WRH$_BUFFERED_QUEUES&lt;br /&gt;WRH$_BUFFERED_SUBSCRIBERS&lt;br /&gt;WRH$_BUFFER_POOL_STATISTICS&lt;br /&gt;WRH$_CLUSTER_INTERCON&lt;br /&gt;WRH$_COMP_IOSTAT&lt;br /&gt;WRH$_CR_BLOCK_SERVER&lt;br /&gt;WRH$_CURRENT_BLOCK_SERVER&lt;br /&gt;WRH$_DATAFILE&lt;br /&gt;WRH$_DB_CACHE_ADVICE&lt;br /&gt;WRH$_DISPATCHER&lt;br /&gt;WRH$_DLM_MISC&lt;br /&gt;WRH$_DYN_REMASTER_STATS&lt;br /&gt;WRH$_DYN_REMASTER_STATS&lt;br /&gt;WRH$_ENQUEUE_STAT&lt;br /&gt;WRH$_EVENT_HISTOGRAM&lt;br /&gt;WRH$_EVENT_NAME&lt;br /&gt;WRH$_FILEMETRIC_HISTORY&lt;br /&gt;WRH$_FILESTATXS&lt;br /&gt;WRH$_IC_CLIENT_STATS&lt;br /&gt;WRH$_IC_DEVICE_STATS&lt;br /&gt;WRH$_INSTANCE_RECOVERY&lt;br /&gt;WRH$_INST_CACHE_TRANSFER&lt;br /&gt;WRH$_INTERCONNECT_PINGS&lt;br /&gt;WRH$_IOSTAT_DETAIL&lt;br /&gt;WRH$_IOSTAT_FILETYPE&lt;br /&gt;WRH$_IOSTAT_FILETYPE_NAME&lt;br /&gt;WRH$_IOSTAT_FUNCTION&lt;br /&gt;WRH$_IOSTAT_FUNCTION_NAME&lt;br /&gt;WRH$_JAVA_POOL_ADVICE&lt;br /&gt;WRH$_LATCH&lt;br /&gt;WRH$_LATCH_CHILDREN&lt;br /&gt;WRH$_LATCH_MISSES_SUMMARY&lt;br /&gt;WRH$_LATCH_NAME&lt;br /&gt;WRH$_LATCH_PARENT&lt;br /&gt;WRH$_LIBRARYCACHE&lt;br /&gt;WRH$_LOG&lt;br /&gt;WRH$_MEMORY_RESIZE_OPS&lt;br /&gt;WRH$_MEMORY_TARGET_ADVICE&lt;br /&gt;WRH$_MEM_DYNAMIC_COMP&lt;br /&gt;WRH$_METRIC_NAME&lt;br /&gt;WRH$_MTTR_TARGET_ADVICE&lt;br /&gt;WRH$_MUTEX_SLEEP&lt;br /&gt;WRH$_MVPARAMETER&lt;br /&gt;WRH$_OPTIMIZER_ENV&lt;br /&gt;WRH$_OSSTAT&lt;br /&gt;WRH$_OSSTAT_NAME&lt;br /&gt;WRH$_PARAMETER&lt;br /&gt;WRH$_PARAMETER_NAME&lt;br /&gt;WRH$_PERSISTENT_QMN_CACHE&lt;br /&gt;WRH$_PERSISTENT_QUEUES&lt;br /&gt;WRH$_PERSISTENT_SUBSCRIBERS&lt;br /&gt;WRH$_PGASTAT&lt;br /&gt;WRH$_PGA_TARGET_ADVICE&lt;br /&gt;WRH$_PLAN_OPERATION_NAME&lt;br /&gt;WRH$_PLAN_OPTION_NAME&lt;br /&gt;WRH$_PROCESS_MEMORY_SUMMARY&lt;br /&gt;WRH$_RESOURCE_LIMIT&lt;br /&gt;WRH$_ROWCACHE_SUMMARY&lt;br /&gt;WRH$_RSRC_CONSUMER_GROUP&lt;br /&gt;WRH$_RSRC_PLAN&lt;br /&gt;WRH$_RULE_SET&lt;br /&gt;WRH$_SEG_STAT&lt;br /&gt;WRH$_SEG_STAT_OBJ&lt;br /&gt;WRH$_SERVICE_NAME&lt;br /&gt;WRH$_SERVICE_STAT&lt;br /&gt;WRH$_SERVICE_WAIT_CLASS&lt;br /&gt;WRH$_SESSMETRIC_HISTORY&lt;br /&gt;WRH$_SESS_TIME_STATS&lt;br /&gt;WRH$_SESS_TIME_STATS&lt;br /&gt;WRH$_SGA&lt;br /&gt;WRH$_SGASTAT&lt;br /&gt;WRH$_SGA_TARGET_ADVICE&lt;br /&gt;WRH$_SHARED_POOL_ADVICE&lt;br /&gt;WRH$_SHARED_SERVER_SUMMARY&lt;br /&gt;WRH$_SQLCOMMAND_NAME&lt;br /&gt;WRH$_SQLSTAT&lt;br /&gt;WRH$_SQLTEXT&lt;br /&gt;WRH$_SQL_BIND_METADATA&lt;br /&gt;WRH$_SQL_PLAN&lt;br /&gt;WRH$_SQL_SUMMARY&lt;br /&gt;WRH$_SQL_WORKAREA_HISTOGRAM&lt;br /&gt;WRH$_STAT_NAME&lt;br /&gt;WRH$_STREAMS_APPLY_SUM&lt;br /&gt;WRH$_STREAMS_APPLY_SUM&lt;br /&gt;WRH$_STREAMS_CAPTURE&lt;br /&gt;WRH$_STREAMS_CAPTURE&lt;br /&gt;WRH$_STREAMS_POOL_ADVICE&lt;br /&gt;WRH$_SYSMETRIC_HISTORY&lt;br /&gt;WRH$_SYSMETRIC_SUMMARY&lt;br /&gt;WRH$_SYSSTAT&lt;br /&gt;WRH$_SYSTEM_EVENT&lt;br /&gt;WRH$_SYS_TIME_MODEL&lt;br /&gt;WRH$_TABLESPACE&lt;br /&gt;WRH$_TABLESPACE_SPACE_USAGE&lt;br /&gt;WRH$_TABLESPACE_STAT&lt;br /&gt;WRH$_TEMPFILE&lt;br /&gt;WRH$_TEMPSTATXS&lt;br /&gt;WRH$_THREAD&lt;br /&gt;WRH$_TOPLEVELCALL_NAME&lt;br /&gt;WRH$_UNDOSTAT&lt;br /&gt;WRH$_WAITCLASSMETRIC_HISTORY&lt;br /&gt;WRH$_WAITSTAT&lt;br /&gt;WRI$_ADV_SQLT_PLAN_HASH&lt;br /&gt;WRI$_OPTSTAT_HISTGRM_HISTORY&lt;br /&gt;WRI$_SQLSET_BINDS&lt;br /&gt;WRI$_SQLSET_DEFINITIONS&lt;br /&gt;WRI$_SQLSET_MASK&lt;br /&gt;WRI$_SQLSET_PLANS&lt;br /&gt;WRI$_SQLSET_PLAN_LINES&lt;br /&gt;WRI$_SQLSET_STATEMENTS&lt;br /&gt;WRI$_SQLSET_STATISTICS&lt;br /&gt;WRI$_SQLTEXT_REFCOUNT&lt;br /&gt;&lt;br /&gt;117 rows selected.&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;You could see that mostly AWR tables are affected (WRH$%, WRI%). The brand new 12c database's AWR tables won't have property set to 1073741824 (0x40000000), unless you wouldn't create some.&lt;br/&gt;If you set the _add_col_optim_enabled parameter to FALSE, you will be safe.&lt;br/&gt;If you will face a same issue one day, the possible workaround for the issue is to rebuild table in anyway to update the problem column (MOVE table, redefine table online, or set column value equals to self).</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/6883749671428926709/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2015/12/ora-8102-on-alter-table-shrink-space.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6883749671428926709'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6883749671428926709'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2015/12/ora-8102-on-alter-table-shrink-space.html' title='ORA-8102 on ALTER TABLE SHRINK SPACE with default column optimization'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-5182054649663215017</id><published>2015-11-30T12:53:00.003+06:00</published><updated>2016-05-14T12:30:00.699+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='nlj_batching'/><category scheme='http://www.blogger.com/atom/ns#' term='12.1.0.2'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><title type='text'>V$SQL_PLAN_MONITOR.STARTS is higher than expected due to NLJ batching/Prefetching</title><content type='html'>Recently one of the developers asked me to explain why V$SQL_PLAN_MONITOR.STARTS is higher than expected for one particular query.&lt;br/&gt;Here is a problem query (some columns are hidden to preserve readability): &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL Plan Monitoring Details (Plan Hash Value=40624586)&lt;br /&gt;================================================================================================================================================&lt;br /&gt;| Id |                Operation                |        Name        | Execs |   Rows   | Read  | Read  | Activity |      Activity Detail       |&lt;br /&gt;|    |                                         |                    |       | (Actual) | Reqs  | Bytes |   (%)    |        (# samples)         |&lt;br /&gt;================================================================================================================================================&lt;br /&gt;|  0 | SELECT STATEMENT                        |                    |     1 |        0 |       |       |          |                            |&lt;br /&gt;|  1 |   NESTED LOOPS                          |                    |     1 |        0 |       |       |          |                            |&lt;br /&gt;|  2 |    NESTED LOOPS                         |                    |     1 |    62594 |       |       |          |                            |&lt;br /&gt;|  3 |     TABLE ACCESS BY INDEX ROWID BATCHED | MAIN_TABLE         |     1 |    62594 | 22777 | 178MB |    25.89 | Cpu (1)                    |&lt;br /&gt;|    |                                         |                    |       |          |       |       |          | db file parallel read (28) |&lt;br /&gt;|  4 |      INDEX RANGE SCAN                   | MAIN_TABLE_I       |     1 |    62594 |    25 | 200KB |          |                            |&lt;br /&gt;|  5 |     INDEX UNIQUE SCAN                   | CHILD_TABLE_PK     |  109K |    62594 | 63798 | 498MB |    71.43 | Cpu (2)                    |&lt;br /&gt;|    |                                         |                    |       |          |       |       |          | db file parallel read (78) |&lt;br /&gt;|  6 |    TABLE ACCESS BY INDEX ROWID          | CHILD_TABLE        |  105K |        0 |  1402 |  11MB |     1.79 | db file parallel read (2)  |&lt;br /&gt;================================================================================================================================================&lt;br /&gt;&lt;/pre&gt;You can see that we've obtained 62K rows at step 3, but notice a number of "Execs" at step 5: 109K. It's almost twice as higher than 62K.&lt;br/&gt;Number of rows ("Rows (Actual)") is correct, though.&lt;br/&gt;I checked relevant columns in V$SQL_PLAN_MONITOR view (STARTS/OUTPUT_ROWS) and verified that there's no contradiction between V$SQL_PLAN_MONITOR view and DBMS_SQLTUNE.REPORT_SQL_MONITOR output.&lt;br/&gt;I investigated this issue further and constructed a simple test case which can be used to reproduce the issue.&lt;br/&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; create table fact&lt;br /&gt;  2  as&lt;br /&gt;  3  select date '2015-08-01' + trunc(level/4)/86400 fact_date,&lt;br /&gt;  4         lpad('x', 240, 'x') padding,&lt;br /&gt;  5         mod(level, 100000) dim_id&lt;br /&gt;  6    from dual&lt;br /&gt;  7    connect by level&lt;=4*86400;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; exec dbms_stats.gather_table_stats( '', 'fact')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; create table dim&lt;br /&gt;  2  as&lt;br /&gt;  3  select trunc(dbms_random.value(1,100000)) id,&lt;br /&gt;  4         lpad('x', 340, 'x') padding&lt;br /&gt;  5    from dual&lt;br /&gt;  6    connect by level&lt;=2*86400;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; create index dim_i on dim(id);&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; exec dbms_stats.gather_table_stats( '', 'dim')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;I created 2 tables: FACT and DIM, populated them with data and gathered statistics.&lt;br/&gt;Now, I will flush the buffer cache and execute a test query: &lt;pre class="brush:sql;highlight:[1,6];"&gt;&lt;br /&gt;SQL&gt; alter system flush buffer_cache;&lt;br /&gt;&lt;br /&gt;System altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select /*+ monitor leading(f) use_nl(d) full(f)*/&lt;br /&gt;  2         count(f.padding),&lt;br /&gt;  3         count(d.padding)&lt;br /&gt;  4    from fact f,&lt;br /&gt;  5         dim d&lt;br /&gt;  6   where f.fact_date between to_date('01.08.2015 12:00', 'dd.mm.yyyy hh24:mi') and to_date('01.08.2015 12:10', 'dd.mm.yyyy hh24:mi')&lt;br /&gt;  7     and d.id = f.dim_id;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;COUNT(F.PADDING) COUNT(D.PADDING)&lt;br /&gt;---------------- ----------------&lt;br /&gt;            4214             4214&lt;br /&gt;&lt;br /&gt;1 row selected.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;&lt;/pre&gt;Let's see the DBMS_SQLTUNE report for the last query: &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql;highlight:[23,25]"&gt;&lt;br /&gt;SQL&gt; select dbms_sqltune.report_sql_monitor from dual;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;REPORT_SQL_MONITOR&lt;br /&gt;-----------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL Monitoring Report&lt;br /&gt;&lt;br /&gt;SQL Text&lt;br /&gt;------------------------------&lt;br /&gt;select /*+ monitor leading(f) use_nl(d) full(f)*/ count(f.padding), count(d.padding) from fact f, dim d where f.fact_date between to_date('01.08.2015 12:00&lt;br /&gt;&lt;br /&gt;.. skip..&lt;br /&gt;&lt;br /&gt;SQL Plan Monitoring Details (Plan Hash Value=85884857)&lt;br /&gt;===========================================================================================================================================================&lt;br /&gt;| Id |            Operation            | Name  |  Rows   | Cost  |   Time    | Start  | Execs |   Rows   | Read | Read  | Activity |   Activity Detail    |&lt;br /&gt;|    |                                 |       | (Estim) |       | Active(s) | Active |       | (Actual) | Reqs | Bytes |   (%)    |     (# samples)      |&lt;br /&gt;===========================================================================================================================================================&lt;br /&gt;|  0 | SELECT STATEMENT                |       |         |       |        10 |    +14 |     1 |        1 |      |       |          |                      |&lt;br /&gt;|  1 |   SORT AGGREGATE                |       |       1 |       |        10 |    +14 |     1 |        1 |      |       |          |                      |&lt;br /&gt;|  2 |    NESTED LOOPS                 |       |         |       |        10 |    +14 |     1 |     4214 |      |       |          |                      |&lt;br /&gt;|  3 |     NESTED LOOPS                |       |    5025 | 11890 |        10 |    +14 |     1 |     4214 |      |       |          |                      |&lt;br /&gt;|  4 |      TABLE ACCESS FULL          | FACT  |    2408 |  3535 |        23 |     +1 |     1 |     2404 |  109 | 100MB |     8.70 | Cpu (1)              |&lt;br /&gt;|    |                                 |       |         |       |           |        |       |          |      |       |          | direct path read (1) |&lt;br /&gt;|  5 |      INDEX RANGE SCAN           | DIM_I |       2 |     1 |        10 |    +14 |  2539 |     4214 |  562 |   4MB |          |                      |&lt;br /&gt;|  6 |     TABLE ACCESS BY INDEX ROWID | DIM   |       2 |     4 |        22 |     +2 |  7582 |     4214 | 2810 |  22MB |    91.30 | Cpu (21)             |&lt;br /&gt;===========================================================================================================================================================&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;Ok, we've just reproduced the issue: row source 4 of the plan generated 2404 rows, but the number of "Execs" (2539) at line 5 is equals to 2539, which is slightly greater.&lt;br/&gt;It was not by accident that I flushed the buffer cache before I execute a query.&lt;br/&gt;If I'll execute a query once again, then dbms_sqltune.report_sql_monitor report has number of "Execs" in line 5 equals to number of rows in line 4: &lt;pre class="brush:sql;highlight:[10,11]"&gt;&lt;br /&gt;SQL Plan Monitoring Details (Plan Hash Value=85884857)&lt;br /&gt;======================================================================================================================================================&lt;br /&gt;| Id |            Operation            | Name  |  Rows   | Cost  |   Time    | Start  | Execs |   Rows   | Read | Read  | Activity | Activity Detail |&lt;br /&gt;|    |                                 |       | (Estim) |       | Active(s) | Active |       | (Actual) | Reqs | Bytes |   (%)    |   (# samples)   |&lt;br /&gt;======================================================================================================================================================&lt;br /&gt;|  0 | SELECT STATEMENT                |       |         |       |         1 |     +0 |     1 |        1 |      |       |          |                 |&lt;br /&gt;|  1 |   SORT AGGREGATE                |       |       1 |       |         1 |     +0 |     1 |        1 |      |       |          |                 |&lt;br /&gt;|  2 |    NESTED LOOPS                 |       |         |       |         1 |     +0 |     1 |     4214 |      |       |          |                 |&lt;br /&gt;|  3 |     NESTED LOOPS                |       |    5025 | 11890 |         1 |     +0 |     1 |     4214 |      |       |          |                 |&lt;br /&gt;|  4 |      TABLE ACCESS FULL          | FACT  |    2408 |  3535 |         1 |     +0 |     1 |     2404 |  108 | 100MB |          |                 |&lt;br /&gt;|  5 |      INDEX RANGE SCAN           | DIM_I |       2 |     1 |         1 |     +0 |  2404 |     4214 |      |       |          |                 |&lt;br /&gt;|  6 |     TABLE ACCESS BY INDEX ROWID | DIM   |       2 |     4 |         1 |     +0 |  4214 |     4214 |      |       |          |                 |&lt;br /&gt;======================================================================================================================================================&lt;br /&gt;&lt;/pre&gt;I believe, that differences in execs/rows were caused by NLJ batching/Table prefetching.&lt;br/&gt;How can we prove it?&lt;br/&gt;First, I'll show how changes "physical reads cache prefetch" before/after query execution. &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select n.name, s.value&lt;br /&gt;  2    from v$statname n, v$mystat s&lt;br /&gt;  3   where n.name like '%prefetch%'&lt;br /&gt;  4     and s.statistic#=n.statistic#&lt;br /&gt;  5     and s.value&gt;0&lt;br /&gt;  6   order by n.name;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;NAME                                VALUE&lt;br /&gt;------------------------------ ----------&lt;br /&gt;physical reads cache prefetch      127987&lt;br /&gt;&lt;br /&gt;1 row selected.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select /*+ monitor leading(f) use_nl(d) full(f)*/&lt;br /&gt;  2         count(f.padding),&lt;br /&gt;  3         count(d.padding)&lt;br /&gt;  4    from fact f,&lt;br /&gt;  5         dim d&lt;br /&gt;  6   where f.fact_date between to_date('01.08.2015 12:00', 'dd.mm.yyyy hh24:mi') and to_date('01.08.2015 12:10', 'dd.mm.yyyy hh24:mi')&lt;br /&gt;  7     and d.id = f.dim_id;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;COUNT(F.PADDING) COUNT(D.PADDING)&lt;br /&gt;---------------- ----------------&lt;br /&gt;            4214             4214&lt;br /&gt;&lt;br /&gt;1 row selected.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select n.name, s.value&lt;br /&gt;  2    from v$statname n, v$mystat s&lt;br /&gt;  3   where n.name like '%prefetch%'&lt;br /&gt;  4     and s.statistic#=n.statistic#&lt;br /&gt;  5     and s.value&gt;0&lt;br /&gt;  6   order by n.name;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;NAME                                VALUE&lt;br /&gt;------------------------------ ----------&lt;br /&gt;physical reads cache prefetch      131321&lt;br /&gt;&lt;br /&gt;1 row selected.&lt;br /&gt;&lt;/pre&gt;Statistic increased by the 131321-127987=3334 blocks. Second, when I disable nlj_batching, there are no differences in execs/rows: &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; alter system flush buffer_cache;&lt;br /&gt;&lt;br /&gt;System altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select n.name, s.value&lt;br /&gt;  2    from v$statname n, v$mystat s&lt;br /&gt;  3   where n.name like '%prefetch%'&lt;br /&gt;  4     and s.statistic#=n.statistic#&lt;br /&gt;  5     and s.value&gt;0&lt;br /&gt;  6   order by n.name;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;NAME                                VALUE&lt;br /&gt;------------------------------ ----------&lt;br /&gt;physical reads cache prefetch      137989&lt;br /&gt;&lt;br /&gt;1 row selected.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select /*+ monitor leading(f) use_nl(d) full(f) opt_param('_nlj_batching_enabled' 0)*/&lt;br /&gt;  2         count(f.padding),&lt;br /&gt;  3         count(d.padding)&lt;br /&gt;  4    from fact f,&lt;br /&gt;  5         dim d&lt;br /&gt;  6   where f.fact_date between to_date('01.08.2015 12:00', 'dd.mm.yyyy hh24:mi') and to_date('01.08.2015 12:10', 'dd.mm.yyyy hh24:mi')&lt;br /&gt;  7     and d.id = f.dim_id;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;COUNT(F.PADDING) COUNT(D.PADDING)&lt;br /&gt;---------------- ----------------&lt;br /&gt;            4214             4214&lt;br /&gt;&lt;br /&gt;1 row selected.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select n.name, s.value&lt;br /&gt;  2    from v$statname n, v$mystat s&lt;br /&gt;  3   where n.name like '%prefetch%'&lt;br /&gt;  4     and s.statistic#=n.statistic#&lt;br /&gt;  5     and s.value&gt;0&lt;br /&gt;  6   order by n.name;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;NAME                                VALUE&lt;br /&gt;------------------------------ ----------&lt;br /&gt;physical reads cache prefetch      137989&lt;br /&gt;&lt;br /&gt;1 row selected.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select dbms_sqltune.report_sql_monitor from dual;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;REPORT_SQL_MONITOR&lt;br /&gt;-----------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL Monitoring Report&lt;br /&gt;&lt;br /&gt;SQL Text&lt;br /&gt;------------------------------&lt;br /&gt;select /*+ monitor leading(f) use_nl(d) full(f) opt_param('_nlj_batching_enabled' 0)*/ count(f.padding), count(d.padding) from fact f, dim d where f.fact_date be&lt;br /&gt; and d.id = f.dim_id&lt;br /&gt;&lt;br /&gt;.. skip ..&lt;br /&gt;&lt;br /&gt;SQL Plan Monitoring Details (Plan Hash Value=1381503666)&lt;br /&gt;=================================================================================================================================================================&lt;br /&gt;| Id |           Operation            | Name  |  Rows   | Cost  |   Time    | Start  | Execs |   Rows   | Read | Read  | Activity |       Activity Detail       |&lt;br /&gt;|    |                                |       | (Estim) |       | Active(s) | Active |       | (Actual) | Reqs | Bytes |   (%)    |         (# samples)         |&lt;br /&gt;=================================================================================================================================================================&lt;br /&gt;|  0 | SELECT STATEMENT               |       |         |       |         1 |     +2 |     1 |        1 |      |       |          |                             |&lt;br /&gt;|  1 |   SORT AGGREGATE               |       |       1 |       |         1 |     +2 |     1 |        1 |      |       |          |                             |&lt;br /&gt;|  2 |    TABLE ACCESS BY INDEX ROWID | DIM   |       2 |     4 |         2 |     +1 |     1 |     4214 | 3360 |  26MB |   100.00 | db file sequential read (2) |&lt;br /&gt;|  3 |     NESTED LOOPS               |       |    5025 | 11890 |         1 |     +2 |     1 |     6619 |      |       |          |                             |&lt;br /&gt;|  4 |      TABLE ACCESS FULL         | FACT  |    2408 |  3535 |         1 |     +2 |     1 |     2404 |  109 | 100MB |          |                             |&lt;br /&gt;|  5 |      INDEX RANGE SCAN          | DIM_I |       2 |     1 |         1 |     +2 |  2404 |     4214 |   12 | 98304 |          |                             |&lt;br /&gt;=================================================================================================================================================================&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;1 row selected.&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;Or, if we want to obtain "more-classic" NLJ plan shape (I added no_nlj_prefetch(d) hint): &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; alter system flush buffer_cache;&lt;br /&gt;&lt;br /&gt;System altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select n.name, s.value&lt;br /&gt;  2    from v$statname n, v$mystat s&lt;br /&gt;  3   where n.name like '%prefetch%'&lt;br /&gt;  4     and s.statistic#=n.statistic#&lt;br /&gt;  5     and s.value&gt;0&lt;br /&gt;  6   order by n.name;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;NAME                                VALUE&lt;br /&gt;------------------------------ ----------&lt;br /&gt;physical reads cache prefetch      137989&lt;br /&gt;&lt;br /&gt;1 row selected.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select /*+ monitor leading(f) use_nl(d) full(f) opt_param('_nlj_batching_enabled' 0) no_nlj_prefetch(d)*/&lt;br /&gt;  2         count(f.padding),&lt;br /&gt;  3         count(d.padding)&lt;br /&gt;  4    from fact f,&lt;br /&gt;  5         dim d&lt;br /&gt;  6   where f.fact_date between to_date('01.08.2015 12:00', 'dd.mm.yyyy hh24:mi') and to_date('01.08.2015 12:10', 'dd.mm.yyyy hh24:mi')&lt;br /&gt;  7     and d.id = f.dim_id;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;COUNT(F.PADDING) COUNT(D.PADDING)&lt;br /&gt;---------------- ----------------&lt;br /&gt;            4214             4214&lt;br /&gt;&lt;br /&gt;1 row selected.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select n.name, s.value&lt;br /&gt;  2    from v$statname n, v$mystat s&lt;br /&gt;  3   where n.name like '%prefetch%'&lt;br /&gt;  4     and s.statistic#=n.statistic#&lt;br /&gt;  5     and s.value&gt;0&lt;br /&gt;  6   order by n.name;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;NAME                                VALUE&lt;br /&gt;------------------------------ ----------&lt;br /&gt;physical reads cache prefetch      137989&lt;br /&gt;&lt;br /&gt;1 row selected.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select dbms_sqltune.report_sql_monitor from dual;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;REPORT_SQL_MONITOR&lt;br /&gt;------------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL Monitoring Report&lt;br /&gt;&lt;br /&gt;SQL Text&lt;br /&gt;------------------------------&lt;br /&gt;select /*+ monitor leading(f) use_nl(d) full(f) opt_param('_nlj_batching_enabled' 0) no_nlj_prefetch(d)*/ count(f.padding), count(d.padding) from fact f, dim d wh&lt;br /&gt;d.mm.yyyy hh24:mi') and d.id = f.dim_id&lt;br /&gt;&lt;br /&gt;.. skip ..&lt;br /&gt;&lt;br /&gt;SQL Plan Monitoring Details (Plan Hash Value=676372893)&lt;br /&gt;==================================================================================================================================================================&lt;br /&gt;| Id |            Operation            | Name  |  Rows   | Cost  |   Time    | Start  | Execs |   Rows   | Read | Read  | Activity |       Activity Detail       |&lt;br /&gt;|    |                                 |       | (Estim) |       | Active(s) | Active |       | (Actual) | Reqs | Bytes |   (%)    |         (# samples)         |&lt;br /&gt;==================================================================================================================================================================&lt;br /&gt;|  0 | SELECT STATEMENT                |       |         |       |         1 |     +2 |     1 |        1 |      |       |          |                             |&lt;br /&gt;|  1 |   SORT AGGREGATE                |       |       1 |       |         1 |     +2 |     1 |        1 |      |       |          |                             |&lt;br /&gt;|  2 |    NESTED LOOPS                 |       |    5025 | 11890 |         1 |     +2 |     1 |     4214 |      |       |          |                             |&lt;br /&gt;|  3 |     TABLE ACCESS FULL           | FACT  |    2408 |  3535 |         1 |     +2 |     1 |     2404 |  109 | 100MB |          |                             |&lt;br /&gt;|  4 |     TABLE ACCESS BY INDEX ROWID | DIM   |       2 |     4 |         2 |     +2 |  2404 |     4214 | 3360 |  26MB |    66.67 | Cpu (1)                     |&lt;br /&gt;|    |                                 |       |         |       |           |        |       |          |      |       |          | db file sequential read (1) |&lt;br /&gt;|  5 |      INDEX RANGE SCAN           | DIM_I |       2 |     1 |         1 |     +2 |  2404 |     4214 |   12 | 98304 |          |                             |&lt;br /&gt;==================================================================================================================================================================&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;I have searched for a similar issues through MOS and found a &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=BUG&amp;&amp;productFamily=Oracle&amp;id=13634445"&gt;Bug 13634445 : V$SQL_PLAN_MONITOR AND NL BATCHING IN 11G&lt;/a&gt;, which has status 92 "Closed, Not a Bug".&lt;br/&gt;Another interesting observation is that by adding a "gather_plan_statistics" hint, I'll disable prefetching for that case and fix V$SQL_PLAN_MONITOR "discrepancy" &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; alter system flush buffer_cache;&lt;br /&gt;&lt;br /&gt;System altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select /*+ monitor leading(f) use_nl(d) full(f) gather_plan_statistics*/&lt;br /&gt;  2         count(f.padding),&lt;br /&gt;  3         count(d.padding)&lt;br /&gt;  4    from fact f,&lt;br /&gt;  5         dim d&lt;br /&gt;  6   where f.fact_date between to_date('01.08.2015 12:00', 'dd.mm.yyyy hh24:mi') and to_date('01.08.2015 12:10', 'dd.mm.yyyy hh24:mi')&lt;br /&gt;  7     and d.id = f.dim_id;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;COUNT(F.PADDING) COUNT(D.PADDING)&lt;br /&gt;---------------- ----------------&lt;br /&gt;            4214             4214&lt;br /&gt;&lt;br /&gt;1 row selected.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select dbms_sqltune.report_sql_monitor from dual;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;REPORT_SQL_MONITOR&lt;br /&gt;------------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;SQL Monitoring Report&lt;br /&gt;&lt;br /&gt;SQL Text&lt;br /&gt;------------------------------&lt;br /&gt;select /*+ monitor leading(f) use_nl(d) full(f) gather_plan_statistics*/ count(f.padding), count(d.padding) from fact f, dim d where f.fact_date between to_date('&lt;br /&gt;dim_id&lt;br /&gt;&lt;br /&gt;..skip..&lt;br /&gt;&lt;br /&gt;SQL Plan Monitoring Details (Plan Hash Value=85884857)&lt;br /&gt;==================================================================================================================================================================&lt;br /&gt;| Id |            Operation            | Name  |  Rows   | Cost  |   Time    | Start  | Execs |   Rows   | Read | Read  | Activity |       Activity Detail       |&lt;br /&gt;|    |                                 |       | (Estim) |       | Active(s) | Active |       | (Actual) | Reqs | Bytes |   (%)    |         (# samples)         |&lt;br /&gt;==================================================================================================================================================================&lt;br /&gt;|  0 | SELECT STATEMENT                |       |         |       |         8 |     +2 |     1 |        1 |      |       |          |                             |&lt;br /&gt;|  1 |   SORT AGGREGATE                |       |       1 |       |         8 |     +2 |     1 |        1 |      |       |          |                             |&lt;br /&gt;|  2 |    NESTED LOOPS                 |       |         |       |         8 |     +2 |     1 |     4214 |      |       |          |                             |&lt;br /&gt;|  3 |     NESTED LOOPS                |       |    5025 | 11890 |         8 |     +2 |     1 |     4214 |      |       |          |                             |&lt;br /&gt;|  4 |      TABLE ACCESS FULL          | FACT  |    2408 |  3535 |         9 |     +1 |     1 |     2404 |  109 | 100MB |    11.11 | direct path read (1)        |&lt;br /&gt;|  5 |      INDEX RANGE SCAN           | DIM_I |       2 |     1 |         8 |     +2 |  2404 |     4214 |   12 | 98304 |          |                             |&lt;br /&gt;|  6 |     TABLE ACCESS BY INDEX ROWID | DIM   |       2 |     4 |         8 |     +2 |  4214 |     4214 | 3360 |  26MB |    88.89 | db file sequential read (8) |&lt;br /&gt;==================================================================================================================================================================&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/5182054649663215017/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2015/11/vsqlplanmonitorstarts-is-higher-than.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5182054649663215017'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/5182054649663215017'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2015/11/vsqlplanmonitorstarts-is-higher-than.html' title='V$SQL_PLAN_MONITOR.STARTS is higher than expected due to NLJ batching/Prefetching'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8357676353221101664</id><published>2015-10-29T11:59:00.000+06:00</published><updated>2016-05-14T12:30:15.750+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='PX'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12.1.0.2'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><title type='text'>12c: PX Auto DOP without IO Calibration</title><content type='html'>I have upgraded one of data warehouse database this week and noticed changes in behaviour of &lt;a href="https://docs.oracle.com/database/121/VLDBG/GUID-29D801DE-54DB-40F3-BAAD-C1C5125C1B35.htm"&gt;PX Auto DOP&lt;/a&gt; feature.&lt;br/&gt;According to the documentation of the parallel_degree_policy parameter &lt;a href="https://docs.oracle.com/database/121/VLDBG/GUID-29D801DE-54DB-40F3-BAAD-C1C5125C1B35.htm"&gt;Oracle Database Reference 11g&lt;/a&gt;:&lt;br/&gt;&lt;ul&gt;  &lt;li&gt;MANUAL&lt;br/&gt;  Disables automatic degree of parallelism, statement queuing, and in-memory parallel execution. This reverts the behavior of parallel execution to what it was prior to Oracle Database 11g Release 2 (11.2). This is the default.&lt;/li&gt;  &lt;li&gt;LIMITED&lt;br/&gt;    Enables automatic degree of parallelism for some statements but statement queuing and in-memory Parallel Execution are disabled. Automatic degree of parallelism is only applied to those statements that access tables or indexes decorated explicitly with the DEFAULT degree of parallelism using the PARALLEL clause. Statements that do not access any tables or indexes decorated with the DEFAULT degree of parallelism will retain the MANUAL behavior.&lt;/li&gt;  &lt;li&gt;AUTO&lt;br/&gt;    Enables automatic degree of parallelism, statement queuing, and in-memory parallel execution.&lt;/li&gt;&lt;/ul&gt;In short:&lt;br/&gt;MANUAL - disables Auto DOP, parallel statement queuing, and in-memory parallel execution.&lt;br/&gt;AUTO - enables all of the above.&lt;br/&gt;What if you need parallel statement queuing but dont need Auto DOP?&lt;br/&gt;MOS note suggests to add hint STATEMENT_QUEUING in your statements manually: &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1902069.1"&gt;How to Achieve Parallel Statement Queuing for an SQL When PARALLEL_DEGREE_POLICY=MANUAL (Doc ID 1902069.1)&lt;/a&gt;&lt;br/&gt;In 11g there was an clever automatic way to achieve this:&lt;br/&gt;&lt;div style="border-width: 1px;border-style:solid;"&gt;&lt;a href="https://docs.oracle.com/cd/E11882_01/server.112/e25523/parallel002.htm#sthref897"&gt;VLDB and Partitioning Guide 11g&lt;/a&gt;&lt;br/&gt;When PARALLEL_DEGREE_POLICY is set to AUTO, Oracle Database determines whether the statement should run in parallel based on the cost of the operations in the execution plan and the hardware characteristics.&lt;br/&gt;&lt;b&gt;The hardware characteristics include I/O calibration statistics so these statistics must be gathered&lt;/b&gt; &lt;b style="color: blue"&gt;otherwise Oracle Database does not use the automatic degree policy feature.&lt;/b&gt;&lt;br/&gt;&lt;/div&gt;&lt;br/&gt;So I simply installed PARALLEL_DEGREE_POLICY=AUTO and didn't gather IO calibration statistics.&lt;br/&gt;This prevents Auto DOP but parallel statement queuing and in-memory parallel execution still enabled.&lt;br/&gt;Now in 12c things got changed:&lt;br/&gt;&lt;div style="border-width: 1px;border-style:solid;"&gt;&lt;a href="http://docs.oracle.com/database/121/VLDBG/GUID-29D801DE-54DB-40F3-BAAD-C1C5125C1B35.htm#d48132e147"&gt;VLDB and Partitioning Guide 12c&lt;/a&gt;&lt;br/&gt;When PARALLEL_DEGREE_POLICY is set to AUTO, Oracle Database determines whether the statement should run in parallel based on the cost of the operations in the execution plan and the hardware characteristics.&lt;br/&gt;&lt;b&gt;The hardware characteristics include I/O calibration statistics so these statistics should be gathered.&lt;/b&gt;&lt;br/&gt;&lt;b style="color: blue"&gt;If I/O calibration is not run to gather the required statistics, a default calibration value is used to calculate the cost of operations and the degree of parallelism.&lt;/b&gt;&lt;br/&gt;&lt;/div&gt;&lt;br/&gt;Have you seen the difference?&lt;br/&gt;It means that now Auto DOP works without IO calibration statistics.&lt;br/&gt;I dont see any announcement in the New Features Guide or VLDB and Partitioning Guide about this change.&lt;br/&gt;Yes, I agree that configuration with PARALLEL_DEGREE_POLICY=AUTO without IO calibration statistics looks an unusual thing.&lt;br/&gt;But I would prefer that Oracle mentions such things at least in the "Changes in this release" section in the relevant book.&lt;br/&gt;I.e. &lt;a href="https://docs.oracle.com/database/121/VLDBG/GUID-C7A9BAD4-E4C9-4765-88C5-51AC7E97BAF1.htm#VLDBG14022"&gt;here&lt;/a&gt;.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/8357676353221101664/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2015/10/12c-px-auto-dop-without-io-calibration.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8357676353221101664'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8357676353221101664'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2015/10/12c-px-auto-dop-without-io-calibration.html' title='12c: PX Auto DOP without IO Calibration'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-4868128136297871279</id><published>2015-09-30T18:19:00.002+06:00</published><updated>2016-05-14T12:30:25.091+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12.1.0.2'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><category scheme='http://www.blogger.com/atom/ns#' term='wrong_results'/><title type='text'>Bug 20214168 - Wrong Results using aggregations of CASE expression with fix of bug 20003240 present</title><content type='html'>I started to use Oracle 12c in the early 2014 in non-production environments.&lt;br/&gt;At now I am extensively testing the ADO, In-Memory functionalities and have couple of database in production.&lt;br/&gt;They already use DBBP (Database Bundle Patch) 10 for engineering systems and database In-Memory and have several underscope parameters in effect.&lt;br/&gt;Unfortunately, a few days ago we have faced with the wrong results caused by the &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=20214168.8"&gt;Bug 20214168 - Wrong Results using aggregations of CASE expression with fix of bug 20003240 present&lt;/a&gt;.&lt;br/&gt;This problem was already discussed on the freelist oracle-l thread &lt;a href="http://www.freelists.org/post/oracle-l/Strange-Behaviour-with-Test-Case"&gt;Strange Behaviour (with Test Case)&lt;/a&gt;.&lt;br/&gt;Original thread was Exadata specific.&lt;br/&gt;We dont have an Exadata yet but we use DBIM (Database In-Memory) and so we install DBBP patches.&lt;br/&gt;I found out that solution from the thread with event 10055 don't help to resolve wrong results issue in our environment.&lt;br/&gt;Let's create test table and data from the original bug: &lt;pre class="brush: sql"&gt;&lt;br /&gt;SQL&gt; create table test_fact(chrtype varchar2(3), rate number);&lt;br /&gt;SQL&gt; insert into test_fact values('R03', 1.3);&lt;br /&gt;SQL&gt; insert into test_fact values('LDU', 0.21);&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from test_fact;&lt;br /&gt;&lt;br /&gt;CHRTYPE         RATE&lt;br /&gt;--------- ----------&lt;br /&gt;R03              1.3&lt;br /&gt;LDU              .21&lt;br /&gt;&lt;/pre&gt;Now execute below query: &lt;pre class="brush: sql;highlight:[10];"&gt;&lt;br /&gt;SQL&gt; select sum(&lt;br /&gt;  2           case&lt;br /&gt;  3             when chrtype in ('R03', 'LDU')&lt;br /&gt;  4             then rate/10&lt;br /&gt;  5           end) result&lt;br /&gt;  6    from test_fact;&lt;br /&gt;&lt;br /&gt;    RESULT&lt;br /&gt;----------&lt;br /&gt;      .041&lt;br /&gt;&lt;/pre&gt;Notice wrong results. Above query should return 0.151 and not 0.041.&lt;br/&gt;Now we will execute same query with the event 10055 set: &lt;pre class="brush: sql;highlight:[12]"&gt;&lt;br /&gt;SQL&gt; alter session set events '10055 trace name context forever, level 0x200';&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select sum(&lt;br /&gt;  2           case&lt;br /&gt;  3             when chrtype in ('R03', 'LDU')&lt;br /&gt;  4             then rate/10&lt;br /&gt;  5           end) result&lt;br /&gt;  6    from test_fact;&lt;br /&gt;&lt;br /&gt;    RESULT&lt;br /&gt;----------&lt;br /&gt;      .041&lt;br /&gt;&lt;/pre&gt;Notice that results are the same (they are wrong) and the event 10055 set to level 0x200 dont help.&lt;br/&gt;I observed these results in the environment with &lt;b&gt;Patch 21188742 - Database Patch for Engineered Systems and DB In-Memory 12.1.0.2.10 (Jul2015)&lt;/b&gt; applied.&lt;br/&gt;May be other levels of event 10055 could help? &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@localhost ~]$ oerr ora 10055&lt;br /&gt;10055, 00000, "Rowsets: turn off rowsets for various operations"&lt;br /&gt;// *Document: NO&lt;br /&gt;// *Cause:    N/A&lt;br /&gt;// *Action:   Turns off rowsets for various operations&lt;br /&gt;//            Level:&lt;br /&gt;//            0x00000001 - turn off for table scan&lt;br /&gt;//            0x00000002 - turn off for hash join consume&lt;br /&gt;//            0x00000004 - turn off for hash join produce&lt;br /&gt;//            0x00000008 - turn off for group by&lt;br /&gt;//            0x00000010 - turn off for sort&lt;br /&gt;//            0x00000020 - turn off for table-queue out&lt;br /&gt;//            0x00000040 - turn off for table-queue in&lt;br /&gt;//            0x00000080 - turn off for identity&lt;br /&gt;//            0x00000100 - turn off for granule iterator&lt;br /&gt;//            0x00000200 - turn off for EVA functions&lt;br /&gt;//            0x00000400 - turn off for PL/SQL&lt;br /&gt;//            0x00000800 - turn off for upgrade&lt;br /&gt;//            0x00001000 - turn off for database startup&lt;br /&gt;//            0x00002000 - turn off for blobs and clobs&lt;br /&gt;//            0x00004000 - turn off for tracing row source&lt;br /&gt;//            0x00008000 - turn off rowset information in explain plan&lt;br /&gt;//            0x00010000 - disable hash join rowsets fast path&lt;br /&gt;//            0x00020000 - turn off for bloom create&lt;br /&gt;//            0x00040000 - turn off for bloom use&lt;br /&gt;//            0x00080000 - disable prefetch for hash join&lt;br /&gt;//            0x00100000 - disable prefetch for bloom&lt;br /&gt;//            0x00200000 - disable semi blocking hash join&lt;br /&gt;//            0x00400000 - turn off rowset for fixed table&lt;br /&gt;//&lt;br /&gt;&lt;/pre&gt;Unfortunately, other levels also have not helped.&lt;br/&gt;I found 2 possible solutions for this problem case.&lt;br/&gt;1. set _rowsets_enabled to false: &lt;pre class="brush:sql;highlight:[10,12,23];"&gt;&lt;br /&gt;SQL&gt; select sum(&lt;br /&gt;  2           case&lt;br /&gt;  3             when chrtype in ('R03', 'LDU')&lt;br /&gt;  4             then rate/10&lt;br /&gt;  5           end) result&lt;br /&gt;  6    from test_fact;&lt;br /&gt;&lt;br /&gt;    RESULT&lt;br /&gt;----------&lt;br /&gt;      .041&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; alter session set "_rowsets_enabled"=false;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select sum(&lt;br /&gt;  2           case&lt;br /&gt;  3             when chrtype in ('R03', 'LDU')&lt;br /&gt;  4             then rate/10&lt;br /&gt;  5           end) result&lt;br /&gt;  6    from test_fact;&lt;br /&gt;&lt;br /&gt;    RESULT&lt;br /&gt;----------&lt;br /&gt;      .151&lt;br /&gt;&lt;/pre&gt;2. set _rowsets_max_rows to 1: &lt;pre class="brush:sql;highlight:[10,12,23];"&gt;&lt;br /&gt;SQL&gt; select sum(&lt;br /&gt;  2           case&lt;br /&gt;  3             when chrtype in ('R03', 'LDU')&lt;br /&gt;  4             then rate/10&lt;br /&gt;  5           end) result&lt;br /&gt;  6    from test_fact;&lt;br /&gt;&lt;br /&gt;    RESULT&lt;br /&gt;----------&lt;br /&gt;      .041&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; alter session set "_rowsets_max_rows"=1;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select sum(&lt;br /&gt;  2           case&lt;br /&gt;  3             when chrtype in ('R03', 'LDU')&lt;br /&gt;  4             then rate/10&lt;br /&gt;  5           end) result&lt;br /&gt;  6    from test_fact;&lt;br /&gt;&lt;br /&gt;    RESULT&lt;br /&gt;----------&lt;br /&gt;      .151&lt;br /&gt;&lt;/pre&gt;Off course, we shouldn't use underscope parameters without Oracle Support agreement.&lt;br/&gt;Instead we should apply the fix for bug 20214168 ASAP.&lt;br/&gt;I tried to apply the patch 20214168 to this Oracle Home but OPatch informed me that patch already applied!&lt;br/&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;Recommended actions: The fixes by this patch are currently in the Oracle Home. There is no need to apply this patch.&lt;br /&gt;Patch : 20214168&lt;br /&gt;&lt;br /&gt;        Bug SubSet of 21125181&lt;br /&gt;        Subset bugs are:&lt;br /&gt;        20214168&lt;br /&gt;&lt;/pre&gt;From the opatch lsinv I saw that definitely fix for bug 20214168 already installed: &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql;highlight:[25]"&gt;&lt;br /&gt;Local Machine Information::&lt;br /&gt;Hostname: localhost&lt;br /&gt;ARU platform id: 23&lt;br /&gt;ARU platform description:: Solaris Operating System (SPARC 64-bit)&lt;br /&gt;                &lt;br /&gt;Installed Top-level Products (1): &lt;br /&gt;Oracle Database 12c                                                  12.1.0.2.0There are 1 products installed in this Oracle Home.&lt;br /&gt;Interim patches (5) :&lt;br /&gt;Patch  20831113     : applied on Wed Aug 05 15:01:24 NOVT 2015&lt;br /&gt;Unique Patch ID:  18927529&lt;br /&gt;Patch description:  "OCW Patch Set Update : 12.1.0.2.4 (20831113)"&lt;br /&gt;   Created on 23 Jun 2015, 06:58:08 hrs UTC&lt;br /&gt;   Bugs fixed:&lt;br /&gt;     18589889, 19139608, 19280860, 19061429, 19133945, 19341538, 20011424&lt;br /&gt;...skip...&lt;br /&gt;Patch  21125181     : applied on Wed Aug 05 14:50:35 NOVT 2015&lt;br /&gt;Unique Patch ID:  19005983&lt;br /&gt;Patch description:  "DATABASE BUNDLE PATCH: 12.1.0.2.10 (21125181)"&lt;br /&gt;   Created on 1 Jul 2015, 22:01:24 hrs PST8PDT&lt;br /&gt;Sub-patch  20594149; "DATABASE BUNDLE PATCH: 12.1.0.2.7 (20594149)"&lt;br /&gt;Sub-patch  20415006; "DATABASE BUNDLE PATCH: 12.1.0.2.6 (20415006)"&lt;br /&gt;Sub-patch  20243804; "DATABASE BUNDLE PATCH: 12.1.0.2.5 (20243804)"&lt;br /&gt;   Bugs fixed:&lt;br /&gt;...skip...&lt;br /&gt;     19990543, 19012044, 20214168, 20209481, 18885870, 13640676, 13498243&lt;br /&gt;...skip...&lt;br /&gt;Patch  19396455     : applied on Mon Jul 13 17:43:01 NOVT 2015&lt;br /&gt;Unique Patch ID:  18154832&lt;br /&gt;   Created on 15 Oct 2014, 20:19:28 hrs PST8PDT&lt;br /&gt;   Bugs fixed:&lt;br /&gt;     19396455&lt;br /&gt;Patch  19567916     : applied on Mon Jul 13 17:41:37 NOVT 2015&lt;br /&gt;Unique Patch ID:  18878751&lt;br /&gt;   Created on 1 May 2015, 01:31:51 hrs PST8PDT&lt;br /&gt;   Bugs fixed:&lt;br /&gt;     19567916&lt;br /&gt;Patch  20879889     : applied on Mon Jul 13 17:33:26 NOVT 2015&lt;br /&gt;Unique Patch ID:  18969474&lt;br /&gt;   Created on 27 May 2015, 10:30:29 hrs PST8PDT&lt;br /&gt;   Bugs fixed:&lt;br /&gt;     20879889&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;I have found that bug 21214168 incorrectly informed as fixed but actually it's not fixed: &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=21553476.8"&gt;Bug 21553476 - Wrong Results using aggregations of CASE expression with fix of bug 20003240 present in Exadata (Doc ID 21553476.8)&lt;/a&gt;.&lt;br/&gt;So instead of install patch 21214168, we should install Patch 21553476: EXADATA X5-2 RESULTS WRONG NUMERIC CALCULATION.&lt;br/&gt;I had installed patch 21553476 and problem was resolved after that! &lt;pre class="brush:sql;highlight:[11]"&gt;&lt;br /&gt;SQL&gt; select sum(&lt;br /&gt;  2           case&lt;br /&gt;  3             when chrtype in ('R03', 'LDU')&lt;br /&gt;  4             then rate/10&lt;br /&gt;  5           end) result&lt;br /&gt;  6    from test_fact&lt;br /&gt;  7  /&lt;br /&gt;&lt;br /&gt;    RESULT&lt;br /&gt;----------&lt;br /&gt;      .151&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/4868128136297871279/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2015/09/bug-20214168-wrong-results-using.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4868128136297871279'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4868128136297871279'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2015/09/bug-20214168-wrong-results-using.html' title='Bug 20214168 - Wrong Results using aggregations of CASE expression with fix of bug 20003240 present'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-4268908264274496761</id><published>2015-08-17T14:55:00.000+06:00</published><updated>2015-08-17T15:48:13.951+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><title type='text'>EM 12.1.0.4 Installing recommended Plug-Ins and Patches</title><content type='html'>In one of the project we will use DBaaS (Database as a Service) functionality of EM Cloud Control 12c.&lt;br/&gt;We faced with a multiple issue and decided to upgrade EM and install Oracle recommended patches from note:&lt;br/&gt;&lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1549855.1"&gt; Enterprise Manager Cloud Control 12c Recommended Plug-Ins and Patches for Database as a Service (DBaaS) (Doc ID 1549855.1)&lt;/a&gt;&lt;br/&gt;Specifically:&lt;br/&gt;    &lt;a href="https://support.oracle.com/epmos/faces/ui/patch/PatchDetail.jspx?parent=DOCUMENT&amp;sourceId=1549855.1&amp;patchId=20870437"&gt;Patch 20870437&lt;/a&gt;: &lt;a href="#psu_install"&gt;ENTERPRISE MANAGER BASE PLATFORM - OMS 12.1.0.4.4 PSU (GENERIC)&lt;/a&gt;&lt;br/&gt;    and&lt;br/&gt;    &lt;a href="https://support.oracle.com/epmos/faces/ui/patch/PatchDetail.jspx?parent=DOCUMENT&amp;sourceId=1549855.1&amp;patchId=21415432"&gt;Patch 21415432&lt;/a&gt;: &lt;a href="#plugin_patches"&gt;enterprise manager for oms plugins 12.1.0.4.14&lt;/a&gt;&lt;br/&gt;We had vanilla EM 12.1.0.4 installation without any PSU or patches (except Cloud Framework Plug-In version 12.1.0.2.0). &lt;br/&gt;&lt;br/&gt;&lt;a id="psu_install"&gt;&lt;/a&gt;ENTERPRISE MANAGER BASE PLATFORM - OMS 12.1.0.4.4 PSU &lt;br/&gt;At the step of installation:&lt;br/&gt;  &lt;i&gt;2.9 Run the following command on each OMS instance home to ensure that you do not have any issues with configuration and binary prerequisite checks&lt;/i&gt;,&lt;br/&gt; I encountered an error: &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql;highlight:[60]"&gt;&lt;br /&gt;[oracle@mgmt 20870437]$ &lt;br /&gt;/u01/app/oracle/oms12/oms/OPatch/opatchauto apply -analyze &lt;br /&gt;-property_file /u01/app/oracle/oms12/oms/OPatch/wlskeys/property_file &lt;br /&gt;-invPtrLoc /u01/app/oracle/oms12/oms/oraInst.loc  &lt;br /&gt;OPatchAuto.OMS_DISABLE_HOST_CHECK=true&lt;br /&gt;OPatch Automation Tool&lt;br /&gt;Copyright (c) 2014, Oracle Corporation.  All rights reserved.&lt;br /&gt;  &lt;br /&gt;  &lt;br /&gt;OPatchauto version : 11.1.0.10.4&lt;br /&gt;OUI version        : 11.1.0.12.0&lt;br /&gt;Running from       : /u01/app/oracle/oms12/oms&lt;br /&gt;Log file location  : /u01/app/oracle/oms12/oms/cfgtoollogs/opatch/opatch2015-08-07_17-00-41PM_1.log&lt;br /&gt;  &lt;br /&gt;OPatchauto log file: /u01/app/oracle/oms12/oms/cfgtoollogs/opatchauto/20870437/opatch_oms_2015-08-07_17-00-43PM_analyze.log&lt;br /&gt;  &lt;br /&gt;  &lt;br /&gt;  &lt;br /&gt;OPatchauto&lt;br /&gt; failed to establish JMX connection to weblogic server. This could be &lt;br /&gt;because of one (or) more of the following reasons:&lt;br /&gt;1. Weblogic admin server URL that manages OMS application may not be right.&lt;br /&gt;2. Weblogic admin server credentials (username, password) may not be right.&lt;br /&gt;3.&lt;br /&gt; Virtual host configuration. If OMS, weblogic server are on virtual host&lt;br /&gt; configuration, Please make sure to add &lt;br /&gt;OPatchAuto.OMS_DISABLE_HOST_CHECK=true to command line and run again. &lt;br /&gt;(example: /u01/app/oracle/oms12/oms/OPatch/opatchauto apply -analyze &lt;br /&gt;-property_file /u01/app/oracle/oms12/oms/OPatch/wlskeys/property_file &lt;br /&gt;-invPtrLoc /u01/app/oracle/oms12/oms/oraInst.loc &lt;br /&gt;OPatchAuto.OMS_DISABLE_HOST_CHECK=true &lt;br /&gt;OPatchAuto.OMS_DISABLE_HOST_CHECK=true)&lt;br /&gt;  &lt;br /&gt;Please check above conditions and if error(s) still persist, Please contact Oracle support.&lt;br /&gt;  &lt;br /&gt;  &lt;br /&gt;[ Error during Get weblogic Admin Server information Phase]. Detail: OPatchauto was not able to find right interview inputs.&lt;br /&gt;OPatchauto failed:&lt;br /&gt;OPatchauto&lt;br /&gt; failed to establish JMX connection to weblogic server. This could be &lt;br /&gt;because of one (or) more of the following reasons:&lt;br /&gt;1. Weblogic admin server URL that manages OMS application may not be right.&lt;br /&gt;2. Weblogic admin server credentials (username, password) may not be right.&lt;br /&gt;3.&lt;br /&gt; Virtual host configuration. If OMS, weblogic server are on virtual host&lt;br /&gt; configuration, Please make sure to add &lt;br /&gt;OPatchAuto.OMS_DISABLE_HOST_CHECK=true to command line and run again. &lt;br /&gt;(example: /u01/app/oracle/oms12/oms/OPatch/opatchauto apply -analyze &lt;br /&gt;-property_file /u01/app/oracle/oms12/oms/OPatch/wlskeys/property_file &lt;br /&gt;-invPtrLoc /u01/app/oracle/oms12/oms/oraInst.loc &lt;br /&gt;OPatchAuto.OMS_DISABLE_HOST_CHECK=true &lt;br /&gt;OPatchAuto.OMS_DISABLE_HOST_CHECK=true)&lt;br /&gt;  &lt;br /&gt;Please check above conditions and if error(s) still persist, Please contact Oracle support.&lt;br /&gt;  &lt;br /&gt;Log file location: /u01/app/oracle/oms12/oms/cfgtoollogs/opatchauto/20870437/opatch_oms_2015-08-07_17-00-43PM_analyze.log&lt;br /&gt;  &lt;br /&gt;Recommended actions: Please correct the interview inputs and run opatchauto again.&lt;br /&gt;  &lt;br /&gt;OPatchauto failed with error code 231&lt;br /&gt;[oracle@mgmt 20870437]$&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;I searched through MOS knowledge base and have decided that this error due to the old OPatch version.&lt;br/&gt;I found a note with a same error:&lt;br/&gt;&lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1644317.1"&gt;EM12c : OPatchauto fails with : opatchauto finds that weblogic credentials may not be right or admin server is down (Doc ID 1644317.1)&lt;/a&gt;&lt;br/&gt;From which I concluded that issue should be resolved after OPatch 11.1.0.11 install.&lt;br/&gt;As I seen from the logs, we have used OPatch version 11.1.0.10.4.&lt;br/&gt;I installed latest OPatch version 11.1.0.x and installation of PSU was ended without any issues.&lt;br/&gt;&lt;br/&gt;&lt;a id="plugin_patches"&gt;&lt;/a&gt;Enterprise Manager for OMS Plug-Ins 12.1.0.4.14 &lt;br/&gt;opatchauto apply -analyze command showed that from 18 sub-patches I could install only 1. &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql;highlight:[60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76]"&gt;&lt;br /&gt;[oracle@mgmt 21415432]$ /u01/app/oracle/oms12/oms/OPatch/opatchauto apply -analyze -invPtrLoc /u01/app/oracle/oms12/oms/oraInst.loc  OPatchAuto.OMS_DISABLE_HOST_CHECK=true&lt;br /&gt;OPatch Automation Tool&lt;br /&gt;Copyright (c) 2014, Oracle Corporation.  All rights reserved.&lt;br /&gt; &lt;br /&gt;OPatchauto version : 11.1.0.12.3&lt;br /&gt;OUI version        : 11.1.0.12.0&lt;br /&gt;Running from       : /u01/app/oracle/oms12/oms&lt;br /&gt;Log file location  : /u01/app/oracle/oms12/oms/cfgtoollogs/opatch/opatch2015-08-10_15-52-13PM_1.log&lt;br /&gt; &lt;br /&gt;OPatchauto log file: /u01/app/oracle/oms12/oms/cfgtoollogs/opatchauto/21415432/opatch_oms_2015-08-10_15-52-16PM_analyze.log&lt;br /&gt; &lt;br /&gt;Please enter OMS weblogic admin server URL(t3s://mgmt.localdomain:7102):&gt;&lt;br /&gt;Please enter OMS weblogic admin server username:&gt; weblogic&lt;br /&gt;Please enter OMS weblogic admin server password:&gt;&lt;br /&gt; &lt;br /&gt;WARNING: Sub-patch "19060193" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "19513319" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "19512418" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "20466650" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "20623942" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "20950018" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "20950277" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21167953" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21167965" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21167991" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21174690" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21185095" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21324604" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21324646" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21324654" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21324861" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21324890" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt; &lt;br /&gt;Configuration Validation: Success&lt;br /&gt; &lt;br /&gt;Running apply prerequisite checks for sub-patch(es) "21167573" and Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.cfw.oms.plugin_12.1.0.2.0"...&lt;br /&gt;Please monitor OPatch log file: /u01/app/oracle/oms12/plugins/oracle.sysman.cfw.oms.plugin_12.1.0.2.0/cfgtoollogs/opatch/21167573_Aug_10_2015_15_52_13/ApplyPrereq2015-08-10_15-53-08PM_2.log&lt;br /&gt;Sub-patch(es) "21167573" are successfully analyzed for Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.cfw.oms.plugin_12.1.0.2.0"&lt;br /&gt; &lt;br /&gt;Complete Summary&lt;br /&gt;================&lt;br /&gt; &lt;br /&gt;All log file names referenced below can be accessed from the directory "/u01/app/oracle/oms12/oms/cfgtoollogs/opatch/2015-08-10_15-52-13PM_SystemPatch_21415432_1"&lt;br /&gt; &lt;br /&gt;Prerequisites analysis summary:&lt;br /&gt;-------------------------------&lt;br /&gt;  &lt;br /&gt;The following sub-patch(es) are applicable:&lt;br /&gt; &lt;br /&gt;  Oracle Home Name   Sub-patches                                          Log file&lt;br /&gt;  ----------------   -----------                                          --------&lt;br /&gt;         OraHome18      21167573   21167573_ApplyPrereq2015-08-10_15-53-08PM_2.log&lt;br /&gt; &lt;br /&gt;The following sub-patches are incompatible with components installed in the OMS system:&lt;br /&gt;19060193,19513319,19512418,20466650,20623942,20950018,20950277,21167953,21167965,21167991,21174690,21185095,21324604,21324646,21324654,21324861,21324890&lt;br /&gt; &lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt; &lt;br /&gt;The following warnings have occurred during OPatchauto execution:&lt;br /&gt;1)  Sub-patch "19060193" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;2)  Sub-patch "19513319" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;3)  Sub-patch "19512418" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;4)  Sub-patch "20466650" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;5)  Sub-patch "20623942" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;6)  Sub-patch "20950018" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;7)  Sub-patch "20950277" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;8)  Sub-patch "21167953" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;9)  Sub-patch "21167965" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;10)  Sub-patch "21167991" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;11)  Sub-patch "21174690" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;12)  Sub-patch "21185095" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;13)  Sub-patch "21324604" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;14)  Sub-patch "21324646" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;15)  Sub-patch "21324654" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;16)  Sub-patch "21324861" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;17)  Sub-patch "21324890" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt; &lt;br /&gt;OPatchauto Session completed with warnings.&lt;br /&gt; &lt;br /&gt;Log file location: /u01/app/oracle/oms12/oms/cfgtoollogs/opatchauto/21415432/opatch_oms_2015-08-10_15-52-16PM_analyze.log&lt;br /&gt; &lt;br /&gt;OPatchauto completed with warnings.&lt;br /&gt; &lt;br /&gt;[oracle@mgmt 21415432]$&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;Most of the patches was skipped due to incompatibility checks: &lt;pre class="brush:sql"&gt;&lt;br /&gt;WARNING: Sub-patch "21324890" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;&lt;/pre&gt;I searched through MOS knowledge base and found a note:&lt;br/&gt; &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1921337.1"&gt;EM 12c: Applying a System Patch to the Enterprise Manager 12.1.0.4 Cloud Control OMS Oracle Home Fails at Analyze with Error: Sub-patch skipped for incompatibility with components installed in the OMS system (Doc ID 1921337.1)&lt;/a&gt;which tell us that:&lt;br/&gt;&lt;br/&gt;&lt;i&gt;Such incompatibility errors result from two scenarios:&lt;br/&gt;Case 1:The Bundle Patch is comprised of patches for the OMS Oracle Home as well as Plug-in Homes. If one of these Plugins is not present in the environment, then these patches would be skipped automatically as they are not needed.  &lt;br/&gt;Case 2: If the plug-in is present but is of a lower version than the plug-in versions mentioned above, then such errors can also result.&lt;/i&gt;&lt;br/&gt;&lt;br/&gt;Patch 21415432 (Enterprise Manager for OMS Plug-Ins 12.1.0.4.14) contains patches for the below list of plugins: &lt;ul&gt;        &lt;li&gt;Enterprise Manager for Cloud: 12.1.0.8.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for Fusion Middleware: 12.1.0.6.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for Oracle Database: 12.1.0.6.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for Fusion Applications: 12.1.0.6.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for Storage Management Framework: 12.1.0.4.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for Siebel: 12.1.0.5.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for Exadata : 12.1.0.6.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for Oracle Virtual Infrastructure: 12.1.0.1.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for Virtualization: 12.1.0.6.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for My Oracle Support: 12.1.0.6.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for Chargeback and Capacity Planning: 12.1.0.6.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for Apache Tomcat: 12.1.0.3.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for Oracle Database: 12.1.0.7.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for Storage Management Framework: 12.1.0.5.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for Cloud: 12.1.0.9.0&lt;/li&gt;        &lt;li&gt;Enterprise Manager for Fusion Middleware: 12.1.0.7.0&lt;/li&gt;&lt;/ul&gt;Reading further the note&lt;br/&gt;&lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1921337.1"&gt;EM 12c: Applying a System Patch to the Enterprise Manager 12.1.0.4 Cloud Control OMS Oracle Home Fails at Analyze with Error: Sub-patch skipped for incompatibility with components installed in the OMS system (Doc ID 1921337.1)&lt;/a&gt;, I have found the emcli commands which can be used to verify versions of plugins installed on the OMS: &lt;pre class="brush:sql"&gt;&lt;br /&gt;./emcli login -username=sysman&lt;br /&gt;./emcli sync&lt;br /&gt;./emcli list_plugins_on_server&lt;br /&gt;&lt;/pre&gt;I run above commands and found that I have plugin versions which should be patched by the Patch 21415432 (I highlight DB and SMF plugins for simplicity): &lt;pre class="brush:sql;highlight:[4,8]"&gt;&lt;br /&gt;OMS name is mgmt.localdomain:4889_Management_Service&lt;br /&gt;Plug-in Name                        Plugin-id                   Version [revision]&lt;br /&gt;Oracle Cloud Framework              oracle.sysman.cfw           12.1.0.2.0&lt;br /&gt;Oracle Database                     oracle.sysman.db            12.1.0.6.0&lt;br /&gt;Oracle Fusion Middleware            oracle.sysman.emas          12.1.0.6.0&lt;br /&gt;Oracle MOS (My Oracle Support)      oracle.sysman.mos           12.1.0.6.0&lt;br /&gt;Oracle Storage Management Framework oracle.sysman.smf           12.1.0.4.0&lt;br /&gt;Oracle Cloud Application            oracle.sysman.ssa           12.1.0.8.0&lt;br /&gt;Oracle Virtual Infrastructure       oracle.sysman.vi            12.1.0.1.0&lt;br /&gt;Oracle Virtualization               oracle.sysman.vt            12.1.0.6.0&lt;br /&gt;Oracle Exadata                      oracle.sysman.xa            12.1.0.6.0&lt;br /&gt;&lt;/pre&gt;I continued searching through MOS and found the &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=21287619.8"&gt;Bug 21287619 : OPATCHAUTO UNABLE TO IDENTIFY INSTALLED PLUGIN_HOME&lt;/a&gt;which was without the resolution but provided some ideas for further investigations.&lt;br/&gt;I started to check them.&lt;br/&gt;At first, I verified that I have correct plugin versions in PLUGIN_HOME: &lt;pre class="brush:sql;highlight:[7,10]"&gt;&lt;br /&gt;[oracle@mgmt 21415432]$ ls -la /u01/app/oracle/oms12/plugins/&lt;br /&gt;drwxr-xr-x 14 oracle oinstall 4096 Aug  4 15:05 .&lt;br /&gt;drwxr-x--- 16 oracle oinstall 4096 Jul 11  2014 ..&lt;br /&gt;drwxr-xr-x  2 oracle oinstall 4096 Aug  4 15:31 backup&lt;br /&gt;drwxr-xr-x 12 oracle oinstall 4096 Jul 11  2014 oracle.sysman.cfw.oms.plugin_12.1.0.1.0&lt;br /&gt;drwxr----- 14 oracle oinstall 4096 Aug 10 14:58 oracle.sysman.cfw.oms.plugin_12.1.0.2.0&lt;br /&gt;drwxr-xr-x 18 oracle oinstall 4096 Aug  4 15:03 oracle.sysman.db.oms.plugin_12.1.0.6.0&lt;br /&gt;drwxr-xr-x 18 oracle oinstall 4096 Jul 11  2014 oracle.sysman.emas.oms.plugin_12.1.0.6.0&lt;br /&gt;drwxr-xr-x 13 oracle oinstall 4096 Jul 11  2014 oracle.sysman.mos.oms.plugin_12.1.0.6.0&lt;br /&gt;drwxr-xr-x 12 oracle oinstall 4096 Jul 11  2014 oracle.sysman.smf.oms.plugin_12.1.0.4.0&lt;br /&gt;drwxr-xr-x 14 oracle oinstall 4096 Jul 11  2014 oracle.sysman.ssa.oms.plugin_12.1.0.8.0&lt;br /&gt;drwxr-xr-x 12 oracle oinstall 4096 Jul 11  2014 oracle.sysman.vi.oms.plugin_12.1.0.1.0&lt;br /&gt;drwxr-xr-x 15 oracle oinstall 4096 Jul 11  2014 oracle.sysman.vt.oms.plugin_12.1.0.6.0&lt;br /&gt;drwxr-xr-x 13 oracle oinstall 4096 Jul 11  2014 oracle.sysman.xa.oms.plugin_12.1.0.6.0&lt;br /&gt;drwxr-xr-x  2 oracle oinstall 4096 Jul 11  2014 tmp&lt;br /&gt;&lt;/pre&gt;I reviewed opatch/opatchauto lspatches output: &lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@mgmt 21415432]$ opatch lspatches&lt;br /&gt;20870437;ENTERPRISE MANAGER BASE PLATFORM - OMS 12.1.0.4.4 PSU (GENERIC)&lt;br /&gt;[oracle@mgmt 21415432]$ opatchauto lspatches&lt;br /&gt;OPatch Automation Tool&lt;br /&gt;Copyright (c) 2014, Oracle Corporation.  All rights reserved.&lt;br /&gt;Oracle Home:/u01/app/oracle/oms12/oms&lt;br /&gt;20870437;ENTERPRISE MANAGER BASE PLATFORM - OMS 12.1.0.4.4 PSU (GENERIC)&lt;br /&gt;The following groups of patch(es) are applied as System Patch bundle(s):&lt;br /&gt;20870437&lt;br /&gt;For more details on installed patch(es) in platform, plugin homes, Please do "/u01/app/oracle/oms12/oms/OPatch/opatch lsinventory -details -oh &lt;desired home path&gt;".&lt;br /&gt;&lt;/pre&gt;opatch lsinv output: &lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@mgmt 21415432]$ opatch lsinv&lt;br /&gt;Oracle Interim Patch Installer version 11.1.0.12.7&lt;br /&gt;Copyright (c) 2015, Oracle Corporation.  All rights reserved.&lt;br /&gt;Oracle Home       : /u01/app/oracle/oms12/oms&lt;br /&gt;Central Inventory : /u01/app/oraInventory&lt;br /&gt;   from           : /u01/app/oracle/oms12/oms/oraInst.loc&lt;br /&gt;OPatch version    : 11.1.0.12.7&lt;br /&gt;OUI version       : 11.1.0.12.0&lt;br /&gt;Log file location : /u01/app/oracle/oms12/oms/cfgtoollogs/opatch/opatch2015-08-11_08-41-48AM_1.log&lt;br /&gt;OPatch detects the Middleware Home as "/u01/app/oracle/oms12"&lt;br /&gt;Lsinventory Output file location : /u01/app/oracle/oms12/oms/cfgtoollogs/opatch/lsinv/lsinventory2015-08-11_08-41-48AM.txt&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;Installed Top-level Products (1):&lt;br /&gt;EM Platform (OMS)                                                    12.1.0.4.0&lt;br /&gt;There are 1 products installed in this Oracle Home.&lt;br /&gt;Interim patches (1) :&lt;br /&gt;Patch  20870437     : applied on Mon Aug 10 15:19:39 MSK 2015&lt;br /&gt;Unique Patch ID:  18978384&lt;br /&gt;Patch description:  "ENTERPRISE MANAGER BASE PLATFORM - OMS 12.1.0.4.4 PSU (GENERIC)"&lt;br /&gt;   Created on 2 Jul 2015, 03:07:25 hrs PST8PDT&lt;br /&gt;   Bugs fixed:&lt;br /&gt;     20010360, 20346629, 18599481, 19459173, 20646440, 18830050, 18244680&lt;br /&gt;     19614772, 20492788, 18932882, 19355307, 20263906, 20556489, 20106145&lt;br /&gt;     14301574, 18721562, 19328391, 19535114, 19861538, 19794113, 19604817&lt;br /&gt;     20596437, 19892848, 19218456, 19978077, 18505219, 17843191, 20345612&lt;br /&gt;     20748748, 20024779, 18256983, 19329809, 19300103, 17987955, 18351725&lt;br /&gt;     18903783, 19430853, 19845101, 20870437, 20223681, 20019184, 20263188&lt;br /&gt;     19069940, 19861412, 19136663, 18446798, 19474685, 18765545, 18038059&lt;br /&gt;     17783148, 18041873, 19509780, 19030447, 20933667, 19574756, 19258481&lt;br /&gt;     18938561, 17812648, 20377474, 19572261, 18945007, 20307428, 18388324&lt;br /&gt;     19500609, 17991694, 19137411, 19474929, 19592446, 18710124, 20536095&lt;br /&gt;     19352118, 19557054, 18726708, 19595813, 19170861, 19685443, 18353162&lt;br /&gt;     19289270, 19367214, 18906451, 19458672, 20284029, 18490444, 19766881&lt;br /&gt;     18509136, 20739088, 19511544, 18695961, 19812966, 20576148, 20623258&lt;br /&gt;     19055251, 20260177, 19323634, 19941819, 18725891, 19824587, 19780847&lt;br /&gt;     18359621, 19393211, 19211048, 20505155, 18476364, 18490468, 18247849&lt;br /&gt;     19071602, 19068674, 18490455, 19524568, 19061168, 19077861, 20031287&lt;br /&gt;     18756725, 19281252, 18977955, 18521731, 18485889, 19775544, 18900197&lt;br /&gt;     17834366, 20460507, 19545505, 19823996, 20645335, 20633770, 17407918&lt;br /&gt;     18706824, 20568225, 18805935, 19376082, 19146514, 18490432, 19694744&lt;br /&gt;     18230284, 18726208, 20044313, 18516298, 20642633, 18999400, 20692416&lt;br /&gt;     20392036, 19362386, 19452280, 18356966, 20617058, 19055979, 19830994&lt;br /&gt;     20030493, 19823761, 18834216, 19196979, 19785223, 18389542&lt;br /&gt;  &lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;OPatch succeeded.&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;I found an answer in an inventory.xml from Central Inventory: &lt;pre class="brush:xml;highlight:[12,13]"&gt;&lt;br /&gt;&amp;lt;HOME NAME="oms12c1" LOC="/u01/app/oracle/oms12/oms" TYPE="O" IDX="3"&gt;&lt;br /&gt;   &amp;lt;REFHOMELIST&gt;&lt;br /&gt;      &amp;lt;REFHOME LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.db.oms.plugin_12.1.0.4.0"/&gt;&lt;br /&gt;      &amp;lt;REFHOME LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.xa.oms.plugin_12.1.0.4.0"/&gt;&lt;br /&gt;      &amp;lt;REFHOME LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.emas.oms.plugin_12.1.0.4.0"/&gt;&lt;br /&gt;      &amp;lt;REFHOME LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.mos.oms.plugin_12.1.0.5.0"/&gt;&lt;br /&gt;      &amp;lt;REFHOME LOC="/u01/app/oracle/oms12/jdk16"/&gt;&lt;br /&gt;      &amp;lt;REFHOME LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.vt.oms.plugin_12.1.0.5.0"/&gt;&lt;br /&gt;      &amp;lt;REFHOME LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.ssa.oms.plugin_12.1.0.6.0"/&gt;&lt;br /&gt;      &amp;lt;REFHOME LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.smf.oms.plugin_12.1.0.2.0"/&gt;&lt;br /&gt;      &amp;lt;REFHOME LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.ssa.oms.plugin_12.1.0.7.0"/&gt;&lt;br /&gt;      &amp;lt;REFHOME LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.db.oms.plugin_12.1.0.5.0"/&gt;&lt;br /&gt;      &amp;lt;REFHOME LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.smf.oms.plugin_12.1.0.3.0"/&gt;&lt;br /&gt;      &amp;lt;REFHOME LOC="/u01/app/oracle/oms12/plugins/oracle.sun.oss7.oms.plugin_12.1.0.4.0"/&gt;&lt;br /&gt;      &amp;lt;REFHOME LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.emas.oms.plugin_12.1.0.5.0"/&gt;&lt;br /&gt;      &amp;lt;REFHOME LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.cfw.oms.plugin_12.1.0.2.0"/&gt;&lt;br /&gt;   &amp;lt;/REFHOMELIST&gt;&lt;br /&gt;&amp;lt;/HOME&gt;&lt;br /&gt;&lt;/pre&gt;Notice, that inventory.xml contains old plugin versions! It's hard to say what exactly leads to a such behaviour and I didn't have enough time for further investigations.&lt;br/&gt;It was enough for me, that inventory.xml dont contain actual plugin versions.&lt;br/&gt;&lt;br/&gt;Example 1: oracle.sysman.smf.oms.plugin (Storage Management Framework).&lt;br/&gt;emcli list_plugins_on_server shows version 12.1.0.4: &lt;pre class="brush:sql"&gt;&lt;br /&gt;Oracle Storage Management Framework          oracle.sysman.smf             12.1.0.4.0&lt;br /&gt;&lt;/pre&gt;inventory.xml contains information about versions 12.1.0.2/12.1.0.3: &lt;pre class="brush:xml"&gt;&lt;br /&gt;&amp;lt;HOME NAME="OraHome13" LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.smf.oms.plugin_12.1.0.2.0" TYPE="O" IDX="24" PLUGIN="T"&gt;&lt;br /&gt;&amp;lt;HOME NAME="OraHome16" LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.smf.oms.plugin_12.1.0.3.0" TYPE="O" IDX="29" PLUGIN="T"&gt;&lt;br /&gt;&lt;/pre&gt;Patch 21415432 contains fixes for SMF plugin versions 12.1.0.4/12.1.0.5.&lt;br/&gt;&lt;br/&gt;Example 2: oracle.sysman.db.oms.plugin (Database Plugin).&lt;br/&gt;emcli list_plugins_on_server shows version 12.1.0.6: &lt;pre class="brush:sql"&gt;&lt;br /&gt;Oracle Database                               oracle.sysman.db                12.1.0.6.0&lt;br /&gt;&lt;/pre&gt;inventory.xml contains information about versions 12.1.0.4/12.1.0.5: &lt;pre class="brush:xml"&gt;&lt;br /&gt;&amp;lt;HOME NAME="oracle_sysman_db11" LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.db.oms.plugin_12.1.0.4.0" TYPE="O" IDX="4" PLUGIN="T"&gt;&lt;br /&gt;&amp;lt;HOME NAME="OraHome15" LOC="/u01/app/oracle/oms12/plugins/oracle.sysman.db.oms.plugin_12.1.0.5.0" TYPE="O" IDX="28" PLUGIN="T"&gt;&lt;br /&gt;&lt;/pre&gt;Patch 21415432 contains fixes for Database Plugin versions 12.1.0.6/12.1.0.7.&lt;br/&gt;Due to such inconsistencies opatch reported a message like below: &lt;pre&gt;&lt;br /&gt;WARNING: Sub-patch "19060193" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;&lt;/pre&gt;I decided to recover lost inventory entities by note:&lt;br/&gt; &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1480237.1"&gt;EM 12c: How to Recover a Lost Inventory Record for the Enterprise Manager 12.1.0.1 Cloud Control OMS and Management Agent (Doc ID 1480237.1)&lt;/a&gt;&lt;br/&gt;&lt;br/&gt;&lt;i&gt;    GOAL&lt;br/&gt;&lt;br/&gt;     In the case that recovering a lost inventory record may be necessary, this note describes how to accomplish this for the Enterprise Manager 12.1.0.1 Cloud Control OMS and Management Agent. &lt;/i&gt;&lt;br/&gt;&lt;br/&gt;First of all, I had take backup of Central Inventory, local inventory, ORACLE_HOME of OMS.&lt;br/&gt;8 plugins from 9 total didn't have an actual version in the inventory.xml.&lt;br/&gt;For each of them, I executed steps from the note:&lt;br/&gt; &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1480237.1"&gt;EM 12c: How to Recover a Lost Inventory Record for the Enterprise Manager 12.1.0.1 Cloud Control OMS and Management Agent (Doc ID 1480237.1)&lt;/a&gt;&lt;br/&gt;I remind, that before my actions only 1 sub-patch (from 18) could be applied to the OMS.&lt;br/&gt;And after that, opatchauto analyze showed that 9 sub-patches from 18 could be applied to the OMS. Bingo!&lt;br/&gt;OMS Plug-Ins patches contains fixes for 2 versions of each plugin. And only one of them was installed in my environment.&lt;br/&gt;&lt;div&gt;&lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;&lt;div style="display: none;"&gt;&lt;pre class="brush:sql"&gt;&lt;br /&gt;[oracle@mgmt 21415432]$ /u01/app/oracle/oms12/oms/OPatch/opatchauto apply -analyze -invPtrLoc /u01/app/oracle/oms12/oms/oraInst.loc  OPatchAuto.OMS_DISABLE_HOST_CHECK=true&lt;br /&gt;OPatch Automation Tool&lt;br /&gt;Copyright (c) 2014, Oracle Corporation.  All rights reserved.&lt;br /&gt; &lt;br /&gt;OPatchauto version : 11.1.0.12.3&lt;br /&gt;OUI version        : 11.1.0.12.0&lt;br /&gt;Running from       : /u01/app/oracle/oms12/oms&lt;br /&gt;Log file location  : /u01/app/oracle/oms12/oms/cfgtoollogs/opatch/opatch2015-08-11_17-13-05PM_1.log&lt;br /&gt;OPatchauto log file: /u01/app/oracle/oms12/oms/cfgtoollogs/opatchauto/21415432/opatch_oms_2015-08-11_17-13-08PM_analyze.log&lt;br /&gt; &lt;br /&gt;Please enter OMS weblogic admin server URL(t3s://mgmt.localdomain:7102):&gt;&lt;br /&gt;Please enter OMS weblogic admin server username:&gt; weblogic&lt;br /&gt;Please enter OMS weblogic admin server password:&gt;&lt;br /&gt; &lt;br /&gt;WARNING: Sub-patch "19512418" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "20466650" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "20950277" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21167965" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21185095" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21324604" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21324646" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21324654" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;WARNING: Sub-patch "21324861" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;  &lt;br /&gt;Configuration Validation: Success&lt;br /&gt; &lt;br /&gt;Running apply prerequisite checks for sub-patch(es) "21324890" and Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.vi.oms.plugin_12.1.0.1.0"...&lt;br /&gt;Please monitor OPatch log file: /u01/app/oracle/oms12/plugins/oracle.sysman.vi.oms.plugin_12.1.0.1.0/cfgtoollogs/opatch/21324890_Aug_11_2015_17_13_05/ApplyPrereq2015-08-11_17-13-58PM_2.log&lt;br /&gt;Sub-patch(es) "21324890" are successfully analyzed for Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.vi.oms.plugin_12.1.0.1.0"&lt;br /&gt; &lt;br /&gt;Running apply prerequisite checks for sub-patch(es) "21167573" and Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.cfw.oms.plugin_12.1.0.2.0"...&lt;br /&gt;Please monitor OPatch log file: /u01/app/oracle/oms12/plugins/oracle.sysman.cfw.oms.plugin_12.1.0.2.0/cfgtoollogs/opatch/21167573_Aug_11_2015_17_13_05/ApplyPrereq2015-08-11_17-14-01PM_2.log&lt;br /&gt;Sub-patch(es) "21167573" are successfully analyzed for Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.cfw.oms.plugin_12.1.0.2.0"&lt;br /&gt; &lt;br /&gt;Running apply prerequisite checks for sub-patch(es) "21174690" and Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.db.oms.plugin_12.1.0.6.0"...&lt;br /&gt;Please monitor OPatch log file: /u01/app/oracle/oms12/plugins/oracle.sysman.db.oms.plugin_12.1.0.6.0/cfgtoollogs/opatch/21174690_Aug_11_2015_17_13_05/ApplyPrereq2015-08-11_17-14-03PM_2.log&lt;br /&gt;Sub-patch(es) "21174690" are successfully analyzed for Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.db.oms.plugin_12.1.0.6.0"&lt;br /&gt; &lt;br /&gt;Running apply prerequisite checks for sub-patch(es) "21167953" and Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.xa.oms.plugin_12.1.0.6.0"...&lt;br /&gt;Please monitor OPatch log file: /u01/app/oracle/oms12/plugins/oracle.sysman.xa.oms.plugin_12.1.0.6.0/cfgtoollogs/opatch/21167953_Aug_11_2015_17_13_05/ApplyPrereq2015-08-11_17-14-06PM_2.log&lt;br /&gt;Sub-patch(es) "21167953" are successfully analyzed for Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.xa.oms.plugin_12.1.0.6.0"&lt;br /&gt; &lt;br /&gt;Running apply prerequisite checks for sub-patch(es) "19060193" and Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.vt.oms.plugin_12.1.0.6.0"...&lt;br /&gt;Please monitor OPatch log file: /u01/app/oracle/oms12/plugins/oracle.sysman.vt.oms.plugin_12.1.0.6.0/cfgtoollogs/opatch/19060193_Aug_11_2015_17_13_05/ApplyPrereq2015-08-11_17-14-09PM_2.log&lt;br /&gt;Sub-patch(es) "19060193" are successfully analyzed for Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.vt.oms.plugin_12.1.0.6.0"&lt;br /&gt; &lt;br /&gt;Running apply prerequisite checks for sub-patch(es) "20950018" and Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.emas.oms.plugin_12.1.0.6.0"...&lt;br /&gt;Please monitor OPatch log file: /u01/app/oracle/oms12/plugins/oracle.sysman.emas.oms.plugin_12.1.0.6.0/cfgtoollogs/opatch/20950018_Aug_11_2015_17_13_05/ApplyPrereq2015-08-11_17-14-11PM_2.log&lt;br /&gt;Sub-patch(es) "20950018" are successfully analyzed for Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.emas.oms.plugin_12.1.0.6.0"&lt;br /&gt; &lt;br /&gt;Running apply prerequisite checks for sub-patch(es) "20623942" and Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.ssa.oms.plugin_12.1.0.8.0"...&lt;br /&gt;Please monitor OPatch log file: /u01/app/oracle/oms12/plugins/oracle.sysman.ssa.oms.plugin_12.1.0.8.0/cfgtoollogs/opatch/20623942_Aug_11_2015_17_13_05/ApplyPrereq2015-08-11_17-14-14PM_2.log&lt;br /&gt;Sub-patch(es) "20623942" are successfully analyzed for Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.ssa.oms.plugin_12.1.0.8.0"&lt;br /&gt; &lt;br /&gt;Running apply prerequisite checks for sub-patch(es) "19513319" and Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.smf.oms.plugin_12.1.0.4.0"...&lt;br /&gt;Please monitor OPatch log file: /u01/app/oracle/oms12/plugins/oracle.sysman.smf.oms.plugin_12.1.0.4.0/cfgtoollogs/opatch/19513319_Aug_11_2015_17_13_05/ApplyPrereq2015-08-11_17-14-17PM_2.log&lt;br /&gt;Sub-patch(es) "19513319" are successfully analyzed for Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.smf.oms.plugin_12.1.0.4.0"&lt;br /&gt; &lt;br /&gt;Running apply prerequisite checks for sub-patch(es) "21167991" and Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.mos.oms.plugin_12.1.0.6.0"...&lt;br /&gt;Please monitor OPatch log file: /u01/app/oracle/oms12/plugins/oracle.sysman.mos.oms.plugin_12.1.0.6.0/cfgtoollogs/opatch/21167991_Aug_11_2015_17_13_05/ApplyPrereq2015-08-11_17-14-19PM_2.log&lt;br /&gt;Sub-patch(es) "21167991" are successfully analyzed for Oracle Home "/u01/app/oracle/oms12/plugins/oracle.sysman.mos.oms.plugin_12.1.0.6.0"&lt;br /&gt; &lt;br /&gt;Complete Summary&lt;br /&gt;================&lt;br /&gt; &lt;br /&gt;All log file names referenced below can be accessed from the directory "/u01/app/oracle/oms12/oms/cfgtoollogs/opatch/2015-08-11_17-13-05PM_SystemPatch_21415432_1"&lt;br /&gt; &lt;br /&gt;Prerequisites analysis summary:&lt;br /&gt;-------------------------------&lt;br /&gt; &lt;br /&gt;The following sub-patch(es) are applicable:&lt;br /&gt; &lt;br /&gt;                                 Oracle Home Name   Sub-patches                                          Log file&lt;br /&gt;                                 ----------------   -----------                                          --------&lt;br /&gt;                       oracle_home_MOS_12_1_0_6_0      21167991   21167991_ApplyPrereq2015-08-11_17-14-19PM_2.log&lt;br /&gt;  oracle_home_Oracle_Fusion_Middleware_12_1_0_6_0      20950018   20950018_ApplyPrereq2015-08-11_17-14-11PM_2.log&lt;br /&gt;                        oracle_home_OV_12_1_0_6_0      19060193   19060193_ApplyPrereq2015-08-11_17-14-09PM_2.log&lt;br /&gt;                                        OraHome18      21167573   21167573_ApplyPrereq2015-08-11_17-14-01PM_2.log&lt;br /&gt;                       oracle_home_OVI_12_1_0_1_0      21324890   21324890_ApplyPrereq2015-08-11_17-13-58PM_2.log&lt;br /&gt;                        oracle_home_OE_12_1_0_6_0      21167953   21167953_ApplyPrereq2015-08-11_17-14-06PM_2.log&lt;br /&gt;                       oracle_home_OCA_12_1_0_8_0      20623942   20623942_ApplyPrereq2015-08-11_17-14-14PM_2.log&lt;br /&gt;           oracle_home_Oracle_Database_12_1_0_6_0      21174690   21174690_ApplyPrereq2015-08-11_17-14-03PM_2.log&lt;br /&gt;                       oracle_home_SMF_12_1_0_4_0      19513319   19513319_ApplyPrereq2015-08-11_17-14-17PM_2.log&lt;br /&gt;  &lt;br /&gt;The following sub-patches are incompatible with components installed in the OMS system:&lt;br /&gt;19512418,20466650,20950277,21167965,21185095,21324604,21324646,21324654,21324861&lt;br /&gt; &lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt; &lt;br /&gt;The following warnings have occurred during OPatchauto execution:&lt;br /&gt;1)  Sub-patch "19512418" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;2)  Sub-patch "20466650" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;3)  Sub-patch "20950277" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;4)  Sub-patch "21167965" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;5)  Sub-patch "21185095" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;6)  Sub-patch "21324604" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;7)  Sub-patch "21324646" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;8)  Sub-patch "21324654" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;9)  Sub-patch "21324861" skipped for incompatibility with components installed in the OMS system.&lt;br /&gt;--------------------------------------------------------------------------------&lt;br /&gt;OPatchauto Session completed with warnings.&lt;br /&gt; &lt;br /&gt;Log file location: /u01/app/oracle/oms12/oms/cfgtoollogs/opatchauto/21415432/opatch_oms_2015-08-11_17-13-08PM_analyze.log&lt;br /&gt; &lt;br /&gt;OPatchauto completed with warnings.&lt;br /&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;Further installation was ended without any issues.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/4268908264274496761/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2015/08/em-12104-installing-recommended-plug.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4268908264274496761'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4268908264274496761'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2015/08/em-12104-installing-recommended-plug.html' title='EM 12.1.0.4 Installing recommended Plug-Ins and Patches'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8138421456551812974</id><published>2015-08-03T15:26:00.003+06:00</published><updated>2016-05-14T12:31:09.079+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='11g'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='11.2.0.4'/><title type='text'>Reclaim unused space from MLOG$ segments after MVIEW Refresh</title><content type='html'>We are using fast-refreshable MVIEWs in some of our database for reporting purposes.&lt;br/&gt;They are works fine most of the time.&lt;br/&gt;However, periodically MLOG size is increased due to different reasons.&lt;br/&gt;Such as: bulk data loading, other abnormal application activities, or delays with MVIEW refresh.&lt;br/&gt;After that, even if you refresh MVIEW, HWM doesn't reset. &lt;br/&gt;You need to reset it manually, using commands such as ALTER TABLE SHRINK/MOVE and so on.&lt;br/&gt;Without resetting the HWM MVIEW refresh performance can be poor.&lt;br/&gt;&lt;br/&gt;Good news: there are Patch 11072728 available for some platforms that can reset the HWM without manual intervention. &lt;br/&gt;This patch was described in MOS note &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1941137.1"&gt;Space Not Reclaimed from MLOG$ Segments After MVIEW Refresh (Doc ID 1941137.1)&lt;/a&gt;&lt;br/&gt;According to the note, the fix for bug 11072728 will be provided in upcoming 12.2 release.&lt;br/&gt;I have already requested that patch for Solaris SPARC64 on top of 11.2.0.4.4/11.2.0.4.6.&lt;br/&gt;&lt;br/&gt;Today I have decided to look closer on Patch 11072728 in one of non-production database. &lt;br/&gt;I want to be sure that patch didn't harm production instance.&lt;br/&gt;&lt;br/&gt;Reading the bug readme, I have found that fix for bug is not enabled by default.&lt;br/&gt;You need to set underscope parameter _bug11072728_mv_refresh_truncate_log to 1 to enable it.&lt;br/&gt;Worth to be noted, is that we can change this parameter on the session and on the system level: &lt;pre class="brush: sql"&gt;&lt;br /&gt;SQL&gt; select isses_modifiable,&lt;br /&gt;  2         issys_modifiable&lt;br /&gt;  3    from v$parameter&lt;br /&gt;  4   where name = '_bug11072728_mv_refresh_truncate_log';&lt;br /&gt;&lt;br /&gt;ISSES_MODIFIABLE ISSYS_MODIFIABLE&lt;br /&gt;---------------- ----------------&lt;br /&gt;TRUE             IMMEDIATE&lt;br /&gt;&lt;/pre&gt; Next script I have used to setup test schema:     &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; grant connect to tc identified by tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt; grant alter session to tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt; grant create materialized view to tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt; grant create table to tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt; grant unlimited tablespace to tc;&lt;br /&gt;&lt;br /&gt;Grant succeeded.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; conn tc/tc&lt;br /&gt;Connected.&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; create table t&lt;br /&gt;  2  as&lt;br /&gt;  3  select *&lt;br /&gt;  4    from all_users;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; alter table t add constraint t_pk primary key(username);&lt;br /&gt;&lt;br /&gt;Table altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; create materialized view log on t with primary key;&lt;br /&gt;&lt;br /&gt;Materialized view log created.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; create materialized view mv_t&lt;br /&gt;  2  refresh fast&lt;br /&gt;  3  as&lt;br /&gt;  4  select *&lt;br /&gt;  5    from t;&lt;br /&gt;&lt;br /&gt;Materialized view created.&lt;br /&gt;    &lt;/pre&gt;In the above script I have created table, mat view log on it, and materialized view.&lt;br/&gt;We can see that mat view log is empty, segment has 8 blocks allocated: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select count(*) from mlog$_t;&lt;br /&gt;&lt;br /&gt;  COUNT(*)&lt;br /&gt;----------&lt;br /&gt;         0&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select blocks&lt;br /&gt;  2    from user_segments&lt;br /&gt;  3   where segment_name = 'MLOG$_T';&lt;br /&gt;&lt;br /&gt;    BLOCKS&lt;br /&gt;----------&lt;br /&gt;         8&lt;br /&gt;&lt;/pre&gt;I update table in loop, 100 times in total: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; begin&lt;br /&gt;  2    for i in 1..100&lt;br /&gt;  3    loop&lt;br /&gt;  4      update t&lt;br /&gt;  5         set created = created&lt;br /&gt;  6       where username &lt;&gt; 'SYS';&lt;br /&gt;  7      commit;&lt;br /&gt;  8    end loop;&lt;br /&gt;  9  end;&lt;br /&gt; 10  /&lt;br /&gt;&lt;/pre&gt;Check that mat view log is not empty, segment was extended: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select count(*) from mlog$_t;&lt;br /&gt;&lt;br /&gt;  COUNT(*)&lt;br /&gt;----------&lt;br /&gt;     19400&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select blocks&lt;br /&gt;  2    from user_segments&lt;br /&gt;  3   where segment_name = 'MLOG$_T';&lt;br /&gt;&lt;br /&gt;    BLOCKS&lt;br /&gt;----------&lt;br /&gt;       104&lt;br /&gt;&lt;/pre&gt;Let's refresh materialized view now: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; exec dbms_mview.refresh( 'mv_t', method=&gt;'f')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;If the patch 11072728 was not applied or the parameter "_bug11072728_mv_refresh_truncate_log" not set to 1, then the HWM is not reset and the segment space allocated is the same: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select count(*) from mlog$_t;&lt;br /&gt;&lt;br /&gt;  COUNT(*)&lt;br /&gt;----------&lt;br /&gt;         0&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select blocks&lt;br /&gt;  2    from user_segments&lt;br /&gt;  3   where segment_name = 'MLOG$_T';&lt;br /&gt;&lt;br /&gt;    BLOCKS&lt;br /&gt;----------&lt;br /&gt;       104&lt;br /&gt;&lt;/pre&gt;In the production system with a high DML activity materialized view logs can grows to a much higher size.&lt;br/&gt;And the materialized view refresh performance degrades.&lt;br/&gt;As I said previously, before the patch 11072728 you need to reset the HWM manually.&lt;br/&gt;With the patch 11072829 you dont need to do it anymore.&lt;br/&gt;Just the set parameter "_bug11072728_mv_refresh_truncate_log" to 1: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; exec dbms_mview.refresh( 'mv_t', method=&gt;'f')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select count(*) from mlog$_t;&lt;br /&gt;&lt;br /&gt;  COUNT(*)&lt;br /&gt;----------&lt;br /&gt;         0&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select blocks&lt;br /&gt;  2    from user_segments&lt;br /&gt;  3   where segment_name = 'MLOG$_T';&lt;br /&gt;&lt;br /&gt;    BLOCKS&lt;br /&gt;----------&lt;br /&gt;         8&lt;br /&gt;&lt;/pre&gt;You can see that segment allocated space was decreased.&lt;br/&gt;How does it works under the hood?&lt;br/&gt;I have setup sql tracing and event 10704 (enqueue trace) to investigate it: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; alter session set events 'sql_trace bind=true:10704 level 10';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; exec dbms_mview.refresh( 'mv_t', method=&gt;'f')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;I used below command to filter the irrelevant lines from output:&lt;br/&gt;egrep "ksqgtl \*|ksqrcl: [^r]|^truncate|select count\(\*\) from .*MLOG" orcl_ora_18632.trc &lt;ul&gt;  &lt;li&gt;ksqgtl - get lock function&lt;/li&gt;  &lt;li&gt;ksqrcl - release lock function&lt;/li&gt;  &lt;li&gt;We want to show the truncate command and the select count(*) from MLOG.&lt;/li&gt;&lt;/ul&gt;Below is the output of egrep command, in which some lines was skipped for brevity: &lt;pre class="brush:sql"&gt;&lt;br /&gt;select count(*) from "TC"."MLOG$_T"&lt;br /&gt;ksqgtl *** TM-001854e4-00000000 mode=6 flags=0x401 timeout=0 ***&lt;br /&gt;select count(*) from "TC"."MLOG$_T"&lt;br /&gt;ksqgtl *** TM-001854e6-00000000 mode=6 flags=0x401 timeout=0 ***&lt;br /&gt;truncate table "TC"."MLOG$_T"&lt;br /&gt;&lt;/pre&gt;These commands was executed when the materialized view update already done.&lt;br/&gt;Looks like that new algorithm with MLOG truncate works in following way: &lt;ol&gt;  &lt;li&gt;execute old refresh code&lt;/li&gt;  &lt;li&gt;check count of rows in MLOG&lt;/li&gt;  &lt;li&gt;if zero, lock master table in exclusive mode nowait (TM lock with timeout=0)&lt;/li&gt;  &lt;li&gt;check count of rows in MLOG again (because there are can be DML between step 2 and 3)&lt;/li&gt;  &lt;li&gt;lock MLOG in exclusive mode nowait (TM lock with timeout=0)&lt;/li&gt;  &lt;li&gt;truncate MLOG&lt;/li&gt;&lt;/ol&gt;At least, an open transaction will prevent the truncation of MLOG. &lt;br/&gt;And that indirectly confirms my assumptions about internal workings of new refresh algorithm. Let's update the 1 row in table in session 1: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; -- session 1&lt;br /&gt;SQL&gt; update t&lt;br /&gt;  2     set created=created&lt;br /&gt;  3   where username='SYS';&lt;br /&gt;&lt;br /&gt;1 row updated.&lt;br /&gt;&lt;/pre&gt;Now we will check space of MLOG before refresh, perform actual refresh and check the space again (in other session): &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; -- session 2&lt;br /&gt;SQL&gt; select blocks&lt;br /&gt;  2    from user_segments&lt;br /&gt;  3   where segment_name = 'MLOG$_T';&lt;br /&gt;&lt;br /&gt;    BLOCKS&lt;br /&gt;----------&lt;br /&gt;       104&lt;br /&gt;&lt;br /&gt;SQL&gt; exec dbms_mview.refresh( 'mv_t', method=&gt;'f')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select count(*) from mlog$_t;&lt;br /&gt;&lt;br /&gt;  COUNT(*)&lt;br /&gt;----------&lt;br /&gt;         0&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select blocks&lt;br /&gt;  2    from user_segments&lt;br /&gt;  3   where segment_name = 'MLOG$_T';&lt;br /&gt;&lt;br /&gt;    BLOCKS&lt;br /&gt;----------&lt;br /&gt;       104&lt;br /&gt;&lt;/pre&gt;And the truncate of MLOG was not executed.&lt;br/&gt;Looks like, it's safe to use a patch 11072728 in the production environment.&lt;br/&gt;If I will face any issue with that patch in the production, I will update this blog post.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/8138421456551812974/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2015/08/reclaim-unused-space-from-mlog-segments.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8138421456551812974'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8138421456551812974'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2015/08/reclaim-unused-space-from-mlog-segments.html' title='Reclaim unused space from MLOG$ segments after MVIEW Refresh'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8657143205883210152</id><published>2015-07-22T16:37:00.000+06:00</published><updated>2016-05-14T12:30:38.778+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12.1.0.2'/><category scheme='http://www.blogger.com/atom/ns#' term='EBR'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><title type='text'>Edition-Based redefinition: adjunct schemas</title><content type='html'>EBR (Edition-Based Redefinition) - one of the killer feature of Oracle Database 11g R2, as &lt;a href="http://www.oracle.com/au/products/database/o30asktom-082672.html"&gt;said Tom Kyte at the 2010&lt;/a&gt;. &lt;br/&gt;But I don't think that this feature widely used by Oracle community. &lt;br/&gt;Why? Probably, because application must be "edition-aware", as described by Tom Kyte in his excellent articles. &lt;br/&gt;I have been using EBR (Edition-Based Redefinition) since 2012. &lt;br/&gt;In this blog post I would like to describe one of the basic component of EBR: adjunct schemas. &lt;br/&gt;All of this information is a pure speculations based on blog posts and Oracle whitepapers, and my experience with EBR feature. &lt;br/&gt;All of the tests are run in Oracle Database version 12.1.0.2 under Solaris SPARC. &lt;br/&gt;Here is a code that I have used for this demo: &lt;pre class="brush:sql"&gt;&lt;br /&gt;def tns_alias=orcl&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  connect as DBA user&lt;br /&gt;#&lt;br /&gt;conn /@&amp;tns_alias.&lt;br /&gt;&lt;br /&gt;set echo on timi off ti off sqlp "SQL&gt; "&lt;br /&gt;&lt;br /&gt;drop edition e1 cascade;&lt;br /&gt;drop edition e2 cascade;&lt;br /&gt;drop user tc cascade;&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  Create editions-enabled schema&lt;br /&gt;#&lt;br /&gt;grant create procedure, create session to tc identified by tc;&lt;br /&gt;&lt;br /&gt;alter user tc enable editions;&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  Enable SQL tracing&lt;br /&gt;#&lt;br /&gt;&lt;br /&gt;alter session set events 'sql_trace bind=true';&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  Create 2 editions&lt;br /&gt;#&lt;br /&gt;&lt;br /&gt;create edition e1;&lt;br /&gt;create edition e2;&lt;br /&gt;&lt;br /&gt;alter session set events 'sql_trace off';&lt;br /&gt;&lt;br /&gt;select value from v$diag_info where name='Default Trace File';&lt;br /&gt;&lt;/pre&gt;You can see that I have created edition-enabled schema TC and 2 editions: E1 and E2. &lt;br/&gt;I would to point your attention to the below recursive SQL executed during "CREATE EDITION" command: &lt;pre class="brush:sql"&gt;&lt;br /&gt;PARSING IN CURSOR #18446744071422692152 len=288 dep=1 uid=0 oct=2 lid=0 tim=9324454212634 hv=556673006 ad='430c59cc0' sqlid='fws71mhhkw9zf'&lt;br /&gt;insert into user$(user#, name, password, ctime, ptime,                      datats#, tempts#, type#, defrole, resource$, ltime,                      astatus, lcount, spare1, spare2, ext_user&lt;br /&gt;name)    values(:1, :2, NULL, sysdate, null, :3, :4, 2, :5, :6, null, :7, 0, 16,           :8, :9)&lt;br /&gt;END OF STMT&lt;br /&gt;PARSE #18446744071422692152:c=1199,e=1198,p=0,cr=0,cu=0,mis=1,r=0,dep=1,og=4,plh=0,tim=9324454212629&lt;br /&gt;BINDS #18446744071422692152:&lt;br /&gt; Bind#0&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=1000001 frm=00 csi=00 siz=24 off=0&lt;br /&gt;  kxsbbbfp=ffffffff77e77150  bln=22  avl=03  flg=05&lt;br /&gt;  value=859&lt;br /&gt; Bind#1&lt;br /&gt;  oacdty=01 mxl=32(30) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=10 fl2=0001 frm=01 csi=171 siz=32 off=0&lt;br /&gt;  kxsbbbfp=ffffffff7fff8688  bln=32  avl=30  flg=09&lt;br /&gt;  value="SYS_DZAYDZXFEF1OQRKZUBTDF4UHRF"&lt;br /&gt; Bind#2&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=1000001 frm=00 csi=00 siz=144 off=0&lt;br /&gt;  kxsbbbfp=ffffffff77e770a8  bln=22  avl=02  flg=05&lt;br /&gt;  value=3&lt;br /&gt; Bind#3&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=1000001 frm=00 csi=00 siz=0 off=24&lt;br /&gt;  kxsbbbfp=ffffffff77e770c0  bln=22  avl=02  flg=01&lt;br /&gt;  value=2&lt;br /&gt; Bind#4&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=1000001 frm=00 csi=00 siz=0 off=48&lt;br /&gt;  kxsbbbfp=ffffffff77e770d8  bln=22  avl=01  flg=01&lt;br /&gt;  value=0&lt;br /&gt; Bind#5&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=1000001 frm=00 csi=00 siz=0 off=72&lt;br /&gt;  kxsbbbfp=ffffffff77e770f0  bln=22  avl=02  flg=01&lt;br /&gt;  value=1&lt;br /&gt; Bind#6&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=1000001 frm=00 csi=00 siz=0 off=96&lt;br /&gt;  kxsbbbfp=ffffffff77e77108  bln=22  avl=01  flg=01&lt;br /&gt;  value=0&lt;br /&gt; Bind#7&lt;br /&gt;  oacdty=02 mxl=22(22) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=00 fl2=1000001 frm=00 csi=00 siz=0 off=120&lt;br /&gt;  kxsbbbfp=ffffffff77e77120  bln=22  avl=04  flg=01&lt;br /&gt;  value=512690&lt;br /&gt; Bind#8&lt;br /&gt;  oacdty=01 mxl=32(02) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=10 fl2=0001 frm=01 csi=171 siz=32 off=0&lt;br /&gt;  kxsbbbfp=ffffffff7fff86c4  bln=32  avl=02  flg=09&lt;br /&gt;  value="TC"&lt;br /&gt;&lt;/pre&gt;Using Tom Kyte print_table procedure I retrieve this row in more readable format: &lt;pre class="brush:sql;highlight:[2,3,19,21];"&gt;&lt;br /&gt;SQL&gt; exec print_table(q'#select * from sys.user$ where name='SYS_DZAYDZXFEF1OQRKZUBTDF4UHRF'#')&lt;br /&gt;USER#                         : 859&lt;br /&gt;NAME                          : SYS_DZAYDZXFEF1OQRKZUBTDF4UHRF&lt;br /&gt;TYPE#                         : 2&lt;br /&gt;PASSWORD                      :&lt;br /&gt;DATATS#                       : 3&lt;br /&gt;TEMPTS#                       : 2&lt;br /&gt;CTIME                         : 22.07.2015 15:44:08&lt;br /&gt;PTIME                         :&lt;br /&gt;EXPTIME                       :&lt;br /&gt;LTIME                         :&lt;br /&gt;RESOURCE$                     : 1&lt;br /&gt;AUDIT$                        :&lt;br /&gt;DEFROLE                       : 0&lt;br /&gt;DEFGRP#                       :&lt;br /&gt;DEFGRP_SEQ#                   :&lt;br /&gt;ASTATUS                       : 0&lt;br /&gt;LCOUNT                        : 0&lt;br /&gt;DEFSCHCLASS                   :&lt;br /&gt;EXT_USERNAME                  : TC&lt;br /&gt;SPARE1                        : 16&lt;br /&gt;SPARE2                        : 512690&lt;br /&gt;SPARE3                        :&lt;br /&gt;SPARE4                        :&lt;br /&gt;SPARE5                        :&lt;br /&gt;SPARE6                        :&lt;br /&gt;SPARE7                        :&lt;br /&gt;SPARE8                        :&lt;br /&gt;SPARE9                        :&lt;br /&gt;SPARE10                       :&lt;br /&gt;SPARE11                       :&lt;br /&gt;-----------------&lt;br /&gt;&lt;/pre&gt;We can see that USER$ was populated with new row with obscure "NAME" SYS_%. New row has "TYPE#"=2. &lt;br/&gt;According to a definition of SYS.USER$ table from @?/rdbms/admin/dcore.bsq this's "adjunct" schema: &lt;pre class="brush:sql"&gt;&lt;br /&gt;create table user$                                             /* user table */&lt;br /&gt;( user#         number not null,                   /* user identifier number */&lt;br /&gt;  name          varchar2("M_IDEN") not null,                 /* name of user */&lt;br /&gt;               /* 0 = role, 1 = user, 2 = adjunct schema, 3 = schema synonym */&lt;br /&gt;&lt;/pre&gt;Row has EXT_USERNAME same as original schema: &lt;pre class="brush:sql"&gt;&lt;br /&gt;EXT_USERNAME                  : TC&lt;br /&gt;&lt;/pre&gt;SPARE2 - references to edition object: &lt;pre class="brush:sql;highlight:[1,7]"&gt;&lt;br /&gt;SPARE2                        : 512690&lt;br /&gt;&lt;br /&gt;SQL&gt; exec print_table('select * from dba_objects where object_id=512690')&lt;br /&gt;OWNER                         : SYS&lt;br /&gt;OBJECT_NAME                   : E1&lt;br /&gt;SUBOBJECT_NAME                :&lt;br /&gt;OBJECT_ID                     : 512690&lt;br /&gt;DATA_OBJECT_ID                :&lt;br /&gt;OBJECT_TYPE                   : EDITION&lt;br /&gt;CREATED                       : 22.07.2015 15:44:08&lt;br /&gt;LAST_DDL_TIME                 : 22.07.2015 15:44:08&lt;br /&gt;TIMESTAMP                     : 2015-07-22:15:44:08&lt;br /&gt;STATUS                        : VALID&lt;br /&gt;TEMPORARY                     : N&lt;br /&gt;GENERATED                     : N&lt;br /&gt;SECONDARY                     : N&lt;br /&gt;NAMESPACE                     : 64&lt;br /&gt;EDITION_NAME                  :&lt;br /&gt;SHARING                       : NONE&lt;br /&gt;EDITIONABLE                   :&lt;br /&gt;ORACLE_MAINTAINED             : N&lt;br /&gt;-----------------&lt;br /&gt;&lt;/pre&gt;Second adjunct schema points to E2 edition (some rows skipped for readability): &lt;pre class="brush:sql;highlight:[2,5,7]"&gt;&lt;br /&gt;SQL&gt; exec print_table(q'#select * from sys.user$ where name='SYS_D$8SPB$NEB3PDFCNYRJHBAV7MK'#')&lt;br /&gt;USER#                         : 861&lt;br /&gt;NAME                          : SYS_D$8SPB$NEB3PDFCNYRJHBAV7MK&lt;br /&gt;TYPE#                         : 2&lt;br /&gt;...&lt;br /&gt;EXT_USERNAME                  : TC&lt;br /&gt;SPARE1                        : 16&lt;br /&gt;SPARE2                        : 512691&lt;br /&gt;...&lt;br /&gt;&lt;br /&gt;SQL&gt; exec print_table('select * from dba_objects where object_id=512691')&lt;br /&gt;OWNER                         : SYS&lt;br /&gt;OBJECT_NAME                   : E2&lt;br /&gt;SUBOBJECT_NAME                :&lt;br /&gt;OBJECT_ID                     : 512691&lt;br /&gt;DATA_OBJECT_ID                :&lt;br /&gt;OBJECT_TYPE                   : EDITION&lt;br /&gt;CREATED                       : 22.07.2015 15:44:08&lt;br /&gt;LAST_DDL_TIME                 : 22.07.2015 15:44:08&lt;br /&gt;TIMESTAMP                     : 2015-07-22:15:44:08&lt;br /&gt;STATUS                        : VALID&lt;br /&gt;TEMPORARY                     : N&lt;br /&gt;GENERATED                     : N&lt;br /&gt;SECONDARY                     : N&lt;br /&gt;NAMESPACE                     : 64&lt;br /&gt;EDITION_NAME                  :&lt;br /&gt;SHARING                       : NONE&lt;br /&gt;EDITIONABLE                   :&lt;br /&gt;ORACLE_MAINTAINED             : N&lt;br /&gt;-----------------&lt;br /&gt;&lt;/pre&gt;Below is the listing of adjunct schemas in one of production database with one edition (we purge old editions periodically). &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select name from sys.user$ where type#=2;&lt;br /&gt;&lt;br /&gt;NAME&lt;br /&gt;------------------------------&lt;br /&gt;SYS_CTO$G3UFDV01YXT$0I2IIAM1FW&lt;br /&gt;SYS_#65J#JRLAO7834YSNCQ09MJB0#&lt;br /&gt;SYS_CFV3AQP2WPEDH4WG#BC_OY_529&lt;br /&gt;SYS_MAEDFDRVL4UF6O0_K#2IKFG332&lt;br /&gt;SYS_ZTM78VJZ1NRBT0OZ7CX3QQYWO#&lt;br /&gt;SYS_PBOZ#4GB#AZAEGM2DQ62ODWO1Q&lt;br /&gt;SYS_4OYT_40J6MSQ9HK4L$R5K8ZD8G&lt;br /&gt;SYS_7DT8CD#ARM8HF8LE5K6T7#G91K&lt;br /&gt;SYS_DAL9_OKM$3EL#MH_IA4IYDJ6V8&lt;br /&gt;SYS_7W7SDDSF#H6QO#D8F_CFH6HL5A&lt;br /&gt;SYS_WW9CZFBWQZH45YCIQW9Z8QXDPG&lt;br /&gt;SYS_R0CCNSCA$$67F4F3JASWEJXZMS&lt;br /&gt;SYS___IC1EVBW5MA9VL6BUY958MFEQ&lt;br /&gt;SYS_JY31UD09PBTXAUV#YLDG8ND1X$&lt;br /&gt;SYS_CMD9YMUP#4W3IRHEA99$OA_2$H&lt;br /&gt;SYS_375#5FX937$H68GJ_ZSX5ROSP3&lt;br /&gt;SYS_U5$O#5LBHUX78D5M6C421CM_F#&lt;br /&gt;SYS_FFQSGVBBM97GZCOVA7ZZCXOE6N&lt;br /&gt;SYS_DX#I9P0FLCROTW5_FUQ0TG4L$M&lt;br /&gt;SYS_7CFP28DK1RX$CV#ES#WEKAJ1WR&lt;br /&gt;&lt;/pre&gt;Sometimes we have 5-6 editions in place. That results in 100-120 additional schemas used by EBR! &lt;br/&gt;Now you know, if you will find a row in user$ with type#=2 and with a obscure name like 'SYS_%' - it's a normal. &lt;br/&gt;At least if you are using Editions.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/8657143205883210152/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2015/07/edition-based-redefinition-adjunct_22.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8657143205883210152'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/8657143205883210152'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2015/07/edition-based-redefinition-adjunct_22.html' title='Edition-Based redefinition: adjunct schemas'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-7862913281987837688</id><published>2015-06-18T12:42:00.000+06:00</published><updated>2016-05-14T12:33:05.597+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='11g'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='11.2.0.4'/><title type='text'>Function-Based index changed its definition after a rebuild</title><content type='html'>One of our developers have discovered a problem when index column data type changed after index had been rebuild. &lt;br/&gt;They asked me for help with that issue. Here's a demo script: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; create table t(&lt;br /&gt;  2    x int,&lt;br /&gt;  3    y int);&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;&lt;br /&gt;SQL&gt; create index t_i on t(&lt;br /&gt;  2    decode(x, 1, to_number(null), y));&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;&lt;br /&gt;SQL&gt; exec dbms_stats.gather_table_stats( '', 't')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;I create a function-based index with one column.&lt;br/&gt;The index column is defined to show "Y" column (with type int) if the "X" column isn't equal to 1 (or null). &lt;br/&gt;According to a documentation: &lt;br/&gt;http://docs.oracle.com/database/121/SQLRF/functions056.htm#SQLRF00631 &lt;pre&gt;&lt;br /&gt;Oracle automatically converts the return value to the same data type as the first result.&lt;br /&gt;If the first result has the data type CHAR or if the first result is null, &lt;br /&gt;then Oracle converts the return value to the data type VARCHAR2.&lt;br /&gt;&lt;/pre&gt;Notice that index column data type is a NUMBER: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select column_name&lt;br /&gt;  2    from user_ind_columns&lt;br /&gt;  3   where index_name = 'T_I';&lt;br /&gt;&lt;br /&gt;COLUMN_NAME&lt;br /&gt;------------------------------&lt;br /&gt;SYS_NC00003$&lt;br /&gt;&lt;br /&gt;SQL&gt; select data_type&lt;br /&gt;  2    from user_tab_cols&lt;br /&gt;  3   where table_name = 'T'&lt;br /&gt;  4     and column_name = 'SYS_NC00003$';&lt;br /&gt;&lt;br /&gt;DATA_TYPE&lt;br /&gt;------------------------------&lt;br /&gt;NUMBER&lt;br /&gt;&lt;/pre&gt;The developer have found that his query doesn't use the index: &lt;pre class="brush:sql;highlight: [19,25]"&gt;&lt;br /&gt;SQL&gt; explain plan for&lt;br /&gt;  2  select *&lt;br /&gt;  3    from t&lt;br /&gt;  4   where decode(x, 1, to_number(null), y) = to_number(:1);&lt;br /&gt;&lt;br /&gt;Explained.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; @?/rdbms/admin/utlxpls&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 2153619298&lt;br /&gt;&lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation         | Name | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT  |      |     1 |    26 |     2   (0)| 00:00:01 |&lt;br /&gt;|*  1 |  TABLE ACCESS FULL| T    |     1 |    26 |     2   (0)| 00:00:01 |&lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   1 - filter(DECODE("X",1,TO_NUMBER(NULL),"Y")=TO_NUMBER(:1))&lt;br /&gt;&lt;/pre&gt;Index will be used when he changed his query to following: &lt;pre class="brush:sql;highlight: [4,20,26]"&gt;&lt;br /&gt;SQL&gt; explain plan for&lt;br /&gt;  2  select *&lt;br /&gt;  3    from t&lt;br /&gt;  4   where decode(x, 1, null, y) = to_number(:1);&lt;br /&gt;&lt;br /&gt;Explained.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; @?/rdbms/admin/utlxpls&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;--------------------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 2858887366&lt;br /&gt;&lt;br /&gt;--------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                           | Name | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;--------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT                    |      |     1 |    39 |     1   (0)| 00:00:01 |&lt;br /&gt;|   1 |  TABLE ACCESS BY INDEX ROWID BATCHED| T    |     1 |    39 |     1   (0)| 00:00:01 |&lt;br /&gt;|*  2 |   INDEX RANGE SCAN                  | T_I  |     1 |       |     1   (0)| 00:00:01 |&lt;br /&gt;--------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   2 - access(DECODE("X",1,NULL,TO_CHAR("Y"))=TO_NUMBER(:1))&lt;br /&gt;&lt;/pre&gt;Why is this?&lt;br/&gt;The index expression is not what I passed in the CREATE INDEX statement: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select column_expression&lt;br /&gt;  2    from user_ind_expressions&lt;br /&gt;  3   where index_name = 'T_I';&lt;br /&gt;&lt;br /&gt;COLUMN_EXPRESSION&lt;br /&gt;------------------------------&lt;br /&gt;DECODE("X",1,NULL,"Y")&lt;br /&gt;&lt;/pre&gt;It looks like Oracle is "clever enough" to change our index expression from: &lt;pre class="brush:sql"&gt;&lt;br /&gt;DECODE(X, 1, TO_NUMBER(NULL), Y)&lt;br /&gt;&lt;/pre&gt;to: &lt;pre class="brush:sql"&gt;&lt;br /&gt;DECODE("X", 1, NULL, "Y")&lt;br /&gt;&lt;/pre&gt;This leads to unexpected results when index was rebuild: &lt;pre class="brush:sql"&gt;&lt;br /&gt;alter index t_i rebuild;&lt;br /&gt;&lt;/pre&gt;The index column data type is VARCHAR2 after that! &lt;pre class="brush:sql;highlight: [8]"&gt;&lt;br /&gt;SQL&gt; select data_type&lt;br /&gt;  2    from user_tab_cols&lt;br /&gt;  3   where table_name = 'T'&lt;br /&gt;  4     and column_name = 'SYS_NC00003$';&lt;br /&gt;&lt;br /&gt;DATA_TYPE&lt;br /&gt;------------------------------&lt;br /&gt;VARCHAR2&lt;br /&gt;&lt;/pre&gt;Our query now suddenly has started using FTS where previously it was using an index: &lt;pre class="brush:sql;highlight:[19,25]"&gt;&lt;br /&gt;SQL&gt; explain plan for&lt;br /&gt;  2  select *&lt;br /&gt;  3    from t&lt;br /&gt;  4   where decode(x, 1, null, y) = to_number(:1);&lt;br /&gt;&lt;br /&gt;Explained.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; @?/rdbms/admin/utlxpls&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;---------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 2153619298&lt;br /&gt;&lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation         | Name | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT  |      |     1 |    48 |     2   (0)| 00:00:01 |&lt;br /&gt;|*  1 |  TABLE ACCESS FULL| T    |     1 |    48 |     2   (0)| 00:00:01 |&lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   1 - filter(TO_NUMBER(DECODE("X",1,NULL,TO_CHAR("Y")))=TO_NUMBER(:1))&lt;br /&gt;&lt;br /&gt;&lt;/pre&gt;Index hint did not help either: &lt;pre class="brush:sql;highlight: [2,19,25]"&gt;&lt;br /&gt;SQL&gt; explain plan for&lt;br /&gt;  2  select /*+ index(t t_i)*/*&lt;br /&gt;  3    from t&lt;br /&gt;  4   where decode(x, 1, null, y) = to_number(:1);&lt;br /&gt;&lt;br /&gt;Explained.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; @?/rdbms/admin/utlxpls&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 2153619298&lt;br /&gt;&lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation         | Name | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT  |      |     1 |    48 |     2   (0)| 00:00:01 |&lt;br /&gt;|*  1 |  TABLE ACCESS FULL| T    |     1 |    48 |     2   (0)| 00:00:01 |&lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   1 - filter(TO_NUMBER(DECODE("X",1,NULL,TO_CHAR("Y")))=TO_NUMBER(:1))&lt;br /&gt;&lt;/pre&gt;Notice TO_NUMBER conversion at line 1: &lt;pre class="brush:sql"&gt;&lt;br /&gt;   1 - filter(TO_NUMBER(DECODE("X",1,NULL,TO_CHAR("Y")))=TO_NUMBER(:1))&lt;br /&gt;&lt;/pre&gt;We should rewrite our query as follows: &lt;pre class="brush:sql;highlight:[4,20,26]"&gt;&lt;br /&gt;SQL&gt; explain plan for&lt;br /&gt;  2  select *&lt;br /&gt;  3    from t&lt;br /&gt;  4   where decode(x, 1, null, y) = to_char(:1);&lt;br /&gt;&lt;br /&gt;Explained.&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; @?/rdbms/admin/utlxpls&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;--------------------------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 2858887366&lt;br /&gt;&lt;br /&gt;--------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                           | Name | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;--------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT                    |      |     1 |    48 |     1   (0)| 00:00:01 |&lt;br /&gt;|   1 |  TABLE ACCESS BY INDEX ROWID BATCHED| T    |     1 |    48 |     1   (0)| 00:00:01 |&lt;br /&gt;|*  2 |   INDEX RANGE SCAN                  | T_I  |     1 |       |     1   (0)| 00:00:01 |&lt;br /&gt;--------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   2 - access(DECODE("X",1,NULL,TO_CHAR("Y"))=:1)&lt;br /&gt;&lt;/pre&gt;To workaround this issue, we could use an index on virtual columns.&lt;br/&gt;We could prevent TO_NUMBER(NULL) to NULL conversion by changing TO_NUMBER(NULL) to CAST(NULL as NUMBER), or other such expression.&lt;br/&gt; I have opened the SR with Oracle and they told me that this's due to:&lt;br/&gt;&lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=BUG&amp;&amp;productFamily=Oracle&amp;id=17871767"&gt;Bug 17871767: FUNCTION BASE INDEX DEFINITION CHANGED ON 11.2, ADDED A TO_CHAR FUNCTION&lt;/a&gt; This bug is still under work and hasn't been resolved yet.&lt;br/&gt;Actually, this issue with function-based indexes has been present for a long time.&lt;br/&gt;I have reproduced it on 9.2.0.6 at least.   </content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/7862913281987837688/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2015/06/function-based-index-changed-its.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7862913281987837688'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/7862913281987837688'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2015/06/function-based-index-changed-its.html' title='Function-Based index changed its definition after a rebuild'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-627008739693639754</id><published>2015-05-21T10:01:00.002+06:00</published><updated>2016-05-14T12:32:03.325+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='11g'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='11.2.0.4'/><title type='text'>session cursor cache count statistics incorrect with parallel queries</title><content type='html'>Recently I investigated a issue with high 'session cursor cache count' statistics in one of database version 11.2.0.4. I found that some of the sessions have extremely high values of this statistics: &lt;pre class="brush:sql;highlight: [12,13,14];"&gt;&lt;br /&gt;SQL&gt; select s.sid, ss.value, s.logon_time, s.service_name, s.program&lt;br /&gt;  2    from v$session s,&lt;br /&gt;  3         v$statname sn,&lt;br /&gt;  4         v$sesstat ss&lt;br /&gt;  5   where sn.name='session cursor cache count'&lt;br /&gt;  6     and ss.statistic#=sn.statistic#&lt;br /&gt;  7     and ss.value &gt; 100&lt;br /&gt;  8     and s.sid=ss.sid;&lt;br /&gt;&lt;br /&gt;       SID      VALUE LOGON_TIME          SERVICE_NAME PROGRAM&lt;br /&gt;---------- ---------- ------------------- ------------ ----------------&lt;br /&gt;       485        255 19.05.2015 02:47:52 dp_task      JDBC Thin Client&lt;br /&gt;       705      12774 19.05.2015 02:47:51 dp_task      JDBC Thin Client&lt;br /&gt;       800        267 19.05.2015 02:47:51 dp_task      JDBC Thin Client&lt;br /&gt;&lt;/pre&gt;session_cached_cursors parameter has default value of 50. My first thought was that sessions changed session_cached_cursors parameter. To confirm my hypothesis, I executed below oradebug command: &lt;pre class="brush:sql"&gt;&lt;br /&gt;oradebug dump modified_parameters 1&lt;br /&gt;&lt;/pre&gt;Looking into trace file: &lt;pre class="brush:sql"&gt;&lt;br /&gt;Received ORADEBUG command (#1) 'dump modified_parameters 1' from process 'Unix process pid: 13761, image: &lt;none&gt;'&lt;br /&gt;DYNAMICALLY MODIFIED PARAMETERS:&lt;br /&gt;  nls_language             = AMERICAN&lt;br /&gt;  nls_territory            = AMERICA&lt;br /&gt;  log_archive_dest_state_3 = ENABLE&lt;br /&gt;  service_names            = drep_dp_stat, drep_dp_task, drep_ora_at, drep_dp_core&lt;br /&gt;&lt;br /&gt;*** 2015-05-14 10:44:20.744&lt;br /&gt;Finished processing ORADEBUG command (#1) 'dump modified_parameters 1'&lt;br /&gt;&lt;/pre&gt;So session_cached_cursors parameter wasn't changed by session. At the next step I decided to dump all cursors cached by session: &lt;pre class="brush:sql"&gt;&lt;br /&gt;oradebug dump cursordump 1&lt;br /&gt;&lt;/pre&gt;Here is a relevant portion of trace file: &lt;pre class="brush:sql;highlight: [6];"&gt;&lt;br /&gt;----- Session Cached Cursor Dump -----&lt;br /&gt;----- Generic Session Cached Cursor Dump -----&lt;br /&gt;-----------------------------------------------------------&lt;br /&gt;-------------- Generic Session Cached Cursors Dump --------&lt;br /&gt;-----------------------------------------------------------&lt;br /&gt;hash table=ffffffff79d34228 cnt=50 LRU=ffffffff79d245f0 cnt=49 hit=64510 max=50 NumberOfTypes=6&lt;br /&gt;&lt;/pre&gt;From the above, there was no doubt that 'session cursor cache count' statistic is lying. I opened SR with Oracle and support engineer pointed to a &lt;a href="https://support.oracle.com/epmos/faces/BugDisplay?id=5713223"&gt;Bug 5713223 : 'SESSION CURSOR CACHE COUNT' OF V$SYSSTAT IS NOT CURRENT VALUE&lt;/a&gt;&lt;br/&gt;This bug was opened in 2006 for 10.2 version and still not resolved yet.&lt;br/&gt;I have couple of SR with Oracle in which I waiting for resolution of such long-lived bugs. So, I decided to further diagnose this issue and provide additional information to the Oracle Support.  All of the sessions are using dp_task database service.  I created this service for reporting application that executes bunch of heavy SQL.&lt;br/&gt;I wrote a simple job that takes a snapshots of v$session, v$sesstat on periodic interval. On a next day I check generated data and find couple of suspicious SQL for further investigation.&lt;br/&gt;Most of them are used some of combination: PARALLEL hint, pipelined table functions, MATERIALIZE hint. Deeping into this further, I found that a incorrect statistics are due to PARALLEL hint.&lt;br/&gt;I created a simple test case that was used to reproduce this issue.  &lt;div&gt;  &lt;input value="Show" onclick="if(this.parentNode.getElementsByTagName('div')[0].style.display != ''){this.parentNode.getElementsByTagName('div')[0].style.display = '';this.value = 'Hide Content';}else{this.parentNode.getElementsByTagName('div')[0].style.display = 'none'; this.value = 'Show Content';}" type="button" /&gt;  &lt;div style="display: none;"&gt;    &lt;pre class="brush:sql"&gt;&lt;br /&gt;create table t as select * from dba_objects;&lt;br /&gt;&lt;br /&gt;sho parameter session_cached_cursors&lt;br /&gt;&lt;br /&gt;select s.value &lt;br /&gt;  from v$statname n, &lt;br /&gt;       v$mystat s &lt;br /&gt; where n.name = 'session cursor cache count' &lt;br /&gt;   and s.statistic#=n.statistic#;&lt;br /&gt;&lt;br /&gt;select /*+ parallel(4)*/count(distinct owner) from t;&lt;br /&gt;&lt;br /&gt;select s.value &lt;br /&gt;  from v$statname n, &lt;br /&gt;       v$mystat s &lt;br /&gt; where n.name = 'session cursor cache count' &lt;br /&gt;   and s.statistic#=n.statistic#;&lt;br /&gt;&lt;br /&gt;select /*+ parallel(4)*/count(distinct owner) from t;&lt;br /&gt;    &lt;/pre&gt;  &lt;/div&gt;&lt;/div&gt;Below is a SQL*Plus output of the script execution. &lt;pre class="brush:sql;highlight: [5,15,33];"&gt;&lt;br /&gt;SQL&gt; sho parameter session_cached_cursors&lt;br /&gt;&lt;br /&gt;NAME                                 TYPE                              VALUE&lt;br /&gt;------------------------------------ --------------------------------- ------------------------------&lt;br /&gt;session_cached_cursors               integer                           50&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select s.value&lt;br /&gt;  2    from v$statname n,&lt;br /&gt;  3         v$mystat s&lt;br /&gt;  4   where n.name = 'session cursor cache count'&lt;br /&gt;  5     and s.statistic#=n.statistic#;&lt;br /&gt;&lt;br /&gt;     VALUE&lt;br /&gt;----------&lt;br /&gt;        49&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select /*+ parallel(4)*/count(distinct owner) from t;&lt;br /&gt;&lt;br /&gt;COUNT(DISTINCTOWNER)&lt;br /&gt;--------------------&lt;br /&gt;                  59&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select s.value&lt;br /&gt;  2    from v$statname n,&lt;br /&gt;  3         v$mystat s&lt;br /&gt;  4   where n.name = 'session cursor cache count'&lt;br /&gt;  5     and s.statistic#=n.statistic#;&lt;br /&gt;&lt;br /&gt;     VALUE&lt;br /&gt;----------&lt;br /&gt;        58&lt;br /&gt;&lt;/pre&gt;Notice that 'session cursor cache count' statistic is 49 before parallel query and 58 after. After I executed parallel query multiple times and checked a statistics at each step, I found that each query execution leads to increase of 'session cursor cache count' statistics by 2*(parallel_degree). &lt;pre class="brush:sql;highlight: [1,15,17,32];"&gt;&lt;br /&gt;SQL&gt; select /*+ parallel(4)*/count(distinct owner) from t;&lt;br /&gt;&lt;br /&gt;COUNT(DISTINCTOWNER)&lt;br /&gt;--------------------&lt;br /&gt;                  59&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select s.value&lt;br /&gt;  2    from v$statname n,&lt;br /&gt;  3         v$mystat s&lt;br /&gt;  4   where n.name = 'session cursor cache count'&lt;br /&gt;  5     and s.statistic#=n.statistic#;&lt;br /&gt;&lt;br /&gt;     VALUE&lt;br /&gt;----------&lt;br /&gt;        98&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select /*+ parallel(8)*/count(distinct owner) from t;&lt;br /&gt;&lt;br /&gt;COUNT(DISTINCTOWNER)&lt;br /&gt;--------------------&lt;br /&gt;                  59&lt;br /&gt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select s.value&lt;br /&gt;  2    from v$statname n,&lt;br /&gt;  3         v$mystat s&lt;br /&gt;  4   where n.name = 'session cursor cache count'&lt;br /&gt;  5     and s.statistic#=n.statistic#;&lt;br /&gt;&lt;br /&gt;     VALUE&lt;br /&gt;----------&lt;br /&gt;       114&lt;br /&gt;SQL&gt; &lt;br /&gt;&lt;/pre&gt; Good news: issue is not reproduced in 12.1.0.2. I hope that Oracle support resolve this issue in 11.2.0.4. &lt;br/&gt;&lt;br/&gt;&lt;b&gt;Update 17.06.2015&lt;/b&gt;: Oracle has released the patch 21135007: SESSION CURSOR CACHE COUNT STATISTICS IS INCORRECT&lt;br/&gt;I applied it to 11.2.0.4 environment and it works as expected. &lt;br/&gt;Now the 'session cursor cache count' statistics is correct.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/627008739693639754/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2015/05/session-cursor-cache-count-statistics.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/627008739693639754'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/627008739693639754'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2015/05/session-cursor-cache-count-statistics.html' title='session cursor cache count statistics incorrect with parallel queries'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-3944314048342780329</id><published>2015-02-11T16:26:00.000+06:00</published><updated>2015-02-11T16:26:44.805+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='CBO'/><title type='text'>Join elimination not performed in the presence of virtual columns on parent table</title><content type='html'>Today I observed poorly written SQL that performed unnecessary join between PARENT/CHILD tables: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select * from table(dbms_xplan.display_cursor( '23hbmd0xxv7p0'));&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;----------------------------------------------------------------------------------------------------&lt;br /&gt;SQL_ID  23hbmd0xxv7p0, child number 0&lt;br /&gt;-------------------------------------&lt;br /&gt;SELECT P.ID FROM PARENT P, CHILD C WHERE P.ID = :B1 AND P.ID = C.PARENT_ID&lt;br /&gt;&lt;br /&gt;Plan hash value: 3267741206&lt;br /&gt;&lt;br /&gt;----------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                    | Name                | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;----------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT             |                     |       |       |     5 (100)|          |&lt;br /&gt;|   1 |  NESTED LOOPS                |                     |     2 |    36 |     5   (0)| 00:00:01 |&lt;br /&gt;|*  2 |   INDEX UNIQUE SCAN          | PARENT_ID_PK        |     1 |     6 |     2   (0)| 00:00:01 |&lt;br /&gt;|   3 |   TABLE ACCESS BY INDEX ROWID| CHILD               |     2 |    24 |     3   (0)| 00:00:01 |&lt;br /&gt;|*  4 |    INDEX RANGE SCAN          | CHILD_PARENT_FK_IDX |     2 |       |     2   (0)| 00:00:01 |&lt;br /&gt;-------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   2 - access("P"."ID"=:B1)&lt;br /&gt;   4 - access("C"."PARENT_ID"=:B1)&lt;br /&gt;&lt;/pre&gt;PARENT table has primary key enabled and validated. &lt;br/&gt;CHILD table with foreign key (enabled and validated) that references PARENT. &lt;br/&gt;Without obvious reason JOIN ELIMINATION is not done when expected. &lt;br/&gt;We are using Oracle database version 11.2.0.3.11 (PSU 11 applied). &lt;br/&gt;I investigated this issue further and found that this's due to presence of virtual columns on PARENT table. &lt;br/&gt;Below is a simple test case used to reproduce this issue (I copied this test case with little modification from &lt;a href="http://antognini.ch/2010/01/join-elimination/"&gt;Excellent Christian Antognini site&lt;/a&gt;): &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; CREATE TABLE t1 (&lt;br /&gt;  2    id NUMBER NOT NULL,&lt;br /&gt;  3    n NUMBER,&lt;br /&gt;  4    pad VARCHAR2(4000),&lt;br /&gt;  5    pad_virt varchar2(4000) generated always as (substr(pad,1,10)) virtual,&lt;br /&gt;  6    CONSTRAINT t1_pk PRIMARY KEY(id)&lt;br /&gt;  7  );&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; CREATE TABLE t2 (&lt;br /&gt;  2    id NUMBER NOT NULL,&lt;br /&gt;  3    t1_id NUMBER NOT NULL,&lt;br /&gt;  4    n NUMBER,&lt;br /&gt;  5    pad VARCHAR2(4000),&lt;br /&gt;  6    CONSTRAINT t2_pk PRIMARY KEY(id),&lt;br /&gt;  7    CONSTRAINT t2_t1_fk FOREIGN KEY (t1_id) REFERENCES t1&lt;br /&gt;  8  );&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; CREATE OR REPLACE VIEW v AS&lt;br /&gt;  2  SELECT t1.id AS t1_id, t1.n AS t1_n, t2.id AS t2_id, t2.n AS t2_n&lt;br /&gt;  3    FROM t1, t2&lt;br /&gt;  4   WHERE t1.id = t2.t1_id;&lt;br /&gt;&lt;/pre&gt;Lets select a rows only from child table: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; EXPLAIN PLAN FOR SELECT t2_id, t2_n FROM v;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select * from table(dbms_xplan.display);&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;-----------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 733458710&lt;br /&gt;&lt;br /&gt;----------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation          | Name  | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;----------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT   |       |     1 |    52 |     2   (0)| 00:00:01 |&lt;br /&gt;|   1 |  NESTED LOOPS      |       |     1 |    52 |     2   (0)| 00:00:01 |&lt;br /&gt;|   2 |   TABLE ACCESS FULL| T2    |     1 |    39 |     2   (0)| 00:00:01 |&lt;br /&gt;|*  3 |   INDEX UNIQUE SCAN| T1_PK |     1 |    13 |     0   (0)| 00:00:01 |&lt;br /&gt;----------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;&lt;br /&gt;   3 - access("T1"."ID"="T2"."T1_ID")&lt;br /&gt;&lt;/pre&gt;Join is not eliminated. Join is eliminated when I dropped virtual column: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; ALTER TABLE t1 DROP COLUMN pad_virt;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; EXPLAIN PLAN FOR SELECT t2_id, t2_n FROM v;&lt;br /&gt;SQL&gt; &lt;br /&gt;SQL&gt; select * from table(dbms_xplan.display);&lt;br /&gt;&lt;br /&gt;PLAN_TABLE_OUTPUT&lt;br /&gt;---------------------------------------------------------------------------&lt;br /&gt;Plan hash value: 2904382265&lt;br /&gt;&lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation         | Name | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT  |      |     1 |    39 |     2   (0)| 00:00:01 |&lt;br /&gt;|   1 |  TABLE ACCESS FULL| T2   |     1 |    39 |     2   (0)| 00:00:01 |&lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;&lt;/pre&gt;Could not find any obvious reason for this in 10053 trace file. But it looks like a problem is known since 2011: &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=12739252.8"&gt;Bug 12739252 : JOIN ELIMINATION IS NOT DONE WHEN JOINING TABLE HAVE VIRTUAL COLUMN&lt;/a&gt;&lt;br/&gt;Good news: problem is not reproduced in 11.2.0.4.4.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/3944314048342780329/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2015/02/join-elimination-not-performed-in.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3944314048342780329'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3944314048342780329'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2015/02/join-elimination-not-performed-in.html' title='Join elimination not performed in the presence of virtual columns on parent table'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-6229690145580037271</id><published>2015-02-09T12:47:00.001+06:00</published><updated>2016-05-14T12:32:18.201+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='11g'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-10704'/><category scheme='http://www.blogger.com/atom/ns#' term='11.2.0.3'/><category scheme='http://www.blogger.com/atom/ns#' term='dtrace'/><title type='text'>Suspending a users session on specific enqueue</title><content type='html'>Recently I faced a strange issue with EBR (Edition-Based Redefinition). In order to understand how things work internally I decided to use DTrace. &lt;br/&gt;I wanted to suspend specific user session when session acquired AE lock. There are similar enq_trace.sh script that written by &lt;a href="http://blog.tanelpoder.com"&gt;Tanel Poder&lt;/a&gt;. Tanel's script could be extended to accommodate to my specific requirements if needed. &lt;br/&gt;My &lt;a name="enq_suspend"&gt;enq_suspend.d&lt;/a&gt; script is below:  &lt;pre class="brush:cpp"&gt;&lt;br /&gt;#!/usr/sbin/dtrace -s&lt;br /&gt;&lt;br /&gt;# pragma D option quiet&lt;br /&gt;# pragma D option destructive&lt;br /&gt;&lt;br /&gt;struct ksqrs_t {&lt;br /&gt;  long     addr;&lt;br /&gt;  char     b1[72];&lt;br /&gt;  uint32_t id1;&lt;br /&gt;  uint32_t id2;&lt;br /&gt;  char     b2[4];&lt;br /&gt;  char     idt[2];/*92=offset of X$KSQRS.KSQRSIDT column from x$kqfco*/&lt;br /&gt;  char     b3[18];&lt;br /&gt;};&lt;br /&gt;&lt;br /&gt;struct ksqrs_t ksqrs;&lt;br /&gt;&lt;br /&gt;pid$target:oracle:ksqgtl*:entry &lt;br /&gt;{ &lt;br /&gt;  ksqeq_lkadr = arg0; /* X$KSQEQ.KSQLKADR*/&lt;br /&gt;  mode = arg1;&lt;br /&gt;  timeout = arg3;&lt;br /&gt;  lock_indx = arg4; /*X$KSIRESTYP.INDX*/&lt;br /&gt;  flags = arg7;&lt;br /&gt;} &lt;br /&gt;&lt;br /&gt;pid$target:oracle:ksqgtl*:return &lt;br /&gt;{&lt;br /&gt;  ksqeq_lkres = *(long *)copyin(ksqeq_lkadr+8,8);&lt;br /&gt;  ksqrs = *(struct ksqrs_t *)copyin(ksqeq_lkres,112);&lt;br /&gt;  ksqrs.addr = ksqeq_lkres;&lt;br /&gt;  printf("%d [%Y] %s: *** %s-%08x-%08x mode=%d flags=0x%x timeout=%d\n",&lt;br /&gt;    timestamp,&lt;br /&gt;    walltimestamp,&lt;br /&gt;    probefunc,&lt;br /&gt;    ksqrs.idt,&lt;br /&gt;    ksqrs.id1,&lt;br /&gt;    ksqrs.id2,&lt;br /&gt;    mode, &lt;br /&gt;    flags, &lt;br /&gt;    timeout&lt;br /&gt;  );&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;pid$target:oracle:ksqrcl*:entry &lt;br /&gt;{ &lt;br /&gt;  enqrs_addr = *(long *)copyin(arg0+8,8); /*X$KSQRS.ADDR enQueue Resource*/&lt;br /&gt;  ksqrs = *(struct ksqrs_t *)copyin(enqrs_addr, 112);&lt;br /&gt;  ksqrs.addr = enqrs_addr;&lt;br /&gt;  printf("%d [%Y] %s: *** %s-%08x-%08x x$ksqrs.addr=0x%016x\n",&lt;br /&gt;    timestamp,&lt;br /&gt;    walltimestamp,&lt;br /&gt;    probefunc,&lt;br /&gt;    ksqrs.idt,&lt;br /&gt;    ksqrs.id1,&lt;br /&gt;    ksqrs.id2,&lt;br /&gt;    ksqrs.addr&lt;br /&gt;  );&lt;br /&gt;} &lt;br /&gt;&lt;br /&gt;pid$target:oracle:ksqrcl*:entry &lt;br /&gt;/ksqrs.idt==$$1/&lt;br /&gt;{&lt;br /&gt;  printf("%d [%Y] %s.%s: lock_type=%s suspending execution\n", timestamp, walltimestamp, probefunc, probename, ksqrs.idt);&lt;br /&gt;  stop();&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;pid$target:oracle:ksqrcl*:return {}&lt;br /&gt;&lt;/pre&gt;A brief description of the script. &lt;ul&gt;  &lt;li&gt;    &lt;pre class="brush:cpp"&gt;&lt;br /&gt;# pragma D option quiet&lt;br /&gt;# pragma D option destructive&lt;br /&gt;    &lt;/pre&gt;    Minimize output, allow destructive actions. We will use "stop()" call further.   &lt;/li&gt;  &lt;li&gt;struct ksqrs_t     &lt;pre class="brush:cpp"&gt;&lt;br /&gt;struct ksqrs_t {&lt;br /&gt;  long     addr;&lt;br /&gt;  char     b1[72];/*unknown not needed*/&lt;br /&gt;  uint32_t id1;/*lock ID1*/&lt;br /&gt;  uint32_t id2;/*lock ID2*/&lt;br /&gt;  char     b2[4];/*unknown not needed*/&lt;br /&gt;  char     idt[2];/*lock type, 92=offset of X$KSQRS.KSQRSIDT column from x$kqfco*/&lt;br /&gt;  char     b3[18];/*unknown not needed*/&lt;br /&gt;};&lt;br /&gt;    &lt;/pre&gt;The above structure describes X$KSQRS entry (Kernel Services enQueue ReSource): &lt;pre class="brush:sql;highlight: [17,18,19];"&gt;&lt;br /&gt;SQL&gt; select c.kqfconam column_name,&lt;br /&gt;  2         c.kqfcodty datatype,&lt;br /&gt;  3         c.kqfcosiz size_byte,&lt;br /&gt;  4         c.kqfcooff offset&lt;br /&gt;  5    from x$kqfta t,&lt;br /&gt;  6         x$kqfco c&lt;br /&gt;  7   where t.kqftanam = 'X$KSQRS'&lt;br /&gt;  8     and c.kqfcotab = t.indx&lt;br /&gt;  9   order by c.indx&lt;br /&gt; 10  /&lt;br /&gt;&lt;br /&gt;COLUMN_NAME   DATATYPE  SIZE_BYTE     OFFSET&lt;br /&gt;----------- ---------- ---------- ----------&lt;br /&gt;ADDR                23          8          0&lt;br /&gt;INDX                 2          4          0&lt;br /&gt;INST_ID              2          4          0&lt;br /&gt;KSQRSID1             2          4         80&lt;br /&gt;KSQRSID2             2          4         84&lt;br /&gt;KSQRSIDT             1          2         92&lt;br /&gt;KSQRSFLG             2          1        111&lt;br /&gt;&lt;/pre&gt;ID1,ID2,IDT columns maps to relevant GV$LOCK columns, this can be obtained from V$FIXED_VIEW_DEFINITION: &lt;pre class="brush:sql"&gt;&lt;br /&gt;select s.inst_id, &lt;br /&gt;       l.laddr,&lt;br /&gt;       l.kaddr,&lt;br /&gt;       s.ksusenum,&lt;br /&gt;       r.ksqrsidt,&lt;br /&gt;       r.ksqrsid1, &lt;br /&gt;       r.ksqrsid2,&lt;br /&gt;       l.lmode,&lt;br /&gt;       l.request,&lt;br /&gt;       l.ctime,&lt;br /&gt;       decode(l.lmode,0,0,l.block)  &lt;br /&gt;  from v$_lock l, &lt;br /&gt;       x$ksuse s, &lt;br /&gt;       x$ksqrs r  &lt;br /&gt; where l.saddr=s.addr &lt;br /&gt;   and concat(USERENV('Instance'),l.raddr)=concat(r.inst_id,r.addr)&lt;br /&gt;&lt;/pre&gt;  &lt;/li&gt;  &lt;li&gt; ksqgtl.entry - get lock function, entry point &lt;pre class="brush:cpp"&gt;&lt;br /&gt;pid$target:oracle:ksqgtl*:entry &lt;br /&gt;{ &lt;br /&gt;  ksqeq_lkadr = arg0; /* X$KSQEQ.KSQLKADR*/&lt;br /&gt;  mode = arg1;&lt;br /&gt;  timeout = arg3;&lt;br /&gt;  lock_indx = arg4; /*X$KSIRESTYP.INDX*/&lt;br /&gt;  flags = arg7;&lt;br /&gt;} &lt;br /&gt;&lt;/pre&gt;  Interesting ksqgtl function arguments saved for further usage. In particularly, arg0 - is X$KSQEQ.KSQLKADR (lock address?).   &lt;/li&gt;  &lt;li&gt; ksqgtl.return - get lock function, return &lt;pre class="brush:cpp"&gt;&lt;br /&gt;pid$target:oracle:ksqgtl*:return &lt;br /&gt;{&lt;br /&gt;  ksqeq_lkres = *(long *)copyin(ksqeq_lkadr+8,8);&lt;br /&gt;  ksqrs = *(struct ksqrs_t *)copyin(ksqeq_lkres,112);&lt;br /&gt;  ksqrs.addr = ksqeq_lkres;&lt;br /&gt;  printf("%d [%Y] %s: *** %s-%08x-%08x mode=%d flags=0x%x timeout=%d\n",&lt;br /&gt;    timestamp,&lt;br /&gt;    walltimestamp,&lt;br /&gt;    probefunc,&lt;br /&gt;    ksqrs.idt,&lt;br /&gt;    ksqrs.id1,&lt;br /&gt;    ksqrs.id2,&lt;br /&gt;    mode, &lt;br /&gt;    flags, &lt;br /&gt;    timeout&lt;br /&gt;  );&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;  We will interesting in "ID1", "ID2", "TYPE" lock attributes. We can fully decode them from X$KSQRS fixed table. &lt;br/&gt;But ksqgtl called with X$KSQEQ.KSQLKADR. X$KSQEQ.KSQLKRES maps to X$KSQRS.ADDR. &lt;pre class="brush:sql;highlight: [19,20]"&gt;&lt;br /&gt;SQL&gt; select c.kqfconam column_name,&lt;br /&gt;  2         c.kqfcodty datatype,&lt;br /&gt;  3         c.kqfcosiz size_byte,&lt;br /&gt;  4         c.kqfcooff offset&lt;br /&gt;  5    from x$kqfta t,&lt;br /&gt;  6         x$kqfco c&lt;br /&gt;  7   where t.kqftanam = 'X$KSQEQ'&lt;br /&gt;  8     and c.kqfcotab = t.indx&lt;br /&gt;  9   order by c.indx&lt;br /&gt; 10  /&lt;br /&gt;&lt;br /&gt;COLUMN_NAME   DATATYPE  SIZE_BYTE     OFFSET&lt;br /&gt;----------- ---------- ---------- ----------&lt;br /&gt;ADDR                23          8          0&lt;br /&gt;INDX                 2          4          0&lt;br /&gt;INST_ID              2          4          0&lt;br /&gt;KSSOBFLG             2          4          0&lt;br /&gt;KSSOBOWN            23          8          0&lt;br /&gt;KSQLKADR            23          8         88&lt;br /&gt;KSQLKRES            23          8         96&lt;br /&gt;KSQLKMOD             2          1        176&lt;br /&gt;KSQLKREQ             2          1        177&lt;br /&gt;KSQLKMXH             2          2        178&lt;br /&gt;KSQLKSES            23          8          0&lt;br /&gt;KSQLKCTIM            2          4          0&lt;br /&gt;KSQLKLBLK            2          4          0&lt;br /&gt;&lt;/pre&gt;   We will print debug output similar to Tanel Poder script and 10704 event format.   &lt;/li&gt;  &lt;li&gt;&lt;pre class="brush:cpp"&gt;&lt;br /&gt;pid$target:oracle:ksqrcl*:entry &lt;br /&gt;{ &lt;br /&gt;  enqrs_addr = *(long *)copyin(arg0+8,8); /*X$KSQRS.ADDR enQueue Resource*/&lt;br /&gt;  ksqrs = *(struct ksqrs_t *)copyin(enqrs_addr, 112);&lt;br /&gt;  ksqrs.addr = enqrs_addr;&lt;br /&gt;  printf("%d [%Y] %s: *** %s-%08x-%08x x$ksqrs.addr=0x%016x\n",&lt;br /&gt;    timestamp,&lt;br /&gt;    walltimestamp,&lt;br /&gt;    probefunc,&lt;br /&gt;    ksqrs.idt,&lt;br /&gt;    ksqrs.id1,&lt;br /&gt;    ksqrs.id2,&lt;br /&gt;    ksqrs.addr&lt;br /&gt;  );&lt;br /&gt;} &lt;br /&gt;&lt;/pre&gt;  &lt;/li&gt;  &lt;li&gt; ksqrcl function (release lock) entry point: &lt;pre class="brush:cpp"&gt;&lt;br /&gt;pid$target:oracle:ksqrcl*:entry &lt;br /&gt;{ &lt;br /&gt;  enqrs_addr = *(long *)copyin(arg0+8,8); /*X$KSQRS.ADDR enQueue Resource*/&lt;br /&gt;  ksqrs = *(struct ksqrs_t *)copyin(enqrs_addr, 112);&lt;br /&gt;  ksqrs.addr = enqrs_addr;&lt;br /&gt;  printf("%d [%Y] %s: *** %s-%08x-%08x x$ksqrs.addr=0x%016x\n",&lt;br /&gt;    timestamp,&lt;br /&gt;    walltimestamp,&lt;br /&gt;    probefunc,&lt;br /&gt;    ksqrs.idt,&lt;br /&gt;    ksqrs.id1,&lt;br /&gt;    ksqrs.id2,&lt;br /&gt;    ksqrs.addr&lt;br /&gt;  );&lt;br /&gt;} &lt;br /&gt;&lt;/pre&gt;We will populate a ksqrs struct again.   &lt;/li&gt;  &lt;li&gt; If lock type equals to parameter passed to script, we will suspend process execution: &lt;pre class="brush:cpp"&gt;&lt;br /&gt;pid$target:oracle:ksqrcl*:entry &lt;br /&gt;/ksqrs.idt==$$1/&lt;br /&gt;{&lt;br /&gt;  printf("%d [%Y] %s.%s: lock_type=%s suspending execution\n", timestamp, walltimestamp, probefunc, probename, ksqrs.idt);&lt;br /&gt;  stop();&lt;br /&gt;}&lt;br /&gt;&lt;/pre&gt;  &lt;/li&gt;&lt;/ul&gt;Short demonstration how this works. &lt;br/&gt;Suppose I will want suspend server process when session acquires TM lock. 1. I opened new session to the DB and determine server process ID and tracefile location: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; select p.spid,&lt;br /&gt;  2         p.tracefile&lt;br /&gt;  3    from v$session s,&lt;br /&gt;  4         v$process p&lt;br /&gt;  5   where s.sid = sys_context( 'userenv', 'sid')&lt;br /&gt;  6     and p.addr = s.paddr&lt;br /&gt;  7  /&lt;br /&gt;&lt;br /&gt;SPID  TRACEFILE&lt;br /&gt;----- ----------------------------------------------------------------------------------------------------&lt;br /&gt;1968  /pub/home/oracle/diag/rdbms/orcl/orcl/trace/orcl_ora_1968.trc&lt;br /&gt;&lt;/pre&gt;2. I created test table: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; create table t (x int);&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;SQL&gt; select object_id,&lt;br /&gt;  2         to_char(object_id, 'fm0xxxxxxx') object_id_hex&lt;br /&gt;  3    from obj&lt;br /&gt;  4   where object_name='T';&lt;br /&gt;&lt;br /&gt; OBJECT_ID OBJECT_ID_HEX&lt;br /&gt;---------- ---------------------------&lt;br /&gt;    349673 000555e9&lt;br /&gt;&lt;/pre&gt;3. Now I enable additional diagnostics: event 10704 to trace enqueues: &lt;pre class="brush:sql"&gt;&lt;br /&gt;SQL&gt; alter session set events '10704 level 2';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;&lt;/pre&gt;4. Next I will run DTrace script &lt;a href="#enq_suspend"&gt;enq_suspend.d&lt;/a&gt; passing server process ID as parameter: &lt;pre class="brush:shell"&gt;&lt;br /&gt;oracle@localhost dtrace$ ./enq_suspend.d -p 1968 TM&lt;br /&gt;&lt;/pre&gt;5. Trying to truncate table T: &lt;pre class="brush:sql"&gt;&lt;br /&gt;&lt;/pre&gt;Session suspending. 6. Observed output into console with DTrace script: &lt;pre class="brush:shell;highlight: [8,9]"&gt;&lt;br /&gt;oracle@localhost dtrace$ ./enq_suspend.d -p 1968 TM&lt;br /&gt;33969273235645237 [2015 Feb  9 12:42:21] ksqgtlctx: *** TM-000555e9-00000000 mode=6 flags=0x401 timeout=0&lt;br /&gt;33969273240887878 [2015 Feb  9 12:42:21] ksqgtlctx: *** TX-0004001b-0000f92e mode=6 flags=0x401 timeout=0&lt;br /&gt;33969273245689382 [2015 Feb  9 12:42:21] ksqrcl: *** TX-0004001b-0000f92e x$ksqrs.addr=0x000000041cda5c90&lt;br /&gt;33969273245764458 [2015 Feb  9 12:42:21] ksqrcli: *** TX-0004001b-0000f92e x$ksqrs.addr=0x000000041cda5c90&lt;br /&gt;33969273246279405 [2015 Feb  9 12:42:21] ksqrcl: *** TM-000555e9-00000000 x$ksqrs.addr=0x000000041cda25d0&lt;br /&gt;33969273246301204 [2015 Feb  9 12:42:21] ksqrcl.entry: lock_type=TM suspending execution&lt;br /&gt;&lt;/pre&gt;You can see that when calling ksqrcl with TM-000555e9-00000000 (our object id) execution is suspending. We can gather any required diagnostic data at this step. 7. 10704 event data in the trace file: &lt;pre class="brush:sql"&gt;&lt;br /&gt;*** 2015-02-09 12:42:21.102&lt;br /&gt;ksqgtl *** TM-000555e9-00000000 mode=6 flags=0x401 timeout=0 ***&lt;br /&gt;ksqgtl: xcb=0x419a6f068, ktcdix=2147483647, topxcb=0x419a6f068&lt;br /&gt;        ktcipt(topxcb)=0x0&lt;br /&gt;ksucti: init txn DID from session DID &lt;br /&gt;ksqgtl:&lt;br /&gt;        ksqlkdid: 0001-0019-00000142&lt;br /&gt;*** ksudidTrace: ksqgtl&lt;br /&gt;        ktcmydid(): 0001-0019-00000142&lt;br /&gt;        ksusesdi:   0001-0019-00000143&lt;br /&gt;        ksusetxn:   0001-0019-00000142&lt;br /&gt;ksqgtl: RETURNS 0&lt;br /&gt;ksqgtl *** TX-0004001b-0000f92e mode=6 flags=0x401 timeout=0 ***&lt;br /&gt;ksqgtl: xcb=0x419a6f068, ktcdix=2147483647, topxcb=0x419a6f068&lt;br /&gt;        ktcipt(topxcb)=0x0&lt;br /&gt;ksucti: init session DID from txn DID: &lt;br /&gt;ksqgtl:&lt;br /&gt;        ksqlkdid: 0001-0019-00000142&lt;br /&gt;*** ksudidTrace: ksqgtl&lt;br /&gt;        ktcmydid(): 0001-0019-00000142&lt;br /&gt;        ksusesdi:   0001-0019-00000143&lt;br /&gt;        ksusetxn:   0001-0019-00000142&lt;br /&gt;ksqgtl: RETURNS 0&lt;br /&gt;ksqrcl: TX,4001b,f92e&lt;br /&gt;ksqrcl: returns 0&lt;br /&gt;&lt;/pre&gt;&lt;a href="#enq_suspend"&gt;enq_suspend.d&lt;/a&gt; script can be further extending for more complex conditions: such as stop when session acquires TM lock with particular object_id and mode, and so on. Script verified in my environment: Oracle Database version 11.2.0.3 on Solaris 10 SPARC64.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/6229690145580037271/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2015/02/suspending-users-session-on-specific.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6229690145580037271'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6229690145580037271'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2015/02/suspending-users-session-on-specific.html' title='Suspending a users session on specific enqueue'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-6474253926455521975</id><published>2014-12-22T21:53:00.002+06:00</published><updated>2014-12-22T21:58:42.121+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='JDBC'/><title type='text'>c3p0 PROBABLYNOT connection test query</title><content type='html'>I am participating in the project, which uses &lt;a href="https://www.playframework.com/"&gt;Play framework&lt;/a&gt; version 1.x.&lt;br/&gt;Business logic at the application level, data stored in the Oracle database.&lt;br/&gt;An SQL query below caught my attention: &lt;pre class="brush:sql"&gt;&lt;br /&gt;--sql_id=az33m61ym46y4&lt;br /&gt;SELECT NULL AS table_cat,&lt;br /&gt;       o.owner AS table_schem,&lt;br /&gt;       o.object_name AS table_name,&lt;br /&gt;       o.object_type AS table_type,&lt;br /&gt;       NULL AS remarks&lt;br /&gt;  FROM all_objects o&lt;br /&gt;  WHERE o.owner LIKE :1 ESCAPE '/'&lt;br /&gt;    AND o.object_name LIKE :2 ESCAPE '/'&lt;br /&gt;    AND o.object_type IN ('xxx', 'TABLE')&lt;br /&gt;  ORDER BY table_type, table_schem, table_name&lt;br /&gt;&lt;/pre&gt;This query was executed 100K times per hour.&lt;br/&gt;I enable SQL trace for a short time period to help diagnose this issue further: &lt;pre class="brush:sql"&gt;&lt;br /&gt;alter system set events 'sql_trace[sql:az33m61ym46y4] bind=true';&lt;br /&gt;&lt;/pre&gt;"Bad" query was executed by different users but has same bind variable data: &lt;pre class="brush:sql;highlight: [6,11]"&gt;&lt;br /&gt;BINDS #18446744071469205160:&lt;br /&gt;Bind#0&lt;br /&gt;  oacdty=01 mxl=32(04) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=03 fl2=1000010 frm=01 csi=873 siz=160 off=0&lt;br /&gt;  kxsbbbfp=ffffffff7a760438  bln=32  avl=01  flg=05&lt;br /&gt;  value="%"&lt;br /&gt;Bind#1&lt;br /&gt;  oacdty=01 mxl=128(44) mxlc=00 mal=00 scl=00 pre=00&lt;br /&gt;  oacflg=03 fl2=1000010 frm=01 csi=873 siz=0 off=32&lt;br /&gt;  kxsbbbfp=ffffffff7a760458  bln=128  avl=11  flg=01&lt;br /&gt;  value="PROBABLYNOT"&lt;br /&gt;&lt;/pre&gt; Looks like we are faced with a &lt;a href="http://sourceforge.net/projects/c3p0/"&gt;c3p0&lt;/a&gt; default connection test query.&lt;br/&gt;&lt;a href="https://www.playframework.com/"&gt;Play framework&lt;/a&gt; uses the popular &lt;a href="http://sourceforge.net/projects/c3p0/"&gt;c3p0&lt;/a&gt; for its connection pool.  This query could be changed for something lightweight, such as: &lt;pre class="brush:sql"&gt;&lt;br /&gt;select 'x' from dual&lt;br /&gt;&lt;/pre&gt;I sent that information to Java programmers and they promised to fix this issue.  </content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/6474253926455521975/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2014/12/c3p0-probablynot-connection-test-query.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6474253926455521975'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6474253926455521975'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2014/12/c3p0-probablynot-connection-test-query.html' title='c3p0 PROBABLYNOT connection test query'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-151503946897691722</id><published>2014-09-16T10:35:00.004+07:00</published><updated>2016-05-14T12:30:51.210+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='12.1.0.2'/><category scheme='http://www.blogger.com/atom/ns#' term='12c'/><category scheme='http://www.blogger.com/atom/ns#' term='_trace_kqlidp'/><title type='text'>Bug 4991675 - Diagnostic event improve diagnosability of data dictionary invalidation issues</title><content type='html'>In recent MOS HOT Topics email I found a note: &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=4991675.8"&gt;Bug 4991675 - Diagnostic event improve diagnosability of data dictionary invalidation issues (Doc ID 4991675.8)&lt;/a&gt;Many DBAs faced with "sporadic" invalidation issues in their work. Finding a root cause for such issues is not always easy.  In many cases we investigate audit records, process redo logs with LogMiner and so on. You are out of problem when there are no DDL in database. Unfortunately, such goal not always reachable.  In patch readme you can find next notes: &lt;pre&gt;&lt;br /&gt;Note:Patch Post Install Steps:&lt;br /&gt;This fix enhances the _trace_kqlidp parameter therefore please set this&lt;br /&gt;parameter to true to enable this fix.&lt;br /&gt;&lt;/pre&gt; _trace_kqlidp was probably introduced in 11.1 but this patch enhances the parameter. I wrote a simple test case that can be used to demonstrate the effect of _trace_kqlidp parameter. &lt;pre class="brush: sql"&gt;&lt;br /&gt;def tns_alias=orcl&lt;br /&gt;&lt;br /&gt;conn /@&amp;tns_alias.&lt;br /&gt;drop user tc cascade;&lt;br /&gt;grant connect to tc identified by tc;&lt;br /&gt;grant alter session, create procedure, create table to tc;&lt;br /&gt;&lt;br /&gt;conn tc/tc@&amp;tns_alias.&lt;br /&gt;&lt;br /&gt;create table t(x int) segment creation deferred;&lt;br /&gt;&lt;br /&gt;create or replace procedure p&lt;br /&gt;is&lt;br /&gt;begin&lt;br /&gt;  for t_rec in (&lt;br /&gt;    select * from t)&lt;br /&gt;  loop&lt;br /&gt;    null;&lt;br /&gt;  end loop;&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;&lt;br /&gt;alter session set "_trace_kqlidp"=true;&lt;br /&gt;&lt;br /&gt;select status from obj where object_name='P';&lt;br /&gt;alter table t add y int;&lt;br /&gt;select status from obj where object_name='P';&lt;br /&gt;&lt;/pre&gt;Latest alter table invalidates the procedure P. With parameter _trace_kqlidp set I see in trace file on 11.2.0.3: &lt;pre class="brush: sql"&gt;&lt;br /&gt;ksedsts()+1296&lt;-kqlidp0()+12068&lt;-atbdrv()+26728&lt;-opiexe()+20544&lt;-opiosq0()+5576&lt;-kpooprx()+212&lt;-kpoal8()+536&lt;-opiodr()+1164&lt;-ttcpip()+1104&lt;-opitsk()+1664&lt;-opiino()+924&lt;-opiodr()+1164&lt;-opidrv()+1032&lt;-sou2o()+88&lt;-opimai_real()+504&lt;-ssthrdmain()+316&lt;-main()+316&lt;br /&gt;&lt;-_start()+380Fine-grain delta dump for unit TC.T&lt;br /&gt;- Change bit vector 0:&lt;br /&gt;  -23, -16, &lt;br /&gt;- Change bit vector 1:Empty&lt;br /&gt;- Change bit vector 2:Empty&lt;br /&gt;- Shift table:Empty &lt;br /&gt;kqlidp0: 964375 (CURSOR TC.T) (Parent:    0) [ROOT]&lt;br /&gt;kqlidp0:. 964376 (PROCEDURE TC.P) (Parent:964375) [ADDED TO QUEUE]&lt;br /&gt;kqlidp0:. 964376 (PROCEDURE TC.P) (Parent:964375) [INVALIDATE]&lt;br /&gt;&lt;/pre&gt;On 12.1.0.2: &lt;pre class="brush: sql;highlight: [1,2]"&gt;&lt;br /&gt;INVALIDATION: Current SQL follows&lt;br /&gt;alter table t add y int&lt;br /&gt;ksedsts()+392&lt;-kqlidp0()+11984&lt;-atbdrv()+6728&lt;-opiexe()+22596&lt;-opiosq0()+3928&lt;-kpooprx()+196&lt;-kpoal8()+656&lt;-opiodr()+1100&lt;-ttcpip()+972&lt;-opitsk()+1820&lt;-opiino()+920&lt;-opiodr()+1100&lt;-opidrv()+932&lt;-sou2o()+112&lt;-opimai_real()+756&lt;-ssthrdmain()+456&lt;-main()+320&lt;-_start()+300&lt;br /&gt;Fine-grain delta dump for unit TC.T&lt;br /&gt;- Change bit vector 0:&lt;br /&gt;  -23, -16, &lt;br /&gt;- Change bit vector 1:Empty&lt;br /&gt;- Change bit vector 2:Empty&lt;br /&gt;- Shift table:Empty &lt;br /&gt;kqlidp0: 91877 (CURSOR TC.T) (Parent:    0) [ROOT]&lt;br /&gt;kqlidp0:. 91878 (PROCEDURE TC.P) (Parent:91877) [ADDED TO QUEUE]&lt;br /&gt;kqlidp0:. 91878 (PROCEDURE TC.P) (Parent:91877) [INVALIDATE]&lt;br /&gt;&lt;/pre&gt;We can see that patch 4991675 probably adds highlighted lines.  "INVALIDATION" line helps in trace file identification.  "Current SQL" line simplify root cause analysis.  Update: alert.log also populated with "INVALIDATION" line. &lt;pre&gt;&lt;br /&gt;Tue Sep 16 10:16:50 2014&lt;br /&gt;INVALIDATION performed by ospid=21919. Please see tracefile.&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/151503946897691722/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2014/09/bug-4991675-diagnostic-event-improve.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/151503946897691722'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/151503946897691722'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2014/09/bug-4991675-diagnostic-event-improve.html' title='Bug 4991675 - Diagnostic event improve diagnosability of data dictionary invalidation issues'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-3737818544157875866</id><published>2014-08-23T23:49:00.003+07:00</published><updated>2014-08-23T23:49:50.036+07:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='ORA-10505'/><title type='text'>event 10505</title><content type='html'>&lt;pre&gt;&lt;br /&gt;[oracle@oracle ~]$ oerr ora 10505&lt;br /&gt;10505, 00000, "CBO enable dynamic sampling dump to table"&lt;br /&gt;// *Cause:&lt;br /&gt;// *Action:&lt;br /&gt;&lt;/pre&gt;Event 10505 can be used to dump dynamic sampling data to table. Same information can be obtained from event 10053 trace files. This event requires additional tables: &lt;pre class="brush: sql"&gt;&lt;br /&gt;-- general table and dynamic sampling stats&lt;br /&gt;create table kkedsamp_table(&lt;br /&gt;  table_name varchar2(30),&lt;br /&gt;  dyn_sampling_level number,&lt;br /&gt;  c3 number, -- unknown&lt;br /&gt;  c4 number, -- unknown&lt;br /&gt;  c5 number, -- unknown&lt;br /&gt;  c6 number, -- unknown&lt;br /&gt;  c7 number, -- unknown&lt;br /&gt;  single_table_dyn_sel_est number,&lt;br /&gt;  dynamic_sampling_card number,&lt;br /&gt;  sample_pct number,&lt;br /&gt;  c11 number, -- unknown, partitioning&lt;br /&gt;  c12 number, -- unknown, partitioning&lt;br /&gt;  c13 number, -- unknown, partitioning&lt;br /&gt;  c14 number, -- unknown&lt;br /&gt;  actual_sample_size number,&lt;br /&gt;  filtered_sample_card number,&lt;br /&gt;  orig_card number,&lt;br /&gt;  block_cnt_for_sampling_tabstat number,&lt;br /&gt;  c19 number,&lt;br /&gt;  max_sample_block_cnt number,&lt;br /&gt;  sample_block_cnt number,&lt;br /&gt;  min_sel_est number);&lt;br /&gt;-- column stats&lt;br /&gt;create table kkedsamp_column(&lt;br /&gt;  column_name varchar2(30),&lt;br /&gt;  table_name varchar2(30),&lt;br /&gt;  c3 number, -- unknown&lt;br /&gt;  num_distinct number,&lt;br /&gt;  num_distinct_scaled number,&lt;br /&gt;  num_nulls number,&lt;br /&gt;  num_nulls_scaled number);&lt;br /&gt;-- index stats&lt;br /&gt;create table kkedsamp_index(&lt;br /&gt;  index_name varchar2(30),&lt;br /&gt;  table_name varchar2(30),&lt;br /&gt;  c3 number, -- unknown&lt;br /&gt;  index_selectity_est number,&lt;br /&gt;  min_sel_est number, &lt;br /&gt;  c6 number, -- unknown&lt;br /&gt;  num_blocks number);&lt;br /&gt;&lt;/pre&gt;Test case (run on 11.2.0.3): &lt;pre class="brush: sql"&gt;&lt;br /&gt;SQL&gt; create table t1 as select * from dba_objects;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;SQL&gt; create table t2 as select * from dba_objects;&lt;br /&gt;&lt;br /&gt;Table created.&lt;br /&gt;SQL&gt; create index t1_subobject_name_i on t1(subobject_name);&lt;br /&gt;&lt;br /&gt;Index created.&lt;br /&gt;SQL&gt; exec dbms_stats.delete_index_stats( '', 'T1_SUBOBJECT_NAME_I')&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;SQL&gt; alter session set events '10505';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;SQL&gt; select /*+ dynamic_sampling(4)*/&lt;br /&gt;  2         count(*)&lt;br /&gt;  3    from t1, t2&lt;br /&gt;  4   where t1.owner='SYSTEM'&lt;br /&gt;  5     and t2.subobject_name=t1.subobject_name&lt;br /&gt;  6     and t2.object_type like 'TABLE%';&lt;br /&gt;&lt;br /&gt;  COUNT(*)&lt;br /&gt;----------&lt;br /&gt;      3425&lt;br /&gt;SQL&gt; alter session set events '10505 off';&lt;br /&gt;&lt;br /&gt;Session altered.&lt;br /&gt;SQL&gt; @pt "select * from kkedsamp_table"&lt;br /&gt;TABLE_NAME                    : "T1"&lt;br /&gt;DYN_SAMPLING_LEVEL            : 4&lt;br /&gt;C3                            : 1&lt;br /&gt;C4                            : 1&lt;br /&gt;C5                            : 1&lt;br /&gt;C6                            : 1&lt;br /&gt;C7                            : 1&lt;br /&gt;SINGLE_TABLE_DYN_SEL_EST      : .060506329113924&lt;br /&gt;DYNAMIC_SAMPLING_CARD         : 12665.0793650794&lt;br /&gt;SAMPLE_PCT                    : 31.1881188118812&lt;br /&gt;C11                           : 1&lt;br /&gt;C12                           : 1&lt;br /&gt;C13                           : 1&lt;br /&gt;C14                           : 1&lt;br /&gt;ACTUAL_SAMPLE_SIZE            : 3950&lt;br /&gt;FILTERED_SAMPLE_CARD          : 239&lt;br /&gt;ORIG_CARD                     : 16500&lt;br /&gt;BLOCK_CNT_FOR_SAMPLING_TABSTAT: 202&lt;br /&gt;C19                           : 0&lt;br /&gt;MAX_SAMPLE_BLOCK_CNT          : 64&lt;br /&gt;SAMPLE_BLOCK_CNT              : 63&lt;br /&gt;MIN_SEL_EST                   : .01&lt;br /&gt;-----------------&lt;br /&gt;TABLE_NAME                    : "T2"&lt;br /&gt;DYN_SAMPLING_LEVEL            : 4&lt;br /&gt;C3                            : 1&lt;br /&gt;C4                            : 1&lt;br /&gt;C5                            : 1&lt;br /&gt;C6                            : 1&lt;br /&gt;C7                            : 0&lt;br /&gt;SINGLE_TABLE_DYN_SEL_EST      : .135717785399314&lt;br /&gt;DYNAMIC_SAMPLING_CARD         : 13088.3174603175&lt;br /&gt;SAMPLE_PCT                    : 31.1881188118812&lt;br /&gt;C11                           : 1&lt;br /&gt;C12                           : 1&lt;br /&gt;C13                           : 1&lt;br /&gt;C14                           : 1&lt;br /&gt;ACTUAL_SAMPLE_SIZE            : 4082&lt;br /&gt;FILTERED_SAMPLE_CARD          : 554&lt;br /&gt;ORIG_CARD                     : 16500&lt;br /&gt;BLOCK_CNT_FOR_SAMPLING_TABSTAT: 202&lt;br /&gt;C19                           : 0&lt;br /&gt;MAX_SAMPLE_BLOCK_CNT          : 64&lt;br /&gt;SAMPLE_BLOCK_CNT              : 63&lt;br /&gt;MIN_SEL_EST                   : .05&lt;br /&gt;-----------------&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;SQL&gt; @pt "select * from kkedsamp_column"&lt;br /&gt;COLUMN_NAME                   : "T1"."SUBOBJECT_NAME"&lt;br /&gt;TABLE_NAME                    : "T1"&lt;br /&gt;C3                            : 3&lt;br /&gt;NUM_DISTINCT                  : 160&lt;br /&gt;NUM_DISTINCT_SCALED           : 161&lt;br /&gt;NUM_NULLS                     : 3699&lt;br /&gt;NUM_NULLS_SCALED              : 11860.2857142857&lt;br /&gt;-----------------&lt;br /&gt;COLUMN_NAME                   : "T2"."SUBOBJECT_NAME"&lt;br /&gt;TABLE_NAME                    : "T2"&lt;br /&gt;C3                            : 3&lt;br /&gt;NUM_DISTINCT                  : 66&lt;br /&gt;NUM_DISTINCT_SCALED           : 66&lt;br /&gt;NUM_NULLS                     : 3997&lt;br /&gt;NUM_NULLS_SCALED              : 12815.7777777778&lt;br /&gt;-----------------&lt;br /&gt;&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;SQL&gt; @pt "select * from kkedsamp_index"&lt;br /&gt;INDEX_NAME                    : T1_SUBOBJECT_NAME_I&lt;br /&gt;TABLE_NAME                    : "T1"&lt;br /&gt;C3                            : 0&lt;br /&gt;INDEX_SELECTITY_EST           : -1&lt;br /&gt;MIN_SEL_EST                   : -1&lt;br /&gt;C6                            : 1&lt;br /&gt;NUM_BLOCKS                    : 8&lt;br /&gt;-----------------&lt;br /&gt;PL/SQL procedure successfully completed.&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/3737818544157875866/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2014/08/event-10505.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3737818544157875866'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/3737818544157875866'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2014/08/event-10505.html' title='event 10505'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-264192975005025692</id><published>2014-08-03T22:46:00.001+07:00</published><updated>2016-05-14T12:32:30.552+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='11g'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='11.2.0.3'/><category scheme='http://www.blogger.com/atom/ns#' term='CBO'/><title type='text'>JPPD bypassed View has non-standard group by</title><content type='html'>В одной из БД Hibernate сгенерировал новый запрос, который вызвал повышенную загрузку. Я исследовал этот запрос, оптимизируется он легко, но я выявил один интересный случай, когда JPPD (join-predicate push-down) не срабатывает для group by view. Test case (11.2.0.3): &lt;pre class="brush: sql"&gt;&lt;br /&gt;drop table t1 cascade constraints purge;&lt;br /&gt;drop table t2 cascade constraints purge;&lt;br /&gt;create table t1(x,y) as select rownum, rownum from dual connect by level&lt;=1e4;&lt;br /&gt;alter table t1 modify x not null;&lt;br /&gt;create index t1_y_i on t1(y);&lt;br /&gt;create table t2(x,z) as select rownum, cast(dummy as char(20)) from dual connect by level&lt;=1e5;&lt;br /&gt;alter table t2 modify x not null;&lt;br /&gt;create index t2_x_i on t2(x);&lt;br /&gt;exec dbms_stats.gather_table_stats( '', 't1')&lt;br /&gt;exec dbms_stats.gather_table_stats( '', 't2')&lt;br /&gt;&lt;/pre&gt;Hibernate генерировал следующий запрос: &lt;pre class="brush: sql"&gt;&lt;br /&gt;select *&lt;br /&gt;  from t1&lt;br /&gt; where y = :1&lt;br /&gt;   and x not in (select x from t2 group by x);&lt;br /&gt;&lt;/pre&gt;С планом: &lt;pre class="brush: sql"&gt;&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                    | Name   | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT             |        |     1 |     8 |    85  (25)| 00:00:02 |&lt;br /&gt;|*  1 |  FILTER                      |        |       |       |            |          |&lt;br /&gt;|   2 |   TABLE ACCESS BY INDEX ROWID| T1     |     1 |     8 |     2   (0)| 00:00:01 |&lt;br /&gt;|*  3 |    INDEX RANGE SCAN          | T1_Y_I |     1 |       |     1   (0)| 00:00:01 |&lt;br /&gt;|*  4 |   FILTER                     |        |       |       |            |          |&lt;br /&gt;|   5 |    HASH GROUP BY             |        |     1 |     5 |    83  (26)| 00:00:01 |&lt;br /&gt;|   6 |     INDEX FAST FULL SCAN     | T2_X_I |   100K|   488K|    65   (5)| 00:00:01 |&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;   1 - filter( NOT EXISTS (SELECT 0 FROM "T2" "T2" GROUP BY "X" HAVING&lt;br /&gt;              "X"=:B1))&lt;br /&gt;   3 - access("Y"=TO_NUMBER(:1))&lt;br /&gt;   4 - filter("X"=:B1)&lt;br /&gt;&lt;/pre&gt;Условие по T1 (Y=:1) - очень селективное. Как видно, subquery unnesting не срабатывает, а хотелось бы видеть анти-соединение, использующее INDEX RANGE SCAN индекса T2_X_I (индекс по T2(X)). Рассмотрим эквивалентный запрос: &lt;pre class="brush: sql"&gt;&lt;br /&gt;select *&lt;br /&gt;  from t1&lt;br /&gt; where y = :1&lt;br /&gt;   and x not in (select x from t2);&lt;br /&gt;&lt;/pre&gt;Его план, который бы хотелось получить для исходного запроса: &lt;pre class="brush: sql"&gt;&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                    | Name   | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT             |        |     1 |    13 |     3   (0)| 00:00:01 |&lt;br /&gt;|   1 |  NESTED LOOPS ANTI           |        |     1 |    13 |     3   (0)| 00:00:01 |&lt;br /&gt;|   2 |   TABLE ACCESS BY INDEX ROWID| T1     |     1 |     8 |     2   (0)| 00:00:01 |&lt;br /&gt;|*  3 |    INDEX RANGE SCAN          | T1_Y_I |     1 |       |     1   (0)| 00:00:01 |&lt;br /&gt;|*  4 |   INDEX RANGE SCAN           | T2_X_I |   100K|   488K|     1   (0)| 00:00:01 |&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;   3 - access("Y"=TO_NUMBER(:1))&lt;br /&gt;   4 - access("X"="X")&lt;br /&gt;&lt;/pre&gt;Как еще можно переписать запрос? По логике, нужно выбрать строки из T1, которых нет в T2. Такой запрос с Oracle синтаксисом Join: &lt;pre class="brush: sql"&gt;&lt;br /&gt;select t1.*&lt;br /&gt;  from t1,&lt;br /&gt;       (select x &lt;br /&gt;          from t2 &lt;br /&gt;         group by x) t2&lt;br /&gt; where y = :1&lt;br /&gt;   and t1.x = t2.x(+)&lt;br /&gt;   and t2.x is null;&lt;br /&gt;&lt;/pre&gt;Имеет план: &lt;pre class="brush: sql"&gt;&lt;br /&gt;-----------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                    | Name   | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     |&lt;br /&gt;-----------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT             |        |     1 |    21 |       |   233   (4)| 00:00:03 |&lt;br /&gt;|*  1 |  HASH JOIN ANTI              |        |     1 |    21 |       |   233   (4)| 00:00:03 |&lt;br /&gt;|   2 |   TABLE ACCESS BY INDEX ROWID| T1     |     1 |     8 |       |     2   (0)| 00:00:01 |&lt;br /&gt;|*  3 |    INDEX RANGE SCAN          | T1_Y_I |     1 |       |       |     1   (0)| 00:00:01 |&lt;br /&gt;|   4 |   VIEW                       |        |   100K|  1269K|       |   228   (3)| 00:00:03 |&lt;br /&gt;|   5 |    HASH GROUP BY             |        |   100K|   488K|  1192K|   228   (3)| 00:00:03 |&lt;br /&gt;|   6 |     INDEX FULL SCAN          | T2_X_I |   100K|   488K|       |   228   (3)| 00:00:03 |&lt;br /&gt;-----------------------------------------------------------------------------------------------&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;   1 - access("T1"."X"="T2"."X")&lt;br /&gt;   3 - access("Y"=TO_NUMBER(:1))&lt;br /&gt;&lt;/pre&gt;Мы видим, что происходит HASH JOIN ANTI (анти-соединение) без JPPD. Т.е. предикат соединения T1.X=T2.X - не был протолкнут внутрь GROUP BY VIEW по T2.  Выполнить проталкивание хинтами не получилось, что говорит о том, что такое VIEW для JPPD не подходит. Пришлось обратиться к трассировке CBO в поисках причин. &lt;pre class="brush: sql;highlight: [4]"&gt;&lt;br /&gt;JPPD:     JPPD bypassed: View has non-standard group by.&lt;br /&gt;JPPD: Applying transformation directives&lt;br /&gt;JPPD: Checking validity of push-down in query block SEL$6D455ABB (#1)&lt;br /&gt;JPPD:   No valid views found to push predicate into.&lt;br /&gt;&lt;/pre&gt;Вот это уже информация для анализа. Мы видим, что JPPD не сработал, т.к. View: "has non-standard group by". Подумав, я написал следующий запрос: &lt;pre class="brush: sql; highlight: [4]"&gt;&lt;br /&gt;select t1.*&lt;br /&gt;  from t1,&lt;br /&gt;       (select x, &lt;br /&gt;               count(*)&lt;br /&gt;          from t2 &lt;br /&gt;         group by x) t2&lt;br /&gt; where y=:1&lt;br /&gt;   and t1.x = t2.x(+)&lt;br /&gt;   and t2.x is null;&lt;br /&gt;&lt;/pre&gt;Его план: &lt;pre class="brush: sql"&gt;&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation                    | Name   | Rows  | Bytes | Cost (%CPU)| Time     |&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT             |        |     1 |    10 |     3   (0)| 00:00:01 |&lt;br /&gt;|   1 |  NESTED LOOPS ANTI           |        |     1 |    10 |     3   (0)| 00:00:01 |&lt;br /&gt;|   2 |   TABLE ACCESS BY INDEX ROWID| T1     |     1 |     8 |     2   (0)| 00:00:01 |&lt;br /&gt;|*  3 |    INDEX RANGE SCAN          | T1_Y_I |     1 |       |     1   (0)| 00:00:01 |&lt;br /&gt;|   4 |   VIEW PUSHED PREDICATE      |        |     1 |     2 |     1   (0)| 00:00:01 |&lt;br /&gt;|   5 |    SORT GROUP BY             |        |     1 |     5 |     1   (0)| 00:00:01 |&lt;br /&gt;|*  6 |     INDEX RANGE SCAN         | T2_X_I |     1 |     5 |     1   (0)| 00:00:01 |&lt;br /&gt;---------------------------------------------------------------------------------------&lt;br /&gt;Predicate Information (identified by operation id):&lt;br /&gt;---------------------------------------------------&lt;br /&gt;   3 - access("Y"=TO_NUMBER(:1))&lt;br /&gt;   6 - access("X"="T1"."X")&lt;br /&gt;&lt;/pre&gt;По сути дела, мы запрос: &lt;pre class="brush: sql"&gt;&lt;br /&gt;select t1.*&lt;br /&gt;  from t1,&lt;br /&gt;       (select x &lt;br /&gt;          from t2 &lt;br /&gt;         group by x) t2&lt;br /&gt; where y = :1&lt;br /&gt;   and t1.x = t2.x(+)&lt;br /&gt;   and t2.x is null;&lt;br /&gt;&lt;/pre&gt;Переписали в эквивалентный: &lt;pre class="brush: sql;highlight: [4]"&gt;&lt;br /&gt;select t1.*&lt;br /&gt;  from t1,&lt;br /&gt;       (select x, &lt;br /&gt;               count(*) &lt;br /&gt;          from t2 &lt;br /&gt;         group by x) t2&lt;br /&gt; where y=:1&lt;br /&gt;   and t1.x = t2.x(+)&lt;br /&gt;   and t2.x is null;&lt;br /&gt;&lt;/pre&gt;И это позволило выполнить JPPD, что видно в плане и в трассе CBO: &lt;pre class="brush: sql;highlight: [7]"&gt;&lt;br /&gt;***********************************&lt;br /&gt;Cost-Based Join Predicate Push-down&lt;br /&gt;***********************************&lt;br /&gt;JPPD: Checking validity of push-down in query block SEL$6D455ABB (#1)&lt;br /&gt;JPPD:   Checking validity of push-down from query block SEL$6D455ABB (#1) to query block SEL$2 (#2)&lt;br /&gt;Check Basic Validity for Non-Union View for query block SEL$2 (#2)&lt;br /&gt;JPPD:     Passed validity checks&lt;br /&gt;JPPD: JPPD:   Pushdown from query block SEL$6D455ABB (#1) passed validity checks.&lt;br /&gt;Join-Predicate push-down on query block SEL$6D455ABB (#1)&lt;br /&gt;JPPD: Using search type: linear&lt;br /&gt;JPPD: Considering join predicate push-down&lt;br /&gt;JPPD: Starting iteration 1, state space = (2) : (0)&lt;br /&gt;JPPD: Performing join predicate push-down (no transformation phase) from query block SEL$6D455ABB (#1) to query block SEL$2 (#2)&lt;br /&gt;&lt;/pre&gt;Пока это похоже на существующее ограничение CBO. Указанное поведение проверялось в 11.2.0.3 и 12.1.0.1.</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/264192975005025692/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2014/08/jppd-bypassed-view-has-non-standard.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/264192975005025692'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/264192975005025692'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2014/08/jppd-bypassed-view-has-non-standard.html' title='JPPD bypassed View has non-standard group by'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-6482135360830535566</id><published>2014-08-03T21:13:00.000+07:00</published><updated>2014-08-03T21:23:36.875+07:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='ORA-10384'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><title type='text'>event 10384</title><content type='html'>event 10384 level 16384: force parallel query runs as serial. &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=1114405.1"&gt;How to Force that a Parallel Query Runs in Serial with the Parallel Execution Plan (Doc ID 1114405.1)&lt;/a&gt;&lt;pre&gt;&lt;br /&gt;[oracle@oracle]$ oerr ora 10384&lt;br /&gt;10384, 00000, "parallel dataflow scheduler tracing"&lt;br /&gt;// *Cause:&lt;br /&gt;// *Action:   set this event only under the supervision of Oracle development&lt;br /&gt;// *Comment:  trace level is a bitfield (see kkrp.h)&lt;br /&gt;&lt;/pre&gt;Test case (run on 11.2.0.3): &lt;pre class="brush: sql"&gt;&lt;br /&gt;doc&lt;br /&gt;  create test data&lt;br /&gt;#&lt;br /&gt;create table t as select * from dba_objects;&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  set statistics_level=all and run parallel query&lt;br /&gt;#&lt;br /&gt;&lt;br /&gt;alter session set statistics_level=all;&lt;br /&gt;select /*+ parallel(t)*/count(*) from t;&lt;br /&gt;select * from table(dbms_xplan.display_cursor( format=&gt; 'allstats all'));&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  purge cursor&lt;br /&gt;#&lt;br /&gt;&lt;br /&gt;col address    new_v address&lt;br /&gt;col hash_value new_v hash_value&lt;br /&gt;select address, hash_value from v$sql where sql_id='apmsk02t1z90x';&lt;br /&gt;exec sys.dbms_shared_pool.purge( '&amp;address.,&amp;hash_value.', 'c')&lt;br /&gt;&lt;br /&gt;doc&lt;br /&gt;  set event 10384 level 16384, _px_trace=all and run query&lt;br /&gt;#&lt;br /&gt;&lt;br /&gt;alter session set events '10384 level 16384';&lt;br /&gt;alter session set "_px_trace"=all;&lt;br /&gt;&lt;br /&gt;select /*+ parallel(t)*/count(*) from t;&lt;br /&gt;select * from table(dbms_xplan.display_cursor( format=&gt; 'allstats all'));&lt;br /&gt;alter session set events '10384 off';&lt;br /&gt;&lt;/pre&gt;Row source execution statistics of first execution. Default degree 16, starts for 5th line is 16. &lt;pre class="brush: sql"&gt;&lt;br /&gt;-----------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation              | Name     | Starts | E-Rows | Cost (%CPU)| E-Time   |    TQ  |IN-OUT| PQ Distrib | A-Rows |   A-Time   | Buffers | Reads  |&lt;br /&gt;-----------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT       |          |      1 |        |     4 (100)|          |        |      |            |      1 |00:00:00.59 |       5 |      0 |&lt;br /&gt;|   1 |  SORT AGGREGATE        |          |      1 |      1 |            |          |        |      |            |      1 |00:00:00.59 |       5 |      0 |&lt;br /&gt;|   2 |   PX COORDINATOR       |          |      1 |        |            |          |        |      |            |     16 |00:00:00.59 |       5 |      0 |&lt;br /&gt;|   3 |    PX SEND QC (RANDOM) | :TQ10000 |      0 |      1 |            |          |  Q1,00 | P-&gt;S | QC (RAND)  |      0 |00:00:00.01 |       0 |      0 |&lt;br /&gt;|   4 |     SORT AGGREGATE     |          |     16 |      1 |            |          |  Q1,00 | PCWP |            |     16 |00:00:01.16 |     567 |    189 |&lt;br /&gt;|   5 |      PX BLOCK ITERATOR |          |     16 |  12736 |     4   (0)| 00:00:01 |  Q1,00 | PCWC |            |  14275 |00:00:01.16 |     567 |    189 |&lt;br /&gt;|*  6 |       TABLE ACCESS FULL| T        |    189 |  12736 |     4   (0)| 00:00:01 |  Q1,00 | PCWP |            |  14275 |00:00:01.14 |     567 |    189 |&lt;br /&gt;-----------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;/pre&gt;Row source execution statistics of second execution. Starts for 5th line is 1. Parallel plan executed serially. &lt;pre class="brush: sql"&gt;&lt;br /&gt;-----------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;| Id  | Operation              | Name     | Starts | E-Rows | Cost (%CPU)| E-Time   |    TQ  |IN-OUT| PQ Distrib | A-Rows |   A-Time   | Buffers | Reads  |&lt;br /&gt;-----------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;|   0 | SELECT STATEMENT       |          |      1 |        |     4 (100)|          |        |      |            |      1 |00:00:00.02 |     194 |     63 |&lt;br /&gt;|   1 |  SORT AGGREGATE        |          |      1 |      1 |            |          |        |      |            |      1 |00:00:00.02 |     194 |     63 |&lt;br /&gt;|   2 |   PX COORDINATOR       |          |      1 |        |            |          |        |      |            |      1 |00:00:00.02 |     194 |     63 |&lt;br /&gt;|   3 |    PX SEND QC (RANDOM) | :TQ10000 |      1 |      1 |            |          |  Q1,00 | P-&gt;S | QC (RAND)  |      1 |00:00:00.02 |     194 |     63 |&lt;br /&gt;|   4 |     SORT AGGREGATE     |          |      1 |      1 |            |          |  Q1,00 | PCWP |            |      1 |00:00:00.02 |     194 |     63 |&lt;br /&gt;|   5 |      PX BLOCK ITERATOR |          |      1 |  12736 |     4   (0)| 00:00:01 |  Q1,00 | PCWC |            |  14275 |00:00:00.02 |     194 |     63 |&lt;br /&gt;|*  6 |       TABLE ACCESS FULL| T        |      1 |  12736 |     4   (0)| 00:00:01 |  Q1,00 | PCWP |            |  14275 |00:00:00.02 |     194 |     63 |&lt;br /&gt;-----------------------------------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;/pre&gt;Trace file with event 10384 set contains a line: &lt;pre&gt;&lt;br /&gt;Parallelism disabled at runtime because forced serial by event 10384&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/6482135360830535566/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2014/08/event-10384.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6482135360830535566'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6482135360830535566'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2014/08/event-10384.html' title='event 10384'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-4046775791658133383</id><published>2014-07-22T20:26:00.000+07:00</published><updated>2014-08-03T21:21:56.736+07:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='ORA-10309'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><title type='text'>event 10309</title><content type='html'>&lt;pre&gt;&lt;br /&gt;[oracle@oracle ~]$ oerr ora 10309&lt;br /&gt;10309, 00000, "Trigger Debug event"&lt;br /&gt;// *Document: NO&lt;br /&gt;// *Cause:&lt;br /&gt;// *Action:&lt;br /&gt;// *Comment: This event replaces the earlier event number 10250&lt;br /&gt;//           which had multiple definitions&lt;br /&gt;&lt;/pre&gt;Test case (run on 11.2.0.3): &lt;pre class="brush: sql"&gt;&lt;br /&gt;drop user tc cascade;&lt;br /&gt;grant connect to tc identified by tc;&lt;br /&gt;grant alter session to tc;&lt;br /&gt;grant create table to tc;&lt;br /&gt;grant create trigger to tc;&lt;br /&gt;alter user tc quota 100M on users;&lt;br /&gt;&lt;br /&gt;conn tc/tc&lt;br /&gt;create table t(x int);&lt;br /&gt;create trigger t_bi&lt;br /&gt;  before insert on t&lt;br /&gt;declare&lt;br /&gt;begin&lt;br /&gt;  null;&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;create trigger t_bir &lt;br /&gt;  before insert on t&lt;br /&gt;  for each row&lt;br /&gt;declare&lt;br /&gt;begin&lt;br /&gt;  null;&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;create trigger t_air &lt;br /&gt;  after insert on t&lt;br /&gt;  for each row&lt;br /&gt;declare&lt;br /&gt;begin&lt;br /&gt;  null;&lt;br /&gt;end;&lt;br /&gt;/&lt;br /&gt;alter session set events '10309';&lt;br /&gt;insert into t values (0);&lt;br /&gt;select value from v$diag_info where name='Default Trace File';&lt;br /&gt;&lt;/pre&gt;Trace file: &lt;pre&gt;&lt;br /&gt;*** 2014-07-21 09:42:05.051&lt;br /&gt;*** SESSION ID:(76.9819) 2014-07-21 09:42:05.051&lt;br /&gt;*** CLIENT ID:() 2014-07-21 09:42:05.051&lt;br /&gt;*** SERVICE NAME:(SYS$USERS) 2014-07-21 09:42:05.051&lt;br /&gt;*** MODULE NAME:(SQL*Plus) 2014-07-21 09:42:05.051&lt;br /&gt;*** ACTION NAME:() 2014-07-21 09:42:05.051&lt;br /&gt;&lt;br /&gt;--------Dumping Sorted Master Trigger List --------&lt;br /&gt;Trigger Owner : TC&lt;br /&gt;Trigger Name : T_AIR&lt;br /&gt;Trigger Owner : TC&lt;br /&gt;Trigger Name : T_BIR&lt;br /&gt;Trigger Owner : TC&lt;br /&gt;Trigger Name : T_BI&lt;br /&gt;--------Dumping Trigger Sublists --------&lt;br /&gt; trigger sublist 0 :&lt;br /&gt;Trigger Owner : TC&lt;br /&gt;Trigger Name : T_BI&lt;br /&gt; trigger sublist 1 :&lt;br /&gt;Trigger Owner : TC&lt;br /&gt;Trigger Name : T_BIR&lt;br /&gt; trigger sublist 2 :&lt;br /&gt; trigger sublist 3 :&lt;br /&gt;Trigger Owner : TC&lt;br /&gt;Trigger Name : T_AIR&lt;br /&gt; trigger sublist 4 :&lt;br /&gt;--------Dumping Sorted Master Trigger List --------&lt;br /&gt;Trigger Owner : TC&lt;br /&gt;Trigger Name : T_AIR&lt;br /&gt;Trigger Owner : TC&lt;br /&gt;Trigger Name : T_BIR&lt;br /&gt;Trigger Owner : TC&lt;br /&gt;Trigger Name : T_BI&lt;br /&gt;--------Dumping Trigger Sublists --------&lt;br /&gt; trigger sublist 0 :&lt;br /&gt;Trigger Owner : TC&lt;br /&gt;Trigger Name : T_BI&lt;br /&gt; trigger sublist 1 :&lt;br /&gt;Trigger Owner : TC&lt;br /&gt;Trigger Name : T_BIR&lt;br /&gt; trigger sublist 2 :&lt;br /&gt; trigger sublist 3 :&lt;br /&gt;Trigger Owner : TC&lt;br /&gt;Trigger Name : T_AIR&lt;br /&gt; trigger sublist 4 :&lt;br /&gt;&lt;br /&gt;*** 2014-07-21 09:42:05.073&lt;br /&gt;Firing Insert Before Table Trigger. Name: T_BI Owner TC&lt;br /&gt;Firing Insert Before Row Trigger. Name: T_BIR Owner TC&lt;br /&gt;Firing Insert After Row Trigger. Name: T_AIR Owner TC&lt;br /&gt;&lt;/pre&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/4046775791658133383/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2014/07/event-10309.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4046775791658133383'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/4046775791658133383'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2014/07/event-10309.html' title='event 10309'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-6548966603811713482</id><published>2014-07-21T16:17:00.002+07:00</published><updated>2016-05-14T12:32:41.024+06:00</updated><category scheme='http://www.blogger.com/atom/ns#' term='11g'/><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#post'/><category scheme='http://www.blogger.com/atom/ns#' term='11.2.0.3'/><title type='text'>Bug 15931756 - ORA-4031 Queries against SYS_FBA_TRACKEDTABLES not shared (do not use binds)</title><content type='html'>В одной из промышленных БД версии 11.2.0.3.7 обнаружил большое количество системных SQL, не использующих литералы. &lt;pre class="brush: sql"&gt;&lt;br /&gt;/*&lt;br /&gt;Find queries that are not using bind variables&lt;br /&gt;*/&lt;br /&gt;select s.*, &lt;br /&gt;      (select sql_text from v$sqlarea where force_matching_signature=sig and rownum=1) sql_text&lt;br /&gt;  from (&lt;br /&gt;       select inst_id, to_char(force_matching_signature) sig,&lt;br /&gt;              count(exact_matching_signature) cnt&lt;br /&gt;         from (&lt;br /&gt;              select inst_id, force_matching_signature, exact_matching_signature&lt;br /&gt;                from gv$sql&lt;br /&gt;               group by inst_id, force_matching_signature, exact_matching_signature&lt;br /&gt;              )&lt;br /&gt;        group by inst_id, force_matching_signature&lt;br /&gt;       having count(exact_matching_signature) &gt; 1&lt;br /&gt;        order by cnt desc&lt;br /&gt;       ) s&lt;br /&gt; where rownum &lt;= 10&lt;br /&gt;&lt;/pre&gt;В выводе оказалось множество запросов вида: &lt;pre class="brush: sql"&gt;&lt;br /&gt;select FLAGS from SYS_FBA_TRACKEDTABLES where OBJ# = 1865226&lt;br /&gt;select count(FA#) from SYS_FBA_TRACKEDTABLES where OBJ# = 1864581 and bitand(FLAGS, 128)=0&lt;br /&gt;&lt;/pre&gt;С кол-вом подобных курсоров в кол-ве 501 и 399 соответственно. &lt;pre class="brush: sql"&gt;&lt;br /&gt;SQL&gt; select sql_text from v$sql where force_matching_signature=15893216616221909352 and rownum&lt;=10;&lt;br /&gt;SQL_TEXT&lt;br /&gt;---------------------------------------------------------------------------------&lt;br /&gt;select FLAGS from SYS_FBA_TRACKEDTABLES where OBJ# = 1865226&lt;br /&gt;select FLAGS from SYS_FBA_TRACKEDTABLES where OBJ# = 1865182&lt;br /&gt;select FLAGS from SYS_FBA_TRACKEDTABLES where OBJ# = 1865129&lt;br /&gt;select FLAGS from SYS_FBA_TRACKEDTABLES where OBJ# = 1864747&lt;br /&gt;select FLAGS from SYS_FBA_TRACKEDTABLES where OBJ# = 1864989&lt;br /&gt;select FLAGS from SYS_FBA_TRACKEDTABLES where OBJ# = 1865069&lt;br /&gt;select FLAGS from SYS_FBA_TRACKEDTABLES where OBJ# = 1864718&lt;br /&gt;select FLAGS from SYS_FBA_TRACKEDTABLES where OBJ# = 1864786&lt;br /&gt;select FLAGS from SYS_FBA_TRACKEDTABLES where OBJ# = 1864815&lt;br /&gt;select FLAGS from SYS_FBA_TRACKEDTABLES where OBJ# = 1864679&lt;br /&gt;&lt;/pre&gt;Поиск на MOS по SYS_FBA_TRACKEDTABLES тут же выдает, что имеет место быть баг: &lt;a href="https://support.oracle.com/CSP/main/article?cmd=show&amp;type=NOT&amp;id=15931756.8"&gt;Bug 15931756 - ORA-4031 / Queries against SYS_FBA_TRACKEDTABLES not shared (do not use binds) (Doc ID 15931756.8)&lt;/a&gt;</content><link rel='replies' type='application/atom+xml' href='https://mvelikikh.blogspot.com/feeds/6548966603811713482/comments/default' title='Комментарии к сообщению'/><link rel='replies' type='text/html' href='https://mvelikikh.blogspot.com/2014/07/bug-15931756-ora-4031-queries-against.html#comment-form' title='Комментарии: 0'/><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6548966603811713482'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/posts/default/6548966603811713482'/><link rel='alternate' type='text/html' href='https://mvelikikh.blogspot.com/2014/07/bug-15931756-ora-4031-queries-against.html' title='Bug 15931756 - ORA-4031 Queries against SYS_FBA_TRACKEDTABLES not shared (do not use binds)'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:total>0</thr:total></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.page-5151012371039921477</id><published>2014-08-23T23:51:00.000+07:00</published><updated>2014-08-23T23:51:07.241+07:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#page'/><title type='text'>events</title><content type='html'>&lt;a href="http://mvelikikh.blogspot.ru/2014/07/event-10309.html"&gt;10309 trigger debug event&lt;/a&gt;&lt;br/&gt;&lt;a href="http://mvelikikh.blogspot.ru/2014/08/event-10384.html"&gt;10384 parallel dataflow scheduler tracing&lt;/a&gt;&lt;br/&gt;&lt;a href="http://mvelikikh.blogspot.ru/2014/08/event-10505.html"&gt;10505 CBO enable dynamic sampling dump to table&lt;/a&gt;</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/pages/default/5151012371039921477'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/pages/default/5151012371039921477'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/p/events.html' title='events'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.page-1938294855535431844</id><published>2014-07-21T13:55:00.000+07:00</published><updated>2014-07-21T13:55:06.221+07:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#page'/><title type='text'>Test page</title><content type='html'>&lt;pre class="brush: sql"&gt;&lt;br /&gt;SQL&gt; select dbms_metadata.get_ddl( 'USER', 'DBSNMP') from dual;&lt;br /&gt;&lt;br /&gt;DBMS_METADATA.GET_DDL('USER','DBSNMP')&lt;br /&gt;------------------------------------------------------------------------------------------------------------------------------&lt;br /&gt;-------------------------------------------------------------------------------------------------------------------&lt;br /&gt;&lt;br /&gt;   CREATE USER "DBSNMP" IDENTIFIED BY VALUES 'S:AB62E40A17E7758ED00ABA09E1BEF9A55D21265F2A2B7F905C5461A36F2E;E066D214D5421CCC'&lt;br /&gt;      DEFAULT TABLESPACE "SYSAUX"&lt;br /&gt;      TEMPORARY TABLESPACE "TEMP"&lt;br /&gt;      PASSWORD EXPIRE&lt;br /&gt;      ACCOUNT LOCK&lt;br /&gt;&lt;br /&gt;SQL&gt; select *&lt;br /&gt;  2    from dual&lt;br /&gt;  3  /&lt;br /&gt;&lt;br /&gt;D&lt;br /&gt;-&lt;br /&gt;X&lt;br /&gt;&lt;/pre&gt;</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/pages/default/1938294855535431844'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/pages/default/1938294855535431844'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/p/blog-page.html' title='Test page'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-7092062876430351871</id><published>2017-03-10T16:41:45.822+06:00</published><updated>2019-07-18T01:27:29.000+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'></title><content type='html'>Этот комментарий был удален администратором блога.</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/2341028443213888621/comments/default/7092062876430351871'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/2341028443213888621/comments/default/7092062876430351871'/><author><name>Unknown</name><uri>https://www.blogger.com/profile/12925256203702412312</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:in-reply-to href='https://mvelikikh.blogspot.com/2016/06/opatch-and-libpicl-on-solaris-sparc.html' ref='tag:blogger.com,1999:blog-3058240549611702067.post-2341028443213888621' source='https://www.blogger.com/feeds/3058240549611702067/posts/default/2341028443213888621' type='text/html'/><gd:extendedProperty name='blogger.contentRemoved' value='true'/><gd:extendedProperty name='blogger.itemClass' value='pid-15183404'/><gd:extendedProperty name='blogger.displayTime' value='10 марта 2017 г., 16:41'/></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-6435493063772195828</id><published>2017-12-20T02:27:16.178+06:00</published><updated>2017-12-20T02:27:16.178+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>Excellent article and provided the solution for th...</title><content type='html'>Excellent article and provided the solution for the exact problem I was facing.&lt;br /&gt;Thanks for the great analysis. I was banging my head against the wall until I came across this article.&lt;br /&gt;</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/2341028443213888621/comments/default/6435493063772195828'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/2341028443213888621/comments/default/6435493063772195828'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/2016/06/opatch-and-libpicl-on-solaris-sparc.html?showComment=1513715236178#c6435493063772195828' title=''/><author><name>Unknown</name><uri>https://www.blogger.com/profile/01546541504579282882</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:in-reply-to href='https://mvelikikh.blogspot.com/2016/06/opatch-and-libpicl-on-solaris-sparc.html' ref='tag:blogger.com,1999:blog-3058240549611702067.post-2341028443213888621' source='https://www.blogger.com/feeds/3058240549611702067/posts/default/2341028443213888621' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-333036942'/><gd:extendedProperty name='blogger.displayTime' value='20 декабря 2017 г., 02:27'/></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-9192104925787760875</id><published>2019-07-17T14:42:54.979+06:00</published><updated>2019-07-17T14:42:54.979+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>Three years later, I found this article of great u...</title><content type='html'>Three years later, I found this article of great use. Thanks a lot and congrats: I still cannot find the right documentation within Oracle site.&lt;br /&gt;</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/2341028443213888621/comments/default/9192104925787760875'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/2341028443213888621/comments/default/9192104925787760875'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/2016/06/opatch-and-libpicl-on-solaris-sparc.html?showComment=1563352974979#c9192104925787760875' title=''/><author><name>toposordo</name><uri>https://www.blogger.com/profile/09021682340372521077</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='32' height='32' src='//2.bp.blogspot.com/-4sFqAdUh3EM/UlKoYbiAeFI/AAAAAAAAABU/oM6DRUL3L_U/s32/cuenno.jpg'/></author><thr:in-reply-to href='https://mvelikikh.blogspot.com/2016/06/opatch-and-libpicl-on-solaris-sparc.html' ref='tag:blogger.com,1999:blog-3058240549611702067.post-2341028443213888621' source='https://www.blogger.com/feeds/3058240549611702067/posts/default/2341028443213888621' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-33892802'/><gd:extendedProperty name='blogger.displayTime' value='17 июля 2019 г., 14:42'/></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-6627494588208024993</id><published>2019-07-18T01:27:54.912+06:00</published><updated>2019-07-18T01:27:54.912+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>Thanks for the comment. Glad it helped.</title><content type='html'>Thanks for the comment. Glad it helped.</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/2341028443213888621/comments/default/6627494588208024993'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/2341028443213888621/comments/default/6627494588208024993'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/2016/06/opatch-and-libpicl-on-solaris-sparc.html?showComment=1563391674912#c6627494588208024993' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/2341028443213888621/comments/default/6435493063772195828'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:in-reply-to href='https://mvelikikh.blogspot.com/2016/06/opatch-and-libpicl-on-solaris-sparc.html' ref='tag:blogger.com,1999:blog-3058240549611702067.post-2341028443213888621' source='https://www.blogger.com/feeds/3058240549611702067/posts/default/2341028443213888621' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1378203249'/><gd:extendedProperty name='blogger.displayTime' value='18 июля 2019 г., 01:27'/></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-3722233906904335845</id><published>2019-07-18T01:28:09.878+06:00</published><updated>2019-07-18T01:28:09.878+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>Thanks your comment. It&amp;#39;s nice to hear that bl...</title><content type='html'>Thanks your comment. It&amp;#39;s nice to hear that blog posts like this are useful.</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/2341028443213888621/comments/default/3722233906904335845'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/2341028443213888621/comments/default/3722233906904335845'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/2016/06/opatch-and-libpicl-on-solaris-sparc.html?showComment=1563391689878#c3722233906904335845' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/2341028443213888621/comments/default/9192104925787760875'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:in-reply-to href='https://mvelikikh.blogspot.com/2016/06/opatch-and-libpicl-on-solaris-sparc.html' ref='tag:blogger.com,1999:blog-3058240549611702067.post-2341028443213888621' source='https://www.blogger.com/feeds/3058240549611702067/posts/default/2341028443213888621' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1378203249'/><gd:extendedProperty name='blogger.displayTime' value='18 июля 2019 г., 01:28'/></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-6419588516863138064</id><published>2020-03-27T15:56:33.473+06:00</published><updated>2020-03-27T15:56:33.473+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>Excellent investigation, Mihail!</title><content type='html'>Excellent investigation, Mihail!</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/6419588516863138064'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/6419588516863138064'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/2019/07/vdbpipes-unveiling-truth-of-oracle-hash.html?showComment=1585302993473#c6419588516863138064' title=''/><author><name>Igor Usoltsev</name><uri>https://www.blogger.com/profile/15303587951058938350</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='27' height='32' src='//1.bp.blogspot.com/_Rg_2iPaduR0/TOrnPBYUH9I/AAAAAAAAB3Q/nSrikZZlwzU/S220-s32/IMG_5628__.jpg'/></author><thr:in-reply-to href='https://mvelikikh.blogspot.com/2019/07/vdbpipes-unveiling-truth-of-oracle-hash.html' ref='tag:blogger.com,1999:blog-3058240549611702067.post-5927580525849202312' source='https://www.blogger.com/feeds/3058240549611702067/posts/default/5927580525849202312' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1511674857'/><gd:extendedProperty name='blogger.displayTime' value='27 марта 2020 г., 15:56'/></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-2705089227183702400</id><published>2020-05-18T00:48:44.778+06:00</published><updated>2020-05-18T00:48:44.778+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>It&amp;#39;s slightly augmented version. It allows to ...</title><content type='html'>It&amp;#39;s slightly augmented version. It allows to get hash for almost all namespaces in CDB and not in CDB. Now it&amp;#39;s possible for fast check for using or executing pl/sql procedures by user sessions using x$kgllk.&lt;br /&gt;&lt;br /&gt;select lower(rawtohex(utl_raw.concat(&lt;br /&gt;             utl_raw.reverse(utl_raw.substr(hv, 1, 4)),&lt;br /&gt;             utl_raw.reverse(utl_raw.substr(hv, 5, 4)),&lt;br /&gt;             utl_raw.reverse(utl_raw.substr(hv, 9, 4)),&lt;br /&gt;             utl_raw.reverse(utl_raw.substr(hv, 13, 4))&lt;br /&gt;           ))) ora_hash_value,&lt;br /&gt;           kglnahsv, kglnahsh, hex_hash, kglhdnsp, kglhdnsd, kglnacon, kglnaown, kglnaobj&lt;br /&gt;      from (select dbms_crypto.hash(rawtohex(kglnaobj || case&lt;br /&gt;                                                           when not kglnaown is null then &amp;#39;.&amp;#39; || kglnaown&lt;br /&gt;                                                         end || &lt;br /&gt;                                                         case&lt;br /&gt;                                                           when not kglnacon is null then &amp;#39;.&amp;#39; || kglnacon&lt;br /&gt;                                                         end ||&lt;br /&gt;                                                         chr(kglhdnsp) || chr(0)||chr(0)||chr(0)), 2) hv,&lt;br /&gt;                   kglnahsv, kglnahsh, to_char(kglnahsh, &amp;#39;fm0xxxxxxx&amp;#39;) hex_hash,&lt;br /&gt;                  kglhdnsp, kglhdnsd, kglnacon, kglnaown, kglnaobj&lt;br /&gt;             from x$kglob t&lt;br /&gt;            where kglhdnsp &amp;gt; 0&lt;br /&gt;              and not kglhdnsp in (45, 48, 75, 113))</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/2705089227183702400'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/2705089227183702400'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/2019/07/vdbpipes-unveiling-truth-of-oracle-hash.html?showComment=1589741324778#c2705089227183702400' title=''/><author><name>Golubov Anton</name><uri>https://www.blogger.com/profile/09912656428402662842</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:in-reply-to href='https://mvelikikh.blogspot.com/2019/07/vdbpipes-unveiling-truth-of-oracle-hash.html' ref='tag:blogger.com,1999:blog-3058240549611702067.post-5927580525849202312' source='https://www.blogger.com/feeds/3058240549611702067/posts/default/5927580525849202312' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-966503639'/><gd:extendedProperty name='blogger.displayTime' value='18 мая 2020 г., 00:48'/></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8470121173401300687</id><published>2020-05-18T09:03:29.851+06:00</published><updated>2020-05-18T09:03:29.851+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>Also, there is a function dbms_utility.get_sql_has...</title><content type='html'>Also, there is a function dbms_utility.get_sql_hash, which works faster than dbms_crypto.hash and return last 4 byte in reverse order itself.</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/8470121173401300687'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/8470121173401300687'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/2019/07/vdbpipes-unveiling-truth-of-oracle-hash.html?showComment=1589771009851#c8470121173401300687' title=''/><author><name>Golubov Anton</name><uri>https://www.blogger.com/profile/09912656428402662842</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:in-reply-to href='https://mvelikikh.blogspot.com/2019/07/vdbpipes-unveiling-truth-of-oracle-hash.html' ref='tag:blogger.com,1999:blog-3058240549611702067.post-5927580525849202312' source='https://www.blogger.com/feeds/3058240549611702067/posts/default/5927580525849202312' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-966503639'/><gd:extendedProperty name='blogger.displayTime' value='18 мая 2020 г., 09:03'/></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8558878200369662332</id><published>2020-05-19T02:46:49.958+06:00</published><updated>2020-05-19T02:46:49.958+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>Thanks for stopping by and providing the query.

I...</title><content type='html'>Thanks for stopping by and providing the query.&lt;br /&gt;&lt;br /&gt;I would also add the following namespaces for 19c: 129, 137, 138, 141&lt;br /&gt;&lt;br /&gt;select kglhdnsp, kglhdnsd, &lt;br /&gt;       count(*) total_objects,&lt;br /&gt;       count(decode(ora_hash_value, kglnahsv, 1)) matched,&lt;br /&gt;       count(decode(ora_hash_value, kglnahsv, null, 1)) non_matched,&lt;br /&gt;       trunc(count(decode(ora_hash_value, kglnahsv, 1))/count(*)*100, 3) matched_pct&lt;br /&gt;  from (select lower(rawtohex(utl_raw.concat(&lt;br /&gt;                 utl_raw.reverse(utl_raw.substr(hv, 1, 4)),&lt;br /&gt;                 utl_raw.reverse(utl_raw.substr(hv, 5, 4)),&lt;br /&gt;                 utl_raw.reverse(utl_raw.substr(hv, 9, 4)),&lt;br /&gt;                 utl_raw.reverse(utl_raw.substr(hv, 13, 4))&lt;br /&gt;               ))) ora_hash_value,&lt;br /&gt;               kglnahsv, kglnahsh, hex_hash, kglhdnsp, kglhdnsd, kglnacon, kglnaown, kglnaobj&lt;br /&gt;          from (select dbms_crypto.hash(rawtohex(kglnaobj &lt;br /&gt;                         || case&lt;br /&gt;                              when not kglnaown is null &lt;br /&gt;                              then &amp;#39;.&amp;#39; || kglnaown&lt;br /&gt;                            end &lt;br /&gt;                         || case&lt;br /&gt;                              when not kglnacon is null &lt;br /&gt;                              then &amp;#39;.&amp;#39; || kglnacon&lt;br /&gt;                            end &lt;br /&gt;                         || chr(kglhdnsp) &lt;br /&gt;                         || chr(0)||chr(0)||chr(0)), 2) hv,&lt;br /&gt;                       kglnahsv,&lt;br /&gt;                       kglnahsh,&lt;br /&gt;                       to_char(kglnahsh, &amp;#39;fm0xxxxxxx&amp;#39;) hex_hash,&lt;br /&gt;                       kglhdnsp,&lt;br /&gt;                       kglhdnsd,&lt;br /&gt;                       kglnacon,&lt;br /&gt;                       kglnaown,&lt;br /&gt;                       kglnaobj&lt;br /&gt;                  from x$kglob t&lt;br /&gt;                 where kglhdnsp &amp;gt; 0)&lt;br /&gt;       )&lt;br /&gt; group by kglhdnsp, kglhdnsd&lt;br /&gt; order by kglhdnsp;&lt;br /&gt;&lt;br /&gt;KGLHDNSP KGLHDNSD                          TOTAL  MATCHED NON_MATCHED MATCHED_PCT&lt;br /&gt;-------- ------------------------------ -------- -------- ----------- -----------&lt;br /&gt;       1 TABLE/PROCEDURE                    1437     1431           6      99.582&lt;br /&gt;       2 BODY                                 51       51           0         100&lt;br /&gt;       3 TRIGGER                               3        3           0         100&lt;br /&gt;       4 INDEX                               155      155           0         100&lt;br /&gt;       5 CLUSTER                              21       21           0         100&lt;br /&gt;      10 QUEUE                                 2        2           0         100&lt;br /&gt;      18 PUB SUB INTERNAL INFORMATION          3        3           0         100&lt;br /&gt;      23 RULESET                               1        1           0         100&lt;br /&gt;      45 MULTI-VERSION OBJECT FOR TABLE       32        0          32           0&lt;br /&gt;      48 MULTI-VERSION OBJECT FOR INDEX       27        0          27           0&lt;br /&gt;      51 SCHEDULER GLOBAL ATTRIBUTE            4        4           0         100&lt;br /&gt;      64 EDITION                               2        2           0         100&lt;br /&gt;      69 DBLINK                                1        1           0         100&lt;br /&gt;      73 SCHEMA                                7        7           0         100&lt;br /&gt;      74 DBINSTANCE                            3        3           0         100&lt;br /&gt;      75 SQL AREA STATS                     1097        0        1097           0&lt;br /&gt;      82 SQL AREA BUILD                      421      421           0         100&lt;br /&gt;      93 AUDIT POLICY                          4        4           0         100&lt;br /&gt;     103 OPTIMIZER FINDING                     8        8           0         100&lt;br /&gt;     104 OPTIMIZER DIRECTIVE OWNER            48       48           0         100&lt;br /&gt;     129 FED APP                               1        0           1           0&lt;br /&gt;     137 OPTIMIZER EXPRESSION HEADER          28        0          28           0&lt;br /&gt;     138 OPTIMIZER EXPRESSION OBJECT           3        0           3           0&lt;br /&gt;     141 RUNTIME STATISTICS                  110        0         110           0&lt;br /&gt;&lt;br /&gt;Judging by my databases, all of those namespace 1 hash mismatches are due to multitenant features: X$CDBVW$/X$OBLNK$ - the containers clause and object links correspondingly.&lt;br /&gt;</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/8558878200369662332'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/8558878200369662332'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/2019/07/vdbpipes-unveiling-truth-of-oracle-hash.html?showComment=1589834809958#c8558878200369662332' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/2705089227183702400'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:in-reply-to href='https://mvelikikh.blogspot.com/2019/07/vdbpipes-unveiling-truth-of-oracle-hash.html' ref='tag:blogger.com,1999:blog-3058240549611702067.post-5927580525849202312' source='https://www.blogger.com/feeds/3058240549611702067/posts/default/5927580525849202312' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1378203249'/><gd:extendedProperty name='blogger.displayTime' value='19 мая 2020 г., 02:46'/></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-3057870235608611332</id><published>2020-05-19T03:10:13.347+06:00</published><updated>2020-05-19T03:10:13.347+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>Thanks for the tip. I was surprised to find that D...</title><content type='html'>Thanks for the tip. I was surprised to find that DBMS_UTILITY.GET_SQL_HASH is a way more faster than DBMS_CRYPTO.HASH.&lt;br /&gt;I see that the former is done through an ICD function, whereas the latter calls an external C library.&lt;br /&gt;I am going to compare these functions using FlameGraphs to identify the root cause: https://github.com/brendangregg/FlameGraph&lt;br /&gt;&lt;br /&gt;DBMS_UTILITY.GET_SQL_HASH has OUT parameters, though, so that it requires a bit of work to use it in an SQL statement.&lt;br /&gt;I would rather go for DBMS_SQL_TRANSLATOR.SQL_HASH if a pure SQL solution is required and performance is not a concern.&lt;br /&gt;&lt;br /&gt;DBMS_UTILITY.GET_SQL_HASH returns an MD5 hash in its OUT-parameter, indeed, which has to be modified in order to get KGLNAHSV:&lt;br /&gt;&lt;br /&gt;var hv varchar2(32)&lt;br /&gt;var pre10ihash number&lt;br /&gt;exec dbms_output.put_line(dbms_utility.get_sql_hash(&amp;#39;select /* test_query*/* from dual&amp;#39;||chr(0), :hv, :pre10ihash))&lt;br /&gt;&lt;br /&gt;print hv&lt;br /&gt;&lt;br /&gt;select /* test_query*/* from dual;&lt;br /&gt;&lt;br /&gt;select kglnahsh, kglnahsv&lt;br /&gt;  from x$kglob&lt;br /&gt; where kglnaobj=&amp;#39;select /* test_query*/* from dual&amp;#39;;&lt;br /&gt;&lt;br /&gt;DBMS_UTILITY.GET_SQL_HASH(HASH_VALUE): &lt;br /&gt;5E80AD80D50E1C809454E8B352F7E43B&lt;br /&gt;&lt;br /&gt;KGLNAHSV: 80ad805e801c0ed5b3e854943be4f752&lt;br /&gt;</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/3057870235608611332'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/3057870235608611332'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/2019/07/vdbpipes-unveiling-truth-of-oracle-hash.html?showComment=1589836213347#c3057870235608611332' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/8470121173401300687'/><author><name>Mikhail Velikikh</name><uri>https://www.blogger.com/profile/12809585068205118395</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:in-reply-to href='https://mvelikikh.blogspot.com/2019/07/vdbpipes-unveiling-truth-of-oracle-hash.html' ref='tag:blogger.com,1999:blog-3058240549611702067.post-5927580525849202312' source='https://www.blogger.com/feeds/3058240549611702067/posts/default/5927580525849202312' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1378203249'/><gd:extendedProperty name='blogger.displayTime' value='19 мая 2020 г., 03:10'/></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-771755456854450227</id><published>2020-05-25T09:54:55.304+06:00</published><updated>2020-05-25T09:54:55.304+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>Yes, it&amp;#39;s more suitable for pl/sql, and faster...</title><content type='html'>Yes, it&amp;#39;s more suitable for pl/sql, and faster in practice. I use result of this function, which is  kglnahsh, not kglnahsv. kglnahsh is more intresting because of indexes on it. In order to discard possible duplicats caused by hashing we can use x$kglob accessed by index on column x$kglob.kglnahsh and it&amp;#39;s column kglhadr to compare with x$kgllk.kgllkhdl</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/771755456854450227'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/771755456854450227'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/2019/07/vdbpipes-unveiling-truth-of-oracle-hash.html?showComment=1590378895304#c771755456854450227' title=''/><link rel='related' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/5927580525849202312/comments/default/8470121173401300687'/><author><name>Golubov Anton</name><uri>https://www.blogger.com/profile/09912656428402662842</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:in-reply-to href='https://mvelikikh.blogspot.com/2019/07/vdbpipes-unveiling-truth-of-oracle-hash.html' ref='tag:blogger.com,1999:blog-3058240549611702067.post-5927580525849202312' source='https://www.blogger.com/feeds/3058240549611702067/posts/default/5927580525849202312' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-966503639'/><gd:extendedProperty name='blogger.displayTime' value='25 мая 2020 г., 09:54'/></entry><entry><id>tag:blogger.com,1999:blog-3058240549611702067.post-8041840257961401070</id><published>2020-08-21T14:32:07.968+06:00</published><updated>2020-08-21T14:32:07.968+06:00</updated><category scheme='http://schemas.google.com/g/2005#kind' term='http://schemas.google.com/blogger/2008/kind#comment'/><title type='text'>I learned a lot from your post - thanks.

Interest...</title><content type='html'>I learned a lot from your post - thanks.&lt;br /&gt;&lt;br /&gt;Interestingly, I couldn&amp;#39;t reproduce ORA-04036 with fill_memory, despite exceeding the limit.&lt;br /&gt;&lt;br /&gt;SQL&amp;gt; select max(pga_alloc_mem)/power(1024,2) from v$process ;&lt;br /&gt;&lt;br /&gt;MAX(PGA_ALLOC_MEM)/POWER(1024,2)&lt;br /&gt;--------------------------------&lt;br /&gt;                      6466.71202&lt;br /&gt;&lt;br /&gt;SQL&amp;gt; show parameter pga&lt;br /&gt;&lt;br /&gt;PARAMETER_NAME                                               TYPE        VALUE&lt;br /&gt;------------------------------------------------------------ ----------- ----------------------------------------------------------------------------------------------------&lt;br /&gt;pga_aggregate_limit                                          big integer 2G&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;SQL&amp;gt; !dbhome&lt;br /&gt;.../product/19.7.0.0.200414&lt;br /&gt;&lt;br /&gt;Best regards,&lt;br /&gt;Nenad</content><link rel='edit' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/7229504241509854539/comments/default/8041840257961401070'/><link rel='self' type='application/atom+xml' href='https://www.blogger.com/feeds/3058240549611702067/7229504241509854539/comments/default/8041840257961401070'/><link rel='alternate' type='text/html' href='http://mvelikikh.blogspot.com/2019/07/ora-04036-troubleshooting-error-stack.html?showComment=1597998727968#c8041840257961401070' title=''/><author><name>Unknown</name><uri>https://www.blogger.com/profile/10528618968191154913</uri><email>noreply@blogger.com</email><gd:image rel='http://schemas.google.com/g/2005#thumbnail' width='35' height='35' src='//www.blogger.com/img/blogger_logo_round_35.png'/></author><thr:in-reply-to href='https://mvelikikh.blogspot.com/2019/07/ora-04036-troubleshooting-error-stack.html' ref='tag:blogger.com,1999:blog-3058240549611702067.post-7229504241509854539' source='https://www.blogger.com/feeds/3058240549611702067/posts/default/7229504241509854539' type='text/html'/><gd:extendedProperty name='blogger.itemClass' value='pid-1935896610'/><gd:extendedProperty name='blogger.displayTime' value='21 августа 2020 г., 14:32'/></entry></feed>